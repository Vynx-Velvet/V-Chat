/*! For license information please see main.679bcfd0.js.LICENSE.txt */
(()=>{"use strict";var e={730:(e,t,n)=>{var r=n(43),i=n(853);function s(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var o=new Set,a={};function l(e,t){u(e,t),u(e+"Capture",t)}function u(e,t){for(a[e]=t,e=0;e<t.length;e++)o.add(t[e])}var c=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),h=Object.prototype.hasOwnProperty,d=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},p={};function m(e,t,n,r,i,s,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=o}var g={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){g[e]=new m(e,0,!1,e,null,!1,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];g[t]=new m(t,1,!1,e[1],null,!1,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){g[e]=new m(e,2,!1,e.toLowerCase(),null,!1,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){g[e]=new m(e,2,!1,e,null,!1,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){g[e]=new m(e,3,!1,e.toLowerCase(),null,!1,!1)})),["checked","multiple","muted","selected"].forEach((function(e){g[e]=new m(e,3,!0,e,null,!1,!1)})),["capture","download"].forEach((function(e){g[e]=new m(e,4,!1,e,null,!1,!1)})),["cols","rows","size","span"].forEach((function(e){g[e]=new m(e,6,!1,e,null,!1,!1)})),["rowSpan","start"].forEach((function(e){g[e]=new m(e,5,!1,e.toLowerCase(),null,!1,!1)}));var v=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function w(e,t,n,r){var i=g.hasOwnProperty(t)?g[t]:null;(null!==i?0!==i.type:r||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!h.call(p,e)||!h.call(f,e)&&(d.test(e)?p[e]=!0:(f[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,null,!1,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(v,y);g[t]=new m(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)})),["tabIndex","crossOrigin"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!1,!1)})),g.xlinkHref=new m("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach((function(e){g[e]=new m(e,1,!1,e.toLowerCase(),null,!0,!0)}));var b=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,_=Symbol.for("react.element"),I=Symbol.for("react.portal"),S=Symbol.for("react.fragment"),E=Symbol.for("react.strict_mode"),T=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),C=Symbol.for("react.context"),x=Symbol.for("react.forward_ref"),N=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),P=Symbol.for("react.memo"),R=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var D=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var O=Symbol.iterator;function L(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=O&&e[O]||e["@@iterator"])?e:null}var M,F=Object.assign;function U(e){if(void 0===M)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);M=t&&t[1]||""}return"\n"+M+e}var j=!1;function V(e,t){if(!e||j)return"";j=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&"string"===typeof u.stack){for(var i=u.stack.split("\n"),s=r.stack.split("\n"),o=i.length-1,a=s.length-1;1<=o&&0<=a&&i[o]!==s[a];)a--;for(;1<=o&&0<=a;o--,a--)if(i[o]!==s[a]){if(1!==o||1!==a)do{if(o--,0>--a||i[o]!==s[a]){var l="\n"+i[o].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}}while(1<=o&&0<=a);break}}}finally{j=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?U(e):""}function z(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=V(e.type,!1);case 11:return e=V(e.type.render,!1);case 1:return e=V(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case S:return"Fragment";case I:return"Portal";case T:return"Profiler";case E:return"StrictMode";case N:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case C:return(e.displayName||"Context")+".Consumer";case k:return(e._context.displayName||"Context")+".Provider";case x:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case P:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case R:t=e._payload,e=e._init;try{return B(e(t))}catch(n){}}return null}function q(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===E?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function $(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function K(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function G(e){e._valueTracker||(e._valueTracker=function(e){var t=K(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,s.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function H(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=K(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function W(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(Yt){return e.body}}function Q(e,t){var n=t.checked;return F({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function J(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=$(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Y(e,t){null!=(t=t.checked)&&w(e,"checked",t,!1)}function X(e,t){Y(e,t);var n=$(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,n):t.hasOwnProperty("defaultValue")&&ee(e,t.type,$(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function ee(e,t,n){"number"===t&&W(e.ownerDocument)===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var te=Array.isArray;function ne(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+$(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function re(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(s(91));return F({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ie(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(s(92));if(te(n)){if(1<n.length)throw Error(s(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:$(n)}}function se(e,t){var n=$(t.value),r=$(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function oe(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ae(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function le(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ae(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ue,ce,he=(ce=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ue=ue||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ue.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,n,r){MSApp.execUnsafeLocalFunction((function(){return ce(e,t)}))}:ce);function de(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},pe=["Webkit","ms","Moz","O"];function me(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function ge(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=me(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(fe).forEach((function(e){pe.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]}))}));var ve=F({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ve[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(s(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(s(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(s(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(s(62))}}function we(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var be=null;function _e(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var Ie=null,Se=null,Ee=null;function Te(e){if(e=Ii(e)){if("function"!==typeof Ie)throw Error(s(280));var t=e.stateNode;t&&(t=Ei(t),Ie(e.stateNode,e.type,t))}}function ke(e){Se?Ee?Ee.push(e):Ee=[e]:Se=e}function Ce(){if(Se){var e=Se,t=Ee;if(Ee=Se=null,Te(e),t)for(e=0;e<t.length;e++)Te(t[e])}}function xe(e,t){return e(t)}function Ne(){}var Ae=!1;function Pe(e,t,n){if(Ae)return e(t,n);Ae=!0;try{return xe(e,t,n)}finally{Ae=!1,(null!==Se||null!==Ee)&&(Ne(),Ce())}}function Re(e,t){var n=e.stateNode;if(null===n)return null;var r=Ei(n);if(null===r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(s(231,t,typeof n));return n}var De=!1;if(c)try{var Oe={};Object.defineProperty(Oe,"passive",{get:function(){De=!0}}),window.addEventListener("test",Oe,Oe),window.removeEventListener("test",Oe,Oe)}catch(ce){De=!1}function Le(e,t,n,r,i,s,o,a,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var Me=!1,Fe=null,Ue=!1,je=null,Ve={onError:function(e){Me=!0,Fe=e}};function ze(e,t,n,r,i,s,o,a,l){Me=!1,Fe=null,Le.apply(Ve,arguments)}function Be(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function qe(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function $e(e){if(Be(e)!==e)throw Error(s(188))}function Ke(e){return e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(s(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return $e(i),e;if(o===r)return $e(i),t;o=o.sibling}throw Error(s(188))}if(n.return!==r.return)n=i,r=o;else{for(var a=!1,l=i.child;l;){if(l===n){a=!0,n=i,r=o;break}if(l===r){a=!0,r=i,n=o;break}l=l.sibling}if(!a){for(l=o.child;l;){if(l===n){a=!0,n=o,r=i;break}if(l===r){a=!0,r=o,n=i;break}l=l.sibling}if(!a)throw Error(s(189))}}if(n.alternate!==r)throw Error(s(190))}if(3!==n.tag)throw Error(s(188));return n.stateNode.current===n?e:t}(e),null!==e?Ge(e):null}function Ge(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=Ge(e);if(null!==t)return t;e=e.sibling}return null}var He=i.unstable_scheduleCallback,We=i.unstable_cancelCallback,Qe=i.unstable_shouldYield,Je=i.unstable_requestPaint,Ye=i.unstable_now,Xe=i.unstable_getCurrentPriorityLevel,Ze=i.unstable_ImmediatePriority,et=i.unstable_UserBlockingPriority,tt=i.unstable_NormalPriority,nt=i.unstable_LowPriority,rt=i.unstable_IdlePriority,it=null,st=null;var ot=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(at(e)/lt|0)|0},at=Math.log,lt=Math.LN2;var ut=64,ct=4194304;function ht(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function dt(e,t){var n=e.pendingLanes;if(0===n)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,o=268435455&n;if(0!==o){var a=o&~i;0!==a?r=ht(a):0!==(s&=o)&&(r=ht(s))}else 0!==(o=n&~i)?r=ht(o):0!==s&&(r=ht(s));if(0===r)return 0;if(0!==t&&t!==r&&0===(t&i)&&((i=r&-r)>=(s=t&-t)||16===i&&0!==(4194240&s)))return t;if(0!==(4&r)&&(r|=16&n),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=r;0<t;)i=1<<(n=31-ot(t)),r|=e[n],t&=~i;return r}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function pt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function mt(){var e=ut;return 0===(4194240&(ut<<=1))&&(ut=64),e}function gt(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function vt(e,t,n){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-ot(t)]=n}function yt(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-ot(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var wt=0;function bt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var _t,It,St,Et,Tt,kt=!1,Ct=[],xt=null,Nt=null,At=null,Pt=new Map,Rt=new Map,Dt=[],Ot="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Lt(e,t){switch(e){case"focusin":case"focusout":xt=null;break;case"dragenter":case"dragleave":Nt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Pt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Rt.delete(t.pointerId)}}function Mt(e,t,n,r,i,s){return null===e||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},null!==t&&(null!==(t=Ii(t))&&It(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,null!==i&&-1===t.indexOf(i)&&t.push(i),e)}function Ft(e){var t=_i(e.target);if(null!==t){var n=Be(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=qe(n)))return e.blockedOn=t,void Tt(e.priority,(function(){St(n)}))}else if(3===t&&n.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var n=Qt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==n)return null!==(t=Ii(n))&&It(t),e.blockedOn=n,!1;var r=new(n=e.nativeEvent).constructor(n.type,n);be=r,n.target.dispatchEvent(r),be=null,t.shift()}return!0}function jt(e,t,n){Ut(e)&&n.delete(t)}function Vt(){kt=!1,null!==xt&&Ut(xt)&&(xt=null),null!==Nt&&Ut(Nt)&&(Nt=null),null!==At&&Ut(At)&&(At=null),Pt.forEach(jt),Rt.forEach(jt)}function zt(e,t){e.blockedOn===t&&(e.blockedOn=null,kt||(kt=!0,i.unstable_scheduleCallback(i.unstable_NormalPriority,Vt)))}function Bt(e){function t(t){return zt(t,e)}if(0<Ct.length){zt(Ct[0],e);for(var n=1;n<Ct.length;n++){var r=Ct[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==xt&&zt(xt,e),null!==Nt&&zt(Nt,e),null!==At&&zt(At,e),Pt.forEach(t),Rt.forEach(t),n=0;n<Dt.length;n++)(r=Dt[n]).blockedOn===e&&(r.blockedOn=null);for(;0<Dt.length&&null===(n=Dt[0]).blockedOn;)Ft(n),null===n.blockedOn&&Dt.shift()}var qt=b.ReactCurrentBatchConfig,$t=!0;function Kt(e,t,n,r){var i=wt,s=qt.transition;qt.transition=null;try{wt=1,Ht(e,t,n,r)}finally{wt=i,qt.transition=s}}function Gt(e,t,n,r){var i=wt,s=qt.transition;qt.transition=null;try{wt=4,Ht(e,t,n,r)}finally{wt=i,qt.transition=s}}function Ht(e,t,n,r){if($t){var i=Qt(e,t,n,r);if(null===i)Hr(e,t,r,Wt,n),Lt(e,r);else if(function(e,t,n,r,i){switch(t){case"focusin":return xt=Mt(xt,e,t,n,r,i),!0;case"dragenter":return Nt=Mt(Nt,e,t,n,r,i),!0;case"mouseover":return At=Mt(At,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Pt.set(s,Mt(Pt.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,Rt.set(s,Mt(Rt.get(s)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r))r.stopPropagation();else if(Lt(e,r),4&t&&-1<Ot.indexOf(e)){for(;null!==i;){var s=Ii(i);if(null!==s&&_t(s),null===(s=Qt(e,t,n,r))&&Hr(e,t,r,Wt,n),s===i)break;i=s}null!==i&&r.stopPropagation()}else Hr(e,t,r,null,n)}}var Wt=null;function Qt(e,t,n,r){if(Wt=null,null!==(e=_i(e=_e(r))))if(null===(t=Be(e)))e=null;else if(13===(n=t.tag)){if(null!==(e=qe(t)))return e;e=null}else if(3===n){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return Wt=e,null}function Jt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case nt:return 16;case rt:return 536870912;default:return 16}default:return 16}}var Xt=null,Zt=null,en=null;function tn(){if(en)return en;var e,t,n=Zt,r=n.length,i="value"in Xt?Xt.value:Xt.textContent,s=i.length;for(e=0;e<r&&n[e]===i[e];e++);var o=r-e;for(t=1;t<=o&&n[r-t]===i[s-t];t++);return en=i.slice(e,1<t?1-t:void 0)}function nn(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function rn(){return!0}function sn(){return!1}function on(e){function t(t,n,r,i,s){for(var o in this._reactName=t,this._targetInst=r,this.type=n,this.nativeEvent=i,this.target=s,this.currentTarget=null,e)e.hasOwnProperty(o)&&(t=e[o],this[o]=t?t(i):i[o]);return this.isDefaultPrevented=(null!=i.defaultPrevented?i.defaultPrevented:!1===i.returnValue)?rn:sn,this.isPropagationStopped=sn,this}return F(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=rn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=rn)},persist:function(){},isPersistent:rn}),t}var an,ln,un,cn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},hn=on(cn),dn=F({},cn,{view:0,detail:0}),fn=on(dn),pn=F({},dn,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:kn,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==un&&(un&&"mousemove"===e.type?(an=e.screenX-un.screenX,ln=e.screenY-un.screenY):ln=an=0,un=e),an)},movementY:function(e){return"movementY"in e?e.movementY:ln}}),mn=on(pn),gn=on(F({},pn,{dataTransfer:0})),vn=on(F({},dn,{relatedTarget:0})),yn=on(F({},cn,{animationName:0,elapsedTime:0,pseudoElement:0})),wn=F({},cn,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),bn=on(wn),_n=on(F({},cn,{data:0})),In={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Sn={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},En={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tn(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=En[e])&&!!t[e]}function kn(){return Tn}var Cn=F({},dn,{key:function(e){if(e.key){var t=In[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=nn(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Sn[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:kn,charCode:function(e){return"keypress"===e.type?nn(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?nn(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),xn=on(Cn),Nn=on(F({},pn,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),An=on(F({},dn,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:kn})),Pn=on(F({},cn,{propertyName:0,elapsedTime:0,pseudoElement:0})),Rn=F({},pn,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Dn=on(Rn),On=[9,13,27,32],Ln=c&&"CompositionEvent"in window,Mn=null;c&&"documentMode"in document&&(Mn=document.documentMode);var Fn=c&&"TextEvent"in window&&!Mn,Un=c&&(!Ln||Mn&&8<Mn&&11>=Mn),jn=String.fromCharCode(32),Vn=!1;function zn(e,t){switch(e){case"keyup":return-1!==On.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Bn(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var qn=!1;var $n={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Kn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!$n[e.type]:"textarea"===t}function Gn(e,t,n,r){ke(r),0<(t=Qr(t,"onChange")).length&&(n=new hn("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var Hn=null,Wn=null;function Qn(e){zr(e,0)}function Jn(e){if(H(Si(e)))return e}function Xn(e,t){if("change"===e)return t}var Zn=!1;if(c){var er;if(c){var tr="oninput"in document;if(!tr){var nr=document.createElement("div");nr.setAttribute("oninput","return;"),tr="function"===typeof nr.oninput}er=tr}else er=!1;Zn=er&&(!document.documentMode||9<document.documentMode)}function rr(){Hn&&(Hn.detachEvent("onpropertychange",ir),Wn=Hn=null)}function ir(e){if("value"===e.propertyName&&Jn(Wn)){var t=[];Gn(t,Wn,e,_e(e)),Pe(Qn,t)}}function sr(e,t,n){"focusin"===e?(rr(),Wn=n,(Hn=t).attachEvent("onpropertychange",ir)):"focusout"===e&&rr()}function or(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return Jn(Wn)}function ar(e,t){if("click"===e)return Jn(t)}function lr(e,t){if("input"===e||"change"===e)return Jn(t)}var ur="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function cr(e,t){if(ur(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!h.call(t,i)||!ur(e[i],t[i]))return!1}return!0}function hr(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function dr(e,t){var n,r=hr(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=hr(r)}}function fr(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?fr(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function pr(){for(var e=window,t=W();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=W((e=t.contentWindow).document)}return t}function mr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function gr(e){var t=pr(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&fr(n.ownerDocument.documentElement,n)){if(null!==r&&mr(n))if(t=r.start,void 0===(e=r.end)&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if((e=(t=n.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=void 0===r.end?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=dr(n,s);var o=dr(n,r);i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)&&((t=t.createRange()).setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(o.node,o.offset)):(t.setEnd(o.node,o.offset),e.addRange(t)))}for(t=[],e=n;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof n.focus&&n.focus(),n=0;n<t.length;n++)(e=t[n]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var yr=c&&"documentMode"in document&&11>=document.documentMode,wr=null,br=null,_r=null,Ir=!1;function Sr(e,t,n){var r=n.window===n?n.document:9===n.nodeType?n:n.ownerDocument;Ir||null==wr||wr!==W(r)||("selectionStart"in(r=wr)&&mr(r)?r={start:r.selectionStart,end:r.selectionEnd}:r={anchorNode:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset},_r&&cr(_r,r)||(_r=r,0<(r=Qr(br,"onSelect")).length&&(t=new hn("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=wr)))}function Er(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Tr={animationend:Er("Animation","AnimationEnd"),animationiteration:Er("Animation","AnimationIteration"),animationstart:Er("Animation","AnimationStart"),transitionend:Er("Transition","TransitionEnd")},kr={},Cr={};function xr(e){if(kr[e])return kr[e];if(!Tr[e])return e;var t,n=Tr[e];for(t in n)if(n.hasOwnProperty(t)&&t in Cr)return kr[e]=n[t];return e}c&&(Cr=document.createElement("div").style,"AnimationEvent"in window||(delete Tr.animationend.animation,delete Tr.animationiteration.animation,delete Tr.animationstart.animation),"TransitionEvent"in window||delete Tr.transitionend.transition);var Nr=xr("animationend"),Ar=xr("animationiteration"),Pr=xr("animationstart"),Rr=xr("transitionend"),Dr=new Map,Or="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Lr(e,t){Dr.set(e,t),l(t,[e])}for(var Mr=0;Mr<Or.length;Mr++){var Fr=Or[Mr];Lr(Fr.toLowerCase(),"on"+(Fr[0].toUpperCase()+Fr.slice(1)))}Lr(Nr,"onAnimationEnd"),Lr(Ar,"onAnimationIteration"),Lr(Pr,"onAnimationStart"),Lr("dblclick","onDoubleClick"),Lr("focusin","onFocus"),Lr("focusout","onBlur"),Lr(Rr,"onTransitionEnd"),u("onMouseEnter",["mouseout","mouseover"]),u("onMouseLeave",["mouseout","mouseover"]),u("onPointerEnter",["pointerout","pointerover"]),u("onPointerLeave",["pointerout","pointerover"]),l("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),l("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),l("onBeforeInput",["compositionend","keypress","textInput","paste"]),l("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),l("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ur="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),jr=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ur));function Vr(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,function(e,t,n,r,i,o,a,l,u){if(ze.apply(this,arguments),Me){if(!Me)throw Error(s(198));var c=Fe;Me=!1,Fe=null,Ue||(Ue=!0,je=c)}}(r,t,void 0,e),e.currentTarget=null}function zr(e,t){t=0!==(4&t);for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,u=a.currentTarget;if(a=a.listener,l!==s&&i.isPropagationStopped())break e;Vr(i,a,u),s=l}else for(o=0;o<r.length;o++){if(l=(a=r[o]).instance,u=a.currentTarget,a=a.listener,l!==s&&i.isPropagationStopped())break e;Vr(i,a,u),s=l}}}if(Ue)throw e=je,Ue=!1,je=null,e}function Br(e,t){var n=t[yi];void 0===n&&(n=t[yi]=new Set);var r=e+"__bubble";n.has(r)||(Gr(t,e,2,!1),n.add(r))}function qr(e,t,n){var r=0;t&&(r|=4),Gr(n,e,r,t)}var $r="_reactListening"+Math.random().toString(36).slice(2);function Kr(e){if(!e[$r]){e[$r]=!0,o.forEach((function(t){"selectionchange"!==t&&(jr.has(t)||qr(t,!1,e),qr(t,!0,e))}));var t=9===e.nodeType?e:e.ownerDocument;null===t||t[$r]||(t[$r]=!0,qr("selectionchange",!1,t))}}function Gr(e,t,n,r){switch(Jt(t)){case 1:var i=Kt;break;case 4:i=Gt;break;default:i=Ht}n=i.bind(null,t,n,e),i=void 0,!De||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(i=!0),r?void 0!==i?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):void 0!==i?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Hr(e,t,n,r,i){var s=r;if(0===(1&t)&&0===(2&t)&&null!==r)e:for(;;){if(null===r)return;var o=r.tag;if(3===o||4===o){var a=r.stateNode.containerInfo;if(a===i||8===a.nodeType&&a.parentNode===i)break;if(4===o)for(o=r.return;null!==o;){var l=o.tag;if((3===l||4===l)&&((l=o.stateNode.containerInfo)===i||8===l.nodeType&&l.parentNode===i))return;o=o.return}for(;null!==a;){if(null===(o=_i(a)))return;if(5===(l=o.tag)||6===l){r=s=o;continue e}a=a.parentNode}}r=r.return}Pe((function(){var r=s,i=_e(n),o=[];e:{var a=Dr.get(e);if(void 0!==a){var l=hn,u=e;switch(e){case"keypress":if(0===nn(n))break e;case"keydown":case"keyup":l=xn;break;case"focusin":u="focus",l=vn;break;case"focusout":u="blur",l=vn;break;case"beforeblur":case"afterblur":l=vn;break;case"click":if(2===n.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":l=mn;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":l=gn;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":l=An;break;case Nr:case Ar:case Pr:l=yn;break;case Rr:l=Pn;break;case"scroll":l=fn;break;case"wheel":l=Dn;break;case"copy":case"cut":case"paste":l=bn;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":l=Nn}var c=0!==(4&t),h=!c&&"scroll"===e,d=c?null!==a?a+"Capture":null:a;c=[];for(var f,p=r;null!==p;){var m=(f=p).stateNode;if(5===f.tag&&null!==m&&(f=m,null!==d&&(null!=(m=Re(p,d))&&c.push(Wr(p,m,f)))),h)break;p=p.return}0<c.length&&(a=new l(a,u,null,n,i),o.push({event:a,listeners:c}))}}if(0===(7&t)){if(l="mouseout"===e||"pointerout"===e,(!(a="mouseover"===e||"pointerover"===e)||n===be||!(u=n.relatedTarget||n.fromElement)||!_i(u)&&!u[vi])&&(l||a)&&(a=i.window===i?i:(a=i.ownerDocument)?a.defaultView||a.parentWindow:window,l?(l=r,null!==(u=(u=n.relatedTarget||n.toElement)?_i(u):null)&&(u!==(h=Be(u))||5!==u.tag&&6!==u.tag)&&(u=null)):(l=null,u=r),l!==u)){if(c=mn,m="onMouseLeave",d="onMouseEnter",p="mouse","pointerout"!==e&&"pointerover"!==e||(c=Nn,m="onPointerLeave",d="onPointerEnter",p="pointer"),h=null==l?a:Si(l),f=null==u?a:Si(u),(a=new c(m,p+"leave",l,n,i)).target=h,a.relatedTarget=f,m=null,_i(i)===r&&((c=new c(d,p+"enter",u,n,i)).target=f,c.relatedTarget=h,m=c),h=m,l&&u)e:{for(d=u,p=0,f=c=l;f;f=Jr(f))p++;for(f=0,m=d;m;m=Jr(m))f++;for(;0<p-f;)c=Jr(c),p--;for(;0<f-p;)d=Jr(d),f--;for(;p--;){if(c===d||null!==d&&c===d.alternate)break e;c=Jr(c),d=Jr(d)}c=null}else c=null;null!==l&&Yr(o,a,l,c,!1),null!==u&&null!==h&&Yr(o,h,u,c,!0)}if("select"===(l=(a=r?Si(r):window).nodeName&&a.nodeName.toLowerCase())||"input"===l&&"file"===a.type)var g=Xn;else if(Kn(a))if(Zn)g=lr;else{g=or;var v=sr}else(l=a.nodeName)&&"input"===l.toLowerCase()&&("checkbox"===a.type||"radio"===a.type)&&(g=ar);switch(g&&(g=g(e,r))?Gn(o,g,n,i):(v&&v(e,a,r),"focusout"===e&&(v=a._wrapperState)&&v.controlled&&"number"===a.type&&ee(a,"number",a.value)),v=r?Si(r):window,e){case"focusin":(Kn(v)||"true"===v.contentEditable)&&(wr=v,br=r,_r=null);break;case"focusout":_r=br=wr=null;break;case"mousedown":Ir=!0;break;case"contextmenu":case"mouseup":case"dragend":Ir=!1,Sr(o,n,i);break;case"selectionchange":if(yr)break;case"keydown":case"keyup":Sr(o,n,i)}var y;if(Ln)e:{switch(e){case"compositionstart":var w="onCompositionStart";break e;case"compositionend":w="onCompositionEnd";break e;case"compositionupdate":w="onCompositionUpdate";break e}w=void 0}else qn?zn(e,n)&&(w="onCompositionEnd"):"keydown"===e&&229===n.keyCode&&(w="onCompositionStart");w&&(Un&&"ko"!==n.locale&&(qn||"onCompositionStart"!==w?"onCompositionEnd"===w&&qn&&(y=tn()):(Zt="value"in(Xt=i)?Xt.value:Xt.textContent,qn=!0)),0<(v=Qr(r,w)).length&&(w=new _n(w,e,null,n,i),o.push({event:w,listeners:v}),y?w.data=y:null!==(y=Bn(n))&&(w.data=y))),(y=Fn?function(e,t){switch(e){case"compositionend":return Bn(t);case"keypress":return 32!==t.which?null:(Vn=!0,jn);case"textInput":return(e=t.data)===jn&&Vn?null:e;default:return null}}(e,n):function(e,t){if(qn)return"compositionend"===e||!Ln&&zn(e,t)?(e=tn(),en=Zt=Xt=null,qn=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Un&&"ko"!==t.locale?null:t.data}}(e,n))&&(0<(r=Qr(r,"onBeforeInput")).length&&(i=new _n("onBeforeInput","beforeinput",null,n,i),o.push({event:i,listeners:r}),i.data=y))}zr(o,t)}))}function Wr(e,t,n){return{instance:e,listener:t,currentTarget:n}}function Qr(e,t){for(var n=t+"Capture",r=[];null!==e;){var i=e,s=i.stateNode;5===i.tag&&null!==s&&(i=s,null!=(s=Re(e,n))&&r.unshift(Wr(e,s,i)),null!=(s=Re(e,t))&&r.push(Wr(e,s,i))),e=e.return}return r}function Jr(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Yr(e,t,n,r,i){for(var s=t._reactName,o=[];null!==n&&n!==r;){var a=n,l=a.alternate,u=a.stateNode;if(null!==l&&l===r)break;5===a.tag&&null!==u&&(a=u,i?null!=(l=Re(n,s))&&o.unshift(Wr(n,l,a)):i||null!=(l=Re(n,s))&&o.push(Wr(n,l,a))),n=n.return}0!==o.length&&e.push({event:t,listeners:o})}var Xr=/\r\n?/g,Zr=/\u0000|\uFFFD/g;function ei(e){return("string"===typeof e?e:""+e).replace(Xr,"\n").replace(Zr,"")}function ti(e,t,n){if(t=ei(t),ei(e)!==t&&n)throw Error(s(425))}function ni(){}var ri=null,ii=null;function si(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var oi="function"===typeof setTimeout?setTimeout:void 0,ai="function"===typeof clearTimeout?clearTimeout:void 0,li="function"===typeof Promise?Promise:void 0,ui="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof li?function(e){return li.resolve(null).then(e).catch(ci)}:oi;function ci(e){setTimeout((function(){throw e}))}function hi(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&8===i.nodeType)if("/$"===(n=i.data)){if(0===r)return e.removeChild(i),void Bt(t);r--}else"$"!==n&&"$?"!==n&&"$!"!==n||r++;n=i}while(n);Bt(t)}function di(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function fi(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var pi=Math.random().toString(36).slice(2),mi="__reactFiber$"+pi,gi="__reactProps$"+pi,vi="__reactContainer$"+pi,yi="__reactEvents$"+pi,wi="__reactListeners$"+pi,bi="__reactHandles$"+pi;function _i(e){var t=e[mi];if(t)return t;for(var n=e.parentNode;n;){if(t=n[vi]||n[mi]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=fi(e);null!==e;){if(n=e[mi])return n;e=fi(e)}return t}n=(e=n).parentNode}return null}function Ii(e){return!(e=e[mi]||e[vi])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function Si(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(s(33))}function Ei(e){return e[gi]||null}var Ti=[],ki=-1;function Ci(e){return{current:e}}function xi(e){0>ki||(e.current=Ti[ki],Ti[ki]=null,ki--)}function Ni(e,t){ki++,Ti[ki]=e.current,e.current=t}var Ai={},Pi=Ci(Ai),Ri=Ci(!1),Di=Ai;function Oi(e,t){var n=e.type.contextTypes;if(!n)return Ai;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,s={};for(i in n)s[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=s),s}function Li(e){return null!==(e=e.childContextTypes)&&void 0!==e}function Mi(){xi(Ri),xi(Pi)}function Fi(e,t,n){if(Pi.current!==Ai)throw Error(s(168));Ni(Pi,t),Ni(Ri,n)}function Ui(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var i in r=r.getChildContext())if(!(i in t))throw Error(s(108,q(e)||"Unknown",i));return F({},n,r)}function ji(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Ai,Di=Pi.current,Ni(Pi,e),Ni(Ri,Ri.current),!0}function Vi(e,t,n){var r=e.stateNode;if(!r)throw Error(s(169));n?(e=Ui(e,t,Di),r.__reactInternalMemoizedMergedChildContext=e,xi(Ri),xi(Pi),Ni(Pi,e)):xi(Ri),Ni(Ri,n)}var zi=null,Bi=!1,qi=!1;function $i(e){null===zi?zi=[e]:zi.push(e)}function Ki(){if(!qi&&null!==zi){qi=!0;var e=0,t=wt;try{var n=zi;for(wt=1;e<n.length;e++){var r=n[e];do{r=r(!0)}while(null!==r)}zi=null,Bi=!1}catch(i){throw null!==zi&&(zi=zi.slice(e+1)),He(Ze,Ki),i}finally{wt=t,qi=!1}}return null}var Gi=[],Hi=0,Wi=null,Qi=0,Ji=[],Yi=0,Xi=null,Zi=1,es="";function ts(e,t){Gi[Hi++]=Qi,Gi[Hi++]=Wi,Wi=e,Qi=t}function ns(e,t,n){Ji[Yi++]=Zi,Ji[Yi++]=es,Ji[Yi++]=Xi,Xi=e;var r=Zi;e=es;var i=32-ot(r)-1;r&=~(1<<i),n+=1;var s=32-ot(t)+i;if(30<s){var o=i-i%5;s=(r&(1<<o)-1).toString(32),r>>=o,i-=o,Zi=1<<32-ot(t)+i|n<<i|r,es=s+e}else Zi=1<<s|n<<i|r,es=e}function rs(e){null!==e.return&&(ts(e,1),ns(e,1,0))}function is(e){for(;e===Wi;)Wi=Gi[--Hi],Gi[Hi]=null,Qi=Gi[--Hi],Gi[Hi]=null;for(;e===Xi;)Xi=Ji[--Yi],Ji[Yi]=null,es=Ji[--Yi],Ji[Yi]=null,Zi=Ji[--Yi],Ji[Yi]=null}var ss=null,os=null,as=!1,ls=null;function us(e,t){var n=Ou(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,null===(t=e.deletions)?(e.deletions=[n],e.flags|=16):t.push(n)}function cs(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,ss=e,os=di(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,ss=e,os=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(n=null!==Xi?{id:Zi,overflow:es}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},(n=Ou(18,null,null,0)).stateNode=t,n.return=e,e.child=n,ss=e,os=null,!0);default:return!1}}function hs(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function ds(e){if(as){var t=os;if(t){var n=t;if(!cs(e,t)){if(hs(e))throw Error(s(418));t=di(n.nextSibling);var r=ss;t&&cs(e,t)?us(r,n):(e.flags=-4097&e.flags|2,as=!1,ss=e)}}else{if(hs(e))throw Error(s(418));e.flags=-4097&e.flags|2,as=!1,ss=e}}}function fs(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;ss=e}function ps(e){if(e!==ss)return!1;if(!as)return fs(e),as=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!si(e.type,e.memoizedProps)),t&&(t=os)){if(hs(e))throw ms(),Error(s(418));for(;t;)us(e,t),t=di(t.nextSibling)}if(fs(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(s(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){os=di(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}os=null}}else os=ss?di(e.stateNode.nextSibling):null;return!0}function ms(){for(var e=os;e;)e=di(e.nextSibling)}function gs(){os=ss=null,as=!1}function vs(e){null===ls?ls=[e]:ls.push(e)}var ys=b.ReactCurrentBatchConfig;function ws(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(s(309));var r=n.stateNode}if(!r)throw Error(s(147,e));var i=r,o=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===o?t.ref:(t=function(e){var t=i.refs;null===e?delete t[o]:t[o]=e},t._stringRef=o,t)}if("string"!==typeof e)throw Error(s(284));if(!n._owner)throw Error(s(290,e))}return e}function bs(e,t){throw e=Object.prototype.toString.call(t),Error(s(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function _s(e){return(0,e._init)(e._payload)}function Is(e){function t(t,n){if(e){var r=t.deletions;null===r?(t.deletions=[n],t.flags|=16):r.push(n)}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Mu(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.flags|=2,n):r:(t.flags|=2,n):(t.flags|=1048576,n)}function a(t){return e&&null===t.alternate&&(t.flags|=2),t}function l(e,t,n,r){return null===t||6!==t.tag?((t=Vu(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function u(e,t,n,r){var s=n.type;return s===S?h(e,t,n.props.children,r,n.key):null!==t&&(t.elementType===s||"object"===typeof s&&null!==s&&s.$$typeof===R&&_s(s)===t.type)?((r=i(t,n.props)).ref=ws(e,t,n),r.return=e,r):((r=Fu(n.type,n.key,n.props,null,e.mode,r)).ref=ws(e,t,n),r.return=e,r)}function c(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=zu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function h(e,t,n,r,s){return null===t||7!==t.tag?((t=Uu(n,e.mode,r,s)).return=e,t):((t=i(t,n)).return=e,t)}function d(e,t,n){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Vu(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case _:return(n=Fu(t.type,t.key,t.props,null,e.mode,n)).ref=ws(e,null,t),n.return=e,n;case I:return(t=zu(t,e.mode,n)).return=e,t;case R:return d(e,(0,t._init)(t._payload),n)}if(te(t)||L(t))return(t=Uu(t,e.mode,n,null)).return=e,t;bs(e,t)}return null}function f(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n&&""!==n||"number"===typeof n)return null!==i?null:l(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case _:return n.key===i?u(e,t,n,r):null;case I:return n.key===i?c(e,t,n,r):null;case R:return f(e,t,(i=n._init)(n._payload),r)}if(te(n)||L(n))return null!==i?null:h(e,t,n,r,null);bs(e,n)}return null}function p(e,t,n,r,i){if("string"===typeof r&&""!==r||"number"===typeof r)return l(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case _:return u(t,e=e.get(null===r.key?n:r.key)||null,r,i);case I:return c(t,e=e.get(null===r.key?n:r.key)||null,r,i);case R:return p(e,t,n,(0,r._init)(r._payload),i)}if(te(r)||L(r))return h(t,e=e.get(n)||null,r,i,null);bs(t,r)}return null}function m(i,s,a,l){for(var u=null,c=null,h=s,m=s=0,g=null;null!==h&&m<a.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=f(i,h,a[m],l);if(null===v){null===h&&(h=g);break}e&&h&&null===v.alternate&&t(i,h),s=o(v,s,m),null===c?u=v:c.sibling=v,c=v,h=g}if(m===a.length)return n(i,h),as&&ts(i,m),u;if(null===h){for(;m<a.length;m++)null!==(h=d(i,a[m],l))&&(s=o(h,s,m),null===c?u=h:c.sibling=h,c=h);return as&&ts(i,m),u}for(h=r(i,h);m<a.length;m++)null!==(g=p(h,i,m,a[m],l))&&(e&&null!==g.alternate&&h.delete(null===g.key?m:g.key),s=o(g,s,m),null===c?u=g:c.sibling=g,c=g);return e&&h.forEach((function(e){return t(i,e)})),as&&ts(i,m),u}function g(i,a,l,u){var c=L(l);if("function"!==typeof c)throw Error(s(150));if(null==(l=c.call(l)))throw Error(s(151));for(var h=c=null,m=a,g=a=0,v=null,y=l.next();null!==m&&!y.done;g++,y=l.next()){m.index>g?(v=m,m=null):v=m.sibling;var w=f(i,m,y.value,u);if(null===w){null===m&&(m=v);break}e&&m&&null===w.alternate&&t(i,m),a=o(w,a,g),null===h?c=w:h.sibling=w,h=w,m=v}if(y.done)return n(i,m),as&&ts(i,g),c;if(null===m){for(;!y.done;g++,y=l.next())null!==(y=d(i,y.value,u))&&(a=o(y,a,g),null===h?c=y:h.sibling=y,h=y);return as&&ts(i,g),c}for(m=r(i,m);!y.done;g++,y=l.next())null!==(y=p(m,i,g,y.value,u))&&(e&&null!==y.alternate&&m.delete(null===y.key?g:y.key),a=o(y,a,g),null===h?c=y:h.sibling=y,h=y);return e&&m.forEach((function(e){return t(i,e)})),as&&ts(i,g),c}return function e(r,s,o,l){if("object"===typeof o&&null!==o&&o.type===S&&null===o.key&&(o=o.props.children),"object"===typeof o&&null!==o){switch(o.$$typeof){case _:e:{for(var u=o.key,c=s;null!==c;){if(c.key===u){if((u=o.type)===S){if(7===c.tag){n(r,c.sibling),(s=i(c,o.props.children)).return=r,r=s;break e}}else if(c.elementType===u||"object"===typeof u&&null!==u&&u.$$typeof===R&&_s(u)===c.type){n(r,c.sibling),(s=i(c,o.props)).ref=ws(r,c,o),s.return=r,r=s;break e}n(r,c);break}t(r,c),c=c.sibling}o.type===S?((s=Uu(o.props.children,r.mode,l,o.key)).return=r,r=s):((l=Fu(o.type,o.key,o.props,null,r.mode,l)).ref=ws(r,s,o),l.return=r,r=l)}return a(r);case I:e:{for(c=o.key;null!==s;){if(s.key===c){if(4===s.tag&&s.stateNode.containerInfo===o.containerInfo&&s.stateNode.implementation===o.implementation){n(r,s.sibling),(s=i(s,o.children||[])).return=r,r=s;break e}n(r,s);break}t(r,s),s=s.sibling}(s=zu(o,r.mode,l)).return=r,r=s}return a(r);case R:return e(r,s,(c=o._init)(o._payload),l)}if(te(o))return m(r,s,o,l);if(L(o))return g(r,s,o,l);bs(r,o)}return"string"===typeof o&&""!==o||"number"===typeof o?(o=""+o,null!==s&&6===s.tag?(n(r,s.sibling),(s=i(s,o)).return=r,r=s):(n(r,s),(s=Vu(o,r.mode,l)).return=r,r=s),a(r)):n(r,s)}}var Ss=Is(!0),Es=Is(!1),Ts=Ci(null),ks=null,Cs=null,xs=null;function Ns(){xs=Cs=ks=null}function As(e){var t=Ts.current;xi(Ts),e._currentValue=t}function Ps(e,t,n){for(;null!==e;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==r&&(r.childLanes|=t)):null!==r&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function Rs(e,t){ks=e,xs=Cs=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(Ia=!0),e.firstContext=null)}function Ds(e){var t=e._currentValue;if(xs!==e)if(e={context:e,memoizedValue:t,next:null},null===Cs){if(null===ks)throw Error(s(308));Cs=e,ks.dependencies={lanes:0,firstContext:e}}else Cs=Cs.next=e;return t}var Os=null;function Ls(e){null===Os?Os=[e]:Os.push(e)}function Ms(e,t,n,r){var i=t.interleaved;return null===i?(n.next=n,Ls(t)):(n.next=i.next,i.next=n),t.interleaved=n,Fs(e,r)}function Fs(e,t){e.lanes|=t;var n=e.alternate;for(null!==n&&(n.lanes|=t),n=e,e=e.return;null!==e;)e.childLanes|=t,null!==(n=e.alternate)&&(n.childLanes|=t),n=e,e=e.return;return 3===n.tag?n.stateNode:null}var Us=!1;function js(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Vs(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function zs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function Bs(e,t,n){var r=e.updateQueue;if(null===r)return null;if(r=r.shared,0!==(2&Pl)){var i=r.pending;return null===i?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Fs(e,n)}return null===(i=r.interleaved)?(t.next=t,Ls(r)):(t.next=i.next,i.next=t),r.interleaved=t,Fs(e,n)}function qs(e,t,n){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&n))){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}function $s(e,t){var n=e.updateQueue,r=e.alternate;if(null!==r&&n===(r=r.updateQueue)){var i=null,s=null;if(null!==(n=n.firstBaseUpdate)){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};null===s?i=s=o:s=s.next=o,n=n.next}while(null!==n);null===s?i=s=t:s=s.next=t}else i=s=t;return n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},void(e.updateQueue=n)}null===(e=n.lastBaseUpdate)?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function Ks(e,t,n,r){var i=e.updateQueue;Us=!1;var s=i.firstBaseUpdate,o=i.lastBaseUpdate,a=i.shared.pending;if(null!==a){i.shared.pending=null;var l=a,u=l.next;l.next=null,null===o?s=u:o.next=u,o=l;var c=e.alternate;null!==c&&((a=(c=c.updateQueue).lastBaseUpdate)!==o&&(null===a?c.firstBaseUpdate=u:a.next=u,c.lastBaseUpdate=l))}if(null!==s){var h=i.baseState;for(o=0,c=u=l=null,a=s;;){var d=a.lane,f=a.eventTime;if((r&d)===d){null!==c&&(c=c.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var p=e,m=a;switch(d=t,f=n,m.tag){case 1:if("function"===typeof(p=m.payload)){h=p.call(f,h,d);break e}h=p;break e;case 3:p.flags=-65537&p.flags|128;case 0:if(null===(d="function"===typeof(p=m.payload)?p.call(f,h,d):p)||void 0===d)break e;h=F({},h,d);break e;case 2:Us=!0}}null!==a.callback&&0!==a.lane&&(e.flags|=64,null===(d=i.effects)?i.effects=[a]:d.push(a))}else f={eventTime:f,lane:d,tag:a.tag,payload:a.payload,callback:a.callback,next:null},null===c?(u=c=f,l=h):c=c.next=f,o|=d;if(null===(a=a.next)){if(null===(a=i.shared.pending))break;a=(d=a).next,d.next=null,i.lastBaseUpdate=d,i.shared.pending=null}}if(null===c&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,null!==(t=i.shared.interleaved)){i=t;do{o|=i.lane,i=i.next}while(i!==t)}else null===s&&(i.shared.lanes=0);jl|=o,e.lanes=o,e.memoizedState=h}}function Gs(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=n,"function"!==typeof i)throw Error(s(191,i));i.call(r)}}}var Hs={},Ws=Ci(Hs),Qs=Ci(Hs),Js=Ci(Hs);function Ys(e){if(e===Hs)throw Error(s(174));return e}function Xs(e,t){switch(Ni(Js,t),Ni(Qs,e),Ni(Ws,Hs),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:le(null,"");break;default:t=le(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}xi(Ws),Ni(Ws,t)}function Zs(){xi(Ws),xi(Qs),xi(Js)}function eo(e){Ys(Js.current);var t=Ys(Ws.current),n=le(t,e.type);t!==n&&(Ni(Qs,e),Ni(Ws,n))}function to(e){Qs.current===e&&(xi(Ws),xi(Qs))}var no=Ci(0);function ro(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var io=[];function so(){for(var e=0;e<io.length;e++)io[e]._workInProgressVersionPrimary=null;io.length=0}var oo=b.ReactCurrentDispatcher,ao=b.ReactCurrentBatchConfig,lo=0,uo=null,co=null,ho=null,fo=!1,po=!1,mo=0,go=0;function vo(){throw Error(s(321))}function yo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!ur(e[n],t[n]))return!1;return!0}function wo(e,t,n,r,i,o){if(lo=o,uo=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,oo.current=null===e||null===e.memoizedState?na:ra,e=n(r,i),po){o=0;do{if(po=!1,mo=0,25<=o)throw Error(s(301));o+=1,ho=co=null,t.updateQueue=null,oo.current=ia,e=n(r,i)}while(po)}if(oo.current=ta,t=null!==co&&null!==co.next,lo=0,ho=co=uo=null,fo=!1,t)throw Error(s(300));return e}function bo(){var e=0!==mo;return mo=0,e}function _o(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ho?uo.memoizedState=ho=e:ho=ho.next=e,ho}function Io(){if(null===co){var e=uo.alternate;e=null!==e?e.memoizedState:null}else e=co.next;var t=null===ho?uo.memoizedState:ho.next;if(null!==t)ho=t,co=e;else{if(null===e)throw Error(s(310));e={memoizedState:(co=e).memoizedState,baseState:co.baseState,baseQueue:co.baseQueue,queue:co.queue,next:null},null===ho?uo.memoizedState=ho=e:ho=ho.next=e}return ho}function So(e,t){return"function"===typeof t?t(e):t}function Eo(e){var t=Io(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=co,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var a=i.next;i.next=o.next,o.next=a}r.baseQueue=i=o,n.pending=null}if(null!==i){o=i.next,r=r.baseState;var l=a=null,u=null,c=o;do{var h=c.lane;if((lo&h)===h)null!==u&&(u=u.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:e(r,c.action);else{var d={lane:h,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};null===u?(l=u=d,a=r):u=u.next=d,uo.lanes|=h,jl|=h}c=c.next}while(null!==c&&c!==o);null===u?a=r:u.next=l,ur(r,t.memoizedState)||(Ia=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=u,n.lastRenderedState=r}if(null!==(e=n.interleaved)){i=e;do{o=i.lane,uo.lanes|=o,jl|=o,i=i.next}while(i!==e)}else null===i&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function To(e){var t=Io(),n=t.queue;if(null===n)throw Error(s(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var a=i=i.next;do{o=e(o,a.action),a=a.next}while(a!==i);ur(o,t.memoizedState)||(Ia=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ko(){}function Co(e,t){var n=uo,r=Io(),i=t(),o=!ur(r.memoizedState,i);if(o&&(r.memoizedState=i,Ia=!0),r=r.queue,jo(Ao.bind(null,n,r,e),[e]),r.getSnapshot!==t||o||null!==ho&&1&ho.memoizedState.tag){if(n.flags|=2048,Oo(9,No.bind(null,n,r,i,t),void 0,null),null===Rl)throw Error(s(349));0!==(30&lo)||xo(n,t,i)}return i}function xo(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},null===(t=uo.updateQueue)?(t={lastEffect:null,stores:null},uo.updateQueue=t,t.stores=[e]):null===(n=t.stores)?t.stores=[e]:n.push(e)}function No(e,t,n,r){t.value=n,t.getSnapshot=r,Po(t)&&Ro(e)}function Ao(e,t,n){return n((function(){Po(t)&&Ro(e)}))}function Po(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!ur(e,n)}catch(r){return!0}}function Ro(e){var t=Fs(e,1);null!==t&&su(t,e,1,-1)}function Do(e){var t=_o();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:So,lastRenderedState:e},t.queue=e,e=e.dispatch=Yo.bind(null,uo,e),[t.memoizedState,e]}function Oo(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=uo.updateQueue)?(t={lastEffect:null,stores:null},uo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function Lo(){return Io().memoizedState}function Mo(e,t,n,r){var i=_o();uo.flags|=e,i.memoizedState=Oo(1|t,n,void 0,void 0===r?null:r)}function Fo(e,t,n,r){var i=Io();r=void 0===r?null:r;var s=void 0;if(null!==co){var o=co.memoizedState;if(s=o.destroy,null!==r&&yo(r,o.deps))return void(i.memoizedState=Oo(t,n,s,r))}uo.flags|=e,i.memoizedState=Oo(1|t,n,s,r)}function Uo(e,t){return Mo(8390656,8,e,t)}function jo(e,t){return Fo(2048,8,e,t)}function Vo(e,t){return Fo(4,2,e,t)}function zo(e,t){return Fo(4,4,e,t)}function Bo(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function qo(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Fo(4,4,Bo.bind(null,t,e),n)}function $o(){}function Ko(e,t){var n=Io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&yo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Go(e,t){var n=Io();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&yo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function Ho(e,t,n){return 0===(21&lo)?(e.baseState&&(e.baseState=!1,Ia=!0),e.memoizedState=n):(ur(n,t)||(n=mt(),uo.lanes|=n,jl|=n,e.baseState=!0),t)}function Wo(e,t){var n=wt;wt=0!==n&&4>n?n:4,e(!0);var r=ao.transition;ao.transition={};try{e(!1),t()}finally{wt=n,ao.transition=r}}function Qo(){return Io().memoizedState}function Jo(e,t,n){var r=iu(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Xo(e))Zo(t,n);else if(null!==(n=Ms(e,t,n,r))){su(n,e,r,ru()),ea(n,t,r)}}function Yo(e,t,n){var r=iu(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Xo(e))Zo(t,i);else{var s=e.alternate;if(0===e.lanes&&(null===s||0===s.lanes)&&null!==(s=t.lastRenderedReducer))try{var o=t.lastRenderedState,a=s(o,n);if(i.hasEagerState=!0,i.eagerState=a,ur(a,o)){var l=t.interleaved;return null===l?(i.next=i,Ls(t)):(i.next=l.next,l.next=i),void(t.interleaved=i)}}catch(u){}null!==(n=Ms(e,t,i,r))&&(su(n,e,r,i=ru()),ea(n,t,r))}}function Xo(e){var t=e.alternate;return e===uo||null!==t&&t===uo}function Zo(e,t){po=fo=!0;var n=e.pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function ea(e,t,n){if(0!==(4194240&n)){var r=t.lanes;n|=r&=e.pendingLanes,t.lanes=n,yt(e,n)}}var ta={readContext:Ds,useCallback:vo,useContext:vo,useEffect:vo,useImperativeHandle:vo,useInsertionEffect:vo,useLayoutEffect:vo,useMemo:vo,useReducer:vo,useRef:vo,useState:vo,useDebugValue:vo,useDeferredValue:vo,useTransition:vo,useMutableSource:vo,useSyncExternalStore:vo,useId:vo,unstable_isNewReconciler:!1},na={readContext:Ds,useCallback:function(e,t){return _o().memoizedState=[e,void 0===t?null:t],e},useContext:Ds,useEffect:Uo,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,Mo(4194308,4,Bo.bind(null,t,e),n)},useLayoutEffect:function(e,t){return Mo(4194308,4,e,t)},useInsertionEffect:function(e,t){return Mo(4,2,e,t)},useMemo:function(e,t){var n=_o();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=_o();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=Jo.bind(null,uo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},_o().memoizedState=e},useState:Do,useDebugValue:$o,useDeferredValue:function(e){return _o().memoizedState=e},useTransition:function(){var e=Do(!1),t=e[0];return e=Wo.bind(null,e[1]),_o().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=uo,i=_o();if(as){if(void 0===n)throw Error(s(407));n=n()}else{if(n=t(),null===Rl)throw Error(s(349));0!==(30&lo)||xo(r,t,n)}i.memoizedState=n;var o={value:n,getSnapshot:t};return i.queue=o,Uo(Ao.bind(null,r,o,e),[e]),r.flags|=2048,Oo(9,No.bind(null,r,o,n,t),void 0,null),n},useId:function(){var e=_o(),t=Rl.identifierPrefix;if(as){var n=es;t=":"+t+"R"+(n=(Zi&~(1<<32-ot(Zi)-1)).toString(32)+n),0<(n=mo++)&&(t+="H"+n.toString(32)),t+=":"}else t=":"+t+"r"+(n=go++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},ra={readContext:Ds,useCallback:Ko,useContext:Ds,useEffect:jo,useImperativeHandle:qo,useInsertionEffect:Vo,useLayoutEffect:zo,useMemo:Go,useReducer:Eo,useRef:Lo,useState:function(){return Eo(So)},useDebugValue:$o,useDeferredValue:function(e){return Ho(Io(),co.memoizedState,e)},useTransition:function(){return[Eo(So)[0],Io().memoizedState]},useMutableSource:ko,useSyncExternalStore:Co,useId:Qo,unstable_isNewReconciler:!1},ia={readContext:Ds,useCallback:Ko,useContext:Ds,useEffect:jo,useImperativeHandle:qo,useInsertionEffect:Vo,useLayoutEffect:zo,useMemo:Go,useReducer:To,useRef:Lo,useState:function(){return To(So)},useDebugValue:$o,useDeferredValue:function(e){var t=Io();return null===co?t.memoizedState=e:Ho(t,co.memoizedState,e)},useTransition:function(){return[To(So)[0],Io().memoizedState]},useMutableSource:ko,useSyncExternalStore:Co,useId:Qo,unstable_isNewReconciler:!1};function sa(e,t){if(e&&e.defaultProps){for(var n in t=F({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}return t}function oa(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:F({},t,n),e.memoizedState=n,0===e.lanes&&(e.updateQueue.baseState=n)}var aa={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=ru(),i=iu(e),s=zs(r,i);s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Bs(e,s,i))&&(su(t,e,i,r),qs(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=ru(),i=iu(e),s=zs(r,i);s.tag=1,s.payload=t,void 0!==n&&null!==n&&(s.callback=n),null!==(t=Bs(e,s,i))&&(su(t,e,i,r),qs(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=ru(),r=iu(e),i=zs(n,r);i.tag=2,void 0!==t&&null!==t&&(i.callback=t),null!==(t=Bs(e,i,r))&&(su(t,e,r,n),qs(t,e,r))}};function la(e,t,n,r,i,s,o){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,s,o):!t.prototype||!t.prototype.isPureReactComponent||(!cr(n,r)||!cr(i,s))}function ua(e,t,n){var r=!1,i=Ai,s=t.contextType;return"object"===typeof s&&null!==s?s=Ds(s):(i=Li(t)?Di:Pi.current,s=(r=null!==(r=t.contextTypes)&&void 0!==r)?Oi(e,i):Ai),t=new t(n,s),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=aa,e.stateNode=t,t._reactInternals=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function ca(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&aa.enqueueReplaceState(t,t.state,null)}function ha(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},js(e);var s=t.contextType;"object"===typeof s&&null!==s?i.context=Ds(s):(s=Li(t)?Di:Pi.current,i.context=Oi(e,s)),i.state=e.memoizedState,"function"===typeof(s=t.getDerivedStateFromProps)&&(oa(e,t,s,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&aa.enqueueReplaceState(i,i.state,null),Ks(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.flags|=4194308)}function da(e,t){try{var n="",r=t;do{n+=z(r),r=r.return}while(r);var i=n}catch(s){i="\nError generating stack: "+s.message+"\n"+s.stack}return{value:e,source:t,stack:i,digest:null}}function fa(e,t,n){return{value:e,source:null,stack:null!=n?n:null,digest:null!=t?t:null}}function pa(e,t){try{console.error(t.value)}catch(n){setTimeout((function(){throw n}))}}var ma="function"===typeof WeakMap?WeakMap:Map;function ga(e,t,n){(n=zs(-1,n)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Hl||(Hl=!0,Wl=r),pa(0,t)},n}function va(e,t,n){(n=zs(-1,n)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){pa(0,t)}}var s=e.stateNode;return null!==s&&"function"===typeof s.componentDidCatch&&(n.callback=function(){pa(0,t),"function"!==typeof r&&(null===Ql?Ql=new Set([this]):Ql.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),n}function ya(e,t,n){var r=e.pingCache;if(null===r){r=e.pingCache=new ma;var i=new Set;r.set(t,i)}else void 0===(i=r.get(t))&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=xu.bind(null,e,t,n),t.then(e,e))}function wa(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function ba(e,t,n,r,i){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,1===n.tag&&(null===n.alternate?n.tag=17:((t=zs(-1,1)).tag=2,Bs(n,t,1))),n.lanes|=1),e):(e.flags|=65536,e.lanes=i,e)}var _a=b.ReactCurrentOwner,Ia=!1;function Sa(e,t,n,r){t.child=null===e?Es(t,null,n,r):Ss(t,e.child,n,r)}function Ea(e,t,n,r,i){n=n.render;var s=t.ref;return Rs(t,i),r=wo(e,t,n,r,s,i),n=bo(),null===e||Ia?(as&&n&&rs(t),t.flags|=1,Sa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function Ta(e,t,n,r,i){if(null===e){var s=n.type;return"function"!==typeof s||Lu(s)||void 0!==s.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Fu(n.type,null,r,t,t.mode,i)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=s,ka(e,t,s,r,i))}if(s=e.child,0===(e.lanes&i)){var o=s.memoizedProps;if((n=null!==(n=n.compare)?n:cr)(o,r)&&e.ref===t.ref)return Ha(e,t,i)}return t.flags|=1,(e=Mu(s,r)).ref=t.ref,e.return=t,t.child=e}function ka(e,t,n,r,i){if(null!==e){var s=e.memoizedProps;if(cr(s,r)&&e.ref===t.ref){if(Ia=!1,t.pendingProps=r=s,0===(e.lanes&i))return t.lanes=e.lanes,Ha(e,t,i);0!==(131072&e.flags)&&(Ia=!0)}}return Na(e,t,n,r,i)}function Ca(e,t,n){var r=t.pendingProps,i=r.children,s=null!==e?e.memoizedState:null;if("hidden"===r.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Ni(Ml,Ll),Ll|=n;else{if(0===(1073741824&n))return e=null!==s?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Ni(Ml,Ll),Ll|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=null!==s?s.baseLanes:n,Ni(Ml,Ll),Ll|=r}else null!==s?(r=s.baseLanes|n,t.memoizedState=null):r=n,Ni(Ml,Ll),Ll|=r;return Sa(e,t,i,n),t.child}function xa(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function Na(e,t,n,r,i){var s=Li(n)?Di:Pi.current;return s=Oi(t,s),Rs(t,i),n=wo(e,t,n,r,s,i),r=bo(),null===e||Ia?(as&&r&&rs(t),t.flags|=1,Sa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Ha(e,t,i))}function Aa(e,t,n,r,i){if(Li(n)){var s=!0;ji(t)}else s=!1;if(Rs(t,i),null===t.stateNode)Ga(e,t),ua(t,n,r),ha(t,n,r,i),r=!0;else if(null===e){var o=t.stateNode,a=t.memoizedProps;o.props=a;var l=o.context,u=n.contextType;"object"===typeof u&&null!==u?u=Ds(u):u=Oi(t,u=Li(n)?Di:Pi.current);var c=n.getDerivedStateFromProps,h="function"===typeof c||"function"===typeof o.getSnapshotBeforeUpdate;h||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==r||l!==u)&&ca(t,o,r,u),Us=!1;var d=t.memoizedState;o.state=d,Ks(t,r,o,i),l=t.memoizedState,a!==r||d!==l||Ri.current||Us?("function"===typeof c&&(oa(t,n,c,r),l=t.memoizedState),(a=Us||la(t,n,a,r,d,l,u))?(h||"function"!==typeof o.UNSAFE_componentWillMount&&"function"!==typeof o.componentWillMount||("function"===typeof o.componentWillMount&&o.componentWillMount(),"function"===typeof o.UNSAFE_componentWillMount&&o.UNSAFE_componentWillMount()),"function"===typeof o.componentDidMount&&(t.flags|=4194308)):("function"===typeof o.componentDidMount&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),o.props=r,o.state=l,o.context=u,r=a):("function"===typeof o.componentDidMount&&(t.flags|=4194308),r=!1)}else{o=t.stateNode,Vs(e,t),a=t.memoizedProps,u=t.type===t.elementType?a:sa(t.type,a),o.props=u,h=t.pendingProps,d=o.context,"object"===typeof(l=n.contextType)&&null!==l?l=Ds(l):l=Oi(t,l=Li(n)?Di:Pi.current);var f=n.getDerivedStateFromProps;(c="function"===typeof f||"function"===typeof o.getSnapshotBeforeUpdate)||"function"!==typeof o.UNSAFE_componentWillReceiveProps&&"function"!==typeof o.componentWillReceiveProps||(a!==h||d!==l)&&ca(t,o,r,l),Us=!1,d=t.memoizedState,o.state=d,Ks(t,r,o,i);var p=t.memoizedState;a!==h||d!==p||Ri.current||Us?("function"===typeof f&&(oa(t,n,f,r),p=t.memoizedState),(u=Us||la(t,n,u,r,d,p,l)||!1)?(c||"function"!==typeof o.UNSAFE_componentWillUpdate&&"function"!==typeof o.componentWillUpdate||("function"===typeof o.componentWillUpdate&&o.componentWillUpdate(r,p,l),"function"===typeof o.UNSAFE_componentWillUpdate&&o.UNSAFE_componentWillUpdate(r,p,l)),"function"===typeof o.componentDidUpdate&&(t.flags|=4),"function"===typeof o.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=p),o.props=r,o.state=p,o.context=l,r=u):("function"!==typeof o.componentDidUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=4),"function"!==typeof o.getSnapshotBeforeUpdate||a===e.memoizedProps&&d===e.memoizedState||(t.flags|=1024),r=!1)}return Pa(e,t,n,r,s,i)}function Pa(e,t,n,r,i,s){xa(e,t);var o=0!==(128&t.flags);if(!r&&!o)return i&&Vi(t,n,!1),Ha(e,t,s);r=t.stateNode,_a.current=t;var a=o&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.flags|=1,null!==e&&o?(t.child=Ss(t,e.child,null,s),t.child=Ss(t,null,a,s)):Sa(e,t,a,s),t.memoizedState=r.state,i&&Vi(t,n,!0),t.child}function Ra(e){var t=e.stateNode;t.pendingContext?Fi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Fi(0,t.context,!1),Xs(e,t.containerInfo)}function Da(e,t,n,r,i){return gs(),vs(i),t.flags|=256,Sa(e,t,n,r),t.child}var Oa,La,Ma,Fa,Ua={dehydrated:null,treeContext:null,retryLane:0};function ja(e){return{baseLanes:e,cachePool:null,transitions:null}}function Va(e,t,n){var r,i=t.pendingProps,o=no.current,a=!1,l=0!==(128&t.flags);if((r=l)||(r=(null===e||null!==e.memoizedState)&&0!==(2&o)),r?(a=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(o|=1),Ni(no,1&o),null===e)return ds(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(l=i.children,e=i.fallback,a?(i=t.mode,a=t.child,l={mode:"hidden",children:l},0===(1&i)&&null!==a?(a.childLanes=0,a.pendingProps=l):a=ju(l,i,0,null),e=Uu(e,i,n,null),a.return=t,e.return=t,a.sibling=e,t.child=a,t.child.memoizedState=ja(n),t.memoizedState=Ua,e):za(t,l));if(null!==(o=e.memoizedState)&&null!==(r=o.dehydrated))return function(e,t,n,r,i,o,a){if(n)return 256&t.flags?(t.flags&=-257,Ba(e,t,a,r=fa(Error(s(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(o=r.fallback,i=t.mode,r=ju({mode:"visible",children:r.children},i,0,null),(o=Uu(o,i,a,null)).flags|=2,r.return=t,o.return=t,r.sibling=o,t.child=r,0!==(1&t.mode)&&Ss(t,e.child,null,a),t.child.memoizedState=ja(a),t.memoizedState=Ua,o);if(0===(1&t.mode))return Ba(e,t,a,null);if("$!"===i.data){if(r=i.nextSibling&&i.nextSibling.dataset)var l=r.dgst;return r=l,Ba(e,t,a,r=fa(o=Error(s(419)),r,void 0))}if(l=0!==(a&e.childLanes),Ia||l){if(null!==(r=Rl)){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}0!==(i=0!==(i&(r.suspendedLanes|a))?0:i)&&i!==o.retryLane&&(o.retryLane=i,Fs(e,i),su(r,e,i,-1))}return yu(),Ba(e,t,a,r=fa(Error(s(421))))}return"$?"===i.data?(t.flags|=128,t.child=e.child,t=Au.bind(null,e),i._reactRetry=t,null):(e=o.treeContext,os=di(i.nextSibling),ss=t,as=!0,ls=null,null!==e&&(Ji[Yi++]=Zi,Ji[Yi++]=es,Ji[Yi++]=Xi,Zi=e.id,es=e.overflow,Xi=t),t=za(t,r.children),t.flags|=4096,t)}(e,t,l,i,r,o,n);if(a){a=i.fallback,l=t.mode,r=(o=e.child).sibling;var u={mode:"hidden",children:i.children};return 0===(1&l)&&t.child!==o?((i=t.child).childLanes=0,i.pendingProps=u,t.deletions=null):(i=Mu(o,u)).subtreeFlags=14680064&o.subtreeFlags,null!==r?a=Mu(r,a):(a=Uu(a,l,n,null)).flags|=2,a.return=t,i.return=t,i.sibling=a,t.child=i,i=a,a=t.child,l=null===(l=e.child.memoizedState)?ja(n):{baseLanes:l.baseLanes|n,cachePool:null,transitions:l.transitions},a.memoizedState=l,a.childLanes=e.childLanes&~n,t.memoizedState=Ua,i}return e=(a=e.child).sibling,i=Mu(a,{mode:"visible",children:i.children}),0===(1&t.mode)&&(i.lanes=n),i.return=t,i.sibling=null,null!==e&&(null===(n=t.deletions)?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=i,t.memoizedState=null,i}function za(e,t){return(t=ju({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ba(e,t,n,r){return null!==r&&vs(r),Ss(t,e.child,null,n),(e=za(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function qa(e,t,n){e.lanes|=t;var r=e.alternate;null!==r&&(r.lanes|=t),Ps(e.return,t,n)}function $a(e,t,n,r,i){var s=e.memoizedState;null===s?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function Ka(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(Sa(e,t,r.children,n),0!==(2&(r=no.current)))r=1&r|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n,t);else if(19===e.tag)qa(e,n,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Ni(no,r),0===(1&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===ro(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),$a(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===ro(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}$a(t,!0,n,null,s);break;case"together":$a(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Ga(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Ha(e,t,n){if(null!==e&&(t.dependencies=e.dependencies),jl|=t.lanes,0===(n&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(s(153));if(null!==t.child){for(n=Mu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Mu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Wa(e,t){if(!as)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function Qa(e){var t=null!==e.alternate&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=14680064&i.subtreeFlags,r|=14680064&i.flags,i.return=e,i=i.sibling;else for(i=e.child;null!==i;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function Ja(e,t,n){var r=t.pendingProps;switch(is(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Qa(t),null;case 1:case 17:return Li(t.type)&&Mi(),Qa(t),null;case 3:return r=t.stateNode,Zs(),xi(Ri),xi(Pi),so(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),null!==e&&null!==e.child||(ps(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==ls&&(uu(ls),ls=null))),La(e,t),Qa(t),null;case 5:to(t);var i=Ys(Js.current);if(n=t.type,null!==e&&null!=t.stateNode)Ma(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(null===t.stateNode)throw Error(s(166));return Qa(t),null}if(e=Ys(Ws.current),ps(t)){r=t.stateNode,n=t.type;var o=t.memoizedProps;switch(r[mi]=t,r[gi]=o,e=0!==(1&t.mode),n){case"dialog":Br("cancel",r),Br("close",r);break;case"iframe":case"object":case"embed":Br("load",r);break;case"video":case"audio":for(i=0;i<Ur.length;i++)Br(Ur[i],r);break;case"source":Br("error",r);break;case"img":case"image":case"link":Br("error",r),Br("load",r);break;case"details":Br("toggle",r);break;case"input":J(r,o),Br("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!o.multiple},Br("invalid",r);break;case"textarea":ie(r,o),Br("invalid",r)}for(var l in ye(n,o),i=null,o)if(o.hasOwnProperty(l)){var u=o[l];"children"===l?"string"===typeof u?r.textContent!==u&&(!0!==o.suppressHydrationWarning&&ti(r.textContent,u,e),i=["children",u]):"number"===typeof u&&r.textContent!==""+u&&(!0!==o.suppressHydrationWarning&&ti(r.textContent,u,e),i=["children",""+u]):a.hasOwnProperty(l)&&null!=u&&"onScroll"===l&&Br("scroll",r)}switch(n){case"input":G(r),Z(r,o,!0);break;case"textarea":G(r),oe(r);break;case"select":case"option":break;default:"function"===typeof o.onClick&&(r.onclick=ni)}r=i,t.updateQueue=r,null!==r&&(t.flags|=4)}else{l=9===i.nodeType?i:i.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ae(n)),"http://www.w3.org/1999/xhtml"===e?"script"===n?((e=l.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=l.createElement(n,{is:r.is}):(e=l.createElement(n),"select"===n&&(l=e,r.multiple?l.multiple=!0:r.size&&(l.size=r.size))):e=l.createElementNS(e,n),e[mi]=t,e[gi]=r,Oa(e,t,!1,!1),t.stateNode=e;e:{switch(l=we(n,r),n){case"dialog":Br("cancel",e),Br("close",e),i=r;break;case"iframe":case"object":case"embed":Br("load",e),i=r;break;case"video":case"audio":for(i=0;i<Ur.length;i++)Br(Ur[i],e);i=r;break;case"source":Br("error",e),i=r;break;case"img":case"image":case"link":Br("error",e),Br("load",e),i=r;break;case"details":Br("toggle",e),i=r;break;case"input":J(e,r),i=Q(e,r),Br("invalid",e);break;case"option":default:i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=F({},r,{value:void 0}),Br("invalid",e);break;case"textarea":ie(e,r),i=re(e,r),Br("invalid",e)}for(o in ye(n,i),u=i)if(u.hasOwnProperty(o)){var c=u[o];"style"===o?ge(e,c):"dangerouslySetInnerHTML"===o?null!=(c=c?c.__html:void 0)&&he(e,c):"children"===o?"string"===typeof c?("textarea"!==n||""!==c)&&de(e,c):"number"===typeof c&&de(e,""+c):"suppressContentEditableWarning"!==o&&"suppressHydrationWarning"!==o&&"autoFocus"!==o&&(a.hasOwnProperty(o)?null!=c&&"onScroll"===o&&Br("scroll",e):null!=c&&w(e,o,c,l))}switch(n){case"input":G(e),Z(e,r,!1);break;case"textarea":G(e),oe(e);break;case"option":null!=r.value&&e.setAttribute("value",""+$(r.value));break;case"select":e.multiple=!!r.multiple,null!=(o=r.value)?ne(e,!!r.multiple,o,!1):null!=r.defaultValue&&ne(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof i.onClick&&(e.onclick=ni)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Qa(t),null;case 6:if(e&&null!=t.stateNode)Fa(e,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(s(166));if(n=Ys(Js.current),Ys(Ws.current),ps(t)){if(r=t.stateNode,n=t.memoizedProps,r[mi]=t,(o=r.nodeValue!==n)&&null!==(e=ss))switch(e.tag){case 3:ti(r.nodeValue,n,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&ti(r.nodeValue,n,0!==(1&e.mode))}o&&(t.flags|=4)}else(r=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[mi]=t,t.stateNode=r}return Qa(t),null;case 13:if(xi(no),r=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(as&&null!==os&&0!==(1&t.mode)&&0===(128&t.flags))ms(),gs(),t.flags|=98560,o=!1;else if(o=ps(t),null!==r&&null!==r.dehydrated){if(null===e){if(!o)throw Error(s(318));if(!(o=null!==(o=t.memoizedState)?o.dehydrated:null))throw Error(s(317));o[mi]=t}else gs(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Qa(t),o=!1}else null!==ls&&(uu(ls),ls=null),o=!0;if(!o)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=n,t):((r=null!==r)!==(null!==e&&null!==e.memoizedState)&&r&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&no.current)?0===Fl&&(Fl=3):yu())),null!==t.updateQueue&&(t.flags|=4),Qa(t),null);case 4:return Zs(),La(e,t),null===e&&Kr(t.stateNode.containerInfo),Qa(t),null;case 10:return As(t.type._context),Qa(t),null;case 19:if(xi(no),null===(o=t.memoizedState))return Qa(t),null;if(r=0!==(128&t.flags),null===(l=o.rendering))if(r)Wa(o,!1);else{if(0!==Fl||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(l=ro(e))){for(t.flags|=128,Wa(o,!1),null!==(r=l.updateQueue)&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;null!==n;)e=r,(o=n).flags&=14680066,null===(l=o.alternate)?(o.childLanes=0,o.lanes=e,o.child=null,o.subtreeFlags=0,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null,o.stateNode=null):(o.childLanes=l.childLanes,o.lanes=l.lanes,o.child=l.child,o.subtreeFlags=0,o.deletions=null,o.memoizedProps=l.memoizedProps,o.memoizedState=l.memoizedState,o.updateQueue=l.updateQueue,o.type=l.type,e=l.dependencies,o.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Ni(no,1&no.current|2),t.child}e=e.sibling}null!==o.tail&&Ye()>Kl&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304)}else{if(!r)if(null!==(e=ro(l))){if(t.flags|=128,r=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.flags|=4),Wa(o,!0),null===o.tail&&"hidden"===o.tailMode&&!l.alternate&&!as)return Qa(t),null}else 2*Ye()-o.renderingStartTime>Kl&&1073741824!==n&&(t.flags|=128,r=!0,Wa(o,!1),t.lanes=4194304);o.isBackwards?(l.sibling=t.child,t.child=l):(null!==(n=o.last)?n.sibling=l:t.child=l,o.last=l)}return null!==o.tail?(t=o.tail,o.rendering=t,o.tail=t.sibling,o.renderingStartTime=Ye(),t.sibling=null,n=no.current,Ni(no,r?1&n|2:1&n),t):(Qa(t),null);case 22:case 23:return pu(),r=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==r&&(t.flags|=8192),r&&0!==(1&t.mode)?0!==(1073741824&Ll)&&(Qa(t),6&t.subtreeFlags&&(t.flags|=8192)):Qa(t),null;case 24:case 25:return null}throw Error(s(156,t.tag))}function Ya(e,t){switch(is(t),t.tag){case 1:return Li(t.type)&&Mi(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Zs(),xi(Ri),xi(Pi),so(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return to(t),null;case 13:if(xi(no),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(s(340));gs()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return xi(no),null;case 4:return Zs(),null;case 10:return As(t.type._context),null;case 22:case 23:return pu(),null;default:return null}}Oa=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},La=function(){},Ma=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,Ys(Ws.current);var s,o=null;switch(n){case"input":i=Q(e,i),r=Q(e,r),o=[];break;case"select":i=F({},i,{value:void 0}),r=F({},r,{value:void 0}),o=[];break;case"textarea":i=re(e,i),r=re(e,r),o=[];break;default:"function"!==typeof i.onClick&&"function"===typeof r.onClick&&(e.onclick=ni)}for(c in ye(n,r),n=null,i)if(!r.hasOwnProperty(c)&&i.hasOwnProperty(c)&&null!=i[c])if("style"===c){var l=i[c];for(s in l)l.hasOwnProperty(s)&&(n||(n={}),n[s]="")}else"dangerouslySetInnerHTML"!==c&&"children"!==c&&"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&"autoFocus"!==c&&(a.hasOwnProperty(c)?o||(o=[]):(o=o||[]).push(c,null));for(c in r){var u=r[c];if(l=null!=i?i[c]:void 0,r.hasOwnProperty(c)&&u!==l&&(null!=u||null!=l))if("style"===c)if(l){for(s in l)!l.hasOwnProperty(s)||u&&u.hasOwnProperty(s)||(n||(n={}),n[s]="");for(s in u)u.hasOwnProperty(s)&&l[s]!==u[s]&&(n||(n={}),n[s]=u[s])}else n||(o||(o=[]),o.push(c,n)),n=u;else"dangerouslySetInnerHTML"===c?(u=u?u.__html:void 0,l=l?l.__html:void 0,null!=u&&l!==u&&(o=o||[]).push(c,u)):"children"===c?"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(c,""+u):"suppressContentEditableWarning"!==c&&"suppressHydrationWarning"!==c&&(a.hasOwnProperty(c)?(null!=u&&"onScroll"===c&&Br("scroll",e),o||l===u||(o=[])):(o=o||[]).push(c,u))}n&&(o=o||[]).push("style",n);var c=o;(t.updateQueue=c)&&(t.flags|=4)}},Fa=function(e,t,n,r){n!==r&&(t.flags|=4)};var Xa=!1,Za=!1,el="function"===typeof WeakSet?WeakSet:Set,tl=null;function nl(e,t){var n=e.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(r){Cu(e,t,r)}else n.current=null}function rl(e,t,n){try{n()}catch(r){Cu(e,t,r)}}var il=!1;function sl(e,t,n){var r=t.updateQueue;if(null!==(r=null!==r?r.lastEffect:null)){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,void 0!==s&&rl(t,n,s)}i=i.next}while(i!==r)}}function ol(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function al(e){var t=e.ref;if(null!==t){var n=e.stateNode;e.tag,e=n,"function"===typeof t?t(e):t.current=e}}function ll(e){var t=e.alternate;null!==t&&(e.alternate=null,ll(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[mi],delete t[gi],delete t[yi],delete t[wi],delete t[bi])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ul(e){return 5===e.tag||3===e.tag||4===e.tag}function cl(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ul(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function hl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?8===n.nodeType?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(8===n.nodeType?(t=n.parentNode).insertBefore(e,n):(t=n).appendChild(e),null!==(n=n._reactRootContainer)&&void 0!==n||null!==t.onclick||(t.onclick=ni));else if(4!==r&&null!==(e=e.child))for(hl(e,t,n),e=e.sibling;null!==e;)hl(e,t,n),e=e.sibling}function dl(e,t,n){var r=e.tag;if(5===r||6===r)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(4!==r&&null!==(e=e.child))for(dl(e,t,n),e=e.sibling;null!==e;)dl(e,t,n),e=e.sibling}var fl=null,pl=!1;function ml(e,t,n){for(n=n.child;null!==n;)gl(e,t,n),n=n.sibling}function gl(e,t,n){if(st&&"function"===typeof st.onCommitFiberUnmount)try{st.onCommitFiberUnmount(it,n)}catch(a){}switch(n.tag){case 5:Za||nl(n,t);case 6:var r=fl,i=pl;fl=null,ml(e,t,n),pl=i,null!==(fl=r)&&(pl?(e=fl,n=n.stateNode,8===e.nodeType?e.parentNode.removeChild(n):e.removeChild(n)):fl.removeChild(n.stateNode));break;case 18:null!==fl&&(pl?(e=fl,n=n.stateNode,8===e.nodeType?hi(e.parentNode,n):1===e.nodeType&&hi(e,n),Bt(e)):hi(fl,n.stateNode));break;case 4:r=fl,i=pl,fl=n.stateNode.containerInfo,pl=!0,ml(e,t,n),fl=r,pl=i;break;case 0:case 11:case 14:case 15:if(!Za&&(null!==(r=n.updateQueue)&&null!==(r=r.lastEffect))){i=r=r.next;do{var s=i,o=s.destroy;s=s.tag,void 0!==o&&(0!==(2&s)||0!==(4&s))&&rl(n,t,o),i=i.next}while(i!==r)}ml(e,t,n);break;case 1:if(!Za&&(nl(n,t),"function"===typeof(r=n.stateNode).componentWillUnmount))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Cu(n,t,a)}ml(e,t,n);break;case 21:ml(e,t,n);break;case 22:1&n.mode?(Za=(r=Za)||null!==n.memoizedState,ml(e,t,n),Za=r):ml(e,t,n);break;default:ml(e,t,n)}}function vl(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new el),t.forEach((function(t){var r=Pu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}function yl(e,t){var n=t.deletions;if(null!==n)for(var r=0;r<n.length;r++){var i=n[r];try{var o=e,a=t,l=a;e:for(;null!==l;){switch(l.tag){case 5:fl=l.stateNode,pl=!1;break e;case 3:case 4:fl=l.stateNode.containerInfo,pl=!0;break e}l=l.return}if(null===fl)throw Error(s(160));gl(o,a,i),fl=null,pl=!1;var u=i.alternate;null!==u&&(u.return=null),i.return=null}catch(c){Cu(i,t,c)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)wl(t,e),t=t.sibling}function wl(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(yl(t,e),bl(e),4&r){try{sl(3,e,e.return),ol(3,e)}catch(g){Cu(e,e.return,g)}try{sl(5,e,e.return)}catch(g){Cu(e,e.return,g)}}break;case 1:yl(t,e),bl(e),512&r&&null!==n&&nl(n,n.return);break;case 5:if(yl(t,e),bl(e),512&r&&null!==n&&nl(n,n.return),32&e.flags){var i=e.stateNode;try{de(i,"")}catch(g){Cu(e,e.return,g)}}if(4&r&&null!=(i=e.stateNode)){var o=e.memoizedProps,a=null!==n?n.memoizedProps:o,l=e.type,u=e.updateQueue;if(e.updateQueue=null,null!==u)try{"input"===l&&"radio"===o.type&&null!=o.name&&Y(i,o),we(l,a);var c=we(l,o);for(a=0;a<u.length;a+=2){var h=u[a],d=u[a+1];"style"===h?ge(i,d):"dangerouslySetInnerHTML"===h?he(i,d):"children"===h?de(i,d):w(i,h,d,c)}switch(l){case"input":X(i,o);break;case"textarea":se(i,o);break;case"select":var f=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!o.multiple;var p=o.value;null!=p?ne(i,!!o.multiple,p,!1):f!==!!o.multiple&&(null!=o.defaultValue?ne(i,!!o.multiple,o.defaultValue,!0):ne(i,!!o.multiple,o.multiple?[]:"",!1))}i[gi]=o}catch(g){Cu(e,e.return,g)}}break;case 6:if(yl(t,e),bl(e),4&r){if(null===e.stateNode)throw Error(s(162));i=e.stateNode,o=e.memoizedProps;try{i.nodeValue=o}catch(g){Cu(e,e.return,g)}}break;case 3:if(yl(t,e),bl(e),4&r&&null!==n&&n.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(g){Cu(e,e.return,g)}break;case 4:default:yl(t,e),bl(e);break;case 13:yl(t,e),bl(e),8192&(i=e.child).flags&&(o=null!==i.memoizedState,i.stateNode.isHidden=o,!o||null!==i.alternate&&null!==i.alternate.memoizedState||($l=Ye())),4&r&&vl(e);break;case 22:if(h=null!==n&&null!==n.memoizedState,1&e.mode?(Za=(c=Za)||h,yl(t,e),Za=c):yl(t,e),bl(e),8192&r){if(c=null!==e.memoizedState,(e.stateNode.isHidden=c)&&!h&&0!==(1&e.mode))for(tl=e,h=e.child;null!==h;){for(d=tl=h;null!==tl;){switch(p=(f=tl).child,f.tag){case 0:case 11:case 14:case 15:sl(4,f,f.return);break;case 1:nl(f,f.return);var m=f.stateNode;if("function"===typeof m.componentWillUnmount){r=f,n=f.return;try{t=r,m.props=t.memoizedProps,m.state=t.memoizedState,m.componentWillUnmount()}catch(g){Cu(r,n,g)}}break;case 5:nl(f,f.return);break;case 22:if(null!==f.memoizedState){El(d);continue}}null!==p?(p.return=f,tl=p):El(d)}h=h.sibling}e:for(h=null,d=e;;){if(5===d.tag){if(null===h){h=d;try{i=d.stateNode,c?"function"===typeof(o=i.style).setProperty?o.setProperty("display","none","important"):o.display="none":(l=d.stateNode,a=void 0!==(u=d.memoizedProps.style)&&null!==u&&u.hasOwnProperty("display")?u.display:null,l.style.display=me("display",a))}catch(g){Cu(e,e.return,g)}}}else if(6===d.tag){if(null===h)try{d.stateNode.nodeValue=c?"":d.memoizedProps}catch(g){Cu(e,e.return,g)}}else if((22!==d.tag&&23!==d.tag||null===d.memoizedState||d===e)&&null!==d.child){d.child.return=d,d=d.child;continue}if(d===e)break e;for(;null===d.sibling;){if(null===d.return||d.return===e)break e;h===d&&(h=null),d=d.return}h===d&&(h=null),d.sibling.return=d.return,d=d.sibling}}break;case 19:yl(t,e),bl(e),4&r&&vl(e);case 21:}}function bl(e){var t=e.flags;if(2&t){try{e:{for(var n=e.return;null!==n;){if(ul(n)){var r=n;break e}n=n.return}throw Error(s(160))}switch(r.tag){case 5:var i=r.stateNode;32&r.flags&&(de(i,""),r.flags&=-33),dl(e,cl(e),i);break;case 3:case 4:var o=r.stateNode.containerInfo;hl(e,cl(e),o);break;default:throw Error(s(161))}}catch(vr){Cu(e,e.return,vr)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function _l(e,t,n){tl=e,Il(e,t,n)}function Il(e,t,n){for(var r=0!==(1&e.mode);null!==tl;){var i=tl,s=i.child;if(22===i.tag&&r){var o=null!==i.memoizedState||Xa;if(!o){var a=i.alternate,l=null!==a&&null!==a.memoizedState||Za;a=Xa;var u=Za;if(Xa=o,(Za=l)&&!u)for(tl=i;null!==tl;)l=(o=tl).child,22===o.tag&&null!==o.memoizedState?Tl(i):null!==l?(l.return=o,tl=l):Tl(i);for(;null!==s;)tl=s,Il(s,t,n),s=s.sibling;tl=i,Xa=a,Za=u}Sl(e)}else 0!==(8772&i.subtreeFlags)&&null!==s?(s.return=i,tl=s):Sl(e)}}function Sl(e){for(;null!==tl;){var t=tl;if(0!==(8772&t.flags)){var n=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Za||ol(5,t);break;case 1:var r=t.stateNode;if(4&t.flags&&!Za)if(null===n)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:sa(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var o=t.updateQueue;null!==o&&Gs(t,o,r);break;case 3:var a=t.updateQueue;if(null!==a){if(n=null,null!==t.child)switch(t.child.tag){case 5:case 1:n=t.child.stateNode}Gs(t,a,n)}break;case 5:var l=t.stateNode;if(null===n&&4&t.flags){n=l;var u=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var c=t.alternate;if(null!==c){var h=c.memoizedState;if(null!==h){var d=h.dehydrated;null!==d&&Bt(d)}}}break;default:throw Error(s(163))}Za||512&t.flags&&al(t)}catch(f){Cu(t,t.return,f)}}if(t===e){tl=null;break}if(null!==(n=t.sibling)){n.return=t.return,tl=n;break}tl=t.return}}function El(e){for(;null!==tl;){var t=tl;if(t===e){tl=null;break}var n=t.sibling;if(null!==n){n.return=t.return,tl=n;break}tl=t.return}}function Tl(e){for(;null!==tl;){var t=tl;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{ol(4,t)}catch(vr){Cu(t,n,vr)}break;case 1:var r=t.stateNode;if("function"===typeof r.componentDidMount){var i=t.return;try{r.componentDidMount()}catch(vr){Cu(t,i,vr)}}var s=t.return;try{al(t)}catch(vr){Cu(t,s,vr)}break;case 5:var o=t.return;try{al(t)}catch(vr){Cu(t,o,vr)}}}catch(vr){Cu(t,t.return,vr)}if(t===e){tl=null;break}var a=t.sibling;if(null!==a){a.return=t.return,tl=a;break}tl=t.return}}var kl,Cl=Math.ceil,xl=b.ReactCurrentDispatcher,Nl=b.ReactCurrentOwner,Al=b.ReactCurrentBatchConfig,Pl=0,Rl=null,Dl=null,Ol=0,Ll=0,Ml=Ci(0),Fl=0,Ul=null,jl=0,Vl=0,zl=0,Bl=null,ql=null,$l=0,Kl=1/0,Gl=null,Hl=!1,Wl=null,Ql=null,Jl=!1,Yl=null,Xl=0,Zl=0,eu=null,tu=-1,nu=0;function ru(){return 0!==(6&Pl)?Ye():-1!==tu?tu:tu=Ye()}function iu(e){return 0===(1&e.mode)?1:0!==(2&Pl)&&0!==Ol?Ol&-Ol:null!==ys.transition?(0===nu&&(nu=mt()),nu):0!==(e=wt)?e:e=void 0===(e=window.event)?16:Jt(e.type)}function su(e,t,n,r){if(50<Zl)throw Zl=0,eu=null,Error(s(185));vt(e,n,r),0!==(2&Pl)&&e===Rl||(e===Rl&&(0===(2&Pl)&&(Vl|=n),4===Fl&&cu(e,Ol)),ou(e,r),1===n&&0===Pl&&0===(1&t.mode)&&(Kl=Ye()+500,Bi&&Ki()))}function ou(e,t){var n=e.callbackNode;!function(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var o=31-ot(s),a=1<<o,l=i[o];-1===l?0!==(a&n)&&0===(a&r)||(i[o]=ft(a,t)):l<=t&&(e.expiredLanes|=a),s&=~a}}(e,t);var r=dt(e,e===Rl?Ol:0);if(0===r)null!==n&&We(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(null!=n&&We(n),1===t)0===e.tag?function(e){Bi=!0,$i(e)}(hu.bind(null,e)):$i(hu.bind(null,e)),ui((function(){0===(6&Pl)&&Ki()})),n=null;else{switch(bt(r)){case 1:n=Ze;break;case 4:n=et;break;case 16:default:n=tt;break;case 536870912:n=rt}n=Ru(n,au.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function au(e,t){if(tu=-1,nu=0,0!==(6&Pl))throw Error(s(327));var n=e.callbackNode;if(Tu()&&e.callbackNode!==n)return null;var r=dt(e,e===Rl?Ol:0);if(0===r)return null;if(0!==(30&r)||0!==(r&e.expiredLanes)||t)t=wu(e,r);else{t=r;var i=Pl;Pl|=2;var o=vu();for(Rl===e&&Ol===t||(Gl=null,Kl=Ye()+500,mu(e,t));;)try{_u();break}catch(l){gu(e,l)}Ns(),xl.current=o,Pl=i,null!==Dl?t=0:(Rl=null,Ol=0,t=Fl)}if(0!==t){if(2===t&&(0!==(i=pt(e))&&(r=i,t=lu(e,i))),1===t)throw n=Ul,mu(e,0),cu(e,r),ou(e,Ye()),n;if(6===t)cu(e,r);else{if(i=e.current.alternate,0===(30&r)&&!function(e){for(var t=e;;){if(16384&t.flags){var n=t.updateQueue;if(null!==n&&null!==(n=n.stores))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!ur(s(),i))return!1}catch(a){return!1}}}if(n=t.child,16384&t.subtreeFlags&&null!==n)n.return=t,t=n;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(i)&&(2===(t=wu(e,r))&&(0!==(o=pt(e))&&(r=o,t=lu(e,o))),1===t))throw n=Ul,mu(e,0),cu(e,r),ou(e,Ye()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(s(345));case 2:case 5:Eu(e,ql,Gl);break;case 3:if(cu(e,r),(130023424&r)===r&&10<(t=$l+500-Ye())){if(0!==dt(e,0))break;if(((i=e.suspendedLanes)&r)!==r){ru(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=oi(Eu.bind(null,e,ql,Gl),t);break}Eu(e,ql,Gl);break;case 4:if(cu(e,r),(4194240&r)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-ot(r);o=1<<a,(a=t[a])>i&&(i=a),r&=~o}if(r=i,10<(r=(120>(r=Ye()-r)?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*Cl(r/1960))-r)){e.timeoutHandle=oi(Eu.bind(null,e,ql,Gl),r);break}Eu(e,ql,Gl);break;default:throw Error(s(329))}}}return ou(e,Ye()),e.callbackNode===n?au.bind(null,e):null}function lu(e,t){var n=Bl;return e.current.memoizedState.isDehydrated&&(mu(e,t).flags|=256),2!==(e=wu(e,t))&&(t=ql,ql=n,null!==t&&uu(t)),e}function uu(e){null===ql?ql=e:ql.push.apply(ql,e)}function cu(e,t){for(t&=~zl,t&=~Vl,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-ot(t),r=1<<n;e[n]=-1,t&=~r}}function hu(e){if(0!==(6&Pl))throw Error(s(327));Tu();var t=dt(e,0);if(0===(1&t))return ou(e,Ye()),null;var n=wu(e,t);if(0!==e.tag&&2===n){var r=pt(e);0!==r&&(t=r,n=lu(e,r))}if(1===n)throw n=Ul,mu(e,0),cu(e,t),ou(e,Ye()),n;if(6===n)throw Error(s(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Eu(e,ql,Gl),ou(e,Ye()),null}function du(e,t){var n=Pl;Pl|=1;try{return e(t)}finally{0===(Pl=n)&&(Kl=Ye()+500,Bi&&Ki())}}function fu(e){null!==Yl&&0===Yl.tag&&0===(6&Pl)&&Tu();var t=Pl;Pl|=1;var n=Al.transition,r=wt;try{if(Al.transition=null,wt=1,e)return e()}finally{wt=r,Al.transition=n,0===(6&(Pl=t))&&Ki()}}function pu(){Ll=Ml.current,xi(Ml)}function mu(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,ai(n)),null!==Dl)for(n=Dl.return;null!==n;){var r=n;switch(is(r),r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&Mi();break;case 3:Zs(),xi(Ri),xi(Pi),so();break;case 5:to(r);break;case 4:Zs();break;case 13:case 19:xi(no);break;case 10:As(r.type._context);break;case 22:case 23:pu()}n=n.return}if(Rl=e,Dl=e=Mu(e.current,null),Ol=Ll=t,Fl=0,Ul=null,zl=Vl=jl=0,ql=Bl=null,null!==Os){for(t=0;t<Os.length;t++)if(null!==(r=(n=Os[t]).interleaved)){n.interleaved=null;var i=r.next,s=n.pending;if(null!==s){var o=s.next;s.next=i,r.next=o}n.pending=r}Os=null}return e}function gu(e,t){for(;;){var n=Dl;try{if(Ns(),oo.current=ta,fo){for(var r=uo.memoizedState;null!==r;){var i=r.queue;null!==i&&(i.pending=null),r=r.next}fo=!1}if(lo=0,ho=co=uo=null,po=!1,mo=0,Nl.current=null,null===n||null===n.return){Fl=1,Ul=t,Dl=null;break}e:{var o=e,a=n.return,l=n,u=t;if(t=Ol,l.flags|=32768,null!==u&&"object"===typeof u&&"function"===typeof u.then){var c=u,h=l,d=h.tag;if(0===(1&h.mode)&&(0===d||11===d||15===d)){var f=h.alternate;f?(h.updateQueue=f.updateQueue,h.memoizedState=f.memoizedState,h.lanes=f.lanes):(h.updateQueue=null,h.memoizedState=null)}var p=wa(a);if(null!==p){p.flags&=-257,ba(p,a,l,0,t),1&p.mode&&ya(o,c,t),u=c;var m=(t=p).updateQueue;if(null===m){var g=new Set;g.add(u),t.updateQueue=g}else m.add(u);break e}if(0===(1&t)){ya(o,c,t),yu();break e}u=Error(s(426))}else if(as&&1&l.mode){var v=wa(a);if(null!==v){0===(65536&v.flags)&&(v.flags|=256),ba(v,a,l,0,t),vs(da(u,l));break e}}o=u=da(u,l),4!==Fl&&(Fl=2),null===Bl?Bl=[o]:Bl.push(o),o=a;do{switch(o.tag){case 3:o.flags|=65536,t&=-t,o.lanes|=t,$s(o,ga(0,u,t));break e;case 1:l=u;var y=o.type,w=o.stateNode;if(0===(128&o.flags)&&("function"===typeof y.getDerivedStateFromError||null!==w&&"function"===typeof w.componentDidCatch&&(null===Ql||!Ql.has(w)))){o.flags|=65536,t&=-t,o.lanes|=t,$s(o,va(o,l,t));break e}}o=o.return}while(null!==o)}Su(n)}catch(b){t=b,Dl===n&&null!==n&&(Dl=n=n.return);continue}break}}function vu(){var e=xl.current;return xl.current=ta,null===e?ta:e}function yu(){0!==Fl&&3!==Fl&&2!==Fl||(Fl=4),null===Rl||0===(268435455&jl)&&0===(268435455&Vl)||cu(Rl,Ol)}function wu(e,t){var n=Pl;Pl|=2;var r=vu();for(Rl===e&&Ol===t||(Gl=null,mu(e,t));;)try{bu();break}catch(i){gu(e,i)}if(Ns(),Pl=n,xl.current=r,null!==Dl)throw Error(s(261));return Rl=null,Ol=0,Fl}function bu(){for(;null!==Dl;)Iu(Dl)}function _u(){for(;null!==Dl&&!Qe();)Iu(Dl)}function Iu(e){var t=kl(e.alternate,e,Ll);e.memoizedProps=e.pendingProps,null===t?Su(e):Dl=t,Nl.current=null}function Su(e){var t=e;do{var n=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(n=Ja(n,t,Ll)))return void(Dl=n)}else{if(null!==(n=Ya(n,t)))return n.flags&=32767,void(Dl=n);if(null===e)return Fl=6,void(Dl=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Dl=t);Dl=t=e}while(null!==t);0===Fl&&(Fl=5)}function Eu(e,t,n){var r=wt,i=Al.transition;try{Al.transition=null,wt=1,function(e,t,n,r){do{Tu()}while(null!==Yl);if(0!==(6&Pl))throw Error(s(327));n=e.finishedWork;var i=e.finishedLanes;if(null===n)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(s(177));e.callbackNode=null,e.callbackPriority=0;var o=n.lanes|n.childLanes;if(function(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-ot(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}(e,o),e===Rl&&(Dl=Rl=null,Ol=0),0===(2064&n.subtreeFlags)&&0===(2064&n.flags)||Jl||(Jl=!0,Ru(tt,(function(){return Tu(),null}))),o=0!==(15990&n.flags),0!==(15990&n.subtreeFlags)||o){o=Al.transition,Al.transition=null;var a=wt;wt=1;var l=Pl;Pl|=4,Nl.current=null,function(e,t){if(ri=$t,mr(e=pr())){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{var r=(n=(n=e.ownerDocument)&&n.defaultView||window).getSelection&&n.getSelection();if(r&&0!==r.rangeCount){n=r.anchorNode;var i=r.anchorOffset,o=r.focusNode;r=r.focusOffset;try{n.nodeType,o.nodeType}catch(Yn){n=null;break e}var a=0,l=-1,u=-1,c=0,h=0,d=e,f=null;t:for(;;){for(var p;d!==n||0!==i&&3!==d.nodeType||(l=a+i),d!==o||0!==r&&3!==d.nodeType||(u=a+r),3===d.nodeType&&(a+=d.nodeValue.length),null!==(p=d.firstChild);)f=d,d=p;for(;;){if(d===e)break t;if(f===n&&++c===i&&(l=a),f===o&&++h===r&&(u=a),null!==(p=d.nextSibling))break;f=(d=f).parentNode}d=p}n=-1===l||-1===u?null:{start:l,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(ii={focusedElem:e,selectionRange:n},$t=!1,tl=t;null!==tl;)if(e=(t=tl).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,tl=e;else for(;null!==tl;){t=tl;try{var m=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==m){var g=m.memoizedProps,v=m.memoizedState,y=t.stateNode,w=y.getSnapshotBeforeUpdate(t.elementType===t.type?g:sa(t.type,g),v);y.__reactInternalSnapshotBeforeUpdate=w}break;case 3:var b=t.stateNode.containerInfo;1===b.nodeType?b.textContent="":9===b.nodeType&&b.documentElement&&b.removeChild(b.documentElement);break;default:throw Error(s(163))}}catch(Yn){Cu(t,t.return,Yn)}if(null!==(e=t.sibling)){e.return=t.return,tl=e;break}tl=t.return}m=il,il=!1}(e,n),wl(n,e),gr(ii),$t=!!ri,ii=ri=null,e.current=n,_l(n,e,i),Je(),Pl=l,wt=a,Al.transition=o}else e.current=n;if(Jl&&(Jl=!1,Yl=e,Xl=i),o=e.pendingLanes,0===o&&(Ql=null),function(e){if(st&&"function"===typeof st.onCommitFiberRoot)try{st.onCommitFiberRoot(it,e,void 0,128===(128&e.current.flags))}catch(t){}}(n.stateNode),ou(e,Ye()),null!==t)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(Hl)throw Hl=!1,e=Wl,Wl=null,e;0!==(1&Xl)&&0!==e.tag&&Tu(),o=e.pendingLanes,0!==(1&o)?e===eu?Zl++:(Zl=0,eu=e):Zl=0,Ki()}(e,t,n,r)}finally{Al.transition=i,wt=r}return null}function Tu(){if(null!==Yl){var e=bt(Xl),t=Al.transition,n=wt;try{if(Al.transition=null,wt=16>e?16:e,null===Yl)var r=!1;else{if(e=Yl,Yl=null,Xl=0,0!==(6&Pl))throw Error(s(331));var i=Pl;for(Pl|=4,tl=e.current;null!==tl;){var o=tl,a=o.child;if(0!==(16&tl.flags)){var l=o.deletions;if(null!==l){for(var u=0;u<l.length;u++){var c=l[u];for(tl=c;null!==tl;){var h=tl;switch(h.tag){case 0:case 11:case 15:sl(8,h,o)}var d=h.child;if(null!==d)d.return=h,tl=d;else for(;null!==tl;){var f=(h=tl).sibling,p=h.return;if(ll(h),h===c){tl=null;break}if(null!==f){f.return=p,tl=f;break}tl=p}}}var m=o.alternate;if(null!==m){var g=m.child;if(null!==g){m.child=null;do{var v=g.sibling;g.sibling=null,g=v}while(null!==g)}}tl=o}}if(0!==(2064&o.subtreeFlags)&&null!==a)a.return=o,tl=a;else e:for(;null!==tl;){if(0!==(2048&(o=tl).flags))switch(o.tag){case 0:case 11:case 15:sl(9,o,o.return)}var y=o.sibling;if(null!==y){y.return=o.return,tl=y;break e}tl=o.return}}var w=e.current;for(tl=w;null!==tl;){var b=(a=tl).child;if(0!==(2064&a.subtreeFlags)&&null!==b)b.return=a,tl=b;else e:for(a=w;null!==tl;){if(0!==(2048&(l=tl).flags))try{switch(l.tag){case 0:case 11:case 15:ol(9,l)}}catch(I){Cu(l,l.return,I)}if(l===a){tl=null;break e}var _=l.sibling;if(null!==_){_.return=l.return,tl=_;break e}tl=l.return}}if(Pl=i,Ki(),st&&"function"===typeof st.onPostCommitFiberRoot)try{st.onPostCommitFiberRoot(it,e)}catch(I){}r=!0}return r}finally{wt=n,Al.transition=t}}return!1}function ku(e,t,n){e=Bs(e,t=ga(0,t=da(n,t),1),1),t=ru(),null!==e&&(vt(e,1,t),ou(e,t))}function Cu(e,t,n){if(3===e.tag)ku(e,e,n);else for(;null!==t;){if(3===t.tag){ku(t,e,n);break}if(1===t.tag){var r=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ql||!Ql.has(r))){t=Bs(t,e=va(t,e=da(n,e),1),1),e=ru(),null!==t&&(vt(t,1,e),ou(t,e));break}}t=t.return}}function xu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),t=ru(),e.pingedLanes|=e.suspendedLanes&n,Rl===e&&(Ol&n)===n&&(4===Fl||3===Fl&&(130023424&Ol)===Ol&&500>Ye()-$l?mu(e,0):zl|=n),ou(e,t)}function Nu(e,t){0===t&&(0===(1&e.mode)?t=1:(t=ct,0===(130023424&(ct<<=1))&&(ct=4194304)));var n=ru();null!==(e=Fs(e,t))&&(vt(e,t,n),ou(e,n))}function Au(e){var t=e.memoizedState,n=0;null!==t&&(n=t.retryLane),Nu(e,n)}function Pu(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;null!==i&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(s(314))}null!==r&&r.delete(t),Nu(e,n)}function Ru(e,t){return He(e,t)}function Du(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Ou(e,t,n,r){return new Du(e,t,n,r)}function Lu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Mu(e,t){var n=e.alternate;return null===n?((n=Ou(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=14680064&e.flags,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Fu(e,t,n,r,i,o){var a=2;if(r=e,"function"===typeof e)Lu(e)&&(a=1);else if("string"===typeof e)a=5;else e:switch(e){case S:return Uu(n.children,i,o,t);case E:a=8,i|=8;break;case T:return(e=Ou(12,n,t,2|i)).elementType=T,e.lanes=o,e;case N:return(e=Ou(13,n,t,i)).elementType=N,e.lanes=o,e;case A:return(e=Ou(19,n,t,i)).elementType=A,e.lanes=o,e;case D:return ju(n,i,o,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case k:a=10;break e;case C:a=9;break e;case x:a=11;break e;case P:a=14;break e;case R:a=16,r=null;break e}throw Error(s(130,null==e?e:typeof e,""))}return(t=Ou(a,n,t,i)).elementType=e,t.type=r,t.lanes=o,t}function Uu(e,t,n,r){return(e=Ou(7,e,r,t)).lanes=n,e}function ju(e,t,n,r){return(e=Ou(22,e,r,t)).elementType=D,e.lanes=n,e.stateNode={isHidden:!1},e}function Vu(e,t,n){return(e=Ou(6,e,null,t)).lanes=n,e}function zu(e,t,n){return(t=Ou(4,null!==e.children?e.children:[],e.key,t)).lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Bu(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=gt(0),this.expirationTimes=gt(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=gt(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function qu(e,t,n,r,i,s,o,a,l){return e=new Bu(e,t,n,a,l),1===t?(t=1,!0===s&&(t|=8)):t=0,s=Ou(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},js(s),e}function $u(e){if(!e)return Ai;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(s(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Li(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(s(171))}if(1===e.tag){var n=e.type;if(Li(n))return Ui(e,n,t)}return t}function Ku(e,t,n,r,i,s,o,a,l){return(e=qu(n,r,!0,e,0,s,0,a,l)).context=$u(null),n=e.current,(s=zs(r=ru(),i=iu(n))).callback=void 0!==t&&null!==t?t:null,Bs(n,s,i),e.current.lanes=i,vt(e,i,r),ou(e,r),e}function Gu(e,t,n,r){var i=t.current,s=ru(),o=iu(i);return n=$u(n),null===t.context?t.context=n:t.pendingContext=n,(t=zs(s,o)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),null!==(e=Bs(i,t,o))&&(su(e,i,o,s),qs(e,i,o)),o}function Hu(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Wu(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var n=e.retryLane;e.retryLane=0!==n&&n<t?n:t}}function Qu(e,t){Wu(e,t),(e=e.alternate)&&Wu(e,t)}kl=function(e,t,n){if(null!==e)if(e.memoizedProps!==t.pendingProps||Ri.current)Ia=!0;else{if(0===(e.lanes&n)&&0===(128&t.flags))return Ia=!1,function(e,t,n){switch(t.tag){case 3:Ra(t),gs();break;case 5:eo(t);break;case 1:Li(t.type)&&ji(t);break;case 4:Xs(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Ni(Ts,r._currentValue),r._currentValue=i;break;case 13:if(null!==(r=t.memoizedState))return null!==r.dehydrated?(Ni(no,1&no.current),t.flags|=128,null):0!==(n&t.child.childLanes)?Va(e,t,n):(Ni(no,1&no.current),null!==(e=Ha(e,t,n))?e.sibling:null);Ni(no,1&no.current);break;case 19:if(r=0!==(n&t.childLanes),0!==(128&e.flags)){if(r)return Ka(e,t,n);t.flags|=128}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null,i.lastEffect=null),Ni(no,no.current),r)break;return null;case 22:case 23:return t.lanes=0,Ca(e,t,n)}return Ha(e,t,n)}(e,t,n);Ia=0!==(131072&e.flags)}else Ia=!1,as&&0!==(1048576&t.flags)&&ns(t,Qi,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;Ga(e,t),e=t.pendingProps;var i=Oi(t,Pi.current);Rs(t,n),i=wo(null,t,r,e,i,n);var o=bo();return t.flags|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Li(r)?(o=!0,ji(t)):o=!1,t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,js(t),i.updater=aa,t.stateNode=i,i._reactInternals=t,ha(t,r,e,n),t=Pa(null,t,r,!0,o,n)):(t.tag=0,as&&o&&rs(t),Sa(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(Ga(e,t),e=t.pendingProps,r=(i=r._init)(r._payload),t.type=r,i=t.tag=function(e){if("function"===typeof e)return Lu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===x)return 11;if(e===P)return 14}return 2}(r),e=sa(r,e),i){case 0:t=Na(null,t,r,e,n);break e;case 1:t=Aa(null,t,r,e,n);break e;case 11:t=Ea(null,t,r,e,n);break e;case 14:t=Ta(null,t,r,sa(r.type,e),n);break e}throw Error(s(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,Na(e,t,r,i=t.elementType===r?i:sa(r,i),n);case 1:return r=t.type,i=t.pendingProps,Aa(e,t,r,i=t.elementType===r?i:sa(r,i),n);case 3:e:{if(Ra(t),null===e)throw Error(s(387));r=t.pendingProps,i=(o=t.memoizedState).element,Vs(e,t),Ks(t,r,null,n);var a=t.memoizedState;if(r=a.element,o.isDehydrated){if(o={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=o,t.memoizedState=o,256&t.flags){t=Da(e,t,r,n,i=da(Error(s(423)),t));break e}if(r!==i){t=Da(e,t,r,n,i=da(Error(s(424)),t));break e}for(os=di(t.stateNode.containerInfo.firstChild),ss=t,as=!0,ls=null,n=Es(t,null,r,n),t.child=n;n;)n.flags=-3&n.flags|4096,n=n.sibling}else{if(gs(),r===i){t=Ha(e,t,n);break e}Sa(e,t,r,n)}t=t.child}return t;case 5:return eo(t),null===e&&ds(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,a=i.children,si(r,i)?a=null:null!==o&&si(r,o)&&(t.flags|=32),xa(e,t),Sa(e,t,a,n),t.child;case 6:return null===e&&ds(t),null;case 13:return Va(e,t,n);case 4:return Xs(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Ss(t,null,r,n):Sa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ea(e,t,r,i=t.elementType===r?i:sa(r,i),n);case 7:return Sa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Sa(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,o=t.memoizedProps,a=i.value,Ni(Ts,r._currentValue),r._currentValue=a,null!==o)if(ur(o.value,a)){if(o.children===i.children&&!Ri.current){t=Ha(e,t,n);break e}}else for(null!==(o=t.child)&&(o.return=t);null!==o;){var l=o.dependencies;if(null!==l){a=o.child;for(var u=l.firstContext;null!==u;){if(u.context===r){if(1===o.tag){(u=zs(-1,n&-n)).tag=2;var c=o.updateQueue;if(null!==c){var h=(c=c.shared).pending;null===h?u.next=u:(u.next=h.next,h.next=u),c.pending=u}}o.lanes|=n,null!==(u=o.alternate)&&(u.lanes|=n),Ps(o.return,n,t),l.lanes|=n;break}u=u.next}}else if(10===o.tag)a=o.type===t.type?null:o.child;else if(18===o.tag){if(null===(a=o.return))throw Error(s(341));a.lanes|=n,null!==(l=a.alternate)&&(l.lanes|=n),Ps(a,n,t),a=o.sibling}else a=o.child;if(null!==a)a.return=o;else for(a=o;null!==a;){if(a===t){a=null;break}if(null!==(o=a.sibling)){o.return=a.return,a=o;break}a=a.return}o=a}Sa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,Rs(t,n),r=r(i=Ds(i)),t.flags|=1,Sa(e,t,r,n),t.child;case 14:return i=sa(r=t.type,t.pendingProps),Ta(e,t,r,i=sa(r.type,i),n);case 15:return ka(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:sa(r,i),Ga(e,t),t.tag=1,Li(r)?(e=!0,ji(t)):e=!1,Rs(t,n),ua(t,r,i),ha(t,r,i,n),Pa(null,t,r,!0,e,n);case 19:return Ka(e,t,n);case 22:return Ca(e,t,n)}throw Error(s(156,t.tag))};var Ju="function"===typeof reportError?reportError:function(e){console.error(e)};function Yu(e){this._internalRoot=e}function Xu(e){this._internalRoot=e}function Zu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function ec(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function tc(){}function nc(e,t,n,r,i){var s=n._reactRootContainer;if(s){var o=s;if("function"===typeof i){var a=i;i=function(){var e=Hu(o);a.call(e)}}Gu(t,o,e,i)}else o=function(e,t,n,r,i){if(i){if("function"===typeof r){var s=r;r=function(){var e=Hu(o);s.call(e)}}var o=Ku(t,r,e,0,null,!1,0,"",tc);return e._reactRootContainer=o,e[vi]=o.current,Kr(8===e.nodeType?e.parentNode:e),fu(),o}for(;i=e.lastChild;)e.removeChild(i);if("function"===typeof r){var a=r;r=function(){var e=Hu(l);a.call(e)}}var l=qu(e,0,!1,null,0,!1,0,"",tc);return e._reactRootContainer=l,e[vi]=l.current,Kr(8===e.nodeType?e.parentNode:e),fu((function(){Gu(t,l,n,r)})),l}(n,t,e,i,r);return Hu(o)}Xu.prototype.render=Yu.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(s(409));Gu(e,t,null,null)},Xu.prototype.unmount=Yu.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;fu((function(){Gu(null,e,null,null)})),t[vi]=null}},Xu.prototype.unstable_scheduleHydration=function(e){if(e){var t=Et();e={blockedOn:null,target:e,priority:t};for(var n=0;n<Dt.length&&0!==t&&t<Dt[n].priority;n++);Dt.splice(n,0,e),0===n&&Ft(e)}},_t=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=ht(t.pendingLanes);0!==n&&(yt(t,1|n),ou(t,Ye()),0===(6&Pl)&&(Kl=Ye()+500,Ki()))}break;case 13:fu((function(){var t=Fs(e,1);if(null!==t){var n=ru();su(t,e,1,n)}})),Qu(e,1)}},It=function(e){if(13===e.tag){var t=Fs(e,134217728);if(null!==t)su(t,e,134217728,ru());Qu(e,134217728)}},St=function(e){if(13===e.tag){var t=iu(e),n=Fs(e,t);if(null!==n)su(n,e,t,ru());Qu(e,t)}},Et=function(){return wt},Tt=function(e,t){var n=wt;try{return wt=e,t()}finally{wt=n}},Ie=function(e,t,n){switch(t){case"input":if(X(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Ei(r);if(!i)throw Error(s(90));H(r),X(r,i)}}}break;case"textarea":se(e,n);break;case"select":null!=(t=n.value)&&ne(e,!!n.multiple,t,!1)}},xe=du,Ne=fu;var rc={usingClientEntryPoint:!1,Events:[Ii,Si,Ei,ke,Ce,du]},ic={findFiberByHostInstance:_i,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sc={bundleType:ic.bundleType,version:ic.version,rendererPackageName:ic.rendererPackageName,rendererConfig:ic.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:b.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ke(e))?null:e.stateNode},findFiberByHostInstance:ic.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var oc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!oc.isDisabled&&oc.supportsFiber)try{it=oc.inject(sc),st=oc}catch(ce){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=rc,t.createPortal=function(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Zu(t))throw Error(s(200));return function(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:I,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}(e,t,null,n)},t.createRoot=function(e,t){if(!Zu(e))throw Error(s(299));var n=!1,r="",i=Ju;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(n=!0),void 0!==t.identifierPrefix&&(r=t.identifierPrefix),void 0!==t.onRecoverableError&&(i=t.onRecoverableError)),t=qu(e,1,!1,null,0,n,0,r,i),e[vi]=t.current,Kr(8===e.nodeType?e.parentNode:e),new Yu(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(s(188));throw e=Object.keys(e).join(","),Error(s(268,e))}return e=null===(e=Ke(t))?null:e.stateNode},t.flushSync=function(e){return fu(e)},t.hydrate=function(e,t,n){if(!ec(t))throw Error(s(200));return nc(null,e,t,!0,n)},t.hydrateRoot=function(e,t,n){if(!Zu(e))throw Error(s(405));var r=null!=n&&n.hydratedSources||null,i=!1,o="",a=Ju;if(null!==n&&void 0!==n&&(!0===n.unstable_strictMode&&(i=!0),void 0!==n.identifierPrefix&&(o=n.identifierPrefix),void 0!==n.onRecoverableError&&(a=n.onRecoverableError)),t=Ku(t,null,e,1,null!=n?n:null,i,0,o,a),e[vi]=t.current,Kr(e),r)for(e=0;e<r.length;e++)i=(i=(n=r[e])._getVersion)(n._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Xu(t)},t.render=function(e,t,n){if(!ec(t))throw Error(s(200));return nc(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!ec(e))throw Error(s(40));return!!e._reactRootContainer&&(fu((function(){nc(null,null,e,!1,(function(){e._reactRootContainer=null,e[vi]=null}))})),!0)},t.unstable_batchedUpdates=du,t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!ec(n))throw Error(s(200));if(null==e||void 0===e._reactInternals)throw Error(s(38));return nc(e,t,n,!1,r)},t.version="18.3.1-next-f1338f8080-20240426"},391:(e,t,n)=>{var r=n(950);t.createRoot=r.createRoot,t.hydrateRoot=r.hydrateRoot},950:(e,t,n)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=n(730)},153:(e,t,n)=>{var r=n(43),i=Symbol.for("react.element"),s=Symbol.for("react.fragment"),o=Object.prototype.hasOwnProperty,a=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,l={key:!0,ref:!0,__self:!0,__source:!0};function u(e,t,n){var r,s={},u=null,c=null;for(r in void 0!==n&&(u=""+n),void 0!==t.key&&(u=""+t.key),void 0!==t.ref&&(c=t.ref),t)o.call(t,r)&&!l.hasOwnProperty(r)&&(s[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps)void 0===s[r]&&(s[r]=t[r]);return{$$typeof:i,type:e,key:u,ref:c,props:s,_owner:a.current}}t.Fragment=s,t.jsx=u,t.jsxs=u},202:(e,t)=>{var n=Symbol.for("react.element"),r=Symbol.for("react.portal"),i=Symbol.for("react.fragment"),s=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),a=Symbol.for("react.provider"),l=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),c=Symbol.for("react.suspense"),h=Symbol.for("react.memo"),d=Symbol.for("react.lazy"),f=Symbol.iterator;var p={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},m=Object.assign,g={};function v(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}function y(){}function w(e,t,n){this.props=e,this.context=t,this.refs=g,this.updater=n||p}v.prototype.isReactComponent={},v.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},v.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=v.prototype;var b=w.prototype=new y;b.constructor=w,m(b,v.prototype),b.isPureReactComponent=!0;var _=Array.isArray,I=Object.prototype.hasOwnProperty,S={current:null},E={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,r){var i,s={},o=null,a=null;if(null!=t)for(i in void 0!==t.ref&&(a=t.ref),void 0!==t.key&&(o=""+t.key),t)I.call(t,i)&&!E.hasOwnProperty(i)&&(s[i]=t[i]);var l=arguments.length-2;if(1===l)s.children=r;else if(1<l){for(var u=Array(l),c=0;c<l;c++)u[c]=arguments[c+2];s.children=u}if(e&&e.defaultProps)for(i in l=e.defaultProps)void 0===s[i]&&(s[i]=l[i]);return{$$typeof:n,type:e,key:o,ref:a,props:s,_owner:S.current}}function k(e){return"object"===typeof e&&null!==e&&e.$$typeof===n}var C=/\/+/g;function x(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,(function(e){return t[e]}))}(""+e.key):t.toString(36)}function N(e,t,i,s,o){var a=typeof e;"undefined"!==a&&"boolean"!==a||(e=null);var l=!1;if(null===e)l=!0;else switch(a){case"string":case"number":l=!0;break;case"object":switch(e.$$typeof){case n:case r:l=!0}}if(l)return o=o(l=e),e=""===s?"."+x(l,0):s,_(o)?(i="",null!=e&&(i=e.replace(C,"$&/")+"/"),N(o,t,i,"",(function(e){return e}))):null!=o&&(k(o)&&(o=function(e,t){return{$$typeof:n,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(o,i+(!o.key||l&&l.key===o.key?"":(""+o.key).replace(C,"$&/")+"/")+e)),t.push(o)),1;if(l=0,s=""===s?".":s+":",_(e))for(var u=0;u<e.length;u++){var c=s+x(a=e[u],u);l+=N(a,t,i,c,o)}else if(c=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof c)for(e=c.call(e),u=0;!(a=e.next()).done;)l+=N(a=a.value,t,i,c=s+x(a,u++),o);else if("object"===a)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return l}function A(e,t,n){if(null==e)return e;var r=[],i=0;return N(e,r,"","",(function(e){return t.call(n,e,i++)})),r}function P(e){if(-1===e._status){var t=e._result;(t=t()).then((function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)}),(function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)})),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var R={current:null},D={transition:null},O={ReactCurrentDispatcher:R,ReactCurrentBatchConfig:D,ReactCurrentOwner:S};function L(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,n){A(e,(function(){t.apply(this,arguments)}),n)},count:function(e){var t=0;return A(e,(function(){t++})),t},toArray:function(e){return A(e,(function(e){return e}))||[]},only:function(e){if(!k(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=v,t.Fragment=i,t.Profiler=o,t.PureComponent=w,t.StrictMode=s,t.Suspense=c,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=O,t.act=L,t.cloneElement=function(e,t,r){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var i=m({},e.props),s=e.key,o=e.ref,a=e._owner;if(null!=t){if(void 0!==t.ref&&(o=t.ref,a=S.current),void 0!==t.key&&(s=""+t.key),e.type&&e.type.defaultProps)var l=e.type.defaultProps;for(u in t)I.call(t,u)&&!E.hasOwnProperty(u)&&(i[u]=void 0===t[u]&&void 0!==l?l[u]:t[u])}var u=arguments.length-2;if(1===u)i.children=r;else if(1<u){l=Array(u);for(var c=0;c<u;c++)l[c]=arguments[c+2];i.children=l}return{$$typeof:n,type:e.type,key:s,ref:o,props:i,_owner:a}},t.createContext=function(e){return(e={$$typeof:l,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:a,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:u,render:e}},t.isValidElement=k,t.lazy=function(e){return{$$typeof:d,_payload:{_status:-1,_result:e},_init:P}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=D.transition;D.transition={};try{e()}finally{D.transition=t}},t.unstable_act=L,t.useCallback=function(e,t){return R.current.useCallback(e,t)},t.useContext=function(e){return R.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return R.current.useDeferredValue(e)},t.useEffect=function(e,t){return R.current.useEffect(e,t)},t.useId=function(){return R.current.useId()},t.useImperativeHandle=function(e,t,n){return R.current.useImperativeHandle(e,t,n)},t.useInsertionEffect=function(e,t){return R.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return R.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return R.current.useMemo(e,t)},t.useReducer=function(e,t,n){return R.current.useReducer(e,t,n)},t.useRef=function(e){return R.current.useRef(e)},t.useState=function(e){return R.current.useState(e)},t.useSyncExternalStore=function(e,t,n){return R.current.useSyncExternalStore(e,t,n)},t.useTransition=function(){return R.current.useTransition()},t.version="18.3.1"},43:(e,t,n)=>{e.exports=n(202)},579:(e,t,n)=>{e.exports=n(153)},234:(e,t)=>{function n(e,t){var n=e.length;e.push(t);e:for(;0<n;){var r=n-1>>>1,i=e[r];if(!(0<s(i,t)))break e;e[r]=t,e[n]=i,n=r}}function r(e){return 0===e.length?null:e[0]}function i(e){if(0===e.length)return null;var t=e[0],n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length,o=i>>>1;r<o;){var a=2*(r+1)-1,l=e[a],u=a+1,c=e[u];if(0>s(l,n))u<i&&0>s(c,l)?(e[r]=c,e[u]=n,r=u):(e[r]=l,e[a]=n,r=a);else{if(!(u<i&&0>s(c,n)))break e;e[r]=c,e[u]=n,r=u}}}return t}function s(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var o=performance;t.unstable_now=function(){return o.now()}}else{var a=Date,l=a.now();t.unstable_now=function(){return a.now()-l}}var u=[],c=[],h=1,d=null,f=3,p=!1,m=!1,g=!1,v="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,w="undefined"!==typeof setImmediate?setImmediate:null;function b(e){for(var t=r(c);null!==t;){if(null===t.callback)i(c);else{if(!(t.startTime<=e))break;i(c),t.sortIndex=t.expirationTime,n(u,t)}t=r(c)}}function _(e){if(g=!1,b(e),!m)if(null!==r(u))m=!0,D(I);else{var t=r(c);null!==t&&O(_,t.startTime-e)}}function I(e,n){m=!1,g&&(g=!1,y(k),k=-1),p=!0;var s=f;try{for(b(n),d=r(u);null!==d&&(!(d.expirationTime>n)||e&&!N());){var o=d.callback;if("function"===typeof o){d.callback=null,f=d.priorityLevel;var a=o(d.expirationTime<=n);n=t.unstable_now(),"function"===typeof a?d.callback=a:d===r(u)&&i(u),b(n)}else i(u);d=r(u)}if(null!==d)var l=!0;else{var h=r(c);null!==h&&O(_,h.startTime-n),l=!1}return l}finally{d=null,f=s,p=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var S,E=!1,T=null,k=-1,C=5,x=-1;function N(){return!(t.unstable_now()-x<C)}function A(){if(null!==T){var e=t.unstable_now();x=e;var n=!0;try{n=T(!0,e)}finally{n?S():(E=!1,T=null)}}else E=!1}if("function"===typeof w)S=function(){w(A)};else if("undefined"!==typeof MessageChannel){var P=new MessageChannel,R=P.port2;P.port1.onmessage=A,S=function(){R.postMessage(null)}}else S=function(){v(A,0)};function D(e){T=e,E||(E=!0,S())}function O(e,n){k=v((function(){e(t.unstable_now())}),n)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){m||p||(m=!0,D(I))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):C=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return r(u)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var n=f;f=t;try{return e()}finally{f=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=f;f=e;try{return t()}finally{f=n}},t.unstable_scheduleCallback=function(e,i,s){var o=t.unstable_now();switch("object"===typeof s&&null!==s?s="number"===typeof(s=s.delay)&&0<s?o+s:o:s=o,e){case 1:var a=-1;break;case 2:a=250;break;case 5:a=1073741823;break;case 4:a=1e4;break;default:a=5e3}return e={id:h++,callback:i,priorityLevel:e,startTime:s,expirationTime:a=s+a,sortIndex:-1},s>o?(e.sortIndex=s,n(c,e),null===r(u)&&e===r(c)&&(g?(y(k),k=-1):g=!0,O(_,s-o))):(e.sortIndex=a,n(u,e),m||p||(m=!0,D(I))),e},t.unstable_shouldYield=N,t.unstable_wrapCallback=function(e){var t=f;return function(){var n=f;f=t;try{return e.apply(this,arguments)}finally{f=n}}}},853:(e,t,n)=>{e.exports=n(234)}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var s=t[r]={exports:{}};return e[r](s,s.exports,n),s.exports}n.m=e,n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.f={},n.e=e=>Promise.all(Object.keys(n.f).reduce(((t,r)=>(n.f[r](e,t),t)),[])),n.u=e=>"static/js/"+e+".0a142e0c.chunk.js",n.miniCssF=e=>{},n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),(()=>{var e={},t="vchat:";n.l=(r,i,s,o)=>{if(e[r])e[r].push(i);else{var a,l;if(void 0!==s)for(var u=document.getElementsByTagName("script"),c=0;c<u.length;c++){var h=u[c];if(h.getAttribute("src")==r||h.getAttribute("data-webpack")==t+s){a=h;break}}a||(l=!0,(a=document.createElement("script")).charset="utf-8",a.timeout=120,n.nc&&a.setAttribute("nonce",n.nc),a.setAttribute("data-webpack",t+s),a.src=r),e[r]=[i];var d=(t,n)=>{a.onerror=a.onload=null,clearTimeout(f);var i=e[r];if(delete e[r],a.parentNode&&a.parentNode.removeChild(a),i&&i.forEach((e=>e(n))),t)return t(n)},f=setTimeout(d.bind(null,void 0,{type:"timeout",target:a}),12e4);a.onerror=d.bind(null,a.onerror),a.onload=d.bind(null,a.onload),l&&document.head.appendChild(a)}}})(),n.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.p="/",(()=>{var e={792:0};n.f.j=(t,r)=>{var i=n.o(e,t)?e[t]:void 0;if(0!==i)if(i)r.push(i[2]);else{var s=new Promise(((n,r)=>i=e[t]=[n,r]));r.push(i[2]=s);var o=n.p+n.u(t),a=new Error;n.l(o,(r=>{if(n.o(e,t)&&(0!==(i=e[t])&&(e[t]=void 0),i)){var s=r&&("load"===r.type?"missing":r.type),o=r&&r.target&&r.target.src;a.message="Loading chunk "+t+" failed.\n("+s+": "+o+")",a.name="ChunkLoadError",a.type=s,a.request=o,i[1](a)}}),"chunk-"+t,t)}};var t=(t,r)=>{var i,s,o=r[0],a=r[1],l=r[2],u=0;if(o.some((t=>0!==e[t]))){for(i in a)n.o(a,i)&&(n.m[i]=a[i]);if(l)l(n)}for(t&&t(r);u<o.length;u++)s=o[u],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0},r=self.webpackChunkvchat=self.webpackChunkvchat||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r={};n.r(r),n.d(r,{FirebaseError:()=>F,SDK_VERSION:()=>mt,_DEFAULT_ENTRY_NAME:()=>Ze,_addComponent:()=>it,_addOrOverwriteComponent:()=>st,_apps:()=>tt,_clearComponents:()=>ht,_components:()=>rt,_getProvider:()=>at,_isFirebaseApp:()=>ut,_isFirebaseServerApp:()=>ct,_registerComponent:()=>ot,_removeServiceInstance:()=>lt,_serverApps:()=>nt,deleteApp:()=>bt,getApp:()=>yt,getApps:()=>wt,initializeApp:()=>gt,initializeServerApp:()=>vt,onLog:()=>It,registerVersion:()=>_t,setLogLevel:()=>St});var i=n(43),s=n(391);const o=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"readwrite";return(await new Promise(((e,t)=>{const n=indexedDB.open("vixens",1);n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("vixens")||t.createObjectStore("vixens",{keyPath:"vixen_id"})},n.onsuccess=t=>e(t.target.result),n.onerror=e=>t(e.target.error)}))).transaction(e,t).objectStore(e)},a=async(e,t)=>{try{const n=(await o(e)).put(t);return new Promise(((e,t)=>{n.onsuccess=()=>e(!0),n.onerror=e=>t(e.target.error)}))}catch(n){throw console.error("Save or update error:",n),n}},l=async e=>{try{const t=(await o(e,"readonly")).getAll();return new Promise(((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=e=>n(e.target.error)}))}catch(t){throw console.error("Fetch all error:",t),t}},u="vixens";async function c(e){const t=await l(u)||[],n=t.find((t=>t.vixen_id===e.vixen_id));n?n.lastMessage=Date.now():t.push({vixen_id:e.vixen_id,vixen_name:e.name,chatHistory:[e.first_message],lastMessage:Date.now(),imageUrl:e.imageUrl}),t.sort(((e,t)=>t.lastMessage-e.lastMessage));for(const r of t)await a(u,r)}const h=async e=>{try{const t=(await o("vixens")).get(e);return new Promise(((e,n)=>{t.onsuccess=()=>e(t.result),t.onerror=e=>n(e.target.error)}))}catch(t){return console.error("Error fetching Vixen from IndexedDB:",t),null}};var d=n(579);function f(e){let{vixen:t,goChat:n,currentChat:r,setCurrentChat:i}=e;return(0,d.jsxs)("div",{className:"vixen-card",onClick:()=>{c(t),i(t.vixen_id),n()},children:[(0,d.jsx)("img",{className:"vixen-profile-card",onMouseMove:p,onMouseLeave:m,src:t.imageUrl,alt:t.name}),(0,d.jsxs)("div",{className:"vixen-details",children:[(0,d.jsxs)("p",{className:"vixen-interactions",children:[t.messageCount||0,"\ud83e\uddfe  ",t.interactionCount||0,"\ud83d\ude47\u200d\u2642\ufe0f ",t.hearts||0,"\ud83d\udc97"]}),(0,d.jsx)("p",{className:"vixen-name",children:t.name}),(0,d.jsx)("p",{className:"vixen-description",children:t.description})]})]})}const p=e=>{const t=e.currentTarget,{offsetWidth:n,offsetHeight:r}=t,{left:i,top:s}=t.getBoundingClientRect(),o=(e.clientX-i)/n*100,a=(e.clientY-s)/r*100;t.style.transform=`rotateX(${.2*(a-50)}deg) rotateY(${.2*(o-50)}deg)`,t.classList.add("shimmer")},m=e=>{const t=e.currentTarget;t.style.transform="rotateX(0deg) rotateY(0deg)",t.classList.remove("shimmer")},g=(0,i.memo)(f),v=function(e){const t=[];let n=0;for(let r=0;r<e.length;r++){let i=e.charCodeAt(r);i<128?t[n++]=i:i<2048?(t[n++]=i>>6|192,t[n++]=63&i|128):55296===(64512&i)&&r+1<e.length&&56320===(64512&e.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&e.charCodeAt(++r)),t[n++]=i>>18|240,t[n++]=i>>12&63|128,t[n++]=i>>6&63|128,t[n++]=63&i|128):(t[n++]=i>>12|224,t[n++]=i>>6&63|128,t[n++]=63&i|128)}return t},y={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray(e,t){if(!Array.isArray(e))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=t?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let i=0;i<e.length;i+=3){const t=e[i],s=i+1<e.length,o=s?e[i+1]:0,a=i+2<e.length,l=a?e[i+2]:0,u=t>>2,c=(3&t)<<4|o>>4;let h=(15&o)<<2|l>>6,d=63&l;a||(d=64,s||(h=64)),r.push(n[u],n[c],n[h],n[d])}return r.join("")},encodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?btoa(e):this.encodeByteArray(v(e),t)},decodeString(e,t){return this.HAS_NATIVE_SUPPORT&&!t?atob(e):function(e){const t=[];let n=0,r=0;for(;n<e.length;){const i=e[n++];if(i<128)t[r++]=String.fromCharCode(i);else if(i>191&&i<224){const s=e[n++];t[r++]=String.fromCharCode((31&i)<<6|63&s)}else if(i>239&&i<365){const s=((7&i)<<18|(63&e[n++])<<12|(63&e[n++])<<6|63&e[n++])-65536;t[r++]=String.fromCharCode(55296+(s>>10)),t[r++]=String.fromCharCode(56320+(1023&s))}else{const s=e[n++],o=e[n++];t[r++]=String.fromCharCode((15&i)<<12|(63&s)<<6|63&o)}}return t.join("")}(this.decodeStringToByteArray(e,t))},decodeStringToByteArray(e,t){this.init_();const n=t?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let i=0;i<e.length;){const t=n[e.charAt(i++)],s=i<e.length?n[e.charAt(i)]:0;++i;const o=i<e.length?n[e.charAt(i)]:64;++i;const a=i<e.length?n[e.charAt(i)]:64;if(++i,null==t||null==s||null==o||null==a)throw new w;const l=t<<2|s>>4;if(r.push(l),64!==o){const e=s<<4&240|o>>2;if(r.push(e),64!==a){const e=o<<6&192|a;r.push(e)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let e=0;e<this.ENCODED_VALS.length;e++)this.byteToCharMap_[e]=this.ENCODED_VALS.charAt(e),this.charToByteMap_[this.byteToCharMap_[e]]=e,this.byteToCharMapWebSafe_[e]=this.ENCODED_VALS_WEBSAFE.charAt(e),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[e]]=e,e>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(e)]=e,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(e)]=e)}}};class w extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const b=function(e){return function(e){const t=v(e);return y.encodeByteArray(t,!0)}(e).replace(/\./g,"")},_=function(e){try{return y.decodeString(e,!0)}catch(t){console.error("base64Decode failed: ",t)}return null};function I(e,t){if(!(t instanceof Object))return t;switch(t.constructor){case Date:return new Date(t.getTime());case Object:void 0===e&&(e={});break;case Array:e=[];break;default:return t}for(const n in t)t.hasOwnProperty(n)&&"__proto__"!==n&&(e[n]=I(e[n],t[n]));return e}function S(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof n.g)return n.g;throw new Error("Unable to locate global object.")}const E=()=>{try{return S().__FIREBASE_DEFAULTS__||(()=>{if("undefined"===typeof process)return;const e={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.__FIREBASE_DEFAULTS__;return e?JSON.parse(e):void 0})()||(()=>{if("undefined"===typeof document)return;let e;try{e=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch(n){return}const t=e&&_(e[1]);return t&&JSON.parse(t)})()}catch(e){return void console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${e}`)}},T=e=>{const t=(e=>{var t,n;return null===(n=null===(t=E())||void 0===t?void 0:t.emulatorHosts)||void 0===n?void 0:n[e]})(e);if(!t)return;const n=t.lastIndexOf(":");if(n<=0||n+1===t.length)throw new Error(`Invalid host ${t} with no separate hostname and port!`);const r=parseInt(t.substring(n+1),10);return"["===t[0]?[t.substring(1,n-1),r]:[t.substring(0,n),r]},k=()=>{var e;return null===(e=E())||void 0===e?void 0:e.config};class C{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}wrapCallback(e){return(t,n)=>{t?this.reject(t):this.resolve(n),"function"===typeof e&&(this.promise.catch((()=>{})),1===e.length?e(t):e(t,n))}}}function x(e,t){if(e.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n=t||"demo-project",r=e.iat||0,i=e.sub||e.user_id;if(!i)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const s=Object.assign({iss:`https://securetoken.google.com/${n}`,aud:n,iat:r,exp:r+3600,auth_time:r,sub:i,user_id:i,firebase:{sign_in_provider:"custom",identities:{}}},e);return[b(JSON.stringify({alg:"none",type:"JWT"})),b(JSON.stringify(s)),""].join(".")}function N(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""}function A(){var e;const t=null===(e=E())||void 0===e?void 0:e.forceEnvironment;if("node"===t)return!0;if("browser"===t)return!1;try{return"[object process]"===Object.prototype.toString.call(n.g.process)}catch(r){return!1}}function P(){return"undefined"!==typeof WorkerGlobalScope&&"undefined"!==typeof self&&self instanceof WorkerGlobalScope}function R(){const e="object"===typeof chrome?chrome.runtime:"object"===typeof browser?browser.runtime:void 0;return"object"===typeof e&&void 0!==e.id}function D(){return"object"===typeof navigator&&"ReactNative"===navigator.product}function O(){const e=N();return e.indexOf("MSIE ")>=0||e.indexOf("Trident/")>=0}function L(){return!A()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function M(){try{return"object"===typeof indexedDB}catch(e){return!1}}class F extends Error{constructor(e,t,n){super(t),this.code=e,this.customData=n,this.name="FirebaseError",Object.setPrototypeOf(this,F.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,U.prototype.create)}}class U{constructor(e,t,n){this.service=e,this.serviceName=t,this.errors=n}create(e){const t=(arguments.length<=1?void 0:arguments[1])||{},n=`${this.service}/${e}`,r=this.errors[e],i=r?function(e,t){return e.replace(j,((e,n)=>{const r=t[n];return null!=r?String(r):`<${n}?>`}))}(r,t):"Error",s=`${this.serviceName}: ${i} (${n}).`;return new F(n,s,t)}}const j=/\{\$([^}]+)}/g;function V(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function z(e,t){if(e===t)return!0;const n=Object.keys(e),r=Object.keys(t);for(const i of n){if(!r.includes(i))return!1;const n=e[i],s=t[i];if(B(n)&&B(s)){if(!z(n,s))return!1}else if(n!==s)return!1}for(const i of r)if(!n.includes(i))return!1;return!0}function B(e){return null!==e&&"object"===typeof e}function q(e){const t=[];for(const[n,r]of Object.entries(e))Array.isArray(r)?r.forEach((e=>{t.push(encodeURIComponent(n)+"="+encodeURIComponent(e))})):t.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return t.length?"&"+t.join("&"):""}function $(e){const t={};return e.replace(/^\?/,"").split("&").forEach((e=>{if(e){const[n,r]=e.split("=");t[decodeURIComponent(n)]=decodeURIComponent(r)}})),t}function K(e){const t=e.indexOf("?");if(!t)return"";const n=e.indexOf("#",t);return e.substring(t,n>0?n:void 0)}function G(e,t){const n=new H(e,t);return n.subscribe.bind(n)}class H{constructor(e,t){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=t,this.task.then((()=>{e(this)})).catch((e=>{this.error(e)}))}next(e){this.forEachObserver((t=>{t.next(e)}))}error(e){this.forEachObserver((t=>{t.error(e)})),this.close(e)}complete(){this.forEachObserver((e=>{e.complete()})),this.close()}subscribe(e,t,n){let r;if(void 0===e&&void 0===t&&void 0===n)throw new Error("Missing Observer.");r=function(e,t){if("object"!==typeof e||null===e)return!1;for(const n of t)if(n in e&&"function"===typeof e[n])return!0;return!1}(e,["next","error","complete"])?e:{next:e,error:t,complete:n},void 0===r.next&&(r.next=W),void 0===r.error&&(r.error=W),void 0===r.complete&&(r.complete=W);const i=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then((()=>{try{this.finalError?r.error(this.finalError):r.complete()}catch(e){}})),this.observers.push(r),i}unsubscribeOne(e){void 0!==this.observers&&void 0!==this.observers[e]&&(delete this.observers[e],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let t=0;t<this.observers.length;t++)this.sendOne(t,e)}sendOne(e,t){this.task.then((()=>{if(void 0!==this.observers&&void 0!==this.observers[e])try{t(this.observers[e])}catch(n){"undefined"!==typeof console&&console.error&&console.error(n)}}))}close(e){this.finalized||(this.finalized=!0,void 0!==e&&(this.finalError=e),this.task.then((()=>{this.observers=void 0,this.onNoObservers=void 0})))}}function W(){}function Q(e){return e&&e._delegate?e._delegate:e}class J{constructor(e,t,n){this.name=e,this.instanceFactory=t,this.type=n,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}const Y="[DEFAULT]";class X{constructor(e,t){this.name=e,this.container=t,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const t=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(t)){const e=new C;if(this.instancesDeferred.set(t,e),this.isInitialized(t)||this.shouldAutoInitialize())try{const n=this.getOrInitializeService({instanceIdentifier:t});n&&e.resolve(n)}catch(n){}}return this.instancesDeferred.get(t).promise}getImmediate(e){var t;const n=this.normalizeInstanceIdentifier(null===e||void 0===e?void 0:e.identifier),r=null!==(t=null===e||void 0===e?void 0:e.optional)&&void 0!==t&&t;if(!this.isInitialized(n)&&!this.shouldAutoInitialize()){if(r)return null;throw Error(`Service ${this.name} is not available`)}try{return this.getOrInitializeService({instanceIdentifier:n})}catch(i){if(r)return null;throw i}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,this.shouldAutoInitialize()){if(function(e){return"EAGER"===e.instantiationMode}(e))try{this.getOrInitializeService({instanceIdentifier:Y})}catch(t){}for(const[e,n]of this.instancesDeferred.entries()){const r=this.normalizeInstanceIdentifier(e);try{const e=this.getOrInitializeService({instanceIdentifier:r});n.resolve(e)}catch(t){}}}}clearInstance(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter((e=>"INTERNAL"in e)).map((e=>e.INTERNAL.delete())),...e.filter((e=>"_delete"in e)).map((e=>e._delete()))])}isComponentSet(){return null!=this.component}isInitialized(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return this.instances.has(e)}getOptions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return this.instancesOptions.get(e)||{}}initialize(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{options:t={}}=e,n=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(n))throw Error(`${this.name}(${n}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const r=this.getOrInitializeService({instanceIdentifier:n,options:t});for(const[i,s]of this.instancesDeferred.entries()){n===this.normalizeInstanceIdentifier(i)&&s.resolve(r)}return r}onInit(e,t){var n;const r=this.normalizeInstanceIdentifier(t),i=null!==(n=this.onInitCallbacks.get(r))&&void 0!==n?n:new Set;i.add(e),this.onInitCallbacks.set(r,i);const s=this.instances.get(r);return s&&e(s,r),()=>{i.delete(e)}}invokeOnInitCallbacks(e,t){const n=this.onInitCallbacks.get(t);if(n)for(const i of n)try{i(e,t)}catch(r){}}getOrInitializeService(e){let{instanceIdentifier:t,options:n={}}=e,r=this.instances.get(t);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:(i=t,i===Y?void 0:i),options:n}),this.instances.set(t,r),this.instancesOptions.set(t,n),this.invokeOnInitCallbacks(r,t),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,t,r)}catch(s){}var i;return r||null}normalizeInstanceIdentifier(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Y;return this.component?this.component.multipleInstances?e:Y:e}shouldAutoInitialize(){return!!this.component&&"EXPLICIT"!==this.component.instantiationMode}}class Z{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const t=this.getProvider(e.name);if(t.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);t.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const t=new X(e,this);return this.providers.set(e,t),t}getProviders(){return Array.from(this.providers.values())}}const ee=[];var te;!function(e){e[e.DEBUG=0]="DEBUG",e[e.VERBOSE=1]="VERBOSE",e[e.INFO=2]="INFO",e[e.WARN=3]="WARN",e[e.ERROR=4]="ERROR",e[e.SILENT=5]="SILENT"}(te||(te={}));const ne={debug:te.DEBUG,verbose:te.VERBOSE,info:te.INFO,warn:te.WARN,error:te.ERROR,silent:te.SILENT},re=te.INFO,ie={[te.DEBUG]:"log",[te.VERBOSE]:"log",[te.INFO]:"info",[te.WARN]:"warn",[te.ERROR]:"error"},se=function(e,t){if(t<e.logLevel)return;const n=(new Date).toISOString(),r=ie[t];if(!r)throw new Error(`Attempted to log a message with an invalid logType (value: ${t})`);for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];console[r](`[${n}]  ${e.name}:`,...s)};class oe{constructor(e){this.name=e,this._logLevel=re,this._logHandler=se,this._userLogHandler=null,ee.push(this)}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in te))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel="string"===typeof e?ne[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if("function"!==typeof e)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,te.DEBUG,...t),this._logHandler(this,te.DEBUG,...t)}log(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,te.VERBOSE,...t),this._logHandler(this,te.VERBOSE,...t)}info(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,te.INFO,...t),this._logHandler(this,te.INFO,...t)}warn(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,te.WARN,...t),this._logHandler(this,te.WARN,...t)}error(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._userLogHandler&&this._userLogHandler(this,te.ERROR,...t),this._logHandler(this,te.ERROR,...t)}}let ae,le;const ue=new WeakMap,ce=new WeakMap,he=new WeakMap,de=new WeakMap,fe=new WeakMap;let pe={get(e,t,n){if(e instanceof IDBTransaction){if("done"===t)return ce.get(e);if("objectStoreNames"===t)return e.objectStoreNames||he.get(e);if("store"===t)return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return ve(e[t])},set:(e,t,n)=>(e[t]=n,!0),has:(e,t)=>e instanceof IDBTransaction&&("done"===t||"store"===t)||t in e};function me(e){return e!==IDBDatabase.prototype.transaction||"objectStoreNames"in IDBTransaction.prototype?(le||(le=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])).includes(e)?function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return e.apply(ye(this),n),ve(ue.get(this))}:function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return ve(e.apply(ye(this),n))}:function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];const s=e.call(ye(this),t,...r);return he.set(s,t.sort?t.sort():[t]),ve(s)}}function ge(e){return"function"===typeof e?me(e):(e instanceof IDBTransaction&&function(e){if(ce.has(e))return;const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("complete",i),e.removeEventListener("error",s),e.removeEventListener("abort",s)},i=()=>{t(),r()},s=()=>{n(e.error||new DOMException("AbortError","AbortError")),r()};e.addEventListener("complete",i),e.addEventListener("error",s),e.addEventListener("abort",s)}));ce.set(e,t)}(e),t=e,(ae||(ae=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])).some((e=>t instanceof e))?new Proxy(e,pe):e);var t}function ve(e){if(e instanceof IDBRequest)return function(e){const t=new Promise(((t,n)=>{const r=()=>{e.removeEventListener("success",i),e.removeEventListener("error",s)},i=()=>{t(ve(e.result)),r()},s=()=>{n(e.error),r()};e.addEventListener("success",i),e.addEventListener("error",s)}));return t.then((t=>{t instanceof IDBCursor&&ue.set(t,e)})).catch((()=>{})),fe.set(t,e),t}(e);if(de.has(e))return de.get(e);const t=ge(e);return t!==e&&(de.set(e,t),fe.set(t,e)),t}const ye=e=>fe.get(e);const we=["get","getKey","getAll","getAllKeys","count"],be=["put","add","delete","clear"],_e=new Map;function Ie(e,t){if(!(e instanceof IDBDatabase)||t in e||"string"!==typeof t)return;if(_e.get(t))return _e.get(t);const n=t.replace(/FromIndex$/,""),r=t!==n,i=be.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!i&&!we.includes(n))return;const s=async function(e){const t=this.transaction(e,i?"readwrite":"readonly");let s=t.store;for(var o=arguments.length,a=new Array(o>1?o-1:0),l=1;l<o;l++)a[l-1]=arguments[l];return r&&(s=s.index(a.shift())),(await Promise.all([s[n](...a),i&&t.done]))[0]};return _e.set(t,s),s}pe=(e=>({...e,get:(t,n,r)=>Ie(t,n)||e.get(t,n,r),has:(t,n)=>!!Ie(t,n)||e.has(t,n)}))(pe);class Se{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map((e=>{if(function(e){const t=e.getComponent();return"VERSION"===(null===t||void 0===t?void 0:t.type)}(e)){const t=e.getImmediate();return`${t.library}/${t.version}`}return null})).filter((e=>e)).join(" ")}}const Ee="@firebase/app",Te="0.10.13",ke=new oe("@firebase/app"),Ce="@firebase/app-compat",xe="@firebase/analytics-compat",Ne="@firebase/analytics",Ae="@firebase/app-check-compat",Pe="@firebase/app-check",Re="@firebase/auth",De="@firebase/auth-compat",Oe="@firebase/database",Le="@firebase/data-connect",Me="@firebase/database-compat",Fe="@firebase/functions",Ue="@firebase/functions-compat",je="@firebase/installations",Ve="@firebase/installations-compat",ze="@firebase/messaging",Be="@firebase/messaging-compat",qe="@firebase/performance",$e="@firebase/performance-compat",Ke="@firebase/remote-config",Ge="@firebase/remote-config-compat",He="@firebase/storage",We="@firebase/storage-compat",Qe="@firebase/firestore",Je="@firebase/vertexai-preview",Ye="@firebase/firestore-compat",Xe="firebase",Ze="[DEFAULT]",et={[Ee]:"fire-core",[Ce]:"fire-core-compat",[Ne]:"fire-analytics",[xe]:"fire-analytics-compat",[Pe]:"fire-app-check",[Ae]:"fire-app-check-compat",[Re]:"fire-auth",[De]:"fire-auth-compat",[Oe]:"fire-rtdb",[Le]:"fire-data-connect",[Me]:"fire-rtdb-compat",[Fe]:"fire-fn",[Ue]:"fire-fn-compat",[je]:"fire-iid",[Ve]:"fire-iid-compat",[ze]:"fire-fcm",[Be]:"fire-fcm-compat",[qe]:"fire-perf",[$e]:"fire-perf-compat",[Ke]:"fire-rc",[Ge]:"fire-rc-compat",[He]:"fire-gcs",[We]:"fire-gcs-compat",[Qe]:"fire-fst",[Ye]:"fire-fst-compat",[Je]:"fire-vertex","fire-js":"fire-js",[Xe]:"fire-js-all"},tt=new Map,nt=new Map,rt=new Map;function it(e,t){try{e.container.addComponent(t)}catch(n){ke.debug(`Component ${t.name} failed to register with FirebaseApp ${e.name}`,n)}}function st(e,t){e.container.addOrOverwriteComponent(t)}function ot(e){const t=e.name;if(rt.has(t))return ke.debug(`There were multiple attempts to register component ${t}.`),!1;rt.set(t,e);for(const n of tt.values())it(n,e);for(const n of nt.values())it(n,e);return!0}function at(e,t){const n=e.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),e.container.getProvider(t)}function lt(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ze;at(e,t).clearInstance(n)}function ut(e){return void 0!==e.options}function ct(e){return void 0!==e.settings}function ht(){rt.clear()}const dt=new U("app","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."});class ft{constructor(e,t,n){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},t),this._name=t.name,this._automaticDataCollectionEnabled=t.automaticDataCollectionEnabled,this._container=n,this.container.addComponent(new J("app",(()=>this),"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw dt.create("app-deleted",{appName:this._name})}}class pt extends ft{constructor(e,t,n,r){const i=void 0!==t.automaticDataCollectionEnabled&&t.automaticDataCollectionEnabled,s={name:n,automaticDataCollectionEnabled:i};if(void 0!==e.apiKey)super(e,s,r);else{super(e.options,s,r)}this._serverConfig=Object.assign({automaticDataCollectionEnabled:i},t),this._finalizationRegistry=null,"undefined"!==typeof FinalizationRegistry&&(this._finalizationRegistry=new FinalizationRegistry((()=>{this.automaticCleanup()}))),this._refCount=0,this.incRefCount(this._serverConfig.releaseOnDeref),this._serverConfig.releaseOnDeref=void 0,t.releaseOnDeref=void 0,_t(Ee,Te,"serverapp")}toJSON(){}get refCount(){return this._refCount}incRefCount(e){this.isDeleted||(this._refCount++,void 0!==e&&null!==this._finalizationRegistry&&this._finalizationRegistry.register(e,this))}decRefCount(){return this.isDeleted?0:--this._refCount}automaticCleanup(){bt(this)}get settings(){return this.checkDestroyed(),this._serverConfig}checkDestroyed(){if(this.isDeleted)throw dt.create("server-app-deleted")}}const mt="10.14.1";function gt(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=e;if("object"!==typeof t){t={name:t}}const r=Object.assign({name:Ze,automaticDataCollectionEnabled:!1},t),i=r.name;if("string"!==typeof i||!i)throw dt.create("bad-app-name",{appName:String(i)});if(n||(n=k()),!n)throw dt.create("no-options");const s=tt.get(i);if(s){if(z(n,s.options)&&z(r,s.config))return s;throw dt.create("duplicate-app",{appName:i})}const o=new Z(i);for(const l of rt.values())o.addComponent(l);const a=new ft(n,r,o);return tt.set(i,a),a}function vt(e,t){if(("undefined"!==typeof window||P())&&!P())throw dt.create("invalid-server-app-environment");let n;void 0===t.automaticDataCollectionEnabled&&(t.automaticDataCollectionEnabled=!1),n=ut(e)?e.options:e;const r=Object.assign(Object.assign({},t),n);void 0!==r.releaseOnDeref&&delete r.releaseOnDeref;if(void 0!==t.releaseOnDeref&&"undefined"===typeof FinalizationRegistry)throw dt.create("finalization-registry-not-supported",{});const i=""+(s=JSON.stringify(r),[...s].reduce(((e,t)=>Math.imul(31,e)+t.charCodeAt(0)|0),0));var s;const o=nt.get(i);if(o)return o.incRefCount(t.releaseOnDeref),o;const a=new Z(i);for(const u of rt.values())a.addComponent(u);const l=new pt(n,t,i,a);return nt.set(i,l),l}function yt(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Ze;const t=tt.get(e);if(!t&&e===Ze&&k())return gt();if(!t)throw dt.create("no-app",{appName:e});return t}function wt(){return Array.from(tt.values())}async function bt(e){let t=!1;const n=e.name;if(tt.has(n))t=!0,tt.delete(n);else if(nt.has(n)){e.decRefCount()<=0&&(nt.delete(n),t=!0)}t&&(await Promise.all(e.container.getProviders().map((e=>e.delete()))),e.isDeleted=!0)}function _t(e,t,n){var r;let i=null!==(r=et[e])&&void 0!==r?r:e;n&&(i+=`-${n}`);const s=i.match(/\s|\//),o=t.match(/\s|\//);if(s||o){const e=[`Unable to register library "${i}" with version "${t}":`];return s&&e.push(`library name "${i}" contains illegal characters (whitespace or "/")`),s&&o&&e.push("and"),o&&e.push(`version name "${t}" contains illegal characters (whitespace or "/")`),void ke.warn(e.join(" "))}ot(new J(`${i}-version`,(()=>({library:i,version:t})),"VERSION"))}function It(e,t){if(null!==e&&"function"!==typeof e)throw dt.create("invalid-log-argument");!function(e,t){for(const n of ee){let r=null;t&&t.level&&(r=ne[t.level]),n.userLogHandler=null===e?null:function(t,n){for(var i=arguments.length,s=new Array(i>2?i-2:0),o=2;o<i;o++)s[o-2]=arguments[o];const a=s.map((e=>{if(null==e)return null;if("string"===typeof e)return e;if("number"===typeof e||"boolean"===typeof e)return e.toString();if(e instanceof Error)return e.message;try{return JSON.stringify(e)}catch(t){return null}})).filter((e=>e)).join(" ");n>=(null!==r&&void 0!==r?r:t.logLevel)&&e({level:te[n].toLowerCase(),message:a,args:s,type:t.name})}}}(e,t)}function St(e){var t;t=e,ee.forEach((e=>{e.setLogLevel(t)}))}const Et="firebase-heartbeat-store";let Tt=null;function kt(){return Tt||(Tt=function(e,t){let{blocked:n,upgrade:r,blocking:i,terminated:s}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const o=indexedDB.open(e,t),a=ve(o);return r&&o.addEventListener("upgradeneeded",(e=>{r(ve(o.result),e.oldVersion,e.newVersion,ve(o.transaction),e)})),n&&o.addEventListener("blocked",(e=>n(e.oldVersion,e.newVersion,e))),a.then((e=>{s&&e.addEventListener("close",(()=>s())),i&&e.addEventListener("versionchange",(e=>i(e.oldVersion,e.newVersion,e)))})).catch((()=>{})),a}("firebase-heartbeat-database",1,{upgrade:(e,t)=>{if(0===t)try{e.createObjectStore(Et)}catch(n){console.warn(n)}}}).catch((e=>{throw dt.create("idb-open",{originalErrorMessage:e.message})}))),Tt}async function Ct(e,t){try{const n=(await kt()).transaction(Et,"readwrite"),r=n.objectStore(Et);await r.put(t,xt(e)),await n.done}catch(n){if(n instanceof F)ke.warn(n.message);else{const e=dt.create("idb-set",{originalErrorMessage:null===n||void 0===n?void 0:n.message});ke.warn(e.message)}}}function xt(e){return`${e.name}!${e.options.appId}`}class Nt{constructor(e){this.container=e,this._heartbeatsCache=null;const t=this.container.getProvider("app").getImmediate();this._storage=new Pt(t),this._heartbeatsCachePromise=this._storage.read().then((e=>(this._heartbeatsCache=e,e)))}async triggerHeartbeat(){var e,t;try{const n=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),r=At();if(null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)&&(this._heartbeatsCache=await this._heartbeatsCachePromise,null==(null===(t=this._heartbeatsCache)||void 0===t?void 0:t.heartbeats)))return;if(this._heartbeatsCache.lastSentHeartbeatDate===r||this._heartbeatsCache.heartbeats.some((e=>e.date===r)))return;return this._heartbeatsCache.heartbeats.push({date:r,agent:n}),this._heartbeatsCache.heartbeats=this._heartbeatsCache.heartbeats.filter((e=>{const t=new Date(e.date).valueOf();return Date.now()-t<=2592e6})),this._storage.overwrite(this._heartbeatsCache)}catch(n){ke.warn(n)}}async getHeartbeatsHeader(){var e;try{if(null===this._heartbeatsCache&&await this._heartbeatsCachePromise,null==(null===(e=this._heartbeatsCache)||void 0===e?void 0:e.heartbeats)||0===this._heartbeatsCache.heartbeats.length)return"";const t=At(),{heartbeatsToSend:n,unsentEntries:r}=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1024;const n=[];let r=e.slice();for(const i of e){const e=n.find((e=>e.agent===i.agent));if(e){if(e.dates.push(i.date),Rt(n)>t){e.dates.pop();break}}else if(n.push({agent:i.agent,dates:[i.date]}),Rt(n)>t){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}(this._heartbeatsCache.heartbeats),i=b(JSON.stringify({version:2,heartbeats:n}));return this._heartbeatsCache.lastSentHeartbeatDate=t,r.length>0?(this._heartbeatsCache.heartbeats=r,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),i}catch(t){return ke.warn(t),""}}}function At(){return(new Date).toISOString().substring(0,10)}class Pt{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return!!M()&&new Promise(((e,t)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",i=self.indexedDB.open(r);i.onsuccess=()=>{i.result.close(),n||self.indexedDB.deleteDatabase(r),e(!0)},i.onupgradeneeded=()=>{n=!1},i.onerror=()=>{var e;t((null===(e=i.error)||void 0===e?void 0:e.message)||"")}}catch(n){t(n)}})).then((()=>!0)).catch((()=>!1))}async read(){if(await this._canUseIndexedDBPromise){const e=await async function(e){try{const t=(await kt()).transaction(Et),n=await t.objectStore(Et).get(xt(e));return await t.done,n}catch(t){if(t instanceof F)ke.warn(t.message);else{const e=dt.create("idb-get",{originalErrorMessage:null===t||void 0===t?void 0:t.message});ke.warn(e.message)}}}(this.app);return(null===e||void 0===e?void 0:e.heartbeats)?e:{heartbeats:[]}}return{heartbeats:[]}}async overwrite(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ct(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:e.heartbeats})}}async add(e){var t;if(await this._canUseIndexedDBPromise){const n=await this.read();return Ct(this.app,{lastSentHeartbeatDate:null!==(t=e.lastSentHeartbeatDate)&&void 0!==t?t:n.lastSentHeartbeatDate,heartbeats:[...n.heartbeats,...e.heartbeats]})}}}function Rt(e){return b(JSON.stringify({version:2,heartbeats:e})).length}var Dt;Dt="",ot(new J("platform-logger",(e=>new Se(e)),"PRIVATE")),ot(new J("heartbeat",(e=>new Nt(e)),"PRIVATE")),_t(Ee,Te,Dt),_t(Ee,Te,"esm2017"),_t("fire-js","");var Ot,Lt,Mt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ft={};(function(){var e;function t(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}function n(e,t,n){n||(n=0);var r=Array(16);if("string"===typeof t)for(var i=0;16>i;++i)r[i]=t.charCodeAt(n++)|t.charCodeAt(n++)<<8|t.charCodeAt(n++)<<16|t.charCodeAt(n++)<<24;else for(i=0;16>i;++i)r[i]=t[n++]|t[n++]<<8|t[n++]<<16|t[n++]<<24;t=e.g[0],n=e.g[1],i=e.g[2];var s=e.g[3],o=t+(s^n&(i^s))+r[0]+3614090360&4294967295;o=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=(n=(i=(s=(t=n+(o<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[1]+3905402710&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[2]+606105819&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[3]+3250441966&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[4]+4118548399&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[5]+1200080426&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[6]+2821735955&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[7]+4249261313&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[8]+1770035416&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[9]+2336552879&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[10]+4294925233&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[11]+2304563134&4294967295)<<22&4294967295|o>>>10))+((o=t+(s^n&(i^s))+r[12]+1804603682&4294967295)<<7&4294967295|o>>>25))+((o=s+(i^t&(n^i))+r[13]+4254626195&4294967295)<<12&4294967295|o>>>20))+((o=i+(n^s&(t^n))+r[14]+2792965006&4294967295)<<17&4294967295|o>>>15))+((o=n+(t^i&(s^t))+r[15]+1236535329&4294967295)<<22&4294967295|o>>>10))+((o=t+(i^s&(n^i))+r[1]+4129170786&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[6]+3225465664&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[11]+643717713&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[0]+3921069994&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[5]+3593408605&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[10]+38016083&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[15]+3634488961&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[4]+3889429448&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[9]+568446438&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[14]+3275163606&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[3]+4107603335&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[8]+1163531501&4294967295)<<20&4294967295|o>>>12))+((o=t+(i^s&(n^i))+r[13]+2850285829&4294967295)<<5&4294967295|o>>>27))+((o=s+(n^i&(t^n))+r[2]+4243563512&4294967295)<<9&4294967295|o>>>23))+((o=i+(t^n&(s^t))+r[7]+1735328473&4294967295)<<14&4294967295|o>>>18))+((o=n+(s^t&(i^s))+r[12]+2368359562&4294967295)<<20&4294967295|o>>>12))+((o=t+(n^i^s)+r[5]+4294588738&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[8]+2272392833&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[11]+1839030562&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[14]+4259657740&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[1]+2763975236&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[4]+1272893353&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[7]+4139469664&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[10]+3200236656&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[13]+681279174&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[0]+3936430074&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[3]+3572445317&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[6]+76029189&4294967295)<<23&4294967295|o>>>9))+((o=t+(n^i^s)+r[9]+3654602809&4294967295)<<4&4294967295|o>>>28))+((o=s+(t^n^i)+r[12]+3873151461&4294967295)<<11&4294967295|o>>>21))+((o=i+(s^t^n)+r[15]+530742520&4294967295)<<16&4294967295|o>>>16))+((o=n+(i^s^t)+r[2]+3299628645&4294967295)<<23&4294967295|o>>>9))+((o=t+(i^(n|~s))+r[0]+4096336452&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[7]+1126891415&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[14]+2878612391&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[5]+4237533241&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[12]+1700485571&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[3]+2399980690&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[10]+4293915773&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[1]+2240044497&4294967295)<<21&4294967295|o>>>11))+((o=t+(i^(n|~s))+r[8]+1873313359&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[15]+4264355552&4294967295)<<10&4294967295|o>>>22))+((o=i+(t^(s|~n))+r[6]+2734768916&4294967295)<<15&4294967295|o>>>17))+((o=n+(s^(i|~t))+r[13]+1309151649&4294967295)<<21&4294967295|o>>>11))+((s=(t=n+((o=t+(i^(n|~s))+r[4]+4149444226&4294967295)<<6&4294967295|o>>>26))+((o=s+(n^(t|~i))+r[11]+3174756917&4294967295)<<10&4294967295|o>>>22))^((i=s+((o=i+(t^(s|~n))+r[2]+718787259&4294967295)<<15&4294967295|o>>>17))|~t))+r[9]+3951481745&4294967295,e.g[0]=e.g[0]+t&4294967295,e.g[1]=e.g[1]+(i+(o<<21&4294967295|o>>>11))&4294967295,e.g[2]=e.g[2]+i&4294967295,e.g[3]=e.g[3]+s&4294967295}function r(e,t){this.h=t;for(var n=[],r=!0,i=e.length-1;0<=i;i--){var s=0|e[i];r&&s==t||(n[i]=s,r=!1)}this.g=n}!function(e,t){function n(){}n.prototype=t.prototype,e.D=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.C=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}(t,(function(){this.blockSize=-1})),t.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0},t.prototype.u=function(e,t){void 0===t&&(t=e.length);for(var r=t-this.blockSize,i=this.B,s=this.h,o=0;o<t;){if(0==s)for(;o<=r;)n(this,e,o),o+=this.blockSize;if("string"===typeof e){for(;o<t;)if(i[s++]=e.charCodeAt(o++),s==this.blockSize){n(this,i),s=0;break}}else for(;o<t;)if(i[s++]=e[o++],s==this.blockSize){n(this,i),s=0;break}}this.h=s,this.o+=t},t.prototype.v=function(){var e=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);e[0]=128;for(var t=1;t<e.length-8;++t)e[t]=0;var n=8*this.o;for(t=e.length-8;t<e.length;++t)e[t]=255&n,n/=256;for(this.u(e),e=Array(16),t=n=0;4>t;++t)for(var r=0;32>r;r+=8)e[n++]=this.g[t]>>>r&255;return e};var i={};function s(e){return-128<=e&&128>e?function(e,t){var n=i;return Object.prototype.hasOwnProperty.call(n,e)?n[e]:n[e]=t(e)}(e,(function(e){return new r([0|e],0>e?-1:0)})):new r([0|e],0>e?-1:0)}function o(e){if(isNaN(e)||!isFinite(e))return a;if(0>e)return d(o(-e));for(var t=[],n=1,i=0;e>=n;i++)t[i]=e/n|0,n*=4294967296;return new r(t,0)}var a=s(0),l=s(1),u=s(16777216);function c(e){if(0!=e.h)return!1;for(var t=0;t<e.g.length;t++)if(0!=e.g[t])return!1;return!0}function h(e){return-1==e.h}function d(e){for(var t=e.g.length,n=[],i=0;i<t;i++)n[i]=~e.g[i];return new r(n,~e.h).add(l)}function f(e,t){return e.add(d(t))}function p(e,t){for(;(65535&e[t])!=e[t];)e[t+1]+=e[t]>>>16,e[t]&=65535,t++}function m(e,t){this.g=e,this.h=t}function g(e,t){if(c(t))throw Error("division by zero");if(c(e))return new m(a,a);if(h(e))return t=g(d(e),t),new m(d(t.g),d(t.h));if(h(t))return t=g(e,d(t)),new m(d(t.g),t.h);if(30<e.g.length){if(h(e)||h(t))throw Error("slowDivide_ only works with positive integers.");for(var n=l,r=t;0>=r.l(e);)n=v(n),r=v(r);var i=y(n,1),s=y(r,1);for(r=y(r,2),n=y(n,2);!c(r);){var u=s.add(r);0>=u.l(e)&&(i=i.add(n),s=u),r=y(r,1),n=y(n,1)}return t=f(e,i.j(t)),new m(i,t)}for(i=a;0<=e.l(t);){for(n=Math.max(1,Math.floor(e.m()/t.m())),r=48>=(r=Math.ceil(Math.log(n)/Math.LN2))?1:Math.pow(2,r-48),u=(s=o(n)).j(t);h(u)||0<u.l(e);)u=(s=o(n-=r)).j(t);c(s)&&(s=l),i=i.add(s),e=f(e,u)}return new m(i,e)}function v(e){for(var t=e.g.length+1,n=[],i=0;i<t;i++)n[i]=e.i(i)<<1|e.i(i-1)>>>31;return new r(n,e.h)}function y(e,t){var n=t>>5;t%=32;for(var i=e.g.length-n,s=[],o=0;o<i;o++)s[o]=0<t?e.i(o+n)>>>t|e.i(o+n+1)<<32-t:e.i(o+n);return new r(s,e.h)}(e=r.prototype).m=function(){if(h(this))return-d(this).m();for(var e=0,t=1,n=0;n<this.g.length;n++){var r=this.i(n);e+=(0<=r?r:4294967296+r)*t,t*=4294967296}return e},e.toString=function(e){if(2>(e=e||10)||36<e)throw Error("radix out of range: "+e);if(c(this))return"0";if(h(this))return"-"+d(this).toString(e);for(var t=o(Math.pow(e,6)),n=this,r="";;){var i=g(n,t).g,s=((0<(n=f(n,i.j(t))).g.length?n.g[0]:n.h)>>>0).toString(e);if(c(n=i))return s+r;for(;6>s.length;)s="0"+s;r=s+r}},e.i=function(e){return 0>e?0:e<this.g.length?this.g[e]:this.h},e.l=function(e){return h(e=f(this,e))?-1:c(e)?0:1},e.abs=function(){return h(this)?d(this):this},e.add=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0,s=0;s<=t;s++){var o=i+(65535&this.i(s))+(65535&e.i(s)),a=(o>>>16)+(this.i(s)>>>16)+(e.i(s)>>>16);i=a>>>16,o&=65535,a&=65535,n[s]=a<<16|o}return new r(n,-2147483648&n[n.length-1]?-1:0)},e.j=function(e){if(c(this)||c(e))return a;if(h(this))return h(e)?d(this).j(d(e)):d(d(this).j(e));if(h(e))return d(this.j(d(e)));if(0>this.l(u)&&0>e.l(u))return o(this.m()*e.m());for(var t=this.g.length+e.g.length,n=[],i=0;i<2*t;i++)n[i]=0;for(i=0;i<this.g.length;i++)for(var s=0;s<e.g.length;s++){var l=this.i(i)>>>16,f=65535&this.i(i),m=e.i(s)>>>16,g=65535&e.i(s);n[2*i+2*s]+=f*g,p(n,2*i+2*s),n[2*i+2*s+1]+=l*g,p(n,2*i+2*s+1),n[2*i+2*s+1]+=f*m,p(n,2*i+2*s+1),n[2*i+2*s+2]+=l*m,p(n,2*i+2*s+2)}for(i=0;i<t;i++)n[i]=n[2*i+1]<<16|n[2*i];for(i=t;i<2*t;i++)n[i]=0;return new r(n,0)},e.A=function(e){return g(this,e).h},e.and=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)&e.i(i);return new r(n,this.h&e.h)},e.or=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)|e.i(i);return new r(n,this.h|e.h)},e.xor=function(e){for(var t=Math.max(this.g.length,e.g.length),n=[],i=0;i<t;i++)n[i]=this.i(i)^e.i(i);return new r(n,this.h^e.h)},t.prototype.digest=t.prototype.v,t.prototype.reset=t.prototype.s,t.prototype.update=t.prototype.u,Lt=Ft.Md5=t,r.prototype.add=r.prototype.add,r.prototype.multiply=r.prototype.j,r.prototype.modulo=r.prototype.A,r.prototype.compare=r.prototype.l,r.prototype.toNumber=r.prototype.m,r.prototype.toString=r.prototype.toString,r.prototype.getBits=r.prototype.i,r.fromNumber=o,r.fromString=function e(t,n){if(0==t.length)throw Error("number format error: empty string");if(2>(n=n||10)||36<n)throw Error("radix out of range: "+n);if("-"==t.charAt(0))return d(e(t.substring(1),n));if(0<=t.indexOf("-"))throw Error('number format error: interior "-" character');for(var r=o(Math.pow(n,8)),i=a,s=0;s<t.length;s+=8){var l=Math.min(8,t.length-s),u=parseInt(t.substring(s,s+l),n);8>l?(l=o(Math.pow(n,l)),i=i.j(l).add(o(u))):i=(i=i.j(r)).add(o(u))}return i},Ot=Ft.Integer=r}).apply("undefined"!==typeof Mt?Mt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});var Ut,jt,Vt,zt,Bt,qt,$t,Kt,Gt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof window?window:"undefined"!==typeof global?global:"undefined"!==typeof self?self:{},Ht={};(function(){var e,t="function"==typeof Object.defineProperties?Object.defineProperty:function(e,t,n){return e==Array.prototype||e==Object.prototype||(e[t]=n.value),e};var n=function(e){e=["object"==typeof globalThis&&globalThis,e,"object"==typeof window&&window,"object"==typeof self&&self,"object"==typeof Gt&&Gt];for(var t=0;t<e.length;++t){var n=e[t];if(n&&n.Math==Math)return n}throw Error("Cannot find global object")}(this);!function(e,r){if(r)e:{var i=n;e=e.split(".");for(var s=0;s<e.length-1;s++){var o=e[s];if(!(o in i))break e;i=i[o]}(r=r(s=i[e=e[e.length-1]]))!=s&&null!=r&&t(i,e,{configurable:!0,writable:!0,value:r})}}("Array.prototype.values",(function(e){return e||function(){return function(e,t){e instanceof String&&(e+="");var n=0,r=!1,i={next:function(){if(!r&&n<e.length){var i=n++;return{value:t(i,e[i]),done:!1}}return r=!0,{done:!0,value:void 0}}};return i[Symbol.iterator]=function(){return i},i}(this,(function(e,t){return t}))}}));var r=r||{},i=this||self;function s(e){var t=typeof e;return"array"==(t="object"!=t?t:e?Array.isArray(e)?"array":t:"null")||"object"==t&&"number"==typeof e.length}function o(e){var t=typeof e;return"object"==t&&null!=e||"function"==t}function a(e,t,n){return e.call.apply(e.bind,arguments)}function l(e,t,n){if(!e)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),e.apply(t,n)}}return function(){return e.apply(t,arguments)}}function u(e,t,n){return(u=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:l).apply(null,arguments)}function c(e,t){var n=Array.prototype.slice.call(arguments,1);return function(){var t=n.slice();return t.push.apply(t,arguments),e.apply(this,t)}}function h(e,t){function n(){}n.prototype=t.prototype,e.aa=t.prototype,e.prototype=new n,e.prototype.constructor=e,e.Qb=function(e,n,r){for(var i=Array(arguments.length-2),s=2;s<arguments.length;s++)i[s-2]=arguments[s];return t.prototype[n].apply(e,i)}}function d(e){const t=e.length;if(0<t){const n=Array(t);for(let r=0;r<t;r++)n[r]=e[r];return n}return[]}function f(e,t){for(let n=1;n<arguments.length;n++){const t=arguments[n];if(s(t)){const n=e.length||0,r=t.length||0;e.length=n+r;for(let i=0;i<r;i++)e[n+i]=t[i]}else e.push(t)}}function p(e){return/^[\s\xa0]*$/.test(e)}function m(){var e=i.navigator;return e&&(e=e.userAgent)?e:""}function g(e){return g[" "](e),e}g[" "]=function(){};var v=-1!=m().indexOf("Gecko")&&!(-1!=m().toLowerCase().indexOf("webkit")&&-1==m().indexOf("Edge"))&&!(-1!=m().indexOf("Trident")||-1!=m().indexOf("MSIE"))&&-1==m().indexOf("Edge");function y(e,t,n){for(const r in e)t.call(n,e[r],r,e)}function w(e){const t={};for(const n in e)t[n]=e[n];return t}const b="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function _(e,t){let n,r;for(let i=1;i<arguments.length;i++){for(n in r=arguments[i],r)e[n]=r[n];for(let t=0;t<b.length;t++)n=b[t],Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}}function I(e){var t=1;e=e.split(":");const n=[];for(;0<t&&e.length;)n.push(e.shift()),t--;return e.length&&n.push(e.join(":")),n}function S(e){i.setTimeout((()=>{throw e}),0)}function E(){var e=N;let t=null;return e.g&&(t=e.g,e.g=e.g.next,e.g||(e.h=null),t.next=null),t}var T=new class{constructor(e,t){this.i=e,this.j=t,this.h=0,this.g=null}get(){let e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e}}((()=>new k),(e=>e.reset()));class k{constructor(){this.next=this.g=this.h=null}set(e,t){this.h=e,this.g=t,this.next=null}reset(){this.next=this.g=this.h=null}}let C,x=!1,N=new class{constructor(){this.h=this.g=null}add(e,t){const n=T.get();n.set(e,t),this.h?this.h.next=n:this.g=n,this.h=n}},A=()=>{const e=i.Promise.resolve(void 0);C=()=>{e.then(P)}};var P=()=>{for(var e;e=E();){try{e.h.call(e.g)}catch(n){S(n)}var t=T;t.j(e),100>t.h&&(t.h++,e.next=t.g,t.g=e)}x=!1};function R(){this.s=this.s,this.C=this.C}function D(e,t){this.type=e,this.g=this.target=t,this.defaultPrevented=!1}R.prototype.s=!1,R.prototype.ma=function(){this.s||(this.s=!0,this.N())},R.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()},D.prototype.h=function(){this.defaultPrevented=!0};var O=function(){if(!i.addEventListener||!Object.defineProperty)return!1;var e=!1,t=Object.defineProperty({},"passive",{get:function(){e=!0}});try{const e=()=>{};i.addEventListener("test",e,t),i.removeEventListener("test",e,t)}catch(n){}return e}();function L(e,t){if(D.call(this,e?e.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,e){var n=this.type=e.type,r=e.changedTouches&&e.changedTouches.length?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.g=t,t=e.relatedTarget){if(v){e:{try{g(t.nodeName);var i=!0;break e}catch(s){}i=!1}i||(t=null)}}else"mouseover"==n?t=e.fromElement:"mouseout"==n&&(t=e.toElement);this.relatedTarget=t,r?(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType="string"===typeof e.pointerType?e.pointerType:M[e.pointerType]||"",this.state=e.state,this.i=e,e.defaultPrevented&&L.aa.h.call(this)}}h(L,D);var M={2:"touch",3:"pen",4:"mouse"};L.prototype.h=function(){L.aa.h.call(this);var e=this.i;e.preventDefault?e.preventDefault():e.returnValue=!1};var F="closure_listenable_"+(1e6*Math.random()|0),U=0;function j(e,t,n,r,i){this.listener=e,this.proxy=null,this.src=t,this.type=n,this.capture=!!r,this.ha=i,this.key=++U,this.da=this.fa=!1}function V(e){e.da=!0,e.listener=null,e.proxy=null,e.src=null,e.ha=null}function z(e){this.src=e,this.g={},this.h=0}function B(e,t){var n=t.type;if(n in e.g){var r,i=e.g[n],s=Array.prototype.indexOf.call(i,t,void 0);(r=0<=s)&&Array.prototype.splice.call(i,s,1),r&&(V(t),0==e.g[n].length&&(delete e.g[n],e.h--))}}function q(e,t,n,r){for(var i=0;i<e.length;++i){var s=e[i];if(!s.da&&s.listener==t&&s.capture==!!n&&s.ha==r)return i}return-1}z.prototype.add=function(e,t,n,r,i){var s=e.toString();(e=this.g[s])||(e=this.g[s]=[],this.h++);var o=q(e,t,r,i);return-1<o?(t=e[o],n||(t.fa=!1)):((t=new j(t,this.src,s,!!r,i)).fa=n,e.push(t)),t};var $="closure_lm_"+(1e6*Math.random()|0),K={};function G(e,t,n,r,i){if(r&&r.once)return W(e,t,n,r,i);if(Array.isArray(t)){for(var s=0;s<t.length;s++)G(e,t[s],n,r,i);return null}return n=te(n),e&&e[F]?e.K(t,n,o(r)?!!r.capture:!!r,i):H(e,t,n,!1,r,i)}function H(e,t,n,r,i,s){if(!t)throw Error("Invalid event type");var a=o(i)?!!i.capture:!!i,l=Z(e);if(l||(e[$]=l=new z(e)),(n=l.add(t,n,r,a,s)).proxy)return n;if(r=function(){function e(n){return t.call(e.src,e.listener,n)}const t=X;return e}(),n.proxy=r,r.src=e,r.listener=n,e.addEventListener)O||(i=a),void 0===i&&(i=!1),e.addEventListener(t.toString(),r,i);else if(e.attachEvent)e.attachEvent(Y(t.toString()),r);else{if(!e.addListener||!e.removeListener)throw Error("addEventListener and attachEvent are unavailable.");e.addListener(r)}return n}function W(e,t,n,r,i){if(Array.isArray(t)){for(var s=0;s<t.length;s++)W(e,t[s],n,r,i);return null}return n=te(n),e&&e[F]?e.L(t,n,o(r)?!!r.capture:!!r,i):H(e,t,n,!0,r,i)}function Q(e,t,n,r,i){if(Array.isArray(t))for(var s=0;s<t.length;s++)Q(e,t[s],n,r,i);else r=o(r)?!!r.capture:!!r,n=te(n),e&&e[F]?(e=e.i,(t=String(t).toString())in e.g&&(-1<(n=q(s=e.g[t],n,r,i))&&(V(s[n]),Array.prototype.splice.call(s,n,1),0==s.length&&(delete e.g[t],e.h--)))):e&&(e=Z(e))&&(t=e.g[t.toString()],e=-1,t&&(e=q(t,n,r,i)),(n=-1<e?t[e]:null)&&J(n))}function J(e){if("number"!==typeof e&&e&&!e.da){var t=e.src;if(t&&t[F])B(t.i,e);else{var n=e.type,r=e.proxy;t.removeEventListener?t.removeEventListener(n,r,e.capture):t.detachEvent?t.detachEvent(Y(n),r):t.addListener&&t.removeListener&&t.removeListener(r),(n=Z(t))?(B(n,e),0==n.h&&(n.src=null,t[$]=null)):V(e)}}}function Y(e){return e in K?K[e]:K[e]="on"+e}function X(e,t){if(e.da)e=!0;else{t=new L(t,this);var n=e.listener,r=e.ha||e.src;e.fa&&J(e),e=n.call(r,t)}return e}function Z(e){return(e=e[$])instanceof z?e:null}var ee="__closure_events_fn_"+(1e9*Math.random()>>>0);function te(e){return"function"===typeof e?e:(e[ee]||(e[ee]=function(t){return e.handleEvent(t)}),e[ee])}function ne(){R.call(this),this.i=new z(this),this.M=this,this.F=null}function re(e,t){var n,r=e.F;if(r)for(n=[];r;r=r.F)n.push(r);if(e=e.M,r=t.type||t,"string"===typeof t)t=new D(t,e);else if(t instanceof D)t.target=t.target||e;else{var i=t;_(t=new D(r,e),i)}if(i=!0,n)for(var s=n.length-1;0<=s;s--){var o=t.g=n[s];i=ie(o,r,!0,t)&&i}if(i=ie(o=t.g=e,r,!0,t)&&i,i=ie(o,r,!1,t)&&i,n)for(s=0;s<n.length;s++)i=ie(o=t.g=n[s],r,!1,t)&&i}function ie(e,t,n,r){if(!(t=e.i.g[String(t)]))return!0;t=t.concat();for(var i=!0,s=0;s<t.length;++s){var o=t[s];if(o&&!o.da&&o.capture==n){var a=o.listener,l=o.ha||o.src;o.fa&&B(e.i,o),i=!1!==a.call(l,r)&&i}}return i&&!r.defaultPrevented}function se(e,t,n){if("function"===typeof e)n&&(e=u(e,n));else{if(!e||"function"!=typeof e.handleEvent)throw Error("Invalid listener argument");e=u(e.handleEvent,e)}return 2147483647<Number(t)?-1:i.setTimeout(e,t||0)}function oe(e){e.g=se((()=>{e.g=null,e.i&&(e.i=!1,oe(e))}),e.l);const t=e.h;e.h=null,e.m.apply(null,t)}h(ne,R),ne.prototype[F]=!0,ne.prototype.removeEventListener=function(e,t,n,r){Q(this,e,t,n,r)},ne.prototype.N=function(){if(ne.aa.N.call(this),this.i){var e,t=this.i;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)V(n[r]);delete t.g[e],t.h--}}this.F=null},ne.prototype.K=function(e,t,n,r){return this.i.add(String(e),t,!1,n,r)},ne.prototype.L=function(e,t,n,r){return this.i.add(String(e),t,!0,n,r)};class ae extends R{constructor(e,t){super(),this.m=e,this.l=t,this.h=null,this.i=!1,this.g=null}j(e){this.h=arguments,this.g?this.i=!0:oe(this)}N(){super.N(),this.g&&(i.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function le(e){R.call(this),this.h=e,this.g={}}h(le,R);var ue=[];function ce(e){y(e.g,(function(e,t){this.g.hasOwnProperty(t)&&J(e)}),e),e.g={}}le.prototype.N=function(){le.aa.N.call(this),ce(this)},le.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var he=i.JSON.stringify,de=i.JSON.parse,fe=class{stringify(e){return i.JSON.stringify(e,void 0)}parse(e){return i.JSON.parse(e,void 0)}};function pe(){}function me(e){return e.h||(e.h=e.i())}function ge(){}pe.prototype.h=null;var ve={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function ye(){D.call(this,"d")}function we(){D.call(this,"c")}h(ye,D),h(we,D);var be={},_e=null;function Ie(){return _e=_e||new ne}function Se(e){D.call(this,be.La,e)}function Ee(e){const t=Ie();re(t,new Se(t))}function Te(e,t){D.call(this,be.STAT_EVENT,e),this.stat=t}function ke(e){const t=Ie();re(t,new Te(t,e))}function Ce(e,t){D.call(this,be.Ma,e),this.size=t}function xe(e,t){if("function"!==typeof e)throw Error("Fn must not be null and must be a function");return i.setTimeout((function(){e()}),t)}function Ne(){this.g=!0}function Ae(e,t,n,r){e.info((function(){return"XMLHTTP TEXT ("+t+"): "+function(e,t){if(!e.g)return t;if(!t)return null;try{var n=JSON.parse(t);if(n)for(e=0;e<n.length;e++)if(Array.isArray(n[e])){var r=n[e];if(!(2>r.length)){var i=r[1];if(Array.isArray(i)&&!(1>i.length)){var s=i[0];if("noop"!=s&&"stop"!=s&&"close"!=s)for(var o=1;o<i.length;o++)i[o]=""}}}return he(n)}catch(a){return t}}(e,n)+(r?" "+r:"")}))}be.La="serverreachability",h(Se,D),be.STAT_EVENT="statevent",h(Te,D),be.Ma="timingevent",h(Ce,D),Ne.prototype.xa=function(){this.g=!1},Ne.prototype.info=function(){};var Pe,Re={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},De={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"};function Oe(){}function Le(e,t,n,r){this.j=e,this.i=t,this.l=n,this.R=r||1,this.U=new le(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Me}function Me(){this.i=null,this.g="",this.h=!1}h(Oe,pe),Oe.prototype.g=function(){return new XMLHttpRequest},Oe.prototype.i=function(){return{}},Pe=new Oe;var Fe={},Ue={};function je(e,t,n){e.L=1,e.v=ht(ot(t)),e.m=n,e.P=!0,Ve(e,null)}function Ve(e,t){e.F=Date.now(),qe(e),e.A=ot(e.v);var n=e.A,r=e.R;Array.isArray(r)||(r=[String(r)]),Tt(n.i,"t",r),e.C=0,n=e.j.J,e.h=new Me,e.g=Tn(e.j,n?t:null,!e.m),0<e.O&&(e.M=new ae(u(e.Y,e,e.g),e.O)),t=e.U,n=e.g,r=e.ca;var i="readystatechange";Array.isArray(i)||(i&&(ue[0]=i.toString()),i=ue);for(var s=0;s<i.length;s++){var o=G(n,i[s],r||t.handleEvent,!1,t.h||t);if(!o)break;t.g[o.key]=o}t=e.H?w(e.H):{},e.m?(e.u||(e.u="POST"),t["Content-Type"]="application/x-www-form-urlencoded",e.g.ea(e.A,e.u,e.m,t)):(e.u="GET",e.g.ea(e.A,e.u,null,t)),Ee(),function(e,t,n,r,i,s){e.info((function(){if(e.g)if(s)for(var o="",a=s.split("&"),l=0;l<a.length;l++){var u=a[l].split("=");if(1<u.length){var c=u[0];u=u[1];var h=c.split("_");o=2<=h.length&&"type"==h[1]?o+(c+"=")+u+"&":o+(c+"=redacted&")}}else o=null;else o=s;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+t+"\n"+n+"\n"+o}))}(e.i,e.u,e.A,e.l,e.R,e.m)}function ze(e){return!!e.g&&("GET"==e.u&&2!=e.L&&e.j.Ca)}function Be(e,t){var n=e.C,r=t.indexOf("\n",n);return-1==r?Ue:(n=Number(t.substring(n,r)),isNaN(n)?Fe:(r+=1)+n>t.length?Ue:(t=t.slice(r,r+n),e.C=r+n,t))}function qe(e){e.S=Date.now()+e.I,$e(e,e.I)}function $e(e,t){if(null!=e.B)throw Error("WatchDog timer not null");e.B=xe(u(e.ba,e),t)}function Ke(e){e.B&&(i.clearTimeout(e.B),e.B=null)}function Ge(e){0==e.j.G||e.J||bn(e.j,e)}function He(e){Ke(e);var t=e.M;t&&"function"==typeof t.ma&&t.ma(),e.M=null,ce(e.U),e.g&&(t=e.g,e.g=null,t.abort(),t.ma())}function We(e,t){try{var n=e.j;if(0!=n.G&&(n.g==e||Ze(n.h,e)))if(!e.K&&Ze(n.h,e)&&3==n.G){try{var r=n.Da.g.parse(t)}catch(c){r=null}if(Array.isArray(r)&&3==r.length){var i=r;if(0==i[0]){e:if(!n.u){if(n.g){if(!(n.g.F+3e3<e.F))break e;wn(n),un(n)}gn(n),ke(18)}}else n.za=i[1],0<n.za-n.T&&37500>i[2]&&n.F&&0==n.v&&!n.C&&(n.C=xe(u(n.Za,n),6e3));if(1>=Xe(n.h)&&n.ca){try{n.ca()}catch(c){}n.ca=void 0}}else In(n,11)}else if((e.K||n.g==e)&&wn(n),!p(t))for(i=n.Da.g.parse(t),t=0;t<i.length;t++){let u=i[t];if(n.T=u[0],u=u[1],2==n.G)if("c"==u[0]){n.K=u[1],n.ia=u[2];const t=u[3];null!=t&&(n.la=t,n.j.info("VER="+n.la));const i=u[4];null!=i&&(n.Aa=i,n.j.info("SVER="+n.Aa));const c=u[5];null!=c&&"number"===typeof c&&0<c&&(r=1.5*c,n.L=r,n.j.info("backChannelRequestTimeoutMs_="+r)),r=n;const h=e.g;if(h){const e=h.g?h.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(e){var s=r.h;s.g||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(s.j=s.l,s.g=new Set,s.h&&(et(s,s.h),s.h=null))}if(r.D){const e=h.g?h.g.getResponseHeader("X-HTTP-Session-Id"):null;e&&(r.ya=e,ct(r.I,r.D,e))}}n.G=3,n.l&&n.l.ua(),n.ba&&(n.R=Date.now()-e.F,n.j.info("Handshake RTT: "+n.R+"ms"));var o=e;if((r=n).qa=En(r,r.J?r.ia:null,r.W),o.K){tt(r.h,o);var a=o,l=r.L;l&&(a.I=l),a.B&&(Ke(a),qe(a)),r.g=o}else mn(r);0<n.i.length&&hn(n)}else"stop"!=u[0]&&"close"!=u[0]||In(n,7);else 3==n.G&&("stop"==u[0]||"close"==u[0]?"stop"==u[0]?In(n,7):ln(n):"noop"!=u[0]&&n.l&&n.l.ta(u),n.v=0)}Ee()}catch(c){}}Le.prototype.ca=function(e){e=e.target;const t=this.M;t&&3==rn(e)?t.j():this.Y(e)},Le.prototype.Y=function(e){try{if(e==this.g)e:{const d=rn(this.g);var t=this.g.Ba();this.g.Z();if(!(3>d)&&(3!=d||this.g&&(this.h.h||this.g.oa()||sn(this.g)))){this.J||4!=d||7==t||Ee(),Ke(this);var n=this.g.Z();this.X=n;t:if(ze(this)){var r=sn(this.g);e="";var s=r.length,o=4==rn(this.g);if(!this.h.i){if("undefined"===typeof TextDecoder){He(this),Ge(this);var a="";break t}this.h.i=new i.TextDecoder}for(t=0;t<s;t++)this.h.h=!0,e+=this.h.i.decode(r[t],{stream:!(o&&t==s-1)});r.length=0,this.h.g+=e,this.C=0,a=this.h.g}else a=this.g.oa();if(this.o=200==n,function(e,t,n,r,i,s,o){e.info((function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+t+"\n"+n+"\n"+s+" "+o}))}(this.i,this.u,this.A,this.l,this.R,d,n),this.o){if(this.T&&!this.K){t:{if(this.g){var l,u=this.g;if((l=u.g?u.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!p(l)){var c=l;break t}}c=null}if(!(n=c)){this.o=!1,this.s=3,ke(12),He(this),Ge(this);break e}Ae(this.i,this.l,n,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,We(this,n)}if(this.P){let e;for(n=!0;!this.J&&this.C<a.length;){if(e=Be(this,a),e==Ue){4==d&&(this.s=4,ke(14),n=!1),Ae(this.i,this.l,null,"[Incomplete Response]");break}if(e==Fe){this.s=4,ke(15),Ae(this.i,this.l,a,"[Invalid Chunk]"),n=!1;break}Ae(this.i,this.l,e,null),We(this,e)}if(ze(this)&&0!=this.C&&(this.h.g=this.h.g.slice(this.C),this.C=0),4!=d||0!=a.length||this.h.h||(this.s=1,ke(16),n=!1),this.o=this.o&&n,n){if(0<a.length&&!this.W){this.W=!0;var h=this.j;h.g==this&&h.ba&&!h.M&&(h.j.info("Great, no buffering proxy detected. Bytes received: "+a.length),vn(h),h.M=!0,ke(11))}}else Ae(this.i,this.l,a,"[Invalid Chunked Response]"),He(this),Ge(this)}else Ae(this.i,this.l,a,null),We(this,a);4==d&&He(this),this.o&&!this.J&&(4==d?bn(this.j,this):(this.o=!1,qe(this)))}else(function(e){const t={};e=(e.g&&2<=rn(e)&&e.g.getAllResponseHeaders()||"").split("\r\n");for(let r=0;r<e.length;r++){if(p(e[r]))continue;var n=I(e[r]);const i=n[0];if("string"!==typeof(n=n[1]))continue;n=n.trim();const s=t[i]||[];t[i]=s,s.push(n)}!function(e,t){for(const n in e)t.call(void 0,e[n],n,e)}(t,(function(e){return e.join(", ")}))})(this.g),400==n&&0<a.indexOf("Unknown SID")?(this.s=3,ke(12)):(this.s=0,ke(13)),He(this),Ge(this)}}}catch(Wt){}},Le.prototype.cancel=function(){this.J=!0,He(this)},Le.prototype.ba=function(){this.B=null;const e=Date.now();0<=e-this.S?(function(e,t){e.info((function(){return"TIMEOUT: "+t}))}(this.i,this.A),2!=this.L&&(Ee(),ke(17)),He(this),this.s=2,Ge(this)):$e(this,this.S-e)};var Qe=class{constructor(e,t){this.g=e,this.map=t}};function Je(e){this.l=e||10,i.PerformanceNavigationTiming?e=0<(e=i.performance.getEntriesByType("navigation")).length&&("hq"==e[0].nextHopProtocol||"h2"==e[0].nextHopProtocol):e=!!(i.chrome&&i.chrome.loadTimes&&i.chrome.loadTimes()&&i.chrome.loadTimes().wasFetchedViaSpdy),this.j=e?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Ye(e){return!!e.h||!!e.g&&e.g.size>=e.j}function Xe(e){return e.h?1:e.g?e.g.size:0}function Ze(e,t){return e.h?e.h==t:!!e.g&&e.g.has(t)}function et(e,t){e.g?e.g.add(t):e.h=t}function tt(e,t){e.h&&e.h==t?e.h=null:e.g&&e.g.has(t)&&e.g.delete(t)}function nt(e){if(null!=e.h)return e.i.concat(e.h.D);if(null!=e.g&&0!==e.g.size){let t=e.i;for(const n of e.g.values())t=t.concat(n.D);return t}return d(e.i)}function rt(e,t){if(e.forEach&&"function"==typeof e.forEach)e.forEach(t,void 0);else if(s(e)||"string"===typeof e)Array.prototype.forEach.call(e,t,void 0);else for(var n=function(e){if(e.na&&"function"==typeof e.na)return e.na();if(!e.V||"function"!=typeof e.V){if("undefined"!==typeof Map&&e instanceof Map)return Array.from(e.keys());if(!("undefined"!==typeof Set&&e instanceof Set)){if(s(e)||"string"===typeof e){var t=[];e=e.length;for(var n=0;n<e;n++)t.push(n);return t}t=[],n=0;for(const r in e)t[n++]=r;return t}}}(e),r=function(e){if(e.V&&"function"==typeof e.V)return e.V();if("undefined"!==typeof Map&&e instanceof Map||"undefined"!==typeof Set&&e instanceof Set)return Array.from(e.values());if("string"===typeof e)return e.split("");if(s(e)){for(var t=[],n=e.length,r=0;r<n;r++)t.push(e[r]);return t}for(r in t=[],n=0,e)t[n++]=e[r];return t}(e),i=r.length,o=0;o<i;o++)t.call(void 0,r[o],n&&n[o],e)}Je.prototype.cancel=function(){if(this.i=nt(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&0!==this.g.size){for(const e of this.g.values())e.cancel();this.g.clear()}};var it=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function st(e){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,e instanceof st){this.h=e.h,at(this,e.j),this.o=e.o,this.g=e.g,lt(this,e.s),this.l=e.l;var t=e.i,n=new _t;n.i=t.i,t.g&&(n.g=new Map(t.g),n.h=t.h),ut(this,n),this.m=e.m}else e&&(t=String(e).match(it))?(this.h=!1,at(this,t[1]||"",!0),this.o=dt(t[2]||""),this.g=dt(t[3]||"",!0),lt(this,t[4]),this.l=dt(t[5]||"",!0),ut(this,t[6]||"",!0),this.m=dt(t[7]||"")):(this.h=!1,this.i=new _t(null,this.h))}function ot(e){return new st(e)}function at(e,t,n){e.j=n?dt(t,!0):t,e.j&&(e.j=e.j.replace(/:$/,""))}function lt(e,t){if(t){if(t=Number(t),isNaN(t)||0>t)throw Error("Bad port number "+t);e.s=t}else e.s=null}function ut(e,t,n){t instanceof _t?(e.i=t,function(e,t){t&&!e.j&&(It(e),e.i=null,e.g.forEach((function(e,t){var n=t.toLowerCase();t!=n&&(St(this,t),Tt(this,n,e))}),e)),e.j=t}(e.i,e.h)):(n||(t=ft(t,wt)),e.i=new _t(t,e.h))}function ct(e,t,n){e.i.set(t,n)}function ht(e){return ct(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),e}function dt(e,t){return e?t?decodeURI(e.replace(/%25/g,"%2525")):decodeURIComponent(e):""}function ft(e,t,n){return"string"===typeof e?(e=encodeURI(e).replace(t,pt),n&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function pt(e){return"%"+((e=e.charCodeAt(0))>>4&15).toString(16)+(15&e).toString(16)}st.prototype.toString=function(){var e=[],t=this.j;t&&e.push(ft(t,gt,!0),":");var n=this.g;return(n||"file"==t)&&(e.push("//"),(t=this.o)&&e.push(ft(t,gt,!0),"@"),e.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.s)&&e.push(":",String(n))),(n=this.l)&&(this.g&&"/"!=n.charAt(0)&&e.push("/"),e.push(ft(n,"/"==n.charAt(0)?yt:vt,!0))),(n=this.i.toString())&&e.push("?",n),(n=this.m)&&e.push("#",ft(n,bt)),e.join("")};var mt,gt=/[#\/\?@]/g,vt=/[#\?:]/g,yt=/[#\?]/g,wt=/[#\?@]/g,bt=/#/g;function _t(e,t){this.h=this.g=null,this.i=e||null,this.j=!!t}function It(e){e.g||(e.g=new Map,e.h=0,e.i&&function(e,t){if(e){e=e.split("&");for(var n=0;n<e.length;n++){var r=e[n].indexOf("="),i=null;if(0<=r){var s=e[n].substring(0,r);i=e[n].substring(r+1)}else s=e[n];t(s,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}(e.i,(function(t,n){e.add(decodeURIComponent(t.replace(/\+/g," ")),n)})))}function St(e,t){It(e),t=kt(e,t),e.g.has(t)&&(e.i=null,e.h-=e.g.get(t).length,e.g.delete(t))}function Et(e,t){return It(e),t=kt(e,t),e.g.has(t)}function Tt(e,t,n){St(e,t),0<n.length&&(e.i=null,e.g.set(kt(e,t),d(n)),e.h+=n.length)}function kt(e,t){return t=String(t),e.j&&(t=t.toLowerCase()),t}function Ct(e,t,n,r,i){try{i&&(i.onload=null,i.onerror=null,i.onabort=null,i.ontimeout=null),r(n)}catch(s){}}function xt(){this.g=new fe}function Nt(e,t,n){const r=n||"";try{rt(e,(function(e,n){let i=e;o(e)&&(i=he(e)),t.push(r+n+"="+encodeURIComponent(i))}))}catch(i){throw t.push(r+"type="+encodeURIComponent("_badmap")),i}}function At(e){this.l=e.Ub||null,this.j=e.eb||!1}function Pt(e,t){ne.call(this),this.D=e,this.o=t,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}function Rt(e){e.j.read().then(e.Pa.bind(e)).catch(e.ga.bind(e))}function Dt(e){e.readyState=4,e.l=null,e.j=null,e.v=null,Ot(e)}function Ot(e){e.onreadystatechange&&e.onreadystatechange.call(e)}function Lt(e){let t="";return y(e,(function(e,n){t+=n,t+=":",t+=e,t+="\r\n"})),t}function Mt(e,t,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=Lt(n),"string"===typeof e?null!=n&&encodeURIComponent(String(n)):ct(e,t,n))}function Ft(e){ne.call(this),this.headers=new Map,this.o=e||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}(e=_t.prototype).add=function(e,t){It(this),this.i=null,e=kt(this,e);var n=this.g.get(e);return n||this.g.set(e,n=[]),n.push(t),this.h+=1,this},e.forEach=function(e,t){It(this),this.g.forEach((function(n,r){n.forEach((function(n){e.call(t,n,r,this)}),this)}),this)},e.na=function(){It(this);const e=Array.from(this.g.values()),t=Array.from(this.g.keys()),n=[];for(let r=0;r<t.length;r++){const i=e[r];for(let e=0;e<i.length;e++)n.push(t[r])}return n},e.V=function(e){It(this);let t=[];if("string"===typeof e)Et(this,e)&&(t=t.concat(this.g.get(kt(this,e))));else{e=Array.from(this.g.values());for(let n=0;n<e.length;n++)t=t.concat(e[n])}return t},e.set=function(e,t){return It(this),this.i=null,Et(this,e=kt(this,e))&&(this.h-=this.g.get(e).length),this.g.set(e,[t]),this.h+=1,this},e.get=function(e,t){return e&&0<(e=this.V(e)).length?String(e[0]):t},e.toString=function(){if(this.i)return this.i;if(!this.g)return"";const e=[],t=Array.from(this.g.keys());for(var n=0;n<t.length;n++){var r=t[n];const s=encodeURIComponent(String(r)),o=this.V(r);for(r=0;r<o.length;r++){var i=s;""!==o[r]&&(i+="="+encodeURIComponent(String(o[r]))),e.push(i)}}return this.i=e.join("&")},h(At,pe),At.prototype.g=function(){return new Pt(this.l,this.j)},At.prototype.i=(mt={},function(){return mt}),h(Pt,ne),(e=Pt.prototype).open=function(e,t){if(0!=this.readyState)throw this.abort(),Error("Error reopening a connection");this.B=e,this.A=t,this.readyState=1,Ot(this)},e.send=function(e){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.g=!0;const t={headers:this.u,method:this.B,credentials:this.m,cache:void 0};e&&(t.body=e),(this.D||i).fetch(new Request(this.A,t)).then(this.Sa.bind(this),this.ga.bind(this))},e.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch((()=>{})),1<=this.readyState&&this.g&&4!=this.readyState&&(this.g=!1,Dt(this)),this.readyState=0},e.Sa=function(e){if(this.g&&(this.l=e,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=e.headers,this.readyState=2,Ot(this)),this.g&&(this.readyState=3,Ot(this),this.g)))if("arraybuffer"===this.responseType)e.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if("undefined"!==typeof i.ReadableStream&&"body"in e){if(this.j=e.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;Rt(this)}else e.text().then(this.Ra.bind(this),this.ga.bind(this))},e.Pa=function(e){if(this.g){if(this.o&&e.value)this.response.push(e.value);else if(!this.o){var t=e.value?e.value:new Uint8Array(0);(t=this.v.decode(t,{stream:!e.done}))&&(this.response=this.responseText+=t)}e.done?Dt(this):Ot(this),3==this.readyState&&Rt(this)}},e.Ra=function(e){this.g&&(this.response=this.responseText=e,Dt(this))},e.Qa=function(e){this.g&&(this.response=e,Dt(this))},e.ga=function(){this.g&&Dt(this)},e.setRequestHeader=function(e,t){this.u.append(e,t)},e.getResponseHeader=function(e){return this.h&&this.h.get(e.toLowerCase())||""},e.getAllResponseHeaders=function(){if(!this.h)return"";const e=[],t=this.h.entries();for(var n=t.next();!n.done;)n=n.value,e.push(n[0]+": "+n[1]),n=t.next();return e.join("\r\n")},Object.defineProperty(Pt.prototype,"withCredentials",{get:function(){return"include"===this.m},set:function(e){this.m=e?"include":"same-origin"}}),h(Ft,ne);var Qt=/^https?$/i,Jt=["POST","PUT"];function Xt(e,t){e.h=!1,e.g&&(e.j=!0,e.g.abort(),e.j=!1),e.l=t,e.m=5,Zt(e),tn(e)}function Zt(e){e.A||(e.A=!0,re(e,"complete"),re(e,"error"))}function en(e){if(e.h&&"undefined"!=typeof r&&(!e.v[1]||4!=rn(e)||2!=e.Z()))if(e.u&&4==rn(e))se(e.Ea,0,e);else if(re(e,"readystatechange"),4==rn(e)){e.h=!1;try{const r=e.Z();e:switch(r){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var t=!0;break e;default:t=!1}var n;if(!(n=t)){var s;if(s=0===r){var o=String(e.D).match(it)[1]||null;!o&&i.self&&i.self.location&&(o=i.self.location.protocol.slice(0,-1)),s=!Qt.test(o?o.toLowerCase():"")}n=s}if(n)re(e,"complete"),re(e,"success");else{e.m=6;try{var a=2<rn(e)?e.g.statusText:""}catch(l){a=""}e.l=a+" ["+e.Z()+"]",Zt(e)}}finally{tn(e)}}}function tn(e,t){if(e.g){nn(e);const r=e.g,i=e.v[0]?()=>{}:null;e.g=null,e.v=null,t||re(e,"ready");try{r.onreadystatechange=i}catch(n){}}}function nn(e){e.I&&(i.clearTimeout(e.I),e.I=null)}function rn(e){return e.g?e.g.readyState:0}function sn(e){try{if(!e.g)return null;if("response"in e.g)return e.g.response;switch(e.H){case"":case"text":return e.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in e.g)return e.g.mozResponseArrayBuffer}return null}catch(Yt){return null}}function on(e,t,n){return n&&n.internalChannelParams&&n.internalChannelParams[e]||t}function an(e){this.Aa=0,this.i=[],this.j=new Ne,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=on("failFast",!1,e),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=on("baseRetryDelayMs",5e3,e),this.cb=on("retryDelaySeedMs",1e4,e),this.Wa=on("forwardChannelMaxRetries",2,e),this.wa=on("forwardChannelRequestTimeoutMs",2e4,e),this.pa=e&&e.xmlHttpFactory||void 0,this.Xa=e&&e.Tb||void 0,this.Ca=e&&e.useFetchStreams||!1,this.L=void 0,this.J=e&&e.supportsCrossDomainXhr||!1,this.K="",this.h=new Je(e&&e.concurrentRequestLimit),this.Da=new xt,this.P=e&&e.fastHandshake||!1,this.O=e&&e.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=e&&e.Rb||!1,e&&e.xa&&this.j.xa(),e&&e.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&e&&e.detectBufferingProxy||!1,this.ja=void 0,e&&e.longPollingTimeout&&0<e.longPollingTimeout&&(this.ja=e.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}function ln(e){if(cn(e),3==e.G){var t=e.U++,n=ot(e.I);if(ct(n,"SID",e.K),ct(n,"RID",t),ct(n,"TYPE","terminate"),fn(e,n),(t=new Le(e,e.j,t)).L=2,t.v=ht(ot(n)),n=!1,i.navigator&&i.navigator.sendBeacon)try{n=i.navigator.sendBeacon(t.v.toString(),"")}catch(r){}!n&&i.Image&&((new Image).src=t.v,n=!0),n||(t.g=Tn(t.j,null),t.g.ea(t.v)),t.F=Date.now(),qe(t)}Sn(e)}function un(e){e.g&&(vn(e),e.g.cancel(),e.g=null)}function cn(e){un(e),e.u&&(i.clearTimeout(e.u),e.u=null),wn(e),e.h.cancel(),e.s&&("number"===typeof e.s&&i.clearTimeout(e.s),e.s=null)}function hn(e){if(!Ye(e.h)&&!e.s){e.s=!0;var t=e.Ga;C||A(),x||(C(),x=!0),N.add(t,e),e.B=0}}function dn(e,t){var n;n=t?t.l:e.U++;const r=ot(e.I);ct(r,"SID",e.K),ct(r,"RID",n),ct(r,"AID",e.T),fn(e,r),e.m&&e.o&&Mt(r,e.m,e.o),n=new Le(e,e.j,n,e.B+1),null===e.m&&(n.H=e.o),t&&(e.i=t.D.concat(e.i)),t=pn(e,n,1e3),n.I=Math.round(.5*e.wa)+Math.round(.5*e.wa*Math.random()),et(e.h,n),je(n,r,t)}function fn(e,t){e.H&&y(e.H,(function(e,n){ct(t,n,e)})),e.l&&rt({},(function(e,n){ct(t,n,e)}))}function pn(e,t,n){n=Math.min(e.i.length,n);var r=e.l?u(e.l.Na,e.l,e):null;e:{var i=e.i;let t=-1;for(;;){const e=["count="+n];-1==t?0<n?(t=i[0].g,e.push("ofs="+t)):t=0:e.push("ofs="+t);let s=!0;for(let o=0;o<n;o++){let n=i[o].g;const a=i[o].map;if(n-=t,0>n)t=Math.max(0,i[o].g-100),s=!1;else try{Nt(a,e,"req"+n+"_")}catch(Wt){r&&r(a)}}if(s){r=e.join("&");break e}}}return e=e.i.splice(0,n),t.D=e,r}function mn(e){if(!e.g&&!e.u){e.Y=1;var t=e.Fa;C||A(),x||(C(),x=!0),N.add(t,e),e.v=0}}function gn(e){return!(e.g||e.u||3<=e.v)&&(e.Y++,e.u=xe(u(e.Fa,e),_n(e,e.v)),e.v++,!0)}function vn(e){null!=e.A&&(i.clearTimeout(e.A),e.A=null)}function yn(e){e.g=new Le(e,e.j,"rpc",e.Y),null===e.m&&(e.g.H=e.o),e.g.O=0;var t=ot(e.qa);ct(t,"RID","rpc"),ct(t,"SID",e.K),ct(t,"AID",e.T),ct(t,"CI",e.F?"0":"1"),!e.F&&e.ja&&ct(t,"TO",e.ja),ct(t,"TYPE","xmlhttp"),fn(e,t),e.m&&e.o&&Mt(t,e.m,e.o),e.L&&(e.g.I=e.L);var n=e.g;e=e.ia,n.L=1,n.v=ht(ot(t)),n.m=null,n.P=!0,Ve(n,e)}function wn(e){null!=e.C&&(i.clearTimeout(e.C),e.C=null)}function bn(e,t){var n=null;if(e.g==t){wn(e),vn(e),e.g=null;var r=2}else{if(!Ze(e.h,t))return;n=t.D,tt(e.h,t),r=1}if(0!=e.G)if(t.o)if(1==r){n=t.m?t.m.length:0,t=Date.now()-t.F;var i=e.B;re(r=Ie(),new Ce(r,n)),hn(e)}else mn(e);else if(3==(i=t.s)||0==i&&0<t.X||!(1==r&&function(e,t){return!(Xe(e.h)>=e.h.j-(e.s?1:0))&&(e.s?(e.i=t.D.concat(e.i),!0):!(1==e.G||2==e.G||e.B>=(e.Va?0:e.Wa))&&(e.s=xe(u(e.Ga,e,t),_n(e,e.B)),e.B++,!0))}(e,t)||2==r&&gn(e)))switch(n&&0<n.length&&(t=e.h,t.i=t.i.concat(n)),i){case 1:In(e,5);break;case 4:In(e,10);break;case 3:In(e,6);break;default:In(e,2)}}function _n(e,t){let n=e.Ta+Math.floor(Math.random()*e.cb);return e.isActive()||(n*=2),n*t}function In(e,t){if(e.j.info("Error code "+t),2==t){var n=u(e.fb,e),r=e.Xa;const t=!r;r=new st(r||"//www.google.com/images/cleardot.gif"),i.location&&"http"==i.location.protocol||at(r,"https"),ht(r),t?function(e,t){const n=new Ne;if(i.Image){const r=new Image;r.onload=c(Ct,n,"TestLoadImage: loaded",!0,t,r),r.onerror=c(Ct,n,"TestLoadImage: error",!1,t,r),r.onabort=c(Ct,n,"TestLoadImage: abort",!1,t,r),r.ontimeout=c(Ct,n,"TestLoadImage: timeout",!1,t,r),i.setTimeout((function(){r.ontimeout&&r.ontimeout()}),1e4),r.src=e}else t(!1)}(r.toString(),n):function(e,t){new Ne;const n=new AbortController,r=setTimeout((()=>{n.abort(),Ct(0,0,!1,t)}),1e4);fetch(e,{signal:n.signal}).then((e=>{clearTimeout(r),e.ok?Ct(0,0,!0,t):Ct(0,0,!1,t)})).catch((()=>{clearTimeout(r),Ct(0,0,!1,t)}))}(r.toString(),n)}else ke(2);e.G=0,e.l&&e.l.sa(t),Sn(e),cn(e)}function Sn(e){if(e.G=0,e.ka=[],e.l){const t=nt(e.h);0==t.length&&0==e.i.length||(f(e.ka,t),f(e.ka,e.i),e.h.i.length=0,d(e.i),e.i.length=0),e.l.ra()}}function En(e,t,n){var r=n instanceof st?ot(n):new st(n);if(""!=r.g)t&&(r.g=t+"."+r.g),lt(r,r.s);else{var s=i.location;r=s.protocol,t=t?t+"."+s.hostname:s.hostname,s=+s.port;var o=new st(null);r&&at(o,r),t&&(o.g=t),s&&lt(o,s),n&&(o.l=n),r=o}return n=e.D,t=e.ya,n&&t&&ct(r,n,t),ct(r,"VER",e.la),fn(e,r),r}function Tn(e,t,n){if(t&&!e.J)throw Error("Can't create secondary domain capable XhrIo object.");return(t=e.Ca&&!e.pa?new Ft(new At({eb:n})):new Ft(e.pa)).Ha(e.J),t}function kn(){}function Cn(){}function xn(e,t){ne.call(this),this.g=new an(t),this.l=e,this.h=t&&t.messageUrlParams||null,e=t&&t.messageHeaders||null,t&&t.clientProtocolHeaderRequired&&(e?e["X-Client-Protocol"]="webchannel":e={"X-Client-Protocol":"webchannel"}),this.g.o=e,e=t&&t.initMessageHeaders||null,t&&t.messageContentType&&(e?e["X-WebChannel-Content-Type"]=t.messageContentType:e={"X-WebChannel-Content-Type":t.messageContentType}),t&&t.va&&(e?e["X-WebChannel-Client-Profile"]=t.va:e={"X-WebChannel-Client-Profile":t.va}),this.g.S=e,(e=t&&t.Sb)&&!p(e)&&(this.g.m=e),this.v=t&&t.supportsCrossDomainXhr||!1,this.u=t&&t.sendRawJson||!1,(t=t&&t.httpSessionIdParam)&&!p(t)&&(this.g.D=t,null!==(e=this.h)&&t in e&&(t in(e=this.h)&&delete e[t])),this.j=new Pn(this)}function Nn(e){ye.call(this),e.__headers__&&(this.headers=e.__headers__,this.statusCode=e.__status__,delete e.__headers__,delete e.__status__);var t=e.__sm__;if(t){e:{for(const n in t){e=n;break e}e=void 0}(this.i=e)&&(e=this.i,t=null!==t&&e in t?t[e]:void 0),this.data=t}else this.data=e}function An(){we.call(this),this.status=1}function Pn(e){this.g=e}(e=Ft.prototype).Ha=function(e){this.J=e},e.ea=function(e,t,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+e);t=t?t.toUpperCase():"GET",this.D=e,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Pe.g(),this.v=this.o?me(this.o):me(Pe),this.g.onreadystatechange=u(this.Ea,this);try{this.B=!0,this.g.open(t,String(e),!0),this.B=!1}catch(o){return void Xt(this,o)}if(e=n||"",n=new Map(this.headers),r)if(Object.getPrototypeOf(r)===Object.prototype)for(var s in r)n.set(s,r[s]);else{if("function"!==typeof r.keys||"function"!==typeof r.get)throw Error("Unknown input type for opt_headers: "+String(r));for(const e of r.keys())n.set(e,r.get(e))}r=Array.from(n.keys()).find((e=>"content-type"==e.toLowerCase())),s=i.FormData&&e instanceof i.FormData,!(0<=Array.prototype.indexOf.call(Jt,t,void 0))||r||s||n.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[i,a]of n)this.g.setRequestHeader(i,a);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nn(this),this.u=!0,this.g.send(e),this.u=!1}catch(o){Xt(this,o)}},e.abort=function(e){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=e||7,re(this,"complete"),re(this,"abort"),tn(this))},e.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),tn(this,!0)),Ft.aa.N.call(this)},e.Ea=function(){this.s||(this.B||this.u||this.j?en(this):this.bb())},e.bb=function(){en(this)},e.isActive=function(){return!!this.g},e.Z=function(){try{return 2<rn(this)?this.g.status:-1}catch(mt){return-1}},e.oa=function(){try{return this.g?this.g.responseText:""}catch(mt){return""}},e.Oa=function(e){if(this.g){var t=this.g.responseText;return e&&0==t.indexOf(e)&&(t=t.substring(e.length)),de(t)}},e.Ba=function(){return this.m},e.Ka=function(){return"string"===typeof this.l?this.l:String(this.l)},(e=an.prototype).la=8,e.G=1,e.connect=function(e,t,n,r){ke(0),this.W=e,this.H=t||{},n&&void 0!==r&&(this.H.OSID=n,this.H.OAID=r),this.F=this.X,this.I=En(this,null,this.W),hn(this)},e.Ga=function(e){if(this.s)if(this.s=null,1==this.G){if(!e){this.U=Math.floor(1e5*Math.random()),e=this.U++;const i=new Le(this,this.j,e);let s=this.o;if(this.S&&(s?(s=w(s),_(s,this.S)):s=this.S),null!==this.m||this.O||(i.H=s,s=null),this.P)e:{for(var t=0,n=0;n<this.i.length;n++){var r=this.i[n];if(void 0===(r="__data__"in r.map&&"string"===typeof(r=r.map.__data__)?r.length:void 0))break;if(4096<(t+=r)){t=n;break e}if(4096===t||n===this.i.length-1){t=n+1;break e}}t=1e3}else t=1e3;t=pn(this,i,t),ct(n=ot(this.I),"RID",e),ct(n,"CVER",22),this.D&&ct(n,"X-HTTP-Session-Id",this.D),fn(this,n),s&&(this.O?t="headers="+encodeURIComponent(String(Lt(s)))+"&"+t:this.m&&Mt(n,this.m,s)),et(this.h,i),this.Ua&&ct(n,"TYPE","init"),this.P?(ct(n,"$req",t),ct(n,"SID","null"),i.T=!0,je(i,n,null)):je(i,n,t),this.G=2}}else 3==this.G&&(e?dn(this,e):0==this.i.length||Ye(this.h)||dn(this))},e.Fa=function(){if(this.u=null,yn(this),this.ba&&!(this.M||null==this.g||0>=this.R)){var e=2*this.R;this.j.info("BP detection timer enabled: "+e),this.A=xe(u(this.ab,this),e)}},e.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ke(10),un(this),yn(this))},e.Za=function(){null!=this.C&&(this.C=null,un(this),gn(this),ke(19))},e.fb=function(e){e?(this.j.info("Successfully pinged google.com"),ke(2)):(this.j.info("Failed to ping google.com"),ke(1))},e.isActive=function(){return!!this.l&&this.l.isActive(this)},(e=kn.prototype).ua=function(){},e.ta=function(){},e.sa=function(){},e.ra=function(){},e.isActive=function(){return!0},e.Na=function(){},Cn.prototype.g=function(e,t){return new xn(e,t)},h(xn,ne),xn.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},xn.prototype.close=function(){ln(this.g)},xn.prototype.o=function(e){var t=this.g;if("string"===typeof e){var n={};n.__data__=e,e=n}else this.u&&((n={}).__data__=he(e),e=n);t.i.push(new Qe(t.Ya++,e)),3==t.G&&hn(t)},xn.prototype.N=function(){this.g.l=null,delete this.j,ln(this.g),delete this.g,xn.aa.N.call(this)},h(Nn,ye),h(An,we),h(Pn,kn),Pn.prototype.ua=function(){re(this.g,"a")},Pn.prototype.ta=function(e){re(this.g,new Nn(e))},Pn.prototype.sa=function(e){re(this.g,new An)},Pn.prototype.ra=function(){re(this.g,"b")},Cn.prototype.createWebChannel=Cn.prototype.g,xn.prototype.send=xn.prototype.o,xn.prototype.open=xn.prototype.m,xn.prototype.close=xn.prototype.close,Kt=Ht.createWebChannelTransport=function(){return new Cn},$t=Ht.getStatEventTarget=function(){return Ie()},qt=Ht.Event=be,Bt=Ht.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Re.NO_ERROR=0,Re.TIMEOUT=8,Re.HTTP_ERROR=6,zt=Ht.ErrorCode=Re,De.COMPLETE="complete",Vt=Ht.EventType=De,ge.EventType=ve,ve.OPEN="a",ve.CLOSE="b",ve.ERROR="c",ve.MESSAGE="d",ne.prototype.listen=ne.prototype.K,jt=Ht.WebChannel=ge,Ht.FetchXmlHttpFactory=At,Ft.prototype.listenOnce=Ft.prototype.L,Ft.prototype.getLastError=Ft.prototype.Ka,Ft.prototype.getLastErrorCode=Ft.prototype.Ba,Ft.prototype.getStatus=Ft.prototype.Z,Ft.prototype.getResponseJson=Ft.prototype.Oa,Ft.prototype.getResponseText=Ft.prototype.oa,Ft.prototype.send=Ft.prototype.ea,Ft.prototype.setWithCredentials=Ft.prototype.Ha,Ut=Ht.XhrIo=Ft}).apply("undefined"!==typeof Gt?Gt:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{});const Wt="@firebase/firestore";class Qt{constructor(e){this.uid=e}isAuthenticated(){return null!=this.uid}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}Qt.UNAUTHENTICATED=new Qt(null),Qt.GOOGLE_CREDENTIALS=new Qt("google-credentials-uid"),Qt.FIRST_PARTY=new Qt("first-party-uid"),Qt.MOCK_USER=new Qt("mock-user");let Jt="10.14.0";const Yt=new oe("@firebase/firestore");function Xt(){return Yt.logLevel}function Zt(e){if(Yt.logLevel<=te.DEBUG){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(nn);Yt.debug(`Firestore (${Jt}): ${e}`,...i)}}function en(e){if(Yt.logLevel<=te.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(nn);Yt.error(`Firestore (${Jt}): ${e}`,...i)}}function tn(e){if(Yt.logLevel<=te.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];const i=n.map(nn);Yt.warn(`Firestore (${Jt}): ${e}`,...i)}}function nn(e){if("string"==typeof e)return e;try{return function(e){return JSON.stringify(e)}(e)}catch(t){return e}}function rn(){const e=`FIRESTORE (${Jt}) INTERNAL ASSERTION FAILED: `+(arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Unexpected state");throw en(e),new Error(e)}function sn(e,t){e||rn()}function on(e,t){return e}const an={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class ln extends F{constructor(e,t){super(e,t),this.code=e,this.message=t,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}class un{constructor(){this.promise=new Promise(((e,t)=>{this.resolve=e,this.reject=t}))}}class cn{constructor(e,t){this.user=t,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class hn{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,t){e.enqueueRetryable((()=>t(Qt.UNAUTHENTICATED)))}shutdown(){}}class dn{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,t){this.changeListener=t,e.enqueueRetryable((()=>t(this.token.user)))}shutdown(){this.changeListener=null}}class fn{constructor(e){this.t=e,this.currentUser=Qt.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,t){sn(void 0===this.o);let n=this.i;const r=e=>this.i!==n?(n=this.i,t(e)):Promise.resolve();let i=new un;this.o=()=>{this.i++,this.currentUser=this.u(),i.resolve(),i=new un,e.enqueueRetryable((()=>r(this.currentUser)))};const s=()=>{const t=i;e.enqueueRetryable((async()=>{await t.promise,await r(this.currentUser)}))},o=e=>{Zt("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=e,this.o&&(this.auth.addAuthTokenListener(this.o),s())};this.t.onInit((e=>o(e))),setTimeout((()=>{if(!this.auth){const e=this.t.getImmediate({optional:!0});e?o(e):(Zt("FirebaseAuthCredentialsProvider","Auth not yet detected"),i.resolve(),i=new un)}}),0),s()}getToken(){const e=this.i,t=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(t).then((t=>this.i!==e?(Zt("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):t?(sn("string"==typeof t.accessToken),new cn(t.accessToken,this.currentUser)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return sn(null===e||"string"==typeof e),new Qt(e)}}class pn{constructor(e,t,n){this.l=e,this.h=t,this.P=n,this.type="FirstParty",this.user=Qt.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);const e=this.T();return e&&this.I.set("Authorization",e),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}}class mn{constructor(e,t,n){this.l=e,this.h=t,this.P=n}getToken(){return Promise.resolve(new pn(this.l,this.h,this.P))}start(e,t){e.enqueueRetryable((()=>t(Qt.FIRST_PARTY)))}shutdown(){}invalidateToken(){}}class gn{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class vn{constructor(e){this.A=e,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(e,t){sn(void 0===this.o);const n=e=>{null!=e.error&&Zt("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${e.error.message}`);const n=e.token!==this.R;return this.R=e.token,Zt("FirebaseAppCheckTokenProvider",`Received ${n?"new":"existing"} token.`),n?t(e.token):Promise.resolve()};this.o=t=>{e.enqueueRetryable((()=>n(t)))};const r=e=>{Zt("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=e,this.o&&this.appCheck.addTokenListener(this.o)};this.A.onInit((e=>r(e))),setTimeout((()=>{if(!this.appCheck){const e=this.A.getImmediate({optional:!0});e?r(e):Zt("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}}),0)}getToken(){const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then((e=>e?(sn("string"==typeof e.token),this.R=e.token,new gn(e.token)):null)):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}function yn(e){const t="undefined"!=typeof self&&(self.crypto||self.msCrypto),n=new Uint8Array(e);if(t&&"function"==typeof t.getRandomValues)t.getRandomValues(n);else for(let r=0;r<e;r++)n[r]=Math.floor(256*Math.random());return n}class wn{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",t=62*Math.floor(256/62);let n="";for(;n.length<20;){const r=yn(40);for(let i=0;i<r.length;++i)n.length<20&&r[i]<t&&(n+=e.charAt(r[i]%62))}return n}}function bn(e,t){return e<t?-1:e>t?1:0}function _n(e,t,n){return e.length===t.length&&e.every(((e,r)=>n(e,t[r])))}function In(e){return e+"\0"}class Sn{constructor(e,t){if(this.seconds=e,this.nanoseconds=t,t<0)throw new ln(an.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(t>=1e9)throw new ln(an.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+t);if(e<-62135596800)throw new ln(an.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new ln(an.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}static now(){return Sn.fromMillis(Date.now())}static fromDate(e){return Sn.fromMillis(e.getTime())}static fromMillis(e){const t=Math.floor(e/1e3),n=Math.floor(1e6*(e-1e3*t));return new Sn(t,n)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(e){return this.seconds===e.seconds?bn(this.nanoseconds,e.nanoseconds):bn(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}class En{constructor(e){this.timestamp=e}static fromTimestamp(e){return new En(e)}static min(){return new En(new Sn(0,0))}static max(){return new En(new Sn(253402300799,999999999))}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}class Tn{constructor(e,t,n){void 0===t?t=0:t>e.length&&rn(),void 0===n?n=e.length-t:n>e.length-t&&rn(),this.segments=e,this.offset=t,this.len=n}get length(){return this.len}isEqual(e){return 0===Tn.comparator(this,e)}child(e){const t=this.segments.slice(this.offset,this.limit());return e instanceof Tn?e.forEach((e=>{t.push(e)})):t.push(e),this.construct(t)}limit(){return this.offset+this.length}popFirst(e){return e=void 0===e?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return 0===this.length}isPrefixOf(e){if(e.length<this.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let t=0;t<this.length;t++)if(this.get(t)!==e.get(t))return!1;return!0}forEach(e){for(let t=this.offset,n=this.limit();t<n;t++)e(this.segments[t])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,t){const n=Math.min(e.length,t.length);for(let r=0;r<n;r++){const n=e.get(r),i=t.get(r);if(n<i)return-1;if(n>i)return 1}return e.length<t.length?-1:e.length>t.length?1:0}}class kn extends Tn{construct(e,t,n){return new kn(e,t,n)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(){const e=[];for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n){if(i.indexOf("//")>=0)throw new ln(an.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter((e=>e.length>0)))}return new kn(e)}static emptyPath(){return new kn([])}}const Cn=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class xn extends Tn{construct(e,t,n){return new xn(e,t,n)}static isValidIdentifier(e){return Cn.test(e)}canonicalString(){return this.toArray().map((e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),xn.isValidIdentifier(e)||(e="`"+e+"`"),e))).join(".")}toString(){return this.canonicalString()}isKeyField(){return 1===this.length&&"__name__"===this.get(0)}static keyField(){return new xn(["__name__"])}static fromServerFormat(e){const t=[];let n="",r=0;const i=()=>{if(0===n.length)throw new ln(an.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);t.push(n),n=""};let s=!1;for(;r<e.length;){const t=e[r];if("\\"===t){if(r+1===e.length)throw new ln(an.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const t=e[r+1];if("\\"!==t&&"."!==t&&"`"!==t)throw new ln(an.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);n+=t,r+=2}else"`"===t?(s=!s,r++):"."!==t||s?(n+=t,r++):(i(),r++)}if(i(),s)throw new ln(an.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new xn(t)}static emptyPath(){return new xn([])}}class Nn{constructor(e){this.path=e}static fromPath(e){return new Nn(kn.fromString(e))}static fromName(e){return new Nn(kn.fromString(e).popFirst(5))}static empty(){return new Nn(kn.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return null!==e&&0===kn.comparator(this.path,e.path)}toString(){return this.path.toString()}static comparator(e,t){return kn.comparator(e.path,t.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Nn(new kn(e.slice()))}}class An{constructor(e,t,n,r){this.indexId=e,this.collectionGroup=t,this.fields=n,this.indexState=r}}function Pn(e){return e.fields.find((e=>2===e.kind))}function Rn(e){return e.fields.filter((e=>2!==e.kind))}An.UNKNOWN_ID=-1;class Dn{constructor(e,t){this.fieldPath=e,this.kind=t}}class On{constructor(e,t){this.sequenceNumber=e,this.offset=t}static empty(){return new On(0,Fn.min())}}function Ln(e,t){const n=e.toTimestamp().seconds,r=e.toTimestamp().nanoseconds+1,i=En.fromTimestamp(1e9===r?new Sn(n+1,0):new Sn(n,r));return new Fn(i,Nn.empty(),t)}function Mn(e){return new Fn(e.readTime,e.key,-1)}class Fn{constructor(e,t,n){this.readTime=e,this.documentKey=t,this.largestBatchId=n}static min(){return new Fn(En.min(),Nn.empty(),-1)}static max(){return new Fn(En.max(),Nn.empty(),-1)}}function Un(e,t){let n=e.readTime.compareTo(t.readTime);return 0!==n?n:(n=Nn.comparator(e.documentKey,t.documentKey),0!==n?n:bn(e.largestBatchId,t.largestBatchId))}const jn="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class Vn{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach((e=>e()))}}async function zn(e){if(e.code!==an.FAILED_PRECONDITION||e.message!==jn)throw e;Zt("LocalStore","Unexpectedly lost primary lease")}class Bn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e((e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)}),(e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)}))}catch(e){return this.next(void 0,e)}next(e,t){return this.callbackAttached&&rn(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(t,this.error):this.wrapSuccess(e,this.result):new Bn(((n,r)=>{this.nextCallback=t=>{this.wrapSuccess(e,t).next(n,r)},this.catchCallback=e=>{this.wrapFailure(t,e).next(n,r)}}))}toPromise(){return new Promise(((e,t)=>{this.next(e,t)}))}wrapUserFunction(e){try{const t=e();return t instanceof Bn?t:Bn.resolve(t)}catch(e){return Bn.reject(e)}}wrapSuccess(e,t){return e?this.wrapUserFunction((()=>e(t))):Bn.resolve(t)}wrapFailure(e,t){return e?this.wrapUserFunction((()=>e(t))):Bn.reject(t)}static resolve(e){return new Bn(((t,n)=>{t(e)}))}static reject(e){return new Bn(((t,n)=>{n(e)}))}static waitFor(e){return new Bn(((t,n)=>{let r=0,i=0,s=!1;e.forEach((e=>{++r,e.next((()=>{++i,s&&i===r&&t()}),(e=>n(e)))})),s=!0,i===r&&t()}))}static or(e){let t=Bn.resolve(!1);for(const n of e)t=t.next((e=>e?Bn.resolve(e):n()));return t}static forEach(e,t){const n=[];return e.forEach(((e,r)=>{n.push(t.call(this,e,r))})),this.waitFor(n)}static mapArray(e,t){return new Bn(((n,r)=>{const i=e.length,s=new Array(i);let o=0;for(let a=0;a<i;a++){const l=a;t(e[l]).next((e=>{s[l]=e,++o,o===i&&n(s)}),(e=>r(e)))}}))}static doWhile(e,t){return new Bn(((n,r)=>{const i=()=>{!0===e()?t().next((()=>{i()}),r):n()};i()}))}}class qn{constructor(e,t){this.action=e,this.transaction=t,this.aborted=!1,this.V=new un,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{t.error?this.V.reject(new Hn(e,t.error)):this.V.resolve()},this.transaction.onerror=t=>{const n=Xn(t.target.error);this.V.reject(new Hn(e,n))}}static open(e,t,n,r){try{return new qn(t,e.transaction(r,n))}catch(e){throw new Hn(t,e)}}get m(){return this.V.promise}abort(e){e&&this.V.reject(e),this.aborted||(Zt("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){const e=this.transaction;this.aborted||"function"!=typeof e.commit||e.commit()}store(e){const t=this.transaction.objectStore(e);return new Qn(t)}}class $n{constructor(e,t,n){this.name=e,this.version=t,this.p=n,12.2===$n.S(N())&&en("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(e){return Zt("SimpleDb","Removing database:",e),Jn(window.indexedDB.deleteDatabase(e)).toPromise()}static D(){if(!M())return!1;if($n.v())return!0;const e=N(),t=$n.S(e),n=0<t&&t<10,r=Kn(e),i=0<r&&r<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||n||i)}static v(){var e;return"undefined"!=typeof process&&"YES"===(null===(e=process.__PRIVATE_env)||void 0===e?void 0:e.C)}static F(e,t){return e.store(t)}static S(e){const t=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),n=t?t[1].split("_").slice(0,2).join("."):"-1";return Number(n)}async M(e){return this.db||(Zt("SimpleDb","Opening database:",this.name),this.db=await new Promise(((t,n)=>{const r=indexedDB.open(this.name,this.version);r.onsuccess=e=>{const n=e.target.result;t(n)},r.onblocked=()=>{n(new Hn(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=t=>{const r=t.target.error;"VersionError"===r.name?n(new ln(an.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):"InvalidStateError"===r.name?n(new ln(an.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+r)):n(new Hn(e,r))},r.onupgradeneeded=e=>{Zt("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',e.oldVersion);const t=e.target.result;this.p.O(t,r.transaction,e.oldVersion,this.version).next((()=>{Zt("SimpleDb","Database upgrade to version "+this.version+" complete")}))}}))),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db}L(e){this.N=e,this.db&&(this.db.onversionchange=t=>e(t))}async runTransaction(e,t,n,r){const i="readonly"===t;let s=0;for(;;){++s;try{this.db=await this.M(e);const t=qn.open(this.db,e,i?"readonly":"readwrite",n),s=r(t).next((e=>(t.g(),e))).catch((e=>(t.abort(e),Bn.reject(e)))).toPromise();return s.catch((()=>{})),await t.m,s}catch(e){const t=e,n="FirebaseError"!==t.name&&s<3;if(Zt("SimpleDb","Transaction failed with error:",t.message,"Retrying:",n),this.close(),!n)return Promise.reject(t)}}}close(){this.db&&this.db.close(),this.db=void 0}}function Kn(e){const t=e.match(/Android ([\d.]+)/i),n=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(n)}class Gn{constructor(e){this.B=e,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(e){this.B=e}done(){this.k=!0}$(e){this.q=e}delete(){return Jn(this.B.delete())}}class Hn extends ln{constructor(e,t){super(an.UNAVAILABLE,`IndexedDB transaction '${e}' failed: ${t}`),this.name="IndexedDbTransactionError"}}function Wn(e){return"IndexedDbTransactionError"===e.name}class Qn{constructor(e){this.store=e}put(e,t){let n;return void 0!==t?(Zt("SimpleDb","PUT",this.store.name,e,t),n=this.store.put(t,e)):(Zt("SimpleDb","PUT",this.store.name,"<auto-key>",e),n=this.store.put(e)),Jn(n)}add(e){return Zt("SimpleDb","ADD",this.store.name,e,e),Jn(this.store.add(e))}get(e){return Jn(this.store.get(e)).next((t=>(void 0===t&&(t=null),Zt("SimpleDb","GET",this.store.name,e,t),t)))}delete(e){return Zt("SimpleDb","DELETE",this.store.name,e),Jn(this.store.delete(e))}count(){return Zt("SimpleDb","COUNT",this.store.name),Jn(this.store.count())}U(e,t){const n=this.options(e,t),r=n.index?this.store.index(n.index):this.store;if("function"==typeof r.getAll){const e=r.getAll(n.range);return new Bn(((t,n)=>{e.onerror=e=>{n(e.target.error)},e.onsuccess=e=>{t(e.target.result)}}))}{const e=this.cursor(n),t=[];return this.W(e,((e,n)=>{t.push(n)})).next((()=>t))}}G(e,t){const n=this.store.getAll(e,null===t?void 0:t);return new Bn(((e,t)=>{n.onerror=e=>{t(e.target.error)},n.onsuccess=t=>{e(t.target.result)}}))}j(e,t){Zt("SimpleDb","DELETE ALL",this.store.name);const n=this.options(e,t);n.H=!1;const r=this.cursor(n);return this.W(r,((e,t,n)=>n.delete()))}J(e,t){let n;t?n=e:(n={},t=e);const r=this.cursor(n);return this.W(r,t)}Y(e){const t=this.cursor({});return new Bn(((n,r)=>{t.onerror=e=>{const t=Xn(e.target.error);r(t)},t.onsuccess=t=>{const r=t.target.result;r?e(r.primaryKey,r.value).next((e=>{e?r.continue():n()})):n()}}))}W(e,t){const n=[];return new Bn(((r,i)=>{e.onerror=e=>{i(e.target.error)},e.onsuccess=e=>{const i=e.target.result;if(!i)return void r();const s=new Gn(i),o=t(i.primaryKey,i.value,s);if(o instanceof Bn){const e=o.catch((e=>(s.done(),Bn.reject(e))));n.push(e)}s.isDone?r():null===s.K?i.continue():i.continue(s.K)}})).next((()=>Bn.waitFor(n)))}options(e,t){let n;return void 0!==e&&("string"==typeof e?n=e:t=e),{index:n,range:t}}cursor(e){let t="next";if(e.reverse&&(t="prev"),e.index){const n=this.store.index(e.index);return e.H?n.openKeyCursor(e.range,t):n.openCursor(e.range,t)}return this.store.openCursor(e.range,t)}}function Jn(e){return new Bn(((t,n)=>{e.onsuccess=e=>{const n=e.target.result;t(n)},e.onerror=e=>{const t=Xn(e.target.error);n(t)}}))}let Yn=!1;function Xn(e){const t=$n.S(N());if(t>=12.2&&t<13){const t="An internal error was encountered in the Indexed Database server";if(e.message.indexOf(t)>=0){const e=new ln("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${t}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return Yn||(Yn=!0,setTimeout((()=>{throw e}),0)),e}}return e}class Zn{constructor(e,t){this.asyncQueue=e,this.Z=t,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return null!==this.task}X(e){Zt("IndexBackfiller",`Scheduled in ${e}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",e,(async()=>{this.task=null;try{Zt("IndexBackfiller",`Documents written: ${await this.Z.ee()}`)}catch(e){Wn(e)?Zt("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):await zn(e)}await this.X(6e4)}))}}class er{constructor(e,t){this.localStore=e,this.persistence=t}async ee(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50;return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",(t=>this.te(t,e)))}te(e,t){const n=new Set;let r=t,i=!0;return Bn.doWhile((()=>!0===i&&r>0),(()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(e).next((t=>{if(null!==t&&!n.has(t))return Zt("IndexBackfiller",`Processing collection: ${t}`),this.ne(e,t,r).next((e=>{r-=e,n.add(t)}));i=!1})))).next((()=>t-r))}ne(e,t,n){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(e,t).next((r=>this.localStore.localDocuments.getNextDocuments(e,t,r,n).next((n=>{const i=n.changes;return this.localStore.indexManager.updateIndexEntries(e,i).next((()=>this.re(r,n))).next((n=>(Zt("IndexBackfiller",`Updating offset: ${n}`),this.localStore.indexManager.updateCollectionGroup(e,t,n)))).next((()=>i.size))}))))}re(e,t){let n=e;return t.changes.forEach(((e,t)=>{const r=Mn(t);Un(r,n)>0&&(n=r)})),new Fn(n.readTime,n.documentKey,Math.max(t.batchId,e.largestBatchId))}}class tr{constructor(e,t){this.previousValue=e,t&&(t.sequenceNumberHandler=e=>this.ie(e),this.se=e=>t.writeSequenceNumber(e))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.se&&this.se(e),e}}function nr(e){return null==e}function rr(e){return 0===e&&1/e==-1/0}function ir(e){return"number"==typeof e&&Number.isInteger(e)&&!rr(e)&&e<=Number.MAX_SAFE_INTEGER&&e>=Number.MIN_SAFE_INTEGER}function sr(e){let t="";for(let n=0;n<e.length;n++)t.length>0&&(t=ar(t)),t=or(e.get(n),t);return ar(t)}function or(e,t){let n=t;const r=e.length;for(let i=0;i<r;i++){const t=e.charAt(i);switch(t){case"\0":n+="\x01\x10";break;case"\x01":n+="\x01\x11";break;default:n+=t}}return n}function ar(e){return e+"\x01\x01"}function lr(e){const t=e.length;if(sn(t>=2),2===t)return sn("\x01"===e.charAt(0)&&"\x01"===e.charAt(1)),kn.emptyPath();const n=t-2,r=[];let i="";for(let s=0;s<t;){const t=e.indexOf("\x01",s);switch((t<0||t>n)&&rn(),e.charAt(t+1)){case"\x01":const n=e.substring(s,t);let o;0===i.length?o=n:(i+=n,o=i,i=""),r.push(o);break;case"\x10":i+=e.substring(s,t),i+="\0";break;case"\x11":i+=e.substring(s,t+1);break;default:rn()}s=t+2}return new kn(r)}tr.oe=-1;const ur=["userId","batchId"];function cr(e,t){return[e,sr(t)]}function hr(e,t,n){return[e,sr(t),n]}const dr={},fr=["prefixPath","collectionGroup","readTime","documentId"],pr=["prefixPath","collectionGroup","documentId"],mr=["collectionGroup","readTime","prefixPath","documentId"],gr=["canonicalId","targetId"],vr=["targetId","path"],yr=["path","targetId"],wr=["collectionId","parent"],br=["indexId","uid"],_r=["uid","sequenceNumber"],Ir=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],Sr=["indexId","uid","orderedDocumentKey"],Er=["userId","collectionPath","documentId"],Tr=["userId","collectionPath","largestBatchId"],kr=["userId","collectionGroup","largestBatchId"],Cr=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],xr=[...Cr,"documentOverlays"],Nr=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ar=Nr,Pr=[...Ar,"indexConfiguration","indexState","indexEntries"],Rr=Pr,Dr=[...Pr,"globals"];class Or extends Vn{constructor(e,t){super(),this._e=e,this.currentSequenceNumber=t}}function Lr(e,t){const n=on(e);return $n.F(n._e,t)}function Mr(e){let t=0;for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t++;return t}function Fr(e,t){for(const n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n])}function Ur(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}class jr{constructor(e,t){this.comparator=e,this.root=t||zr.EMPTY}insert(e,t){return new jr(this.comparator,this.root.insert(e,t,this.comparator).copy(null,null,zr.BLACK,null,null))}remove(e){return new jr(this.comparator,this.root.remove(e,this.comparator).copy(null,null,zr.BLACK,null,null))}get(e){let t=this.root;for(;!t.isEmpty();){const n=this.comparator(e,t.key);if(0===n)return t.value;n<0?t=t.left:n>0&&(t=t.right)}return null}indexOf(e){let t=0,n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(0===r)return t+n.left.size;r<0?n=n.left:(t+=n.left.size+1,n=n.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal(((t,n)=>(e(t,n),!1)))}toString(){const e=[];return this.inorderTraversal(((t,n)=>(e.push(`${t}:${n}`),!1))),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new Vr(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new Vr(this.root,e,this.comparator,!1)}getReverseIterator(){return new Vr(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new Vr(this.root,e,this.comparator,!0)}}class Vr{constructor(e,t,n,r){this.isReverse=r,this.nodeStack=[];let i=1;for(;!e.isEmpty();)if(i=t?n(e.key,t):1,t&&r&&(i*=-1),i<0)e=this.isReverse?e.left:e.right;else{if(0===i){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const t={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return t}hasNext(){return this.nodeStack.length>0}peek(){if(0===this.nodeStack.length)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class zr{constructor(e,t,n,r,i){this.key=e,this.value=t,this.color=null!=n?n:zr.RED,this.left=null!=r?r:zr.EMPTY,this.right=null!=i?i:zr.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,t,n,r,i){return new zr(null!=e?e:this.key,null!=t?t:this.value,null!=n?n:this.color,null!=r?r:this.left,null!=i?i:this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,t,n){let r=this;const i=n(e,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(e,t,n),null):0===i?r.copy(null,t,null,null,null):r.copy(null,null,null,null,r.right.insert(e,t,n)),r.fixUp()}removeMin(){if(this.left.isEmpty())return zr.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,t){let n,r=this;if(t(e,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(e,t),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),0===t(e,r.key)){if(r.right.isEmpty())return zr.EMPTY;n=r.right.min(),r=r.copy(n.key,n.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(e,t))}return r.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,zr.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,zr.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),t=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,t)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw rn();if(this.right.isRed())throw rn();const e=this.left.check();if(e!==this.right.check())throw rn();return e+(this.isRed()?0:1)}}zr.EMPTY=null,zr.RED=!0,zr.BLACK=!1,zr.EMPTY=new class{constructor(){this.size=0}get key(){throw rn()}get value(){throw rn()}get color(){throw rn()}get left(){throw rn()}get right(){throw rn()}copy(e,t,n,r,i){return this}insert(e,t,n){return new zr(e,t)}remove(e,t){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};class Br{constructor(e){this.comparator=e,this.data=new jr(this.comparator)}has(e){return null!==this.data.get(e)}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal(((t,n)=>(e(t),!1)))}forEachInRange(e,t){const n=this.data.getIteratorFrom(e[0]);for(;n.hasNext();){const r=n.getNext();if(this.comparator(r.key,e[1])>=0)return;t(r.key)}}forEachWhile(e,t){let n;for(n=void 0!==t?this.data.getIteratorFrom(t):this.data.getIterator();n.hasNext();)if(!e(n.getNext().key))return}firstAfterOrEqual(e){const t=this.data.getIteratorFrom(e);return t.hasNext()?t.getNext().key:null}getIterator(){return new qr(this.data.getIterator())}getIteratorFrom(e){return new qr(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let t=this;return t.size<e.size&&(t=e,e=this),e.forEach((e=>{t=t.add(e)})),t}isEqual(e){if(!(e instanceof Br))return!1;if(this.size!==e.size)return!1;const t=this.data.getIterator(),n=e.data.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(0!==this.comparator(e,r))return!1}return!0}toArray(){const e=[];return this.forEach((t=>{e.push(t)})),e}toString(){const e=[];return this.forEach((t=>e.push(t))),"SortedSet("+e.toString()+")"}copy(e){const t=new Br(this.comparator);return t.data=e,t}}class qr{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}function $r(e){return e.hasNext()?e.getNext():void 0}class Kr{constructor(e){this.fields=e,e.sort(xn.comparator)}static empty(){return new Kr([])}unionWith(e){let t=new Br(xn.comparator);for(const n of this.fields)t=t.add(n);for(const n of e)t=t.add(n);return new Kr(t.toArray())}covers(e){for(const t of this.fields)if(t.isPrefixOf(e))return!0;return!1}isEqual(e){return _n(this.fields,e.fields,((e,t)=>e.isEqual(t)))}}class Gr extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}class Hr{constructor(e){this.binaryString=e}static fromBase64String(e){const t=function(e){try{return atob(e)}catch(e){throw"undefined"!=typeof DOMException&&e instanceof DOMException?new Gr("Invalid base64 string: "+e):e}}(e);return new Hr(t)}static fromUint8Array(e){const t=function(e){let t="";for(let n=0;n<e.length;++n)t+=String.fromCharCode(e[n]);return t}(e);return new Hr(t)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return e=this.binaryString,btoa(e);var e}toUint8Array(){return function(e){const t=new Uint8Array(e.length);for(let n=0;n<e.length;n++)t[n]=e.charCodeAt(n);return t}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return bn(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Hr.EMPTY_BYTE_STRING=new Hr("");const Wr=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qr(e){if(sn(!!e),"string"==typeof e){let t=0;const n=Wr.exec(e);if(sn(!!n),n[1]){let e=n[1];e=(e+"000000000").substr(0,9),t=Number(e)}const r=new Date(e);return{seconds:Math.floor(r.getTime()/1e3),nanos:t}}return{seconds:Jr(e.seconds),nanos:Jr(e.nanos)}}function Jr(e){return"number"==typeof e?e:"string"==typeof e?Number(e):0}function Yr(e){return"string"==typeof e?Hr.fromBase64String(e):Hr.fromUint8Array(e)}function Xr(e){var t,n;return"server_timestamp"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function Zr(e){const t=e.mapValue.fields.__previous_value__;return Xr(t)?Zr(t):t}function ei(e){const t=Qr(e.mapValue.fields.__local_write_time__.timestampValue);return new Sn(t.seconds,t.nanos)}class ti{constructor(e,t,n,r,i,s,o,a,l){this.databaseId=e,this.appId=t,this.persistenceKey=n,this.host=r,this.ssl=i,this.forceLongPolling=s,this.autoDetectLongPolling=o,this.longPollingOptions=a,this.useFetchStreams=l}}class ni{constructor(e,t){this.projectId=e,this.database=t||"(default)"}static empty(){return new ni("","")}get isDefaultDatabase(){return"(default)"===this.database}isEqual(e){return e instanceof ni&&e.projectId===this.projectId&&e.database===this.database}}const ri={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ii={nullValue:"NULL_VALUE"};function si(e){return"nullValue"in e?0:"booleanValue"in e?1:"integerValue"in e||"doubleValue"in e?2:"timestampValue"in e?3:"stringValue"in e?5:"bytesValue"in e?6:"referenceValue"in e?7:"geoPointValue"in e?8:"arrayValue"in e?9:"mapValue"in e?Xr(e)?4:_i(e)?9007199254740991:wi(e)?10:11:rn()}function oi(e,t){if(e===t)return!0;const n=si(e);if(n!==si(t))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return e.booleanValue===t.booleanValue;case 4:return ei(e).isEqual(ei(t));case 3:return function(e,t){if("string"==typeof e.timestampValue&&"string"==typeof t.timestampValue&&e.timestampValue.length===t.timestampValue.length)return e.timestampValue===t.timestampValue;const n=Qr(e.timestampValue),r=Qr(t.timestampValue);return n.seconds===r.seconds&&n.nanos===r.nanos}(e,t);case 5:return e.stringValue===t.stringValue;case 6:return function(e,t){return Yr(e.bytesValue).isEqual(Yr(t.bytesValue))}(e,t);case 7:return e.referenceValue===t.referenceValue;case 8:return function(e,t){return Jr(e.geoPointValue.latitude)===Jr(t.geoPointValue.latitude)&&Jr(e.geoPointValue.longitude)===Jr(t.geoPointValue.longitude)}(e,t);case 2:return function(e,t){if("integerValue"in e&&"integerValue"in t)return Jr(e.integerValue)===Jr(t.integerValue);if("doubleValue"in e&&"doubleValue"in t){const n=Jr(e.doubleValue),r=Jr(t.doubleValue);return n===r?rr(n)===rr(r):isNaN(n)&&isNaN(r)}return!1}(e,t);case 9:return _n(e.arrayValue.values||[],t.arrayValue.values||[],oi);case 10:case 11:return function(e,t){const n=e.mapValue.fields||{},r=t.mapValue.fields||{};if(Mr(n)!==Mr(r))return!1;for(const i in n)if(n.hasOwnProperty(i)&&(void 0===r[i]||!oi(n[i],r[i])))return!1;return!0}(e,t);default:return rn()}}function ai(e,t){return void 0!==(e.values||[]).find((e=>oi(e,t)))}function li(e,t){if(e===t)return 0;const n=si(e),r=si(t);if(n!==r)return bn(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return bn(e.booleanValue,t.booleanValue);case 2:return function(e,t){const n=Jr(e.integerValue||e.doubleValue),r=Jr(t.integerValue||t.doubleValue);return n<r?-1:n>r?1:n===r?0:isNaN(n)?isNaN(r)?0:-1:1}(e,t);case 3:return ui(e.timestampValue,t.timestampValue);case 4:return ui(ei(e),ei(t));case 5:return bn(e.stringValue,t.stringValue);case 6:return function(e,t){const n=Yr(e),r=Yr(t);return n.compareTo(r)}(e.bytesValue,t.bytesValue);case 7:return function(e,t){const n=e.split("/"),r=t.split("/");for(let i=0;i<n.length&&i<r.length;i++){const e=bn(n[i],r[i]);if(0!==e)return e}return bn(n.length,r.length)}(e.referenceValue,t.referenceValue);case 8:return function(e,t){const n=bn(Jr(e.latitude),Jr(t.latitude));return 0!==n?n:bn(Jr(e.longitude),Jr(t.longitude))}(e.geoPointValue,t.geoPointValue);case 9:return ci(e.arrayValue,t.arrayValue);case 10:return function(e,t){var n,r,i,s;const o=e.fields||{},a=t.fields||{},l=null===(n=o.value)||void 0===n?void 0:n.arrayValue,u=null===(r=a.value)||void 0===r?void 0:r.arrayValue,c=bn((null===(i=null==l?void 0:l.values)||void 0===i?void 0:i.length)||0,(null===(s=null==u?void 0:u.values)||void 0===s?void 0:s.length)||0);return 0!==c?c:ci(l,u)}(e.mapValue,t.mapValue);case 11:return function(e,t){if(e===ri.mapValue&&t===ri.mapValue)return 0;if(e===ri.mapValue)return 1;if(t===ri.mapValue)return-1;const n=e.fields||{},r=Object.keys(n),i=t.fields||{},s=Object.keys(i);r.sort(),s.sort();for(let o=0;o<r.length&&o<s.length;++o){const e=bn(r[o],s[o]);if(0!==e)return e;const t=li(n[r[o]],i[s[o]]);if(0!==t)return t}return bn(r.length,s.length)}(e.mapValue,t.mapValue);default:throw rn()}}function ui(e,t){if("string"==typeof e&&"string"==typeof t&&e.length===t.length)return bn(e,t);const n=Qr(e),r=Qr(t),i=bn(n.seconds,r.seconds);return 0!==i?i:bn(n.nanos,r.nanos)}function ci(e,t){const n=e.values||[],r=t.values||[];for(let i=0;i<n.length&&i<r.length;++i){const e=li(n[i],r[i]);if(e)return e}return bn(n.length,r.length)}function hi(e){return di(e)}function di(e){return"nullValue"in e?"null":"booleanValue"in e?""+e.booleanValue:"integerValue"in e?""+e.integerValue:"doubleValue"in e?""+e.doubleValue:"timestampValue"in e?function(e){const t=Qr(e);return`time(${t.seconds},${t.nanos})`}(e.timestampValue):"stringValue"in e?e.stringValue:"bytesValue"in e?function(e){return Yr(e).toBase64()}(e.bytesValue):"referenceValue"in e?function(e){return Nn.fromName(e).toString()}(e.referenceValue):"geoPointValue"in e?function(e){return`geo(${e.latitude},${e.longitude})`}(e.geoPointValue):"arrayValue"in e?function(e){let t="[",n=!0;for(const r of e.values||[])n?n=!1:t+=",",t+=di(r);return t+"]"}(e.arrayValue):"mapValue"in e?function(e){const t=Object.keys(e.fields||{}).sort();let n="{",r=!0;for(const i of t)r?r=!1:n+=",",n+=`${i}:${di(e.fields[i])}`;return n+"}"}(e.mapValue):rn()}function fi(e,t){return{referenceValue:`projects/${e.projectId}/databases/${e.database}/documents/${t.path.canonicalString()}`}}function pi(e){return!!e&&"integerValue"in e}function mi(e){return!!e&&"arrayValue"in e}function gi(e){return!!e&&"nullValue"in e}function vi(e){return!!e&&"doubleValue"in e&&isNaN(Number(e.doubleValue))}function yi(e){return!!e&&"mapValue"in e}function wi(e){var t,n;return"__vector__"===(null===(n=((null===(t=null==e?void 0:e.mapValue)||void 0===t?void 0:t.fields)||{}).__type__)||void 0===n?void 0:n.stringValue)}function bi(e){if(e.geoPointValue)return{geoPointValue:Object.assign({},e.geoPointValue)};if(e.timestampValue&&"object"==typeof e.timestampValue)return{timestampValue:Object.assign({},e.timestampValue)};if(e.mapValue){const t={mapValue:{fields:{}}};return Fr(e.mapValue.fields,((e,n)=>t.mapValue.fields[e]=bi(n))),t}if(e.arrayValue){const t={arrayValue:{values:[]}};for(let n=0;n<(e.arrayValue.values||[]).length;++n)t.arrayValue.values[n]=bi(e.arrayValue.values[n]);return t}return Object.assign({},e)}function _i(e){return"__max__"===(((e.mapValue||{}).fields||{}).__type__||{}).stringValue}const Ii={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function Si(e){return"nullValue"in e?ii:"booleanValue"in e?{booleanValue:!1}:"integerValue"in e||"doubleValue"in e?{doubleValue:NaN}:"timestampValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in e?{stringValue:""}:"bytesValue"in e?{bytesValue:""}:"referenceValue"in e?fi(ni.empty(),Nn.empty()):"geoPointValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in e?{arrayValue:{}}:"mapValue"in e?wi(e)?Ii:{mapValue:{}}:rn()}function Ei(e){return"nullValue"in e?{booleanValue:!1}:"booleanValue"in e?{doubleValue:NaN}:"integerValue"in e||"doubleValue"in e?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in e?{stringValue:""}:"stringValue"in e?{bytesValue:""}:"bytesValue"in e?fi(ni.empty(),Nn.empty()):"referenceValue"in e?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in e?{arrayValue:{}}:"arrayValue"in e?Ii:"mapValue"in e?wi(e)?{mapValue:{}}:ri:rn()}function Ti(e,t){const n=li(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?-1:!e.inclusive&&t.inclusive?1:0}function ki(e,t){const n=li(e.value,t.value);return 0!==n?n:e.inclusive&&!t.inclusive?1:!e.inclusive&&t.inclusive?-1:0}class Ci{constructor(e){this.value=e}static empty(){return new Ci({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let t=this.value;for(let n=0;n<e.length-1;++n)if(t=(t.mapValue.fields||{})[e.get(n)],!yi(t))return null;return t=(t.mapValue.fields||{})[e.lastSegment()],t||null}}set(e,t){this.getFieldsMap(e.popLast())[e.lastSegment()]=bi(t)}setAll(e){let t=xn.emptyPath(),n={},r=[];e.forEach(((e,i)=>{if(!t.isImmediateParentOf(i)){const e=this.getFieldsMap(t);this.applyChanges(e,n,r),n={},r=[],t=i.popLast()}e?n[i.lastSegment()]=bi(e):r.push(i.lastSegment())}));const i=this.getFieldsMap(t);this.applyChanges(i,n,r)}delete(e){const t=this.field(e.popLast());yi(t)&&t.mapValue.fields&&delete t.mapValue.fields[e.lastSegment()]}isEqual(e){return oi(this.value,e.value)}getFieldsMap(e){let t=this.value;t.mapValue.fields||(t.mapValue={fields:{}});for(let n=0;n<e.length;++n){let r=t.mapValue.fields[e.get(n)];yi(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},t.mapValue.fields[e.get(n)]=r),t=r}return t.mapValue.fields}applyChanges(e,t,n){Fr(t,((t,n)=>e[t]=n));for(const r of n)delete e[r]}clone(){return new Ci(bi(this.value))}}function xi(e){const t=[];return Fr(e.fields,((e,n)=>{const r=new xn([e]);if(yi(n)){const e=xi(n.mapValue).fields;if(0===e.length)t.push(r);else for(const n of e)t.push(r.child(n))}else t.push(r)})),new Kr(t)}class Ni{constructor(e,t,n,r,i,s,o){this.key=e,this.documentType=t,this.version=n,this.readTime=r,this.createTime=i,this.data=s,this.documentState=o}static newInvalidDocument(e){return new Ni(e,0,En.min(),En.min(),En.min(),Ci.empty(),0)}static newFoundDocument(e,t,n,r){return new Ni(e,1,t,En.min(),n,r,0)}static newNoDocument(e,t){return new Ni(e,2,t,En.min(),En.min(),Ci.empty(),0)}static newUnknownDocument(e,t){return new Ni(e,3,t,En.min(),En.min(),Ci.empty(),2)}convertToFoundDocument(e,t){return!this.createTime.isEqual(En.min())||2!==this.documentType&&0!==this.documentType||(this.createTime=e),this.version=e,this.documentType=1,this.data=t,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=Ci.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=Ci.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=En.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return 1===this.documentState}get hasCommittedMutations(){return 2===this.documentState}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return 0!==this.documentType}isFoundDocument(){return 1===this.documentType}isNoDocument(){return 2===this.documentType}isUnknownDocument(){return 3===this.documentType}isEqual(e){return e instanceof Ni&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Ni(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}class Ai{constructor(e,t){this.position=e,this.inclusive=t}}function Pi(e,t,n){let r=0;for(let i=0;i<e.position.length;i++){const s=t[i],o=e.position[i];if(r=s.field.isKeyField()?Nn.comparator(Nn.fromName(o.referenceValue),n.key):li(o,n.data.field(s.field)),"desc"===s.dir&&(r*=-1),0!==r)break}return r}function Ri(e,t){if(null===e)return null===t;if(null===t)return!1;if(e.inclusive!==t.inclusive||e.position.length!==t.position.length)return!1;for(let n=0;n<e.position.length;n++)if(!oi(e.position[n],t.position[n]))return!1;return!0}class Di{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc";this.field=e,this.dir=t}}function Oi(e,t){return e.dir===t.dir&&e.field.isEqual(t.field)}class Li{}class Mi extends Li{constructor(e,t,n){super(),this.field=e,this.op=t,this.value=n}static create(e,t,n){return e.isKeyField()?"in"===t||"not-in"===t?this.createKeyFieldInFilter(e,t,n):new Gi(e,t,n):"array-contains"===t?new Ji(e,n):"in"===t?new Yi(e,n):"not-in"===t?new Xi(e,n):"array-contains-any"===t?new Zi(e,n):new Mi(e,t,n)}static createKeyFieldInFilter(e,t,n){return"in"===t?new Hi(e,n):new Wi(e,n)}matches(e){const t=e.data.field(this.field);return"!="===this.op?null!==t&&this.matchesComparison(li(t,this.value)):null!==t&&si(this.value)===si(t)&&this.matchesComparison(li(t,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return 0===e;case"!=":return 0!==e;case">":return e>0;case">=":return e>=0;default:return rn()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class Fi extends Li{constructor(e,t){super(),this.filters=e,this.op=t,this.ae=null}static create(e,t){return new Fi(e,t)}matches(e){return Ui(this)?void 0===this.filters.find((t=>!t.matches(e))):void 0!==this.filters.find((t=>t.matches(e)))}getFlattenedFilters(){return null!==this.ae||(this.ae=this.filters.reduce(((e,t)=>e.concat(t.getFlattenedFilters())),[])),this.ae}getFilters(){return Object.assign([],this.filters)}}function Ui(e){return"and"===e.op}function ji(e){return"or"===e.op}function Vi(e){return zi(e)&&Ui(e)}function zi(e){for(const t of e.filters)if(t instanceof Fi)return!1;return!0}function Bi(e){if(e instanceof Mi)return e.field.canonicalString()+e.op.toString()+hi(e.value);if(Vi(e))return e.filters.map((e=>Bi(e))).join(",");{const t=e.filters.map((e=>Bi(e))).join(",");return`${e.op}(${t})`}}function qi(e,t){return e instanceof Mi?function(e,t){return t instanceof Mi&&e.op===t.op&&e.field.isEqual(t.field)&&oi(e.value,t.value)}(e,t):e instanceof Fi?function(e,t){return t instanceof Fi&&e.op===t.op&&e.filters.length===t.filters.length&&e.filters.reduce(((e,n,r)=>e&&qi(n,t.filters[r])),!0)}(e,t):void rn()}function $i(e,t){const n=e.filters.concat(t);return Fi.create(n,e.op)}function Ki(e){return e instanceof Mi?function(e){return`${e.field.canonicalString()} ${e.op} ${hi(e.value)}`}(e):e instanceof Fi?function(e){return e.op.toString()+" {"+e.getFilters().map(Ki).join(" ,")+"}"}(e):"Filter"}class Gi extends Mi{constructor(e,t,n){super(e,t,n),this.key=Nn.fromName(n.referenceValue)}matches(e){const t=Nn.comparator(e.key,this.key);return this.matchesComparison(t)}}class Hi extends Mi{constructor(e,t){super(e,"in",t),this.keys=Qi("in",t)}matches(e){return this.keys.some((t=>t.isEqual(e.key)))}}class Wi extends Mi{constructor(e,t){super(e,"not-in",t),this.keys=Qi("not-in",t)}matches(e){return!this.keys.some((t=>t.isEqual(e.key)))}}function Qi(e,t){var n;return((null===(n=t.arrayValue)||void 0===n?void 0:n.values)||[]).map((e=>Nn.fromName(e.referenceValue)))}class Ji extends Mi{constructor(e,t){super(e,"array-contains",t)}matches(e){const t=e.data.field(this.field);return mi(t)&&ai(t.arrayValue,this.value)}}class Yi extends Mi{constructor(e,t){super(e,"in",t)}matches(e){const t=e.data.field(this.field);return null!==t&&ai(this.value.arrayValue,t)}}class Xi extends Mi{constructor(e,t){super(e,"not-in",t)}matches(e){if(ai(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const t=e.data.field(this.field);return null!==t&&!ai(this.value.arrayValue,t)}}class Zi extends Mi{constructor(e,t){super(e,"array-contains-any",t)}matches(e){const t=e.data.field(this.field);return!(!mi(t)||!t.arrayValue.values)&&t.arrayValue.values.some((e=>ai(this.value.arrayValue,e)))}}class es{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null;this.path=e,this.collectionGroup=t,this.orderBy=n,this.filters=r,this.limit=i,this.startAt=s,this.endAt=o,this.ue=null}}function ts(e){return new es(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,arguments.length>5&&void 0!==arguments[5]?arguments[5]:null,arguments.length>6&&void 0!==arguments[6]?arguments[6]:null)}function ns(e){const t=on(e);if(null===t.ue){let e=t.path.canonicalString();null!==t.collectionGroup&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map((e=>Bi(e))).join(","),e+="|ob:",e+=t.orderBy.map((e=>function(e){return e.field.canonicalString()+e.dir}(e))).join(","),nr(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map((e=>hi(e))).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map((e=>hi(e))).join(",")),t.ue=e}return t.ue}function rs(e,t){if(e.limit!==t.limit)return!1;if(e.orderBy.length!==t.orderBy.length)return!1;for(let n=0;n<e.orderBy.length;n++)if(!Oi(e.orderBy[n],t.orderBy[n]))return!1;if(e.filters.length!==t.filters.length)return!1;for(let n=0;n<e.filters.length;n++)if(!qi(e.filters[n],t.filters[n]))return!1;return e.collectionGroup===t.collectionGroup&&!!e.path.isEqual(t.path)&&!!Ri(e.startAt,t.startAt)&&Ri(e.endAt,t.endAt)}function is(e){return Nn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}function ss(e,t){return e.filters.filter((e=>e instanceof Mi&&e.field.isEqual(t)))}function os(e,t,n){let r=ii,i=!0;for(const s of ss(e,t)){let e=ii,t=!0;switch(s.op){case"<":case"<=":e=Si(s.value);break;case"==":case"in":case">=":e=s.value;break;case">":e=s.value,t=!1;break;case"!=":case"not-in":e=ii}Ti({value:r,inclusive:i},{value:e,inclusive:t})<0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];Ti({value:r,inclusive:i},{value:e,inclusive:n.inclusive})<0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}function as(e,t,n){let r=ri,i=!0;for(const s of ss(e,t)){let e=ri,t=!0;switch(s.op){case">=":case">":e=Ei(s.value),t=!1;break;case"==":case"in":case"<=":e=s.value;break;case"<":e=s.value,t=!1;break;case"!=":case"not-in":e=ri}ki({value:r,inclusive:i},{value:e,inclusive:t})>0&&(r=e,i=t)}if(null!==n)for(let s=0;s<e.orderBy.length;++s)if(e.orderBy[s].field.isEqual(t)){const e=n.position[s];ki({value:r,inclusive:i},{value:e,inclusive:n.inclusive})>0&&(r=e,i=n.inclusive);break}return{value:r,inclusive:i}}class ls{constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"F",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:null,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.path=e,this.collectionGroup=t,this.explicitOrderBy=n,this.filters=r,this.limit=i,this.limitType=s,this.startAt=o,this.endAt=a,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}}function us(e,t,n,r,i,s,o,a){return new ls(e,t,n,r,i,s,o,a)}function cs(e){return new ls(e)}function hs(e){return 0===e.filters.length&&null===e.limit&&null==e.startAt&&null==e.endAt&&(0===e.explicitOrderBy.length||1===e.explicitOrderBy.length&&e.explicitOrderBy[0].field.isKeyField())}function ds(e){return null!==e.collectionGroup}function fs(e){const t=on(e);if(null===t.ce){t.ce=[];const e=new Set;for(const i of t.explicitOrderBy)t.ce.push(i),e.add(i.field.canonicalString());const n=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc",r=function(e){let t=new Br(xn.comparator);return e.filters.forEach((e=>{e.getFlattenedFilters().forEach((e=>{e.isInequality()&&(t=t.add(e.field))}))})),t}(t);r.forEach((r=>{e.has(r.canonicalString())||r.isKeyField()||t.ce.push(new Di(r,n))})),e.has(xn.keyField().canonicalString())||t.ce.push(new Di(xn.keyField(),n))}return t.ce}function ps(e){const t=on(e);return t.le||(t.le=ms(t,fs(e))),t.le}function ms(e,t){if("F"===e.limitType)return ts(e.path,e.collectionGroup,t,e.filters,e.limit,e.startAt,e.endAt);{t=t.map((e=>{const t="desc"===e.dir?"asc":"desc";return new Di(e.field,t)}));const n=e.endAt?new Ai(e.endAt.position,e.endAt.inclusive):null,r=e.startAt?new Ai(e.startAt.position,e.startAt.inclusive):null;return ts(e.path,e.collectionGroup,t,e.filters,e.limit,n,r)}}function gs(e,t){const n=e.filters.concat([t]);return new ls(e.path,e.collectionGroup,e.explicitOrderBy.slice(),n,e.limit,e.limitType,e.startAt,e.endAt)}function vs(e,t,n){return new ls(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),t,n,e.startAt,e.endAt)}function ys(e,t){return rs(ps(e),ps(t))&&e.limitType===t.limitType}function ws(e){return`${ns(ps(e))}|lt:${e.limitType}`}function bs(e){return`Query(target=${function(e){let t=e.path.canonicalString();return null!==e.collectionGroup&&(t+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(t+=`, filters: [${e.filters.map((e=>Ki(e))).join(", ")}]`),nr(e.limit)||(t+=", limit: "+e.limit),e.orderBy.length>0&&(t+=`, orderBy: [${e.orderBy.map((e=>function(e){return`${e.field.canonicalString()} (${e.dir})`}(e))).join(", ")}]`),e.startAt&&(t+=", startAt: ",t+=e.startAt.inclusive?"b:":"a:",t+=e.startAt.position.map((e=>hi(e))).join(",")),e.endAt&&(t+=", endAt: ",t+=e.endAt.inclusive?"a:":"b:",t+=e.endAt.position.map((e=>hi(e))).join(",")),`Target(${t})`}(ps(e))}; limitType=${e.limitType})`}function _s(e,t){return t.isFoundDocument()&&function(e,t){const n=t.key.path;return null!==e.collectionGroup?t.key.hasCollectionId(e.collectionGroup)&&e.path.isPrefixOf(n):Nn.isDocumentKey(e.path)?e.path.isEqual(n):e.path.isImmediateParentOf(n)}(e,t)&&function(e,t){for(const n of fs(e))if(!n.field.isKeyField()&&null===t.data.field(n.field))return!1;return!0}(e,t)&&function(e,t){for(const n of e.filters)if(!n.matches(t))return!1;return!0}(e,t)&&function(e,t){return!(e.startAt&&!function(e,t,n){const r=Pi(e,t,n);return e.inclusive?r<=0:r<0}(e.startAt,fs(e),t))&&!(e.endAt&&!function(e,t,n){const r=Pi(e,t,n);return e.inclusive?r>=0:r>0}(e.endAt,fs(e),t))}(e,t)}function Is(e){return e.collectionGroup||(e.path.length%2==1?e.path.lastSegment():e.path.get(e.path.length-2))}function Ss(e){return(t,n)=>{let r=!1;for(const i of fs(e)){const e=Es(i,t,n);if(0!==e)return e;r=r||i.field.isKeyField()}return 0}}function Es(e,t,n){const r=e.field.isKeyField()?Nn.comparator(t.key,n.key):function(e,t,n){const r=t.data.field(e),i=n.data.field(e);return null!==r&&null!==i?li(r,i):rn()}(e.field,t,n);switch(e.dir){case"asc":return r;case"desc":return-1*r;default:return rn()}}class Ts{constructor(e,t){this.mapKeyFn=e,this.equalsFn=t,this.inner={},this.innerSize=0}get(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0!==n)for(const[r,i]of n)if(this.equalsFn(r,e))return i}has(e){return void 0!==this.get(e)}set(e,t){const n=this.mapKeyFn(e),r=this.inner[n];if(void 0===r)return this.inner[n]=[[e,t]],void this.innerSize++;for(let i=0;i<r.length;i++)if(this.equalsFn(r[i][0],e))return void(r[i]=[e,t]);r.push([e,t]),this.innerSize++}delete(e){const t=this.mapKeyFn(e),n=this.inner[t];if(void 0===n)return!1;for(let r=0;r<n.length;r++)if(this.equalsFn(n[r][0],e))return 1===n.length?delete this.inner[t]:n.splice(r,1),this.innerSize--,!0;return!1}forEach(e){Fr(this.inner,((t,n)=>{for(const[r,i]of n)e(r,i)}))}isEmpty(){return Ur(this.inner)}size(){return this.innerSize}}const ks=new jr(Nn.comparator);function Cs(){return ks}const xs=new jr(Nn.comparator);function Ns(){let e=xs;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.insert(i.key,i);return e}function As(e){let t=xs;return e.forEach(((e,n)=>t=t.insert(e,n.overlayedDocument))),t}function Ps(){return Ds()}function Rs(){return Ds()}function Ds(){return new Ts((e=>e.toString()),((e,t)=>e.isEqual(t)))}const Os=new jr(Nn.comparator),Ls=new Br(Nn.comparator);function Ms(){let e=Ls;for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(const i of n)e=e.add(i);return e}const Fs=new Br(bn);function Us(){return Fs}function js(e,t){if(e.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:rr(t)?"-0":t}}function Vs(e){return{integerValue:""+e}}function zs(e,t){return ir(t)?Vs(t):js(e,t)}class Bs{constructor(){this._=void 0}}function qs(e,t,n){return e instanceof Gs?function(e,t){const n={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:e.seconds,nanos:e.nanoseconds}}}};return t&&Xr(t)&&(t=Zr(t)),t&&(n.fields.__previous_value__=t),{mapValue:n}}(n,t):e instanceof Hs?Ws(e,t):e instanceof Qs?Js(e,t):function(e,t){const n=Ks(e,t),r=Xs(n)+Xs(e.Pe);return pi(n)&&pi(e.Pe)?Vs(r):js(e.serializer,r)}(e,t)}function $s(e,t,n){return e instanceof Hs?Ws(e,t):e instanceof Qs?Js(e,t):n}function Ks(e,t){return e instanceof Ys?function(e){return pi(e)||function(e){return!!e&&"doubleValue"in e}(e)}(t)?t:{integerValue:0}:null}class Gs extends Bs{}class Hs extends Bs{constructor(e){super(),this.elements=e}}function Ws(e,t){const n=Zs(t);for(const r of e.elements)n.some((e=>oi(e,r)))||n.push(r);return{arrayValue:{values:n}}}class Qs extends Bs{constructor(e){super(),this.elements=e}}function Js(e,t){let n=Zs(t);for(const r of e.elements)n=n.filter((e=>!oi(e,r)));return{arrayValue:{values:n}}}class Ys extends Bs{constructor(e,t){super(),this.serializer=e,this.Pe=t}}function Xs(e){return Jr(e.integerValue||e.doubleValue)}function Zs(e){return mi(e)&&e.arrayValue.values?e.arrayValue.values.slice():[]}class eo{constructor(e,t){this.field=e,this.transform=t}}class to{constructor(e,t){this.version=e,this.transformResults=t}}class no{constructor(e,t){this.updateTime=e,this.exists=t}static none(){return new no}static exists(e){return new no(void 0,e)}static updateTime(e){return new no(e)}get isNone(){return void 0===this.updateTime&&void 0===this.exists}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function ro(e,t){return void 0!==e.updateTime?t.isFoundDocument()&&t.version.isEqual(e.updateTime):void 0===e.exists||e.exists===t.isFoundDocument()}class io{}function so(e,t){if(!e.hasLocalMutations||t&&0===t.fields.length)return null;if(null===t)return e.isNoDocument()?new go(e.key,no.none()):new co(e.key,e.data,no.none());{const n=e.data,r=Ci.empty();let i=new Br(xn.comparator);for(let e of t.fields)if(!i.has(e)){let t=n.field(e);null===t&&e.length>1&&(e=e.popLast(),t=n.field(e)),null===t?r.delete(e):r.set(e,t),i=i.add(e)}return new ho(e.key,r,new Kr(i.toArray()),no.none())}}function oo(e,t,n){e instanceof co?function(e,t,n){const r=e.value.clone(),i=po(e.fieldTransforms,t,n.transformResults);r.setAll(i),t.convertToFoundDocument(n.version,r).setHasCommittedMutations()}(e,t,n):e instanceof ho?function(e,t,n){if(!ro(e.precondition,t))return void t.convertToUnknownDocument(n.version);const r=po(e.fieldTransforms,t,n.transformResults),i=t.data;i.setAll(fo(e)),i.setAll(r),t.convertToFoundDocument(n.version,i).setHasCommittedMutations()}(e,t,n):function(e,t,n){t.convertToNoDocument(n.version).setHasCommittedMutations()}(0,t,n)}function ao(e,t,n,r){return e instanceof co?function(e,t,n,r){if(!ro(e.precondition,t))return n;const i=e.value.clone(),s=mo(e.fieldTransforms,r,t);return i.setAll(s),t.convertToFoundDocument(t.version,i).setHasLocalMutations(),null}(e,t,n,r):e instanceof ho?function(e,t,n,r){if(!ro(e.precondition,t))return n;const i=mo(e.fieldTransforms,r,t),s=t.data;return s.setAll(fo(e)),s.setAll(i),t.convertToFoundDocument(t.version,s).setHasLocalMutations(),null===n?null:n.unionWith(e.fieldMask.fields).unionWith(e.fieldTransforms.map((e=>e.field)))}(e,t,n,r):function(e,t,n){return ro(e.precondition,t)?(t.convertToNoDocument(t.version).setHasLocalMutations(),null):n}(e,t,n)}function lo(e,t){let n=null;for(const r of e.fieldTransforms){const e=t.data.field(r.field),i=Ks(r.transform,e||null);null!=i&&(null===n&&(n=Ci.empty()),n.set(r.field,i))}return n||null}function uo(e,t){return e.type===t.type&&!!e.key.isEqual(t.key)&&!!e.precondition.isEqual(t.precondition)&&!!function(e,t){return void 0===e&&void 0===t||!(!e||!t)&&_n(e,t,((e,t)=>function(e,t){return e.field.isEqual(t.field)&&function(e,t){return e instanceof Hs&&t instanceof Hs||e instanceof Qs&&t instanceof Qs?_n(e.elements,t.elements,oi):e instanceof Ys&&t instanceof Ys?oi(e.Pe,t.Pe):e instanceof Gs&&t instanceof Gs}(e.transform,t.transform)}(e,t)))}(e.fieldTransforms,t.fieldTransforms)&&(0===e.type?e.value.isEqual(t.value):1!==e.type||e.data.isEqual(t.data)&&e.fieldMask.isEqual(t.fieldMask))}class co extends io{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];super(),this.key=e,this.value=t,this.precondition=n,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}}class ho extends io{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:[];super(),this.key=e,this.data=t,this.fieldMask=n,this.precondition=r,this.fieldTransforms=i,this.type=1}getFieldMask(){return this.fieldMask}}function fo(e){const t=new Map;return e.fieldMask.fields.forEach((n=>{if(!n.isEmpty()){const r=e.data.field(n);t.set(n,r)}})),t}function po(e,t,n){const r=new Map;sn(e.length===n.length);for(let i=0;i<n.length;i++){const s=e[i],o=s.transform,a=t.data.field(s.field);r.set(s.field,$s(o,a,n[i]))}return r}function mo(e,t,n){const r=new Map;for(const i of e){const e=i.transform,s=n.data.field(i.field);r.set(i.field,qs(e,s,t))}return r}class go extends io{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class vo extends io{constructor(e,t){super(),this.key=e,this.precondition=t,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}class yo{constructor(e,t,n,r){this.batchId=e,this.localWriteTime=t,this.baseMutations=n,this.mutations=r}applyToRemoteDocument(e,t){const n=t.mutationResults;for(let r=0;r<this.mutations.length;r++){const t=this.mutations[r];t.key.isEqual(e.key)&&oo(t,e,n[r])}}applyToLocalView(e,t){for(const n of this.baseMutations)n.key.isEqual(e.key)&&(t=ao(n,e,t,this.localWriteTime));for(const n of this.mutations)n.key.isEqual(e.key)&&(t=ao(n,e,t,this.localWriteTime));return t}applyToLocalDocumentSet(e,t){const n=Rs();return this.mutations.forEach((r=>{const i=e.get(r.key),s=i.overlayedDocument;let o=this.applyToLocalView(s,i.mutatedFields);o=t.has(r.key)?null:o;const a=so(s,o);null!==a&&n.set(r.key,a),s.isValidDocument()||s.convertToNoDocument(En.min())})),n}keys(){return this.mutations.reduce(((e,t)=>e.add(t.key)),Ms())}isEqual(e){return this.batchId===e.batchId&&_n(this.mutations,e.mutations,((e,t)=>uo(e,t)))&&_n(this.baseMutations,e.baseMutations,((e,t)=>uo(e,t)))}}class wo{constructor(e,t,n,r){this.batch=e,this.commitVersion=t,this.mutationResults=n,this.docVersions=r}static from(e,t,n){sn(e.mutations.length===n.length);let r=Os;const i=e.mutations;for(let s=0;s<i.length;s++)r=r.insert(i[s].key,n[s].version);return new wo(e,t,n,r)}}class bo{constructor(e,t){this.largestBatchId=e,this.mutation=t}getKey(){return this.mutation.key}isEqual(e){return null!==e&&this.mutation===e.mutation}toString(){return`Overlay{\n      largestBatchId: ${this.largestBatchId},\n      mutation: ${this.mutation.toString()}\n    }`}}class _o{constructor(e,t){this.count=e,this.unchangedNames=t}}var Io,So;function Eo(e){switch(e){default:return rn();case an.CANCELLED:case an.UNKNOWN:case an.DEADLINE_EXCEEDED:case an.RESOURCE_EXHAUSTED:case an.INTERNAL:case an.UNAVAILABLE:case an.UNAUTHENTICATED:return!1;case an.INVALID_ARGUMENT:case an.NOT_FOUND:case an.ALREADY_EXISTS:case an.PERMISSION_DENIED:case an.FAILED_PRECONDITION:case an.ABORTED:case an.OUT_OF_RANGE:case an.UNIMPLEMENTED:case an.DATA_LOSS:return!0}}function To(e){if(void 0===e)return en("GRPC error has no .code"),an.UNKNOWN;switch(e){case Io.OK:return an.OK;case Io.CANCELLED:return an.CANCELLED;case Io.UNKNOWN:return an.UNKNOWN;case Io.DEADLINE_EXCEEDED:return an.DEADLINE_EXCEEDED;case Io.RESOURCE_EXHAUSTED:return an.RESOURCE_EXHAUSTED;case Io.INTERNAL:return an.INTERNAL;case Io.UNAVAILABLE:return an.UNAVAILABLE;case Io.UNAUTHENTICATED:return an.UNAUTHENTICATED;case Io.INVALID_ARGUMENT:return an.INVALID_ARGUMENT;case Io.NOT_FOUND:return an.NOT_FOUND;case Io.ALREADY_EXISTS:return an.ALREADY_EXISTS;case Io.PERMISSION_DENIED:return an.PERMISSION_DENIED;case Io.FAILED_PRECONDITION:return an.FAILED_PRECONDITION;case Io.ABORTED:return an.ABORTED;case Io.OUT_OF_RANGE:return an.OUT_OF_RANGE;case Io.UNIMPLEMENTED:return an.UNIMPLEMENTED;case Io.DATA_LOSS:return an.DATA_LOSS;default:return rn()}}(So=Io||(Io={}))[So.OK=0]="OK",So[So.CANCELLED=1]="CANCELLED",So[So.UNKNOWN=2]="UNKNOWN",So[So.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",So[So.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",So[So.NOT_FOUND=5]="NOT_FOUND",So[So.ALREADY_EXISTS=6]="ALREADY_EXISTS",So[So.PERMISSION_DENIED=7]="PERMISSION_DENIED",So[So.UNAUTHENTICATED=16]="UNAUTHENTICATED",So[So.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",So[So.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",So[So.ABORTED=10]="ABORTED",So[So.OUT_OF_RANGE=11]="OUT_OF_RANGE",So[So.UNIMPLEMENTED=12]="UNIMPLEMENTED",So[So.INTERNAL=13]="INTERNAL",So[So.UNAVAILABLE=14]="UNAVAILABLE",So[So.DATA_LOSS=15]="DATA_LOSS";let ko=null;function Co(){return new TextEncoder}const xo=new Ot([4294967295,4294967295],0);function No(e){const t=Co().encode(e),n=new Lt;return n.update(t),new Uint8Array(n.digest())}function Ao(e){const t=new DataView(e.buffer),n=t.getUint32(0,!0),r=t.getUint32(4,!0),i=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Ot([n,r],0),new Ot([i,s],0)]}class Po{constructor(e,t,n){if(this.bitmap=e,this.padding=t,this.hashCount=n,t<0||t>=8)throw new Ro(`Invalid padding: ${t}`);if(n<0)throw new Ro(`Invalid hash count: ${n}`);if(e.length>0&&0===this.hashCount)throw new Ro(`Invalid hash count: ${n}`);if(0===e.length&&0!==t)throw new Ro(`Invalid padding when bitmap length is 0: ${t}`);this.Ie=8*e.length-t,this.Te=Ot.fromNumber(this.Ie)}Ee(e,t,n){let r=e.add(t.multiply(Ot.fromNumber(n)));return 1===r.compare(xo)&&(r=new Ot([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(e){return 0!=(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(0===this.Ie)return!1;const t=No(e),[n,r]=Ao(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);if(!this.de(e))return!1}return!0}static create(e,t,n){const r=e%8==0?0:8-e%8,i=new Uint8Array(Math.ceil(e/8)),s=new Po(i,r,t);return n.forEach((e=>s.insert(e))),s}insert(e){if(0===this.Ie)return;const t=No(e),[n,r]=Ao(t);for(let i=0;i<this.hashCount;i++){const e=this.Ee(n,r,i);this.Ae(e)}}Ae(e){const t=Math.floor(e/8),n=e%8;this.bitmap[t]|=1<<n}}class Ro extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}class Do{constructor(e,t,n,r,i){this.snapshotVersion=e,this.targetChanges=t,this.targetMismatches=n,this.documentUpdates=r,this.resolvedLimboDocuments=i}static createSynthesizedRemoteEventForCurrentChange(e,t,n){const r=new Map;return r.set(e,Oo.createSynthesizedTargetChangeForCurrentChange(e,t,n)),new Do(En.min(),r,new jr(bn),Cs(),Ms())}}class Oo{constructor(e,t,n,r,i){this.resumeToken=e,this.current=t,this.addedDocuments=n,this.modifiedDocuments=r,this.removedDocuments=i}static createSynthesizedTargetChangeForCurrentChange(e,t,n){return new Oo(n,t,Ms(),Ms(),Ms())}}class Lo{constructor(e,t,n,r){this.Re=e,this.removedTargetIds=t,this.key=n,this.Ve=r}}class Mo{constructor(e,t){this.targetId=e,this.me=t}}class Fo{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Hr.EMPTY_BYTE_STRING,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;this.state=e,this.targetIds=t,this.resumeToken=n,this.cause=r}}class Uo{constructor(){this.fe=0,this.ge=zo(),this.pe=Hr.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return 0!==this.fe}get be(){return this.we}De(e){e.approximateByteSize()>0&&(this.we=!0,this.pe=e)}ve(){let e=Ms(),t=Ms(),n=Ms();return this.ge.forEach(((r,i)=>{switch(i){case 0:e=e.add(r);break;case 2:t=t.add(r);break;case 1:n=n.add(r);break;default:rn()}})),new Oo(this.pe,this.ye,e,t,n)}Ce(){this.we=!1,this.ge=zo()}Fe(e,t){this.we=!0,this.ge=this.ge.insert(e,t)}Me(e){this.we=!0,this.ge=this.ge.remove(e)}xe(){this.fe+=1}Oe(){this.fe-=1,sn(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}}class jo{constructor(e){this.Le=e,this.Be=new Map,this.ke=Cs(),this.qe=Vo(),this.Qe=new jr(bn)}Ke(e){for(const t of e.Re)e.Ve&&e.Ve.isFoundDocument()?this.$e(t,e.Ve):this.Ue(t,e.key,e.Ve);for(const t of e.removedTargetIds)this.Ue(t,e.key,e.Ve)}We(e){this.forEachTarget(e,(t=>{const n=this.Ge(t);switch(e.state){case 0:this.ze(t)&&n.De(e.resumeToken);break;case 1:n.Oe(),n.Se||n.Ce(),n.De(e.resumeToken);break;case 2:n.Oe(),n.Se||this.removeTarget(t);break;case 3:this.ze(t)&&(n.Ne(),n.De(e.resumeToken));break;case 4:this.ze(t)&&(this.je(t),n.De(e.resumeToken));break;default:rn()}}))}forEachTarget(e,t){e.targetIds.length>0?e.targetIds.forEach(t):this.Be.forEach(((e,n)=>{this.ze(n)&&t(n)}))}He(e){const t=e.targetId,n=e.me.count,r=this.Je(t);if(r){const i=r.target;if(is(i))if(0===n){const e=new Nn(i.path);this.Ue(t,e,Ni.newNoDocument(e,En.min()))}else sn(1===n);else{const r=this.Ye(t);if(r!==n){const n=this.Ze(e),i=n?this.Xe(n,e,r):1;if(0!==i){this.je(t);const e=2===i?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(t,e)}null==ko||ko.et(function(e,t,n,r,i){var s,o,a,l,u,c;const h={localCacheCount:e,existenceFilterCount:t.count,databaseId:n.database,projectId:n.projectId},d=t.unchangedNames;return d&&(h.bloomFilter={applied:0===i,hashCount:null!==(s=null==d?void 0:d.hashCount)&&void 0!==s?s:0,bitmapLength:null!==(l=null===(a=null===(o=null==d?void 0:d.bits)||void 0===o?void 0:o.bitmap)||void 0===a?void 0:a.length)&&void 0!==l?l:0,padding:null!==(c=null===(u=null==d?void 0:d.bits)||void 0===u?void 0:u.padding)&&void 0!==c?c:0,mightContain:e=>{var t;return null!==(t=null==r?void 0:r.mightContain(e))&&void 0!==t&&t}}),h}(r,e.me,this.Le.tt(),n,i))}}}}Ze(e){const t=e.me.unchangedNames;if(!t||!t.bits)return null;const{bits:{bitmap:n="",padding:r=0},hashCount:i=0}=t;let s,o;try{s=Yr(n).toUint8Array()}catch(e){if(e instanceof Gr)return tn("Decoding the base64 bloom filter in existence filter failed ("+e.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw e}try{o=new Po(s,r,i)}catch(e){return tn(e instanceof Ro?"BloomFilter error: ":"Applying bloom filter failed: ",e),null}return 0===o.Ie?null:o}Xe(e,t,n){return t.me.count===n-this.nt(e,t.targetId)?0:2}nt(e,t){const n=this.Le.getRemoteKeysForTarget(t);let r=0;return n.forEach((n=>{const i=this.Le.tt(),s=`projects/${i.projectId}/databases/${i.database}/documents/${n.path.canonicalString()}`;e.mightContain(s)||(this.Ue(t,n,null),r++)})),r}rt(e){const t=new Map;this.Be.forEach(((n,r)=>{const i=this.Je(r);if(i){if(n.current&&is(i.target)){const t=new Nn(i.target.path);null!==this.ke.get(t)||this.it(r,t)||this.Ue(r,t,Ni.newNoDocument(t,e))}n.be&&(t.set(r,n.ve()),n.Ce())}}));let n=Ms();this.qe.forEach(((e,t)=>{let r=!0;t.forEachWhile((e=>{const t=this.Je(e);return!t||"TargetPurposeLimboResolution"===t.purpose||(r=!1,!1)})),r&&(n=n.add(e))})),this.ke.forEach(((t,n)=>n.setReadTime(e)));const r=new Do(e,t,this.Qe,this.ke,n);return this.ke=Cs(),this.qe=Vo(),this.Qe=new jr(bn),r}$e(e,t){if(!this.ze(e))return;const n=this.it(e,t.key)?2:0;this.Ge(e).Fe(t.key,n),this.ke=this.ke.insert(t.key,t),this.qe=this.qe.insert(t.key,this.st(t.key).add(e))}Ue(e,t,n){if(!this.ze(e))return;const r=this.Ge(e);this.it(e,t)?r.Fe(t,1):r.Me(t),this.qe=this.qe.insert(t,this.st(t).delete(e)),n&&(this.ke=this.ke.insert(t,n))}removeTarget(e){this.Be.delete(e)}Ye(e){const t=this.Ge(e).ve();return this.Le.getRemoteKeysForTarget(e).size+t.addedDocuments.size-t.removedDocuments.size}xe(e){this.Ge(e).xe()}Ge(e){let t=this.Be.get(e);return t||(t=new Uo,this.Be.set(e,t)),t}st(e){let t=this.qe.get(e);return t||(t=new Br(bn),this.qe=this.qe.insert(e,t)),t}ze(e){const t=null!==this.Je(e);return t||Zt("WatchChangeAggregator","Detected inactive target",e),t}Je(e){const t=this.Be.get(e);return t&&t.Se?null:this.Le.ot(e)}je(e){this.Be.set(e,new Uo),this.Le.getRemoteKeysForTarget(e).forEach((t=>{this.Ue(e,t,null)}))}it(e,t){return this.Le.getRemoteKeysForTarget(e).has(t)}}function Vo(){return new jr(Nn.comparator)}function zo(){return new jr(Nn.comparator)}const Bo={asc:"ASCENDING",desc:"DESCENDING"},qo={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},$o={and:"AND",or:"OR"};class Ko{constructor(e,t){this.databaseId=e,this.useProto3Json=t}}function Go(e,t){return e.useProto3Json||nr(t)?t:{value:t}}function Ho(e,t){return e.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Wo(e,t){return e.useProto3Json?t.toBase64():t.toUint8Array()}function Qo(e,t){return Ho(e,t.toTimestamp())}function Jo(e){return sn(!!e),En.fromTimestamp(function(e){const t=Qr(e);return new Sn(t.seconds,t.nanos)}(e))}function Yo(e,t){return Xo(e,t).canonicalString()}function Xo(e,t){const n=function(e){return new kn(["projects",e.projectId,"databases",e.database])}(e).child("documents");return void 0===t?n:n.child(t)}function Zo(e){const t=kn.fromString(e);return sn(_a(t)),t}function ea(e,t){return Yo(e.databaseId,t.path)}function ta(e,t){const n=Zo(t);if(n.get(1)!==e.databaseId.projectId)throw new ln(an.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+e.databaseId.projectId);if(n.get(3)!==e.databaseId.database)throw new ln(an.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+e.databaseId.database);return new Nn(sa(n))}function na(e,t){return Yo(e.databaseId,t)}function ra(e){const t=Zo(e);return 4===t.length?kn.emptyPath():sa(t)}function ia(e){return new kn(["projects",e.databaseId.projectId,"databases",e.databaseId.database]).canonicalString()}function sa(e){return sn(e.length>4&&"documents"===e.get(4)),e.popFirst(5)}function oa(e,t,n){return{name:ea(e,t),fields:n.value.mapValue.fields}}function aa(e,t,n){const r=ta(e,t.name),i=Jo(t.updateTime),s=t.createTime?Jo(t.createTime):En.min(),o=new Ci({mapValue:{fields:t.fields}}),a=Ni.newFoundDocument(r,i,s,o);return n&&a.setHasCommittedMutations(),n?a.setHasCommittedMutations():a}function la(e,t){let n;if(t instanceof co)n={update:oa(e,t.key,t.value)};else if(t instanceof go)n={delete:ea(e,t.key)};else if(t instanceof ho)n={update:oa(e,t.key,t.data),updateMask:ba(t.fieldMask)};else{if(!(t instanceof vo))return rn();n={verify:ea(e,t.key)}}return t.fieldTransforms.length>0&&(n.updateTransforms=t.fieldTransforms.map((e=>function(e,t){const n=t.transform;if(n instanceof Gs)return{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(n instanceof Hs)return{fieldPath:t.field.canonicalString(),appendMissingElements:{values:n.elements}};if(n instanceof Qs)return{fieldPath:t.field.canonicalString(),removeAllFromArray:{values:n.elements}};if(n instanceof Ys)return{fieldPath:t.field.canonicalString(),increment:n.Pe};throw rn()}(0,e)))),t.precondition.isNone||(n.currentDocument=function(e,t){return void 0!==t.updateTime?{updateTime:Qo(e,t.updateTime)}:void 0!==t.exists?{exists:t.exists}:rn()}(e,t.precondition)),n}function ua(e,t){const n=t.currentDocument?function(e){return void 0!==e.updateTime?no.updateTime(Jo(e.updateTime)):void 0!==e.exists?no.exists(e.exists):no.none()}(t.currentDocument):no.none(),r=t.updateTransforms?t.updateTransforms.map((t=>function(e,t){let n=null;if("setToServerValue"in t)sn("REQUEST_TIME"===t.setToServerValue),n=new Gs;else if("appendMissingElements"in t){const e=t.appendMissingElements.values||[];n=new Hs(e)}else if("removeAllFromArray"in t){const e=t.removeAllFromArray.values||[];n=new Qs(e)}else"increment"in t?n=new Ys(e,t.increment):rn();const r=xn.fromServerFormat(t.fieldPath);return new eo(r,n)}(e,t))):[];if(t.update){t.update.name;const i=ta(e,t.update.name),s=new Ci({mapValue:{fields:t.update.fields}});if(t.updateMask){const e=function(e){const t=e.fieldPaths||[];return new Kr(t.map((e=>xn.fromServerFormat(e))))}(t.updateMask);return new ho(i,s,e,n,r)}return new co(i,s,n,r)}if(t.delete){const r=ta(e,t.delete);return new go(r,n)}if(t.verify){const r=ta(e,t.verify);return new vo(r,n)}return rn()}function ca(e,t){return{documents:[na(e,t.path)]}}function ha(e,t){const n={structuredQuery:{}},r=t.path;let i;null!==t.collectionGroup?(i=r,n.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(i=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=na(e,i);const s=function(e){if(0!==e.length)return wa(Fi.create(e,"and"))}(t.filters);s&&(n.structuredQuery.where=s);const o=function(e){if(0!==e.length)return e.map((e=>function(e){return{field:va(e.field),direction:pa(e.dir)}}(e)))}(t.orderBy);o&&(n.structuredQuery.orderBy=o);const a=Go(e,t.limit);return null!==a&&(n.structuredQuery.limit=a),t.startAt&&(n.structuredQuery.startAt=function(e){return{before:e.inclusive,values:e.position}}(t.startAt)),t.endAt&&(n.structuredQuery.endAt=function(e){return{before:!e.inclusive,values:e.position}}(t.endAt)),{_t:n,parent:i}}function da(e){let t=ra(e.parent);const n=e.structuredQuery,r=n.from?n.from.length:0;let i=null;if(r>0){sn(1===r);const e=n.from[0];e.allDescendants?i=e.collectionId:t=t.child(e.collectionId)}let s=[];n.where&&(s=function(e){const t=fa(e);return t instanceof Fi&&Vi(t)?t.getFilters():[t]}(n.where));let o=[];n.orderBy&&(o=function(e){return e.map((e=>function(e){return new Di(ya(e.field),function(e){switch(e){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(e.direction))}(e)))}(n.orderBy));let a=null;n.limit&&(a=function(e){let t;return t="object"==typeof e?e.value:e,nr(t)?null:t}(n.limit));let l=null;n.startAt&&(l=function(e){const t=!!e.before,n=e.values||[];return new Ai(n,t)}(n.startAt));let u=null;return n.endAt&&(u=function(e){const t=!e.before,n=e.values||[];return new Ai(n,t)}(n.endAt)),us(t,i,o,s,a,"F",l,u)}function fa(e){return void 0!==e.unaryFilter?function(e){switch(e.unaryFilter.op){case"IS_NAN":const t=ya(e.unaryFilter.field);return Mi.create(t,"==",{doubleValue:NaN});case"IS_NULL":const n=ya(e.unaryFilter.field);return Mi.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const r=ya(e.unaryFilter.field);return Mi.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const i=ya(e.unaryFilter.field);return Mi.create(i,"!=",{nullValue:"NULL_VALUE"});default:return rn()}}(e):void 0!==e.fieldFilter?function(e){return Mi.create(ya(e.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return rn()}}(e.fieldFilter.op),e.fieldFilter.value)}(e):void 0!==e.compositeFilter?function(e){return Fi.create(e.compositeFilter.filters.map((e=>fa(e))),function(e){switch(e){case"AND":return"and";case"OR":return"or";default:return rn()}}(e.compositeFilter.op))}(e):rn()}function pa(e){return Bo[e]}function ma(e){return qo[e]}function ga(e){return $o[e]}function va(e){return{fieldPath:e.canonicalString()}}function ya(e){return xn.fromServerFormat(e.fieldPath)}function wa(e){return e instanceof Mi?function(e){if("=="===e.op){if(vi(e.value))return{unaryFilter:{field:va(e.field),op:"IS_NAN"}};if(gi(e.value))return{unaryFilter:{field:va(e.field),op:"IS_NULL"}}}else if("!="===e.op){if(vi(e.value))return{unaryFilter:{field:va(e.field),op:"IS_NOT_NAN"}};if(gi(e.value))return{unaryFilter:{field:va(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:va(e.field),op:ma(e.op),value:e.value}}}(e):e instanceof Fi?function(e){const t=e.getFilters().map((e=>wa(e)));return 1===t.length?t[0]:{compositeFilter:{op:ga(e.op),filters:t}}}(e):rn()}function ba(e){const t=[];return e.fields.forEach((e=>t.push(e.canonicalString()))),{fieldPaths:t}}function _a(e){return e.length>=4&&"projects"===e.get(0)&&"databases"===e.get(2)}class Ia{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:En.min(),s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:En.min(),o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:Hr.EMPTY_BYTE_STRING,a=arguments.length>7&&void 0!==arguments[7]?arguments[7]:null;this.target=e,this.targetId=t,this.purpose=n,this.sequenceNumber=r,this.snapshotVersion=i,this.lastLimboFreeSnapshotVersion=s,this.resumeToken=o,this.expectedCount=a}withSequenceNumber(e){return new Ia(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,t){return new Ia(this.target,this.targetId,this.purpose,this.sequenceNumber,t,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Ia(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}class Sa{constructor(e){this.ct=e}}function Ea(e,t){const n=t.key,r={prefixPath:n.getCollectionPath().popLast().toArray(),collectionGroup:n.collectionGroup,documentId:n.path.lastSegment(),readTime:Ta(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())r.document=function(e,t){return{name:ea(e,t.key),fields:t.data.value.mapValue.fields,updateTime:Ho(e,t.version.toTimestamp()),createTime:Ho(e,t.createTime.toTimestamp())}}(e.ct,t);else if(t.isNoDocument())r.noDocument={path:n.path.toArray(),readTime:ka(t.version)};else{if(!t.isUnknownDocument())return rn();r.unknownDocument={path:n.path.toArray(),version:ka(t.version)}}return r}function Ta(e){const t=e.toTimestamp();return[t.seconds,t.nanoseconds]}function ka(e){const t=e.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function Ca(e){const t=new Sn(e.seconds,e.nanoseconds);return En.fromTimestamp(t)}function xa(e,t){const n=(t.baseMutations||[]).map((t=>ua(e.ct,t)));for(let s=0;s<t.mutations.length-1;++s){const e=t.mutations[s];if(s+1<t.mutations.length&&void 0!==t.mutations[s+1].transform){const n=t.mutations[s+1];e.updateTransforms=n.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}const r=t.mutations.map((t=>ua(e.ct,t))),i=Sn.fromMillis(t.localWriteTimeMs);return new yo(t.batchId,i,n,r)}function Na(e){const t=Ca(e.readTime),n=void 0!==e.lastLimboFreeSnapshotVersion?Ca(e.lastLimboFreeSnapshotVersion):En.min();let r;return r=function(e){return void 0!==e.documents}(e.query)?function(e){return sn(1===e.documents.length),ps(cs(ra(e.documents[0])))}(e.query):function(e){return ps(da(e))}(e.query),new Ia(r,e.targetId,"TargetPurposeListen",e.lastListenSequenceNumber,t,n,Hr.fromBase64String(e.resumeToken))}function Aa(e,t){const n=ka(t.snapshotVersion),r=ka(t.lastLimboFreeSnapshotVersion);let i;i=is(t.target)?ca(e.ct,t.target):ha(e.ct,t.target)._t;const s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:ns(t.target),readTime:n,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:r,query:i}}function Pa(e){const t=da({parent:e.parent,structuredQuery:e.structuredQuery});return"LAST"===e.limitType?vs(t,t.limit,"L"):t}function Ra(e,t){return new bo(t.largestBatchId,ua(e.ct,t.overlayMutation))}function Da(e,t){const n=t.path.lastSegment();return[e,sr(t.path.popLast()),n]}function Oa(e,t,n,r){return{indexId:e,uid:t,sequenceNumber:n,readTime:ka(r.readTime),documentKey:sr(r.documentKey.path),largestBatchId:r.largestBatchId}}class La{getBundleMetadata(e,t){return Ma(e).get(t).next((e=>{if(e)return function(e){return{id:e.bundleId,createTime:Ca(e.createTime),version:e.version}}(e)}))}saveBundleMetadata(e,t){return Ma(e).put(function(e){return{bundleId:e.id,createTime:ka(Jo(e.createTime)),version:e.version}}(t))}getNamedQuery(e,t){return Fa(e).get(t).next((e=>{if(e)return function(e){return{name:e.name,query:Pa(e.bundledQuery),readTime:Ca(e.readTime)}}(e)}))}saveNamedQuery(e,t){return Fa(e).put(function(e){return{name:e.name,readTime:ka(Jo(e.readTime)),bundledQuery:e.bundledQuery}}(t))}}function Ma(e){return Lr(e,"bundles")}function Fa(e){return Lr(e,"namedQueries")}class Ua{constructor(e,t){this.serializer=e,this.userId=t}static lt(e,t){const n=t.uid||"";return new Ua(e,n)}getOverlay(e,t){return ja(e).get(Da(this.userId,t)).next((e=>e?Ra(this.serializer,e):null))}getOverlays(e,t){const n=Ps();return Bn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){const r=[];return n.forEach(((n,i)=>{const s=new bo(t,i);r.push(this.ht(e,s))})),Bn.waitFor(r)}removeOverlaysForBatchId(e,t,n){const r=new Set;t.forEach((e=>r.add(sr(e.getCollectionPath()))));const i=[];return r.forEach((t=>{const r=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,n+1],!1,!0);i.push(ja(e).j("collectionPathOverlayIndex",r))})),Bn.waitFor(i)}getOverlaysForCollection(e,t,n){const r=Ps(),i=sr(t),s=IDBKeyRange.bound([this.userId,i,n],[this.userId,i,Number.POSITIVE_INFINITY],!0);return ja(e).U("collectionPathOverlayIndex",s).next((e=>{for(const t of e){const e=Ra(this.serializer,t);r.set(e.getKey(),e)}return r}))}getOverlaysForCollectionGroup(e,t,n,r){const i=Ps();let s;const o=IDBKeyRange.bound([this.userId,t,n],[this.userId,t,Number.POSITIVE_INFINITY],!0);return ja(e).J({index:"collectionGroupOverlayIndex",range:o},((e,t,n)=>{const o=Ra(this.serializer,t);i.size()<r||o.largestBatchId===s?(i.set(o.getKey(),o),s=o.largestBatchId):n.done()})).next((()=>i))}ht(e,t){return ja(e).put(function(e,t,n){const[r,i,s]=Da(t,n.mutation.key);return{userId:t,collectionPath:i,documentId:s,collectionGroup:n.mutation.key.getCollectionGroup(),largestBatchId:n.largestBatchId,overlayMutation:la(e.ct,n.mutation)}}(this.serializer,this.userId,t))}}function ja(e){return Lr(e,"documentOverlays")}class Va{Pt(e){return Lr(e,"globals")}getSessionToken(e){return this.Pt(e).get("sessionToken").next((e=>{const t=null==e?void 0:e.value;return t?Hr.fromUint8Array(t):Hr.EMPTY_BYTE_STRING}))}setSessionToken(e,t){return this.Pt(e).put({name:"sessionToken",value:t.toUint8Array()})}}class za{constructor(){}It(e,t){this.Tt(e,t),t.Et()}Tt(e,t){if("nullValue"in e)this.dt(t,5);else if("booleanValue"in e)this.dt(t,10),t.At(e.booleanValue?1:0);else if("integerValue"in e)this.dt(t,15),t.At(Jr(e.integerValue));else if("doubleValue"in e){const n=Jr(e.doubleValue);isNaN(n)?this.dt(t,13):(this.dt(t,15),rr(n)?t.At(0):t.At(n))}else if("timestampValue"in e){let n=e.timestampValue;this.dt(t,20),"string"==typeof n&&(n=Qr(n)),t.Rt(`${n.seconds||""}`),t.At(n.nanos||0)}else if("stringValue"in e)this.Vt(e.stringValue,t),this.ft(t);else if("bytesValue"in e)this.dt(t,30),t.gt(Yr(e.bytesValue)),this.ft(t);else if("referenceValue"in e)this.yt(e.referenceValue,t);else if("geoPointValue"in e){const n=e.geoPointValue;this.dt(t,45),t.At(n.latitude||0),t.At(n.longitude||0)}else"mapValue"in e?_i(e)?this.dt(t,Number.MAX_SAFE_INTEGER):wi(e)?this.wt(e.mapValue,t):(this.St(e.mapValue,t),this.ft(t)):"arrayValue"in e?(this.bt(e.arrayValue,t),this.ft(t)):rn()}Vt(e,t){this.dt(t,25),this.Dt(e,t)}Dt(e,t){t.Rt(e)}St(e,t){const n=e.fields||{};this.dt(t,55);for(const r of Object.keys(n))this.Vt(r,t),this.Tt(n[r],t)}wt(e,t){var n,r;const i=e.fields||{};this.dt(t,53);const s="value",o=(null===(r=null===(n=i[s].arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.length)||0;this.dt(t,15),t.At(Jr(o)),this.Vt(s,t),this.Tt(i[s],t)}bt(e,t){const n=e.values||[];this.dt(t,50);for(const r of n)this.Tt(r,t)}yt(e,t){this.dt(t,37),Nn.fromName(e).path.forEach((e=>{this.dt(t,60),this.Dt(e,t)}))}dt(e,t){e.At(t)}ft(e){e.At(2)}}function Ba(e){if(0===e)return 8;let t=0;return e>>4==0&&(t+=4,e<<=4),e>>6==0&&(t+=2,e<<=2),e>>7==0&&(t+=1),t}function qa(e){const t=64-function(e){let t=0;for(let n=0;n<8;++n){const r=Ba(255&e[n]);if(t+=r,8!==r)break}return t}(e);return Math.ceil(t/8)}za.vt=new za;class $a{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ft(n.value),n=t.next();this.Mt()}xt(e){const t=e[Symbol.iterator]();let n=t.next();for(;!n.done;)this.Ot(n.value),n=t.next();this.Nt()}Lt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ft(e);else if(e<2048)this.Ft(960|e>>>6),this.Ft(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ft(480|e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e);else{const e=t.codePointAt(0);this.Ft(240|e>>>18),this.Ft(128|63&e>>>12),this.Ft(128|63&e>>>6),this.Ft(128|63&e)}}this.Mt()}Bt(e){for(const t of e){const e=t.charCodeAt(0);if(e<128)this.Ot(e);else if(e<2048)this.Ot(960|e>>>6),this.Ot(128|63&e);else if(t<"\ud800"||"\udbff"<t)this.Ot(480|e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e);else{const e=t.codePointAt(0);this.Ot(240|e>>>18),this.Ot(128|63&e>>>12),this.Ot(128|63&e>>>6),this.Ot(128|63&e)}}this.Nt()}kt(e){const t=this.qt(e),n=qa(t);this.Qt(1+n),this.buffer[this.position++]=255&n;for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=255&t[r]}Kt(e){const t=this.qt(e),n=qa(t);this.Qt(1+n),this.buffer[this.position++]=~(255&n);for(let r=t.length-n;r<t.length;++r)this.buffer[this.position++]=~(255&t[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(e){this.Qt(e.length),this.buffer.set(e,this.position),this.position+=e.length}zt(){return this.buffer.slice(0,this.position)}qt(e){const t=function(e){const t=new DataView(new ArrayBuffer(8));return t.setFloat64(0,e,!1),new Uint8Array(t.buffer)}(e),n=0!=(128&t[0]);t[0]^=n?255:128;for(let r=1;r<t.length;++r)t[r]^=n?255:0;return t}Ft(e){const t=255&e;0===t?(this.Ut(0),this.Ut(255)):255===t?(this.Ut(255),this.Ut(0)):this.Ut(t)}Ot(e){const t=255&e;0===t?(this.Gt(0),this.Gt(255)):255===t?(this.Gt(255),this.Gt(0)):this.Gt(e)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(e){this.Qt(1),this.buffer[this.position++]=e}Gt(e){this.Qt(1),this.buffer[this.position++]=~e}Qt(e){const t=e+this.position;if(t<=this.buffer.length)return;let n=2*this.buffer.length;n<t&&(n=t);const r=new Uint8Array(n);r.set(this.buffer),this.buffer=r}}class Ka{constructor(e){this.jt=e}gt(e){this.jt.Ct(e)}Rt(e){this.jt.Lt(e)}At(e){this.jt.kt(e)}Et(){this.jt.$t()}}class Ga{constructor(e){this.jt=e}gt(e){this.jt.xt(e)}Rt(e){this.jt.Bt(e)}At(e){this.jt.Kt(e)}Et(){this.jt.Wt()}}class Ha{constructor(){this.jt=new $a,this.Ht=new Ka(this.jt),this.Jt=new Ga(this.jt)}seed(e){this.jt.seed(e)}Yt(e){return 0===e?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}}class Wa{constructor(e,t,n,r){this.indexId=e,this.documentKey=t,this.arrayValue=n,this.directionalValue=r}Zt(){const e=this.directionalValue.length,t=0===e||255===this.directionalValue[e-1]?e+1:e,n=new Uint8Array(t);return n.set(this.directionalValue,0),t!==e?n.set([0],this.directionalValue.length):++n[n.length-1],new Wa(this.indexId,this.documentKey,this.arrayValue,n)}}function Qa(e,t){let n=e.indexId-t.indexId;return 0!==n?n:(n=Ja(e.arrayValue,t.arrayValue),0!==n?n:(n=Ja(e.directionalValue,t.directionalValue),0!==n?n:Nn.comparator(e.documentKey,t.documentKey)))}function Ja(e,t){for(let n=0;n<e.length&&n<t.length;++n){const r=e[n]-t[n];if(0!==r)return r}return e.length-t.length}class Ya{constructor(e){this.Xt=new Br(((e,t)=>xn.comparator(e.field,t.field))),this.collectionId=null!=e.collectionGroup?e.collectionGroup:e.path.lastSegment(),this.en=e.orderBy,this.tn=[];for(const t of e.filters){const e=t;e.isInequality()?this.Xt=this.Xt.add(e):this.tn.push(e)}}get nn(){return this.Xt.size>1}rn(e){if(sn(e.collectionGroup===this.collectionId),this.nn)return!1;const t=Pn(e);if(void 0!==t&&!this.sn(t))return!1;const n=Rn(e);let r=new Set,i=0,s=0;for(;i<n.length&&this.sn(n[i]);++i)r=r.add(n[i].fieldPath.canonicalString());if(i===n.length)return!0;if(this.Xt.size>0){const e=this.Xt.getIterator().getNext();if(!r.has(e.field.canonicalString())){const t=n[i];if(!this.on(e,t)||!this._n(this.en[s++],t))return!1}++i}for(;i<n.length;++i){const e=n[i];if(s>=this.en.length||!this._n(this.en[s++],e))return!1}return!0}an(){if(this.nn)return null;let e=new Br(xn.comparator);const t=[];for(const n of this.tn)if(!n.field.isKeyField())if("array-contains"===n.op||"array-contains-any"===n.op)t.push(new Dn(n.field,2));else{if(e.has(n.field))continue;e=e.add(n.field),t.push(new Dn(n.field,0))}for(const n of this.en)n.field.isKeyField()||e.has(n.field)||(e=e.add(n.field),t.push(new Dn(n.field,"asc"===n.dir?0:1)));return new An(An.UNKNOWN_ID,this.collectionId,t,On.empty())}sn(e){for(const t of this.tn)if(this.on(t,e))return!0;return!1}on(e,t){if(void 0===e||!e.field.isEqual(t.fieldPath))return!1;const n="array-contains"===e.op||"array-contains-any"===e.op;return 2===t.kind===n}_n(e,t){return!!e.field.isEqual(t.fieldPath)&&(0===t.kind&&"asc"===e.dir||1===t.kind&&"desc"===e.dir)}}function Xa(e){var t,n;if(sn(e instanceof Mi||e instanceof Fi),e instanceof Mi){if(e instanceof Yi){const r=(null===(n=null===(t=e.value.arrayValue)||void 0===t?void 0:t.values)||void 0===n?void 0:n.map((t=>Mi.create(e.field,"==",t))))||[];return Fi.create(r,"or")}return e}const r=e.filters.map((e=>Xa(e)));return Fi.create(r,e.op)}function Za(e){if(0===e.getFilters().length)return[];const t=rl(Xa(e));return sn(nl(t)),el(t)||tl(t)?[t]:t.getFilters()}function el(e){return e instanceof Mi}function tl(e){return e instanceof Fi&&Vi(e)}function nl(e){return el(e)||tl(e)||function(e){if(e instanceof Fi&&ji(e)){for(const t of e.getFilters())if(!el(t)&&!tl(t))return!1;return!0}return!1}(e)}function rl(e){if(sn(e instanceof Mi||e instanceof Fi),e instanceof Mi)return e;if(1===e.filters.length)return rl(e.filters[0]);const t=e.filters.map((e=>rl(e)));let n=Fi.create(t,e.op);return n=ol(n),nl(n)?n:(sn(n instanceof Fi),sn(Ui(n)),sn(n.filters.length>1),n.filters.reduce(((e,t)=>il(e,t))))}function il(e,t){let n;return sn(e instanceof Mi||e instanceof Fi),sn(t instanceof Mi||t instanceof Fi),n=e instanceof Mi?t instanceof Mi?function(e,t){return Fi.create([e,t],"and")}(e,t):sl(e,t):t instanceof Mi?sl(t,e):function(e,t){if(sn(e.filters.length>0&&t.filters.length>0),Ui(e)&&Ui(t))return $i(e,t.getFilters());const n=ji(e)?e:t,r=ji(e)?t:e,i=n.filters.map((e=>il(e,r)));return Fi.create(i,"or")}(e,t),ol(n)}function sl(e,t){if(Ui(t))return $i(t,e.getFilters());{const n=t.filters.map((t=>il(e,t)));return Fi.create(n,"or")}}function ol(e){if(sn(e instanceof Mi||e instanceof Fi),e instanceof Mi)return e;const t=e.getFilters();if(1===t.length)return ol(t[0]);if(zi(e))return e;const n=t.map((e=>ol(e))),r=[];return n.forEach((t=>{t instanceof Mi?r.push(t):t instanceof Fi&&(t.op===e.op?r.push(...t.filters):r.push(t))})),1===r.length?r[0]:Fi.create(r,e.op)}class al{constructor(){this.un=new ll}addToCollectionParentIndex(e,t){return this.un.add(t),Bn.resolve()}getCollectionParents(e,t){return Bn.resolve(this.un.getEntries(t))}addFieldIndex(e,t){return Bn.resolve()}deleteFieldIndex(e,t){return Bn.resolve()}deleteAllFieldIndexes(e){return Bn.resolve()}createTargetIndexes(e,t){return Bn.resolve()}getDocumentsMatchingTarget(e,t){return Bn.resolve(null)}getIndexType(e,t){return Bn.resolve(0)}getFieldIndexes(e,t){return Bn.resolve([])}getNextCollectionGroupToUpdate(e){return Bn.resolve(null)}getMinOffset(e,t){return Bn.resolve(Fn.min())}getMinOffsetFromCollectionGroup(e,t){return Bn.resolve(Fn.min())}updateCollectionGroup(e,t,n){return Bn.resolve()}updateIndexEntries(e,t){return Bn.resolve()}}class ll{constructor(){this.index={}}add(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t]||new Br(kn.comparator),i=!r.has(n);return this.index[t]=r.add(n),i}has(e){const t=e.lastSegment(),n=e.popLast(),r=this.index[t];return r&&r.has(n)}getEntries(e){return(this.index[e]||new Br(kn.comparator)).toArray()}}const ul=new Uint8Array(0);class cl{constructor(e,t){this.databaseId=t,this.cn=new ll,this.ln=new Ts((e=>ns(e)),((e,t)=>rs(e,t))),this.uid=e.uid||""}addToCollectionParentIndex(e,t){if(!this.cn.has(t)){const n=t.lastSegment(),r=t.popLast();e.addOnCommittedListener((()=>{this.cn.add(t)}));const i={collectionId:n,parent:sr(r)};return hl(e).put(i)}return Bn.resolve()}getCollectionParents(e,t){const n=[],r=IDBKeyRange.bound([t,""],[In(t),""],!1,!0);return hl(e).U(r).next((e=>{for(const r of e){if(r.collectionId!==t)break;n.push(lr(r.parent))}return n}))}addFieldIndex(e,t){const n=fl(e),r=function(e){return{indexId:e.indexId,collectionGroup:e.collectionGroup,fields:e.fields.map((e=>[e.fieldPath.canonicalString(),e.kind]))}}(t);delete r.indexId;const i=n.add(r);if(t.indexState){const n=pl(e);return i.next((e=>{n.put(Oa(e,this.uid,t.indexState.sequenceNumber,t.indexState.offset))}))}return i.next()}deleteFieldIndex(e,t){const n=fl(e),r=pl(e),i=dl(e);return n.delete(t.indexId).next((()=>r.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0)))).next((()=>i.delete(IDBKeyRange.bound([t.indexId],[t.indexId+1],!1,!0))))}deleteAllFieldIndexes(e){const t=fl(e),n=dl(e),r=pl(e);return t.j().next((()=>n.j())).next((()=>r.j()))}createTargetIndexes(e,t){return Bn.forEach(this.hn(t),(t=>this.getIndexType(e,t).next((n=>{if(0===n||1===n){const n=new Ya(t).an();if(null!=n)return this.addFieldIndex(e,n)}}))))}getDocumentsMatchingTarget(e,t){const n=dl(e);let r=!0;const i=new Map;return Bn.forEach(this.hn(t),(t=>this.Pn(e,t).next((e=>{r&&(r=!!e),i.set(t,e)})))).next((()=>{if(r){let e=Ms();const r=[];return Bn.forEach(i,((i,s)=>{Zt("IndexedDbIndexManager",`Using index ${function(e){return`id=${e.indexId}|cg=${e.collectionGroup}|f=${e.fields.map((e=>`${e.fieldPath}:${e.kind}`)).join(",")}`}(i)} to execute ${ns(t)}`);const o=function(e,t){const n=Pn(t);if(void 0===n)return null;for(const r of ss(e,n.fieldPath))switch(r.op){case"array-contains-any":return r.value.arrayValue.values||[];case"array-contains":return[r.value]}return null}(s,i),a=function(e,t){const n=new Map;for(const r of Rn(t))for(const t of ss(e,r.fieldPath))switch(t.op){case"==":case"in":n.set(r.fieldPath.canonicalString(),t.value);break;case"not-in":case"!=":return n.set(r.fieldPath.canonicalString(),t.value),Array.from(n.values())}return null}(s,i),l=function(e,t){const n=[];let r=!0;for(const i of Rn(t)){const t=0===i.kind?os(e,i.fieldPath,e.startAt):as(e,i.fieldPath,e.startAt);n.push(t.value),r&&(r=t.inclusive)}return new Ai(n,r)}(s,i),u=function(e,t){const n=[];let r=!0;for(const i of Rn(t)){const t=0===i.kind?as(e,i.fieldPath,e.endAt):os(e,i.fieldPath,e.endAt);n.push(t.value),r&&(r=t.inclusive)}return new Ai(n,r)}(s,i),c=this.In(i,s,l),h=this.In(i,s,u),d=this.Tn(i,s,a),f=this.En(i.indexId,o,c,l.inclusive,h,u.inclusive,d);return Bn.forEach(f,(i=>n.G(i,t.limit).next((t=>{t.forEach((t=>{const n=Nn.fromSegments(t.documentKey);e.has(n)||(e=e.add(n),r.push(n))}))}))))})).next((()=>r))}return Bn.resolve(null)}))}hn(e){let t=this.ln.get(e);return t||(t=0===e.filters.length?[e]:Za(Fi.create(e.filters,"and")).map((t=>ts(e.path,e.collectionGroup,e.orderBy,t.getFilters(),e.limit,e.startAt,e.endAt))),this.ln.set(e,t),t)}En(e,t,n,r,i,s,o){const a=(null!=t?t.length:1)*Math.max(n.length,i.length),l=a/(null!=t?t.length:1),u=[];for(let c=0;c<a;++c){const a=t?this.dn(t[c/l]):ul,h=this.An(e,a,n[c%l],r),d=this.Rn(e,a,i[c%l],s),f=o.map((t=>this.An(e,a,t,!0)));u.push(...this.createRange(h,d,f))}return u}An(e,t,n,r){const i=new Wa(e,Nn.empty(),t,n);return r?i:i.Zt()}Rn(e,t,n,r){const i=new Wa(e,Nn.empty(),t,n);return r?i.Zt():i}Pn(e,t){const n=new Ya(t),r=null!=t.collectionGroup?t.collectionGroup:t.path.lastSegment();return this.getFieldIndexes(e,r).next((e=>{let t=null;for(const r of e)n.rn(r)&&(!t||r.fields.length>t.fields.length)&&(t=r);return t}))}getIndexType(e,t){let n=2;const r=this.hn(t);return Bn.forEach(r,(t=>this.Pn(e,t).next((e=>{e?0!==n&&e.fields.length<function(e){let t=new Br(xn.comparator),n=!1;for(const r of e.filters)for(const e of r.getFlattenedFilters())e.field.isKeyField()||("array-contains"===e.op||"array-contains-any"===e.op?n=!0:t=t.add(e.field));for(const r of e.orderBy)r.field.isKeyField()||(t=t.add(r.field));return t.size+(n?1:0)}(t)&&(n=1):n=0})))).next((()=>function(e){return null!==e.limit}(t)&&r.length>1&&2===n?1:n))}Vn(e,t){const n=new Ha;for(const r of Rn(e)){const e=t.data.field(r.fieldPath);if(null==e)return null;const i=n.Yt(r.kind);za.vt.It(e,i)}return n.zt()}dn(e){const t=new Ha;return za.vt.It(e,t.Yt(0)),t.zt()}mn(e,t){const n=new Ha;return za.vt.It(fi(this.databaseId,t),n.Yt(function(e){const t=Rn(e);return 0===t.length?0:t[t.length-1].kind}(e))),n.zt()}Tn(e,t,n){if(null===n)return[];let r=[];r.push(new Ha);let i=0;for(const s of Rn(e)){const e=n[i++];for(const n of r)if(this.fn(t,s.fieldPath)&&mi(e))r=this.gn(r,s,e);else{const t=n.Yt(s.kind);za.vt.It(e,t)}}return this.pn(r)}In(e,t,n){return this.Tn(e,t,n.position)}pn(e){const t=[];for(let n=0;n<e.length;++n)t[n]=e[n].zt();return t}gn(e,t,n){const r=[...e],i=[];for(const s of n.arrayValue.values||[])for(const e of r){const n=new Ha;n.seed(e.zt()),za.vt.It(s,n.Yt(t.kind)),i.push(n)}return i}fn(e,t){return!!e.filters.find((e=>e instanceof Mi&&e.field.isEqual(t)&&("in"===e.op||"not-in"===e.op)))}getFieldIndexes(e,t){const n=fl(e),r=pl(e);return(t?n.U("collectionGroupIndex",IDBKeyRange.bound(t,t)):n.U()).next((e=>{const t=[];return Bn.forEach(e,(e=>r.get([e.indexId,this.uid]).next((n=>{t.push(function(e,t){const n=t?new On(t.sequenceNumber,new Fn(Ca(t.readTime),new Nn(lr(t.documentKey)),t.largestBatchId)):On.empty(),r=e.fields.map((e=>{let[t,n]=e;return new Dn(xn.fromServerFormat(t),n)}));return new An(e.indexId,e.collectionGroup,r,n)}(e,n))})))).next((()=>t))}))}getNextCollectionGroupToUpdate(e){return this.getFieldIndexes(e).next((e=>0===e.length?null:(e.sort(((e,t)=>{const n=e.indexState.sequenceNumber-t.indexState.sequenceNumber;return 0!==n?n:bn(e.collectionGroup,t.collectionGroup)})),e[0].collectionGroup)))}updateCollectionGroup(e,t,n){const r=fl(e),i=pl(e);return this.yn(e).next((e=>r.U("collectionGroupIndex",IDBKeyRange.bound(t,t)).next((t=>Bn.forEach(t,(t=>i.put(Oa(t.indexId,this.uid,e,n))))))))}updateIndexEntries(e,t){const n=new Map;return Bn.forEach(t,((t,r)=>{const i=n.get(t.collectionGroup);return(i?Bn.resolve(i):this.getFieldIndexes(e,t.collectionGroup)).next((i=>(n.set(t.collectionGroup,i),Bn.forEach(i,(n=>this.wn(e,t,n).next((t=>{const i=this.Sn(r,n);return t.isEqual(i)?Bn.resolve():this.bn(e,r,n,t,i)})))))))}))}Dn(e,t,n,r){return dl(e).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(n,t.key),documentKey:t.key.path.toArray()})}vn(e,t,n,r){return dl(e).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(n,t.key),t.key.path.toArray()])}wn(e,t,n){const r=dl(e);let i=new Br(Qa);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([n.indexId,this.uid,this.mn(n,t)])},((e,r)=>{i=i.add(new Wa(n.indexId,t,r.arrayValue,r.directionalValue))})).next((()=>i))}Sn(e,t){let n=new Br(Qa);const r=this.Vn(t,e);if(null==r)return n;const i=Pn(t);if(null!=i){const s=e.data.field(i.fieldPath);if(mi(s))for(const i of s.arrayValue.values||[])n=n.add(new Wa(t.indexId,e.key,this.dn(i),r))}else n=n.add(new Wa(t.indexId,e.key,ul,r));return n}bn(e,t,n,r,i){Zt("IndexedDbIndexManager","Updating index entries for document '%s'",t.key);const s=[];return function(e,t,n,r,i){const s=e.getIterator(),o=t.getIterator();let a=$r(s),l=$r(o);for(;a||l;){let e=!1,t=!1;if(a&&l){const r=n(a,l);r<0?t=!0:r>0&&(e=!0)}else null!=a?t=!0:e=!0;e?(r(l),l=$r(o)):t?(i(a),a=$r(s)):(a=$r(s),l=$r(o))}}(r,i,Qa,(r=>{s.push(this.Dn(e,t,n,r))}),(r=>{s.push(this.vn(e,t,n,r))})),Bn.waitFor(s)}yn(e){let t=1;return pl(e).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},((e,n,r)=>{r.done(),t=n.sequenceNumber+1})).next((()=>t))}createRange(e,t,n){n=n.sort(((e,t)=>Qa(e,t))).filter(((e,t,n)=>!t||0!==Qa(e,n[t-1])));const r=[];r.push(e);for(const s of n){const n=Qa(s,e),i=Qa(s,t);if(0===n)r[0]=e.Zt();else if(n>0&&i<0)r.push(s),r.push(s.Zt());else if(i>0)break}r.push(t);const i=[];for(let s=0;s<r.length;s+=2){if(this.Cn(r[s],r[s+1]))return[];const e=[r[s].indexId,this.uid,r[s].arrayValue,r[s].directionalValue,ul,[]],t=[r[s+1].indexId,this.uid,r[s+1].arrayValue,r[s+1].directionalValue,ul,[]];i.push(IDBKeyRange.bound(e,t))}return i}Cn(e,t){return Qa(e,t)>0}getMinOffsetFromCollectionGroup(e,t){return this.getFieldIndexes(e,t).next(ml)}getMinOffset(e,t){return Bn.mapArray(this.hn(t),(t=>this.Pn(e,t).next((e=>e||rn())))).next(ml)}}function hl(e){return Lr(e,"collectionParents")}function dl(e){return Lr(e,"indexEntries")}function fl(e){return Lr(e,"indexConfiguration")}function pl(e){return Lr(e,"indexState")}function ml(e){sn(0!==e.length);let t=e[0].indexState.offset,n=t.largestBatchId;for(let r=1;r<e.length;r++){const i=e[r].indexState.offset;Un(i,t)<0&&(t=i),n<i.largestBatchId&&(n=i.largestBatchId)}return new Fn(t.readTime,t.documentKey,n)}const gl={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0};class vl{constructor(e,t,n){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=t,this.maximumSequenceNumbersToCollect=n}static withCacheSize(e){return new vl(e,vl.DEFAULT_COLLECTION_PERCENTILE,vl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}}function yl(e,t,n){const r=e.store("mutations"),i=e.store("documentMutations"),s=[],o=IDBKeyRange.only(n.batchId);let a=0;const l=r.J({range:o},((e,t,n)=>(a++,n.delete())));s.push(l.next((()=>{sn(1===a)})));const u=[];for(const c of n.mutations){const e=hr(t,c.key.path,n.batchId);s.push(i.delete(e)),u.push(c.key)}return Bn.waitFor(s).next((()=>u))}function wl(e){if(!e)return 0;let t;if(e.document)t=e.document;else if(e.unknownDocument)t=e.unknownDocument;else{if(!e.noDocument)throw rn();t=e.noDocument}return JSON.stringify(t).length}vl.DEFAULT_COLLECTION_PERCENTILE=10,vl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,vl.DEFAULT=new vl(41943040,vl.DEFAULT_COLLECTION_PERCENTILE,vl.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),vl.DISABLED=new vl(-1,0,0);class bl{constructor(e,t,n,r){this.userId=e,this.serializer=t,this.indexManager=n,this.referenceDelegate=r,this.Fn={}}static lt(e,t,n,r){sn(""!==e.uid);const i=e.isAuthenticated()?e.uid:"";return new bl(i,t,n,r)}checkEmpty(e){let t=!0;const n=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Il(e).J({index:"userMutationsIndex",range:n},((e,n,r)=>{t=!1,r.done()})).next((()=>t))}addMutationBatch(e,t,n,r){const i=Sl(e),s=Il(e);return s.add({}).next((o=>{sn("number"==typeof o);const a=new yo(o,t,n,r),l=function(e,t,n){const r=n.baseMutations.map((t=>la(e.ct,t))),i=n.mutations.map((t=>la(e.ct,t)));return{userId:t,batchId:n.batchId,localWriteTimeMs:n.localWriteTime.toMillis(),baseMutations:r,mutations:i}}(this.serializer,this.userId,a),u=[];let c=new Br(((e,t)=>bn(e.canonicalString(),t.canonicalString())));for(const e of r){const t=hr(this.userId,e.key.path,o);c=c.add(e.key.path.popLast()),u.push(s.put(l)),u.push(i.put(t,dr))}return c.forEach((t=>{u.push(this.indexManager.addToCollectionParentIndex(e,t))})),e.addOnCommittedListener((()=>{this.Fn[o]=a.keys()})),Bn.waitFor(u).next((()=>a))}))}lookupMutationBatch(e,t){return Il(e).get(t).next((e=>e?(sn(e.userId===this.userId),xa(this.serializer,e)):null))}Mn(e,t){return this.Fn[t]?Bn.resolve(this.Fn[t]):this.lookupMutationBatch(e,t).next((e=>{if(e){const n=e.keys();return this.Fn[t]=n,n}return null}))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=IDBKeyRange.lowerBound([this.userId,n]);let i=null;return Il(e).J({index:"userMutationsIndex",range:r},((e,t,r)=>{t.userId===this.userId&&(sn(t.batchId>=n),i=xa(this.serializer,t)),r.done()})).next((()=>i))}getHighestUnacknowledgedBatchId(e){const t=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]);let n=-1;return Il(e).J({index:"userMutationsIndex",range:t,reverse:!0},((e,t,r)=>{n=t.batchId,r.done()})).next((()=>n))}getAllMutationBatches(e){const t=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Il(e).U("userMutationsIndex",t).next((e=>e.map((e=>xa(this.serializer,e)))))}getAllMutationBatchesAffectingDocumentKey(e,t){const n=cr(this.userId,t.path),r=IDBKeyRange.lowerBound(n),i=[];return Sl(e).J({range:r},((n,r,s)=>{const[o,a,l]=n,u=lr(a);if(o===this.userId&&t.path.isEqual(u))return Il(e).get(l).next((e=>{if(!e)throw rn();sn(e.userId===this.userId),i.push(xa(this.serializer,e))}));s.done()})).next((()=>i))}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Br(bn);const r=[];return t.forEach((t=>{const i=cr(this.userId,t.path),s=IDBKeyRange.lowerBound(i),o=Sl(e).J({range:s},((e,r,i)=>{const[s,o,a]=e,l=lr(o);s===this.userId&&t.path.isEqual(l)?n=n.add(a):i.done()}));r.push(o)})),Bn.waitFor(r).next((()=>this.xn(e,n)))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1,i=cr(this.userId,n),s=IDBKeyRange.lowerBound(i);let o=new Br(bn);return Sl(e).J({range:s},((e,t,i)=>{const[s,a,l]=e,u=lr(a);s===this.userId&&n.isPrefixOf(u)?u.length===r&&(o=o.add(l)):i.done()})).next((()=>this.xn(e,o)))}xn(e,t){const n=[],r=[];return t.forEach((t=>{r.push(Il(e).get(t).next((e=>{if(null===e)throw rn();sn(e.userId===this.userId),n.push(xa(this.serializer,e))})))})),Bn.waitFor(r).next((()=>n))}removeMutationBatch(e,t){return yl(e._e,this.userId,t).next((n=>(e.addOnCommittedListener((()=>{this.On(t.batchId)})),Bn.forEach(n,(t=>this.referenceDelegate.markPotentiallyOrphaned(e,t))))))}On(e){delete this.Fn[e]}performConsistencyCheck(e){return this.checkEmpty(e).next((t=>{if(!t)return Bn.resolve();const n=IDBKeyRange.lowerBound(function(e){return[e]}(this.userId)),r=[];return Sl(e).J({range:n},((e,t,n)=>{if(e[0]===this.userId){const t=lr(e[1]);r.push(t)}else n.done()})).next((()=>{sn(0===r.length)}))}))}containsKey(e,t){return _l(e,this.userId,t)}Nn(e){return El(e).get(this.userId).next((e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""}))}}function _l(e,t,n){const r=cr(t,n.path),i=r[1],s=IDBKeyRange.lowerBound(r);let o=!1;return Sl(e).J({range:s,H:!0},((e,n,r)=>{const[s,a,l]=e;s===t&&a===i&&(o=!0),r.done()})).next((()=>o))}function Il(e){return Lr(e,"mutations")}function Sl(e){return Lr(e,"documentMutations")}function El(e){return Lr(e,"mutationQueues")}class Tl{constructor(e){this.Ln=e}next(){return this.Ln+=2,this.Ln}static Bn(){return new Tl(0)}static kn(){return new Tl(-1)}}class kl{constructor(e,t){this.referenceDelegate=e,this.serializer=t}allocateTargetId(e){return this.qn(e).next((t=>{const n=new Tl(t.highestTargetId);return t.highestTargetId=n.next(),this.Qn(e,t).next((()=>t.highestTargetId))}))}getLastRemoteSnapshotVersion(e){return this.qn(e).next((e=>En.fromTimestamp(new Sn(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds))))}getHighestSequenceNumber(e){return this.qn(e).next((e=>e.highestListenSequenceNumber))}setTargetsMetadata(e,t,n){return this.qn(e).next((r=>(r.highestListenSequenceNumber=t,n&&(r.lastRemoteSnapshotVersion=n.toTimestamp()),t>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=t),this.Qn(e,r))))}addTargetData(e,t){return this.Kn(e,t).next((()=>this.qn(e).next((n=>(n.targetCount+=1,this.$n(t,n),this.Qn(e,n))))))}updateTargetData(e,t){return this.Kn(e,t)}removeTargetData(e,t){return this.removeMatchingKeysForTargetId(e,t.targetId).next((()=>Cl(e).delete(t.targetId))).next((()=>this.qn(e))).next((t=>(sn(t.targetCount>0),t.targetCount-=1,this.Qn(e,t))))}removeTargets(e,t,n){let r=0;const i=[];return Cl(e).J(((s,o)=>{const a=Na(o);a.sequenceNumber<=t&&null===n.get(a.targetId)&&(r++,i.push(this.removeTargetData(e,a)))})).next((()=>Bn.waitFor(i))).next((()=>r))}forEachTarget(e,t){return Cl(e).J(((e,n)=>{const r=Na(n);t(r)}))}qn(e){return xl(e).get("targetGlobalKey").next((e=>(sn(null!==e),e)))}Qn(e,t){return xl(e).put("targetGlobalKey",t)}Kn(e,t){return Cl(e).put(Aa(this.serializer,t))}$n(e,t){let n=!1;return e.targetId>t.highestTargetId&&(t.highestTargetId=e.targetId,n=!0),e.sequenceNumber>t.highestListenSequenceNumber&&(t.highestListenSequenceNumber=e.sequenceNumber,n=!0),n}getTargetCount(e){return this.qn(e).next((e=>e.targetCount))}getTargetData(e,t){const n=ns(t),r=IDBKeyRange.bound([n,Number.NEGATIVE_INFINITY],[n,Number.POSITIVE_INFINITY]);let i=null;return Cl(e).J({range:r,index:"queryTargetsIndex"},((e,n,r)=>{const s=Na(n);rs(t,s.target)&&(i=s,r.done())})).next((()=>i))}addMatchingKeys(e,t,n){const r=[],i=Nl(e);return t.forEach((t=>{const s=sr(t.path);r.push(i.put({targetId:n,path:s})),r.push(this.referenceDelegate.addReference(e,n,t))})),Bn.waitFor(r)}removeMatchingKeys(e,t,n){const r=Nl(e);return Bn.forEach(t,(t=>{const i=sr(t.path);return Bn.waitFor([r.delete([n,i]),this.referenceDelegate.removeReference(e,n,t)])}))}removeMatchingKeysForTargetId(e,t){const n=Nl(e),r=IDBKeyRange.bound([t],[t+1],!1,!0);return n.delete(r)}getMatchingKeysForTargetId(e,t){const n=IDBKeyRange.bound([t],[t+1],!1,!0),r=Nl(e);let i=Ms();return r.J({range:n,H:!0},((e,t,n)=>{const r=lr(e[1]),s=new Nn(r);i=i.add(s)})).next((()=>i))}containsKey(e,t){const n=sr(t.path),r=IDBKeyRange.bound([n],[In(n)],!1,!0);let i=0;return Nl(e).J({index:"documentTargetsIndex",H:!0,range:r},((e,t,n)=>{let[r,s]=e;0!==r&&(i++,n.done())})).next((()=>i>0))}ot(e,t){return Cl(e).get(t).next((e=>e?Na(e):null))}}function Cl(e){return Lr(e,"targets")}function xl(e){return Lr(e,"targetGlobal")}function Nl(e){return Lr(e,"targetDocuments")}function Al(e,t){let[n,r]=e,[i,s]=t;const o=bn(n,i);return 0===o?bn(r,s):o}class Pl{constructor(e){this.Un=e,this.buffer=new Br(Al),this.Wn=0}Gn(){return++this.Wn}zn(e){const t=[e,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(t);else{const e=this.buffer.last();Al(t,e)<0&&(this.buffer=this.buffer.delete(e).add(t))}}get maxValue(){return this.buffer.last()[0]}}class Rl{constructor(e,t,n){this.garbageCollector=e,this.asyncQueue=t,this.localStore=n,this.jn=null}start(){-1!==this.garbageCollector.params.cacheSizeCollectionThreshold&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return null!==this.jn}Hn(e){Zt("LruGarbageCollector",`Garbage collection scheduled in ${e}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,(async()=>{this.jn=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(e){Wn(e)?Zt("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):await zn(e)}await this.Hn(3e5)}))}}class Dl{constructor(e,t){this.Jn=e,this.params=t}calculateTargetCount(e,t){return this.Jn.Yn(e).next((e=>Math.floor(t/100*e)))}nthSequenceNumber(e,t){if(0===t)return Bn.resolve(tr.oe);const n=new Pl(t);return this.Jn.forEachTarget(e,(e=>n.zn(e.sequenceNumber))).next((()=>this.Jn.Zn(e,(e=>n.zn(e))))).next((()=>n.maxValue))}removeTargets(e,t,n){return this.Jn.removeTargets(e,t,n)}removeOrphanedDocuments(e,t){return this.Jn.removeOrphanedDocuments(e,t)}collect(e,t){return-1===this.params.cacheSizeCollectionThreshold?(Zt("LruGarbageCollector","Garbage collection skipped; disabled"),Bn.resolve(gl)):this.getCacheSize(e).next((n=>n<this.params.cacheSizeCollectionThreshold?(Zt("LruGarbageCollector",`Garbage collection skipped; Cache size ${n} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),gl):this.Xn(e,t)))}getCacheSize(e){return this.Jn.getCacheSize(e)}Xn(e,t){let n,r,i,s,o,a,l;const u=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next((t=>(t>this.params.maximumSequenceNumbersToCollect?(Zt("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${t}`),r=this.params.maximumSequenceNumbersToCollect):r=t,s=Date.now(),this.nthSequenceNumber(e,r)))).next((r=>(n=r,o=Date.now(),this.removeTargets(e,n,t)))).next((t=>(i=t,a=Date.now(),this.removeOrphanedDocuments(e,n)))).next((e=>(l=Date.now(),Xt()<=te.DEBUG&&Zt("LruGarbageCollector",`LRU Garbage Collection\n\tCounted targets in ${s-u}ms\n\tDetermined least recently used ${r} in `+(o-s)+"ms\n"+`\tRemoved ${i} targets in `+(a-o)+"ms\n"+`\tRemoved ${e} documents in `+(l-a)+"ms\n"+`Total Duration: ${l-u}ms`),Bn.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:i,documentsRemoved:e}))))}}function Ol(e,t){return new Dl(e,t)}class Ll{constructor(e,t){this.db=e,this.garbageCollector=Ol(this,t)}Yn(e){const t=this.er(e);return this.db.getTargetCache().getTargetCount(e).next((e=>t.next((t=>e+t))))}er(e){let t=0;return this.Zn(e,(e=>{t++})).next((()=>t))}forEachTarget(e,t){return this.db.getTargetCache().forEachTarget(e,t)}Zn(e,t){return this.tr(e,((e,n)=>t(n)))}addReference(e,t,n){return Ml(e,n)}removeReference(e,t,n){return Ml(e,n)}removeTargets(e,t,n){return this.db.getTargetCache().removeTargets(e,t,n)}markPotentiallyOrphaned(e,t){return Ml(e,t)}nr(e,t){return function(e,t){let n=!1;return El(e).Y((r=>_l(e,r,t).next((e=>(e&&(n=!0),Bn.resolve(!e)))))).next((()=>n))}(e,t)}removeOrphanedDocuments(e,t){const n=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[];let i=0;return this.tr(e,((s,o)=>{if(o<=t){const t=this.nr(e,s).next((t=>{if(!t)return i++,n.getEntry(e,s).next((()=>(n.removeEntry(s,En.min()),Nl(e).delete(function(e){return[0,sr(e.path)]}(s)))))}));r.push(t)}})).next((()=>Bn.waitFor(r))).next((()=>n.apply(e))).next((()=>i))}removeTarget(e,t){const n=t.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,n)}updateLimboDocument(e,t){return Ml(e,t)}tr(e,t){const n=Nl(e);let r,i=tr.oe;return n.J({index:"documentTargetsIndex"},((e,n)=>{let[s,o]=e,{path:a,sequenceNumber:l}=n;0===s?(i!==tr.oe&&t(new Nn(lr(r)),i),i=l,r=a):i=tr.oe})).next((()=>{i!==tr.oe&&t(new Nn(lr(r)),i)}))}getCacheSize(e){return this.db.getRemoteDocumentCache().getSize(e)}}function Ml(e,t){return Nl(e).put(function(e,t){return{targetId:0,path:sr(e.path),sequenceNumber:t}}(t,e.currentSequenceNumber))}class Fl{constructor(){this.changes=new Ts((e=>e.toString()),((e,t)=>e.isEqual(t))),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,t){this.assertNotApplied(),this.changes.set(e,Ni.newInvalidDocument(e).setReadTime(t))}getEntry(e,t){this.assertNotApplied();const n=this.changes.get(t);return void 0!==n?Bn.resolve(n):this.getFromCache(e,t)}getEntries(e,t){return this.getAllFromCache(e,t)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}class Ul{constructor(e){this.serializer=e}setIndexManager(e){this.indexManager=e}addEntry(e,t,n){return Bl(e).put(n)}removeEntry(e,t,n){return Bl(e).delete(function(e,t){const n=e.path.toArray();return[n.slice(0,n.length-2),n[n.length-2],Ta(t),n[n.length-1]]}(t,n))}updateMetadata(e,t){return this.getMetadata(e).next((n=>(n.byteSize+=t,this.rr(e,n))))}getEntry(e,t){let n=Ni.newInvalidDocument(t);return Bl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ql(t))},((e,r)=>{n=this.ir(t,r)})).next((()=>n))}sr(e,t){let n={size:0,document:Ni.newInvalidDocument(t)};return Bl(e).J({index:"documentKeyIndex",range:IDBKeyRange.only(ql(t))},((e,r)=>{n={document:this.ir(t,r),size:wl(r)}})).next((()=>n))}getEntries(e,t){let n=Cs();return this._r(e,t,((e,t)=>{const r=this.ir(e,t);n=n.insert(e,r)})).next((()=>n))}ar(e,t){let n=Cs(),r=new jr(Nn.comparator);return this._r(e,t,((e,t)=>{const i=this.ir(e,t);n=n.insert(e,i),r=r.insert(e,wl(t))})).next((()=>({documents:n,ur:r})))}_r(e,t,n){if(t.isEmpty())return Bn.resolve();let r=new Br(Kl);t.forEach((e=>r=r.add(e)));const i=IDBKeyRange.bound(ql(r.first()),ql(r.last())),s=r.getIterator();let o=s.getNext();return Bl(e).J({index:"documentKeyIndex",range:i},((e,t,r)=>{const i=Nn.fromSegments([...t.prefixPath,t.collectionGroup,t.documentId]);for(;o&&Kl(o,i)<0;)n(o,null),o=s.getNext();o&&o.isEqual(i)&&(n(o,t),o=s.hasNext()?s.getNext():null),o?r.$(ql(o)):r.done()})).next((()=>{for(;o;)n(o,null),o=s.hasNext()?s.getNext():null}))}getDocumentsMatchingQuery(e,t,n,r,i){const s=t.path,o=[s.popLast().toArray(),s.lastSegment(),Ta(n.readTime),n.documentKey.path.isEmpty()?"":n.documentKey.path.lastSegment()],a=[s.popLast().toArray(),s.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Bl(e).U(IDBKeyRange.bound(o,a,!0)).next((e=>{null==i||i.incrementDocumentReadCount(e.length);let n=Cs();for(const i of e){const e=this.ir(Nn.fromSegments(i.prefixPath.concat(i.collectionGroup,i.documentId)),i);e.isFoundDocument()&&(_s(t,e)||r.has(e.key))&&(n=n.insert(e.key,e))}return n}))}getAllFromCollectionGroup(e,t,n,r){let i=Cs();const s=$l(t,n),o=$l(t,Fn.max());return Bl(e).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(s,o,!0)},((e,t,n)=>{const s=this.ir(Nn.fromSegments(t.prefixPath.concat(t.collectionGroup,t.documentId)),t);i=i.insert(s.key,s),i.size===r&&n.done()})).next((()=>i))}newChangeBuffer(e){return new Vl(this,!!e&&e.trackRemovals)}getSize(e){return this.getMetadata(e).next((e=>e.byteSize))}getMetadata(e){return zl(e).get("remoteDocumentGlobalKey").next((e=>(sn(!!e),e)))}rr(e,t){return zl(e).put("remoteDocumentGlobalKey",t)}ir(e,t){if(t){const e=function(e,t){let n;if(t.document)n=aa(e.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){const e=Nn.fromSegments(t.noDocument.path),r=Ca(t.noDocument.readTime);n=Ni.newNoDocument(e,r),t.hasCommittedMutations&&n.setHasCommittedMutations()}else{if(!t.unknownDocument)return rn();{const e=Nn.fromSegments(t.unknownDocument.path),r=Ca(t.unknownDocument.version);n=Ni.newUnknownDocument(e,r)}}return t.readTime&&n.setReadTime(function(e){const t=new Sn(e[0],e[1]);return En.fromTimestamp(t)}(t.readTime)),n}(this.serializer,t);if(!e.isNoDocument()||!e.version.isEqual(En.min()))return e}return Ni.newInvalidDocument(e)}}function jl(e){return new Ul(e)}class Vl extends Fl{constructor(e,t){super(),this.cr=e,this.trackRemovals=t,this.lr=new Ts((e=>e.toString()),((e,t)=>e.isEqual(t)))}applyChanges(e){const t=[];let n=0,r=new Br(((e,t)=>bn(e.canonicalString(),t.canonicalString())));return this.changes.forEach(((i,s)=>{const o=this.lr.get(i);if(t.push(this.cr.removeEntry(e,i,o.readTime)),s.isValidDocument()){const a=Ea(this.cr.serializer,s);r=r.add(i.path.popLast());const l=wl(a);n+=l-o.size,t.push(this.cr.addEntry(e,i,a))}else if(n-=o.size,this.trackRemovals){const n=Ea(this.cr.serializer,s.convertToNoDocument(En.min()));t.push(this.cr.addEntry(e,i,n))}})),r.forEach((n=>{t.push(this.cr.indexManager.addToCollectionParentIndex(e,n))})),t.push(this.cr.updateMetadata(e,n)),Bn.waitFor(t)}getFromCache(e,t){return this.cr.sr(e,t).next((e=>(this.lr.set(t,{size:e.size,readTime:e.document.readTime}),e.document)))}getAllFromCache(e,t){return this.cr.ar(e,t).next((e=>{let{documents:t,ur:n}=e;return n.forEach(((e,n)=>{this.lr.set(e,{size:n,readTime:t.get(e).readTime})})),t}))}}function zl(e){return Lr(e,"remoteDocumentGlobal")}function Bl(e){return Lr(e,"remoteDocumentsV14")}function ql(e){const t=e.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function $l(e,t){const n=t.documentKey.path.toArray();return[e,Ta(t.readTime),n.slice(0,n.length-2),n.length>0?n[n.length-1]:""]}function Kl(e,t){const n=e.path.toArray(),r=t.path.toArray();let i=0;for(let s=0;s<n.length-2&&s<r.length-2;++s)if(i=bn(n[s],r[s]),i)return i;return i=bn(n.length,r.length),i||(i=bn(n[n.length-2],r[r.length-2]),i||bn(n[n.length-1],r[r.length-1]))}class Gl{constructor(e,t){this.overlayedDocument=e,this.mutatedFields=t}}class Hl{constructor(e,t,n,r){this.remoteDocumentCache=e,this.mutationQueue=t,this.documentOverlayCache=n,this.indexManager=r}getDocument(e,t){let n=null;return this.documentOverlayCache.getOverlay(e,t).next((r=>(n=r,this.remoteDocumentCache.getEntry(e,t)))).next((e=>(null!==n&&ao(n.mutation,e,Kr.empty(),Sn.now()),e)))}getDocuments(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.getLocalViewOfDocuments(e,t,Ms()).next((()=>t))))}getLocalViewOfDocuments(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ms();const r=Ps();return this.populateOverlays(e,r,t).next((()=>this.computeViews(e,t,r,n).next((e=>{let t=Ns();return e.forEach(((e,n)=>{t=t.insert(e,n.overlayedDocument)})),t}))))}getOverlayedDocuments(e,t){const n=Ps();return this.populateOverlays(e,n,t).next((()=>this.computeViews(e,t,n,Ms())))}populateOverlays(e,t,n){const r=[];return n.forEach((e=>{t.has(e)||r.push(e)})),this.documentOverlayCache.getOverlays(e,r).next((e=>{e.forEach(((e,n)=>{t.set(e,n)}))}))}computeViews(e,t,n,r){let i=Cs();const s=Ds(),o=Ds();return t.forEach(((e,t)=>{const o=n.get(t.key);r.has(t.key)&&(void 0===o||o.mutation instanceof ho)?i=i.insert(t.key,t):void 0!==o?(s.set(t.key,o.mutation.getFieldMask()),ao(o.mutation,t,o.mutation.getFieldMask(),Sn.now())):s.set(t.key,Kr.empty())})),this.recalculateAndSaveOverlays(e,i).next((e=>(e.forEach(((e,t)=>s.set(e,t))),t.forEach(((e,t)=>{var n;return o.set(e,new Gl(t,null!==(n=s.get(e))&&void 0!==n?n:null))})),o)))}recalculateAndSaveOverlays(e,t){const n=Ds();let r=new jr(((e,t)=>e-t)),i=Ms();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,t).next((e=>{for(const i of e)i.keys().forEach((e=>{const s=t.get(e);if(null===s)return;let o=n.get(e)||Kr.empty();o=i.applyToLocalView(s,o),n.set(e,o);const a=(r.get(i.batchId)||Ms()).add(e);r=r.insert(i.batchId,a)}))})).next((()=>{const s=[],o=r.getReverseIterator();for(;o.hasNext();){const r=o.getNext(),a=r.key,l=r.value,u=Rs();l.forEach((e=>{if(!i.has(e)){const r=so(t.get(e),n.get(e));null!==r&&u.set(e,r),i=i.add(e)}})),s.push(this.documentOverlayCache.saveOverlays(e,a,u))}return Bn.waitFor(s)})).next((()=>n))}recalculateAndSaveOverlaysForDocumentKeys(e,t){return this.remoteDocumentCache.getEntries(e,t).next((t=>this.recalculateAndSaveOverlays(e,t)))}getDocumentsMatchingQuery(e,t,n,r){return function(e){return Nn.isDocumentKey(e.path)&&null===e.collectionGroup&&0===e.filters.length}(t)?this.getDocumentsMatchingDocumentQuery(e,t.path):ds(t)?this.getDocumentsMatchingCollectionGroupQuery(e,t,n,r):this.getDocumentsMatchingCollectionQuery(e,t,n,r)}getNextDocuments(e,t,n,r){return this.remoteDocumentCache.getAllFromCollectionGroup(e,t,n,r).next((i=>{const s=r-i.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,t,n.largestBatchId,r-i.size):Bn.resolve(Ps());let o=-1,a=i;return s.next((t=>Bn.forEach(t,((t,n)=>(o<n.largestBatchId&&(o=n.largestBatchId),i.get(t)?Bn.resolve():this.remoteDocumentCache.getEntry(e,t).next((e=>{a=a.insert(t,e)}))))).next((()=>this.populateOverlays(e,t,i))).next((()=>this.computeViews(e,a,t,Ms()))).next((e=>({batchId:o,changes:As(e)})))))}))}getDocumentsMatchingDocumentQuery(e,t){return this.getDocument(e,new Nn(t)).next((e=>{let t=Ns();return e.isFoundDocument()&&(t=t.insert(e.key,e)),t}))}getDocumentsMatchingCollectionGroupQuery(e,t,n,r){const i=t.collectionGroup;let s=Ns();return this.indexManager.getCollectionParents(e,i).next((o=>Bn.forEach(o,(o=>{const a=function(e,t){return new ls(t,null,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(t,o.child(i));return this.getDocumentsMatchingCollectionQuery(e,a,n,r).next((e=>{e.forEach(((e,t)=>{s=s.insert(e,t)}))}))})).next((()=>s))))}getDocumentsMatchingCollectionQuery(e,t,n,r){let i;return this.documentOverlayCache.getOverlaysForCollection(e,t.path,n.largestBatchId).next((s=>(i=s,this.remoteDocumentCache.getDocumentsMatchingQuery(e,t,n,i,r)))).next((e=>{i.forEach(((t,n)=>{const r=n.getKey();null===e.get(r)&&(e=e.insert(r,Ni.newInvalidDocument(r)))}));let n=Ns();return e.forEach(((e,r)=>{const s=i.get(e);void 0!==s&&ao(s.mutation,r,Kr.empty(),Sn.now()),_s(t,r)&&(n=n.insert(e,r))})),n}))}}class Wl{constructor(e){this.serializer=e,this.hr=new Map,this.Pr=new Map}getBundleMetadata(e,t){return Bn.resolve(this.hr.get(t))}saveBundleMetadata(e,t){return this.hr.set(t.id,function(e){return{id:e.id,version:e.version,createTime:Jo(e.createTime)}}(t)),Bn.resolve()}getNamedQuery(e,t){return Bn.resolve(this.Pr.get(t))}saveNamedQuery(e,t){return this.Pr.set(t.name,function(e){return{name:e.name,query:Pa(e.bundledQuery),readTime:Jo(e.readTime)}}(t)),Bn.resolve()}}class Ql{constructor(){this.overlays=new jr(Nn.comparator),this.Ir=new Map}getOverlay(e,t){return Bn.resolve(this.overlays.get(t))}getOverlays(e,t){const n=Ps();return Bn.forEach(t,(t=>this.getOverlay(e,t).next((e=>{null!==e&&n.set(t,e)})))).next((()=>n))}saveOverlays(e,t,n){return n.forEach(((n,r)=>{this.ht(e,t,r)})),Bn.resolve()}removeOverlaysForBatchId(e,t,n){const r=this.Ir.get(n);return void 0!==r&&(r.forEach((e=>this.overlays=this.overlays.remove(e))),this.Ir.delete(n)),Bn.resolve()}getOverlaysForCollection(e,t,n){const r=Ps(),i=t.length+1,s=new Nn(t.child("")),o=this.overlays.getIteratorFrom(s);for(;o.hasNext();){const e=o.getNext().value,s=e.getKey();if(!t.isPrefixOf(s.path))break;s.path.length===i&&e.largestBatchId>n&&r.set(e.getKey(),e)}return Bn.resolve(r)}getOverlaysForCollectionGroup(e,t,n,r){let i=new jr(((e,t)=>e-t));const s=this.overlays.getIterator();for(;s.hasNext();){const e=s.getNext().value;if(e.getKey().getCollectionGroup()===t&&e.largestBatchId>n){let t=i.get(e.largestBatchId);null===t&&(t=Ps(),i=i.insert(e.largestBatchId,t)),t.set(e.getKey(),e)}}const o=Ps(),a=i.getIterator();for(;a.hasNext()&&(a.getNext().value.forEach(((e,t)=>o.set(e,t))),!(o.size()>=r)););return Bn.resolve(o)}ht(e,t,n){const r=this.overlays.get(n.key);if(null!==r){const e=this.Ir.get(r.largestBatchId).delete(n.key);this.Ir.set(r.largestBatchId,e)}this.overlays=this.overlays.insert(n.key,new bo(t,n));let i=this.Ir.get(t);void 0===i&&(i=Ms(),this.Ir.set(t,i)),this.Ir.set(t,i.add(n.key))}}class Jl{constructor(){this.sessionToken=Hr.EMPTY_BYTE_STRING}getSessionToken(e){return Bn.resolve(this.sessionToken)}setSessionToken(e,t){return this.sessionToken=t,Bn.resolve()}}class Yl{constructor(){this.Tr=new Br(Xl.Er),this.dr=new Br(Xl.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(e,t){const n=new Xl(e,t);this.Tr=this.Tr.add(n),this.dr=this.dr.add(n)}Rr(e,t){e.forEach((e=>this.addReference(e,t)))}removeReference(e,t){this.Vr(new Xl(e,t))}mr(e,t){e.forEach((e=>this.removeReference(e,t)))}gr(e){const t=new Nn(new kn([])),n=new Xl(t,e),r=new Xl(t,e+1),i=[];return this.dr.forEachInRange([n,r],(e=>{this.Vr(e),i.push(e.key)})),i}pr(){this.Tr.forEach((e=>this.Vr(e)))}Vr(e){this.Tr=this.Tr.delete(e),this.dr=this.dr.delete(e)}yr(e){const t=new Nn(new kn([])),n=new Xl(t,e),r=new Xl(t,e+1);let i=Ms();return this.dr.forEachInRange([n,r],(e=>{i=i.add(e.key)})),i}containsKey(e){const t=new Xl(e,0),n=this.Tr.firstAfterOrEqual(t);return null!==n&&e.isEqual(n.key)}}class Xl{constructor(e,t){this.key=e,this.wr=t}static Er(e,t){return Nn.comparator(e.key,t.key)||bn(e.wr,t.wr)}static Ar(e,t){return bn(e.wr,t.wr)||Nn.comparator(e.key,t.key)}}class Zl{constructor(e,t){this.indexManager=e,this.referenceDelegate=t,this.mutationQueue=[],this.Sr=1,this.br=new Br(Xl.Er)}checkEmpty(e){return Bn.resolve(0===this.mutationQueue.length)}addMutationBatch(e,t,n,r){const i=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const s=new yo(i,t,n,r);this.mutationQueue.push(s);for(const o of r)this.br=this.br.add(new Xl(o.key,i)),this.indexManager.addToCollectionParentIndex(e,o.key.path.popLast());return Bn.resolve(s)}lookupMutationBatch(e,t){return Bn.resolve(this.Dr(t))}getNextMutationBatchAfterBatchId(e,t){const n=t+1,r=this.vr(n),i=r<0?0:r;return Bn.resolve(this.mutationQueue.length>i?this.mutationQueue[i]:null)}getHighestUnacknowledgedBatchId(){return Bn.resolve(0===this.mutationQueue.length?-1:this.Sr-1)}getAllMutationBatches(e){return Bn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,t){const n=new Xl(t,0),r=new Xl(t,Number.POSITIVE_INFINITY),i=[];return this.br.forEachInRange([n,r],(e=>{const t=this.Dr(e.wr);i.push(t)})),Bn.resolve(i)}getAllMutationBatchesAffectingDocumentKeys(e,t){let n=new Br(bn);return t.forEach((e=>{const t=new Xl(e,0),r=new Xl(e,Number.POSITIVE_INFINITY);this.br.forEachInRange([t,r],(e=>{n=n.add(e.wr)}))})),Bn.resolve(this.Cr(n))}getAllMutationBatchesAffectingQuery(e,t){const n=t.path,r=n.length+1;let i=n;Nn.isDocumentKey(i)||(i=i.child(""));const s=new Xl(new Nn(i),0);let o=new Br(bn);return this.br.forEachWhile((e=>{const t=e.key.path;return!!n.isPrefixOf(t)&&(t.length===r&&(o=o.add(e.wr)),!0)}),s),Bn.resolve(this.Cr(o))}Cr(e){const t=[];return e.forEach((e=>{const n=this.Dr(e);null!==n&&t.push(n)})),t}removeMutationBatch(e,t){sn(0===this.Fr(t.batchId,"removed")),this.mutationQueue.shift();let n=this.br;return Bn.forEach(t.mutations,(r=>{const i=new Xl(r.key,t.batchId);return n=n.delete(i),this.referenceDelegate.markPotentiallyOrphaned(e,r.key)})).next((()=>{this.br=n}))}On(e){}containsKey(e,t){const n=new Xl(t,0),r=this.br.firstAfterOrEqual(n);return Bn.resolve(t.isEqual(r&&r.key))}performConsistencyCheck(e){return this.mutationQueue.length,Bn.resolve()}Fr(e,t){return this.vr(e)}vr(e){return 0===this.mutationQueue.length?0:e-this.mutationQueue[0].batchId}Dr(e){const t=this.vr(e);return t<0||t>=this.mutationQueue.length?null:this.mutationQueue[t]}}class eu{constructor(e){this.Mr=e,this.docs=new jr(Nn.comparator),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,t){const n=t.key,r=this.docs.get(n),i=r?r.size:0,s=this.Mr(t);return this.docs=this.docs.insert(n,{document:t.mutableCopy(),size:s}),this.size+=s-i,this.indexManager.addToCollectionParentIndex(e,n.path.popLast())}removeEntry(e){const t=this.docs.get(e);t&&(this.docs=this.docs.remove(e),this.size-=t.size)}getEntry(e,t){const n=this.docs.get(t);return Bn.resolve(n?n.document.mutableCopy():Ni.newInvalidDocument(t))}getEntries(e,t){let n=Cs();return t.forEach((e=>{const t=this.docs.get(e);n=n.insert(e,t?t.document.mutableCopy():Ni.newInvalidDocument(e))})),Bn.resolve(n)}getDocumentsMatchingQuery(e,t,n,r){let i=Cs();const s=t.path,o=new Nn(s.child("")),a=this.docs.getIteratorFrom(o);for(;a.hasNext();){const{key:e,value:{document:o}}=a.getNext();if(!s.isPrefixOf(e.path))break;e.path.length>s.length+1||Un(Mn(o),n)<=0||(r.has(o.key)||_s(t,o))&&(i=i.insert(o.key,o.mutableCopy()))}return Bn.resolve(i)}getAllFromCollectionGroup(e,t,n,r){rn()}Or(e,t){return Bn.forEach(this.docs,(e=>t(e)))}newChangeBuffer(e){return new tu(this)}getSize(e){return Bn.resolve(this.size)}}class tu extends Fl{constructor(e){super(),this.cr=e}applyChanges(e){const t=[];return this.changes.forEach(((n,r)=>{r.isValidDocument()?t.push(this.cr.addEntry(e,r)):this.cr.removeEntry(n)})),Bn.waitFor(t)}getFromCache(e,t){return this.cr.getEntry(e,t)}getAllFromCache(e,t){return this.cr.getEntries(e,t)}}class nu{constructor(e){this.persistence=e,this.Nr=new Ts((e=>ns(e)),rs),this.lastRemoteSnapshotVersion=En.min(),this.highestTargetId=0,this.Lr=0,this.Br=new Yl,this.targetCount=0,this.kr=Tl.Bn()}forEachTarget(e,t){return this.Nr.forEach(((e,n)=>t(n))),Bn.resolve()}getLastRemoteSnapshotVersion(e){return Bn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Bn.resolve(this.Lr)}allocateTargetId(e){return this.highestTargetId=this.kr.next(),Bn.resolve(this.highestTargetId)}setTargetsMetadata(e,t,n){return n&&(this.lastRemoteSnapshotVersion=n),t>this.Lr&&(this.Lr=t),Bn.resolve()}Kn(e){this.Nr.set(e.target,e);const t=e.targetId;t>this.highestTargetId&&(this.kr=new Tl(t),this.highestTargetId=t),e.sequenceNumber>this.Lr&&(this.Lr=e.sequenceNumber)}addTargetData(e,t){return this.Kn(t),this.targetCount+=1,Bn.resolve()}updateTargetData(e,t){return this.Kn(t),Bn.resolve()}removeTargetData(e,t){return this.Nr.delete(t.target),this.Br.gr(t.targetId),this.targetCount-=1,Bn.resolve()}removeTargets(e,t,n){let r=0;const i=[];return this.Nr.forEach(((s,o)=>{o.sequenceNumber<=t&&null===n.get(o.targetId)&&(this.Nr.delete(s),i.push(this.removeMatchingKeysForTargetId(e,o.targetId)),r++)})),Bn.waitFor(i).next((()=>r))}getTargetCount(e){return Bn.resolve(this.targetCount)}getTargetData(e,t){const n=this.Nr.get(t)||null;return Bn.resolve(n)}addMatchingKeys(e,t,n){return this.Br.Rr(t,n),Bn.resolve()}removeMatchingKeys(e,t,n){this.Br.mr(t,n);const r=this.persistence.referenceDelegate,i=[];return r&&t.forEach((t=>{i.push(r.markPotentiallyOrphaned(e,t))})),Bn.waitFor(i)}removeMatchingKeysForTargetId(e,t){return this.Br.gr(t),Bn.resolve()}getMatchingKeysForTargetId(e,t){const n=this.Br.yr(t);return Bn.resolve(n)}containsKey(e,t){return Bn.resolve(this.Br.containsKey(t))}}class ru{constructor(e,t){this.qr={},this.overlays={},this.Qr=new tr(0),this.Kr=!1,this.Kr=!0,this.$r=new Jl,this.referenceDelegate=e(this),this.Ur=new nu(this),this.indexManager=new al,this.remoteDocumentCache=function(e){return new eu(e)}((e=>this.referenceDelegate.Wr(e))),this.serializer=new Sa(t),this.Gr=new Wl(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let t=this.overlays[e.toKey()];return t||(t=new Ql,this.overlays[e.toKey()]=t),t}getMutationQueue(e,t){let n=this.qr[e.toKey()];return n||(n=new Zl(t,this.referenceDelegate),this.qr[e.toKey()]=n),n}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(e,t,n){Zt("MemoryPersistence","Starting transaction:",e);const r=new iu(this.Qr.next());return this.referenceDelegate.zr(),n(r).next((e=>this.referenceDelegate.jr(r).next((()=>e)))).toPromise().then((e=>(r.raiseOnCommittedEvent(),e)))}Hr(e,t){return Bn.or(Object.values(this.qr).map((n=>()=>n.containsKey(e,t))))}}class iu extends Vn{constructor(e){super(),this.currentSequenceNumber=e}}class su{constructor(e){this.persistence=e,this.Jr=new Yl,this.Yr=null}static Zr(e){return new su(e)}get Xr(){if(this.Yr)return this.Yr;throw rn()}addReference(e,t,n){return this.Jr.addReference(n,t),this.Xr.delete(n.toString()),Bn.resolve()}removeReference(e,t,n){return this.Jr.removeReference(n,t),this.Xr.add(n.toString()),Bn.resolve()}markPotentiallyOrphaned(e,t){return this.Xr.add(t.toString()),Bn.resolve()}removeTarget(e,t){this.Jr.gr(t.targetId).forEach((e=>this.Xr.add(e.toString())));const n=this.persistence.getTargetCache();return n.getMatchingKeysForTargetId(e,t.targetId).next((e=>{e.forEach((e=>this.Xr.add(e.toString())))})).next((()=>n.removeTargetData(e,t)))}zr(){this.Yr=new Set}jr(e){const t=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Bn.forEach(this.Xr,(n=>{const r=Nn.fromPath(n);return this.ei(e,r).next((e=>{e||t.removeEntry(r,En.min())}))})).next((()=>(this.Yr=null,t.apply(e))))}updateLimboDocument(e,t){return this.ei(e,t).next((e=>{e?this.Xr.delete(t.toString()):this.Xr.add(t.toString())}))}Wr(e){return 0}ei(e,t){return Bn.or([()=>Bn.resolve(this.Jr.containsKey(t)),()=>this.persistence.getTargetCache().containsKey(e,t),()=>this.persistence.Hr(e,t)])}}class ou{constructor(e){this.serializer=e}O(e,t,n,r){const i=new qn("createOrUpgrade",t);n<1&&r>=1&&(function(e){e.createObjectStore("owner")}(e),function(e){e.createObjectStore("mutationQueues",{keyPath:"userId"}),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ur,{unique:!0}),e.createObjectStore("documentMutations")}(e),au(e),function(e){e.createObjectStore("remoteDocuments")}(e));let s=Bn.resolve();return n<3&&r>=3&&(0!==n&&(function(e){e.deleteObjectStore("targetDocuments"),e.deleteObjectStore("targets"),e.deleteObjectStore("targetGlobal")}(e),au(e)),s=s.next((()=>function(e){const t=e.store("targetGlobal"),n={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:En.min().toTimestamp(),targetCount:0};return t.put("targetGlobalKey",n)}(i)))),n<4&&r>=4&&(0!==n&&(s=s.next((()=>function(e,t){return t.store("mutations").U().next((n=>{e.deleteObjectStore("mutations"),e.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",ur,{unique:!0});const r=t.store("mutations"),i=n.map((e=>r.put(e)));return Bn.waitFor(i)}))}(e,i)))),s=s.next((()=>{!function(e){e.createObjectStore("clientMetadata",{keyPath:"clientId"})}(e)}))),n<5&&r>=5&&(s=s.next((()=>this.ni(i)))),n<6&&r>=6&&(s=s.next((()=>(function(e){e.createObjectStore("remoteDocumentGlobal")}(e),this.ri(i))))),n<7&&r>=7&&(s=s.next((()=>this.ii(i)))),n<8&&r>=8&&(s=s.next((()=>this.si(e,i)))),n<9&&r>=9&&(s=s.next((()=>{!function(e){e.objectStoreNames.contains("remoteDocumentChanges")&&e.deleteObjectStore("remoteDocumentChanges")}(e)}))),n<10&&r>=10&&(s=s.next((()=>this.oi(i)))),n<11&&r>=11&&(s=s.next((()=>{!function(e){e.createObjectStore("bundles",{keyPath:"bundleId"})}(e),function(e){e.createObjectStore("namedQueries",{keyPath:"name"})}(e)}))),n<12&&r>=12&&(s=s.next((()=>{!function(e){const t=e.createObjectStore("documentOverlays",{keyPath:Er});t.createIndex("collectionPathOverlayIndex",Tr,{unique:!1}),t.createIndex("collectionGroupOverlayIndex",kr,{unique:!1})}(e)}))),n<13&&r>=13&&(s=s.next((()=>function(e){const t=e.createObjectStore("remoteDocumentsV14",{keyPath:fr});t.createIndex("documentKeyIndex",pr),t.createIndex("collectionGroupIndex",mr)}(e))).next((()=>this._i(e,i))).next((()=>e.deleteObjectStore("remoteDocuments")))),n<14&&r>=14&&(s=s.next((()=>this.ai(e,i)))),n<15&&r>=15&&(s=s.next((()=>function(e){e.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),e.createObjectStore("indexState",{keyPath:br}).createIndex("sequenceNumberIndex",_r,{unique:!1}),e.createObjectStore("indexEntries",{keyPath:Ir}).createIndex("documentKeyIndex",Sr,{unique:!1})}(e)))),n<16&&r>=16&&(s=s.next((()=>{t.objectStore("indexState").clear()})).next((()=>{t.objectStore("indexEntries").clear()}))),n<17&&r>=17&&(s=s.next((()=>{!function(e){e.createObjectStore("globals",{keyPath:"name"})}(e)}))),s}ri(e){let t=0;return e.store("remoteDocuments").J(((e,n)=>{t+=wl(n)})).next((()=>{const n={byteSize:t};return e.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",n)}))}ni(e){const t=e.store("mutationQueues"),n=e.store("mutations");return t.U().next((t=>Bn.forEach(t,(t=>{const r=IDBKeyRange.bound([t.userId,-1],[t.userId,t.lastAcknowledgedBatchId]);return n.U("userMutationsIndex",r).next((n=>Bn.forEach(n,(n=>{sn(n.userId===t.userId);const r=xa(this.serializer,n);return yl(e,t.userId,r).next((()=>{}))}))))}))))}ii(e){const t=e.store("targetDocuments"),n=e.store("remoteDocuments");return e.store("targetGlobal").get("targetGlobalKey").next((e=>{const r=[];return n.J(((n,i)=>{const s=new kn(n),o=function(e){return[0,sr(e)]}(s);r.push(t.get(o).next((n=>n?Bn.resolve():(n=>t.put({targetId:0,path:sr(n),sequenceNumber:e.highestListenSequenceNumber}))(s))))})).next((()=>Bn.waitFor(r)))}))}si(e,t){e.createObjectStore("collectionParents",{keyPath:wr});const n=t.store("collectionParents"),r=new ll,i=e=>{if(r.add(e)){const t=e.lastSegment(),r=e.popLast();return n.put({collectionId:t,parent:sr(r)})}};return t.store("remoteDocuments").J({H:!0},((e,t)=>{const n=new kn(e);return i(n.popLast())})).next((()=>t.store("documentMutations").J({H:!0},((e,t)=>{let[n,r,s]=e;const o=lr(r);return i(o.popLast())}))))}oi(e){const t=e.store("targets");return t.J(((e,n)=>{const r=Na(n),i=Aa(this.serializer,r);return t.put(i)}))}_i(e,t){const n=t.store("remoteDocuments"),r=[];return n.J(((e,n)=>{const i=t.store("remoteDocumentsV14"),s=function(e){return e.document?new Nn(kn.fromString(e.document.name).popFirst(5)):e.noDocument?Nn.fromSegments(e.noDocument.path):e.unknownDocument?Nn.fromSegments(e.unknownDocument.path):rn()}(n).path.toArray(),o={prefixPath:s.slice(0,s.length-2),collectionGroup:s[s.length-2],documentId:s[s.length-1],readTime:n.readTime||[0,0],unknownDocument:n.unknownDocument,noDocument:n.noDocument,document:n.document,hasCommittedMutations:!!n.hasCommittedMutations};r.push(i.put(o))})).next((()=>Bn.waitFor(r)))}ai(e,t){const n=t.store("mutations"),r=jl(this.serializer),i=new ru(su.Zr,this.serializer.ct);return n.U().next((e=>{const n=new Map;return e.forEach((e=>{var t;let r=null!==(t=n.get(e.userId))&&void 0!==t?t:Ms();xa(this.serializer,e).keys().forEach((e=>r=r.add(e))),n.set(e.userId,r)})),Bn.forEach(n,((e,n)=>{const s=new Qt(n),o=Ua.lt(this.serializer,s),a=i.getIndexManager(s),l=bl.lt(s,this.serializer,a,i.referenceDelegate);return new Hl(r,l,o,a).recalculateAndSaveOverlaysForDocumentKeys(new Or(t,tr.oe),e).next()}))}))}}function au(e){e.createObjectStore("targetDocuments",{keyPath:vr}).createIndex("documentTargetsIndex",yr,{unique:!0}),e.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",gr,{unique:!0}),e.createObjectStore("targetGlobal")}const lu="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.";class uu{constructor(e,t,n,r,i,s,o,a,l,u){let c=arguments.length>10&&void 0!==arguments[10]?arguments[10]:17;if(this.allowTabSynchronization=e,this.persistenceKey=t,this.clientId=n,this.ui=i,this.window=s,this.document=o,this.ci=l,this.li=u,this.hi=c,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=e=>Promise.resolve(),!uu.D())throw new ln(an.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new Ll(this,r),this.Ai=t+"main",this.serializer=new Sa(a),this.Ri=new $n(this.Ai,this.hi,new ou(this.serializer)),this.$r=new Va,this.Ur=new kl(this.referenceDelegate,this.serializer),this.remoteDocumentCache=jl(this.serializer),this.Gr=new La,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,!1===u&&en("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then((()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new ln(an.FAILED_PRECONDITION,lu);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",(e=>this.Ur.getHighestSequenceNumber(e)))})).then((e=>{this.Qr=new tr(e,this.ci)})).then((()=>{this.Kr=!0})).catch((e=>(this.Ri&&this.Ri.close(),Promise.reject(e))))}yi(e){return this.di=async t=>{if(this.started)return e(t)},e(this.isPrimary)}setDatabaseDeletedListener(e){this.Ri.L((async t=>{null===t.newVersion&&await e()}))}setNetworkEnabled(e){this.networkEnabled!==e&&(this.networkEnabled=e,this.ui.enqueueAndForget((async()=>{this.started&&await this.mi()})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",(e=>hu(e).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next((()=>{if(this.isPrimary)return this.wi(e).next((e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))))}))})).next((()=>this.Si(e))).next((t=>this.isPrimary&&!t?this.bi(e).next((()=>!1)):!!t&&this.Di(e).next((()=>!0)))))).catch((e=>{if(Wn(e))return Zt("IndexedDbPersistence","Failed to extend owner lease: ",e),this.isPrimary;if(!this.allowTabSynchronization)throw e;return Zt("IndexedDbPersistence","Releasing owner lease after error during lease refresh",e),!1})).then((e=>{this.isPrimary!==e&&this.ui.enqueueRetryable((()=>this.di(e))),this.isPrimary=e}))}wi(e){return cu(e).get("owner").next((e=>Bn.resolve(this.vi(e))))}Ci(e){return hu(e).delete(this.clientId)}async Fi(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();const e=await this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",(e=>{const t=Lr(e,"clientMetadata");return t.U().next((e=>{const n=this.xi(e,18e5),r=e.filter((e=>-1===n.indexOf(e)));return Bn.forEach(r,(e=>t.delete(e.clientId))).next((()=>r))}))})).catch((()=>[]));if(this.Vi)for(const t of e)this.Vi.removeItem(this.Oi(t.clientId))}}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,(()=>this.mi().then((()=>this.Fi())).then((()=>this.pi()))))}vi(e){return!!e&&e.ownerId===this.clientId}Si(e){return this.li?Bn.resolve(!0):cu(e).get("owner").next((t=>{if(null!==t&&this.Mi(t.leaseTimestampMs,5e3)&&!this.Ni(t.ownerId)){if(this.vi(t)&&this.networkEnabled)return!0;if(!this.vi(t)){if(!t.allowTabSynchronization)throw new ln(an.FAILED_PRECONDITION,lu);return!1}}return!(!this.networkEnabled||!this.inForeground)||hu(e).U().next((e=>void 0===this.xi(e,5e3).find((e=>{if(this.clientId!==e.clientId){const t=!this.networkEnabled&&e.networkEnabled,n=!this.inForeground&&e.inForeground,r=this.networkEnabled===e.networkEnabled;if(t||n&&r)return!0}return!1}))))})).next((e=>(this.isPrimary!==e&&Zt("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e)))}async shutdown(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),await this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],(e=>{const t=new Or(e,tr.oe);return this.bi(t).next((()=>this.Ci(t)))})),this.Ri.close(),this.qi()}xi(e,t){return e.filter((e=>this.Mi(e.updateTimeMs,t)&&!this.Ni(e.clientId)))}Qi(){return this.runTransaction("getActiveClients","readonly",(e=>hu(e).U().next((e=>this.xi(e,18e5).map((e=>e.clientId))))))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(e,t){return bl.lt(e,this.serializer,t,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(e){return new cl(e,this.serializer.ct.databaseId)}getDocumentOverlayCache(e){return Ua.lt(this.serializer,e)}getBundleCache(){return this.Gr}runTransaction(e,t,n){Zt("IndexedDbPersistence","Starting transaction:",e);const r="readonly"===t?"readonly":"readwrite",i=function(e){return 17===e?Dr:16===e?Rr:15===e?Pr:14===e?Ar:13===e?Nr:12===e?xr:11===e?Cr:void rn()}(this.hi);let s;return this.Ri.runTransaction(e,r,i,(r=>(s=new Or(r,this.Qr?this.Qr.next():tr.oe),"readwrite-primary"===t?this.wi(s).next((e=>!!e||this.Si(s))).next((t=>{if(!t)throw en(`Failed to obtain primary lease for action '${e}'.`),this.isPrimary=!1,this.ui.enqueueRetryable((()=>this.di(!1))),new ln(an.FAILED_PRECONDITION,jn);return n(s)})).next((e=>this.Di(s).next((()=>e)))):this.Ki(s).next((()=>n(s)))))).then((e=>(s.raiseOnCommittedEvent(),e)))}Ki(e){return cu(e).get("owner").next((e=>{if(null!==e&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new ln(an.FAILED_PRECONDITION,lu)}))}Di(e){const t={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return cu(e).put("owner",t)}static D(){return $n.D()}bi(e){const t=cu(e);return t.get("owner").next((e=>this.vi(e)?(Zt("IndexedDbPersistence","Releasing primary lease."),t.delete("owner")):Bn.resolve()))}Mi(e,t){const n=Date.now();return!(e<n-t)&&(!(e>n)||(en(`Detected an update time that is in the future: ${e} > ${n}`),!1))}fi(){null!==this.document&&"function"==typeof this.document.addEventListener&&(this.Ii=()=>{this.ui.enqueueAndForget((()=>(this.inForeground="visible"===this.document.visibilityState,this.mi())))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground="visible"===this.document.visibilityState)}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var e;"function"==typeof(null===(e=this.window)||void 0===e?void 0:e.addEventListener)&&(this.Pi=()=>{this.Li();const e=/(?:Version|Mobile)\/1[456]/;L()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget((()=>this.shutdown()))},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(e){var t;try{const n=null!==(null===(t=this.Vi)||void 0===t?void 0:t.getItem(this.Oi(e)));return Zt("IndexedDbPersistence",`Client '${e}' ${n?"is":"is not"} zombied in LocalStorage`),n}catch(e){return en("IndexedDbPersistence","Failed to get zombied client id.",e),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(e){en("Failed to set zombie client id.",e)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch(e){}}Oi(e){return`firestore_zombie_${this.persistenceKey}_${e}`}}function cu(e){return Lr(e,"owner")}function hu(e){return Lr(e,"clientMetadata")}function du(e,t){let n=e.projectId;return e.isDefaultDatabase||(n+="."+e.database),"firestore/"+t+"/"+n+"/"}class fu{constructor(e,t,n,r){this.targetId=e,this.fromCache=t,this.$i=n,this.Ui=r}static Wi(e,t){let n=Ms(),r=Ms();for(const i of t.docChanges)switch(i.type){case 0:n=n.add(i.doc.key);break;case 1:r=r.add(i.doc.key)}return new fu(e,t.fromCache,n,r)}}class pu{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}class mu{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=L()?8:Kn(N())>0?6:4}initialize(e,t){this.Ji=e,this.indexManager=t,this.Gi=!0}getDocumentsMatchingQuery(e,t,n,r){const i={result:null};return this.Yi(e,t).next((e=>{i.result=e})).next((()=>{if(!i.result)return this.Zi(e,t,r,n).next((e=>{i.result=e}))})).next((()=>{if(i.result)return;const n=new pu;return this.Xi(e,t,n).next((r=>{if(i.result=r,this.zi)return this.es(e,t,n,r.size)}))})).next((()=>i.result))}es(e,t,n,r){return n.documentReadCount<this.ji?(Xt()<=te.DEBUG&&Zt("QueryEngine","SDK will not create cache indexes for query:",bs(t),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),Bn.resolve()):(Xt()<=te.DEBUG&&Zt("QueryEngine","Query:",bs(t),"scans",n.documentReadCount,"local documents and returns",r,"documents as results."),n.documentReadCount>this.Hi*r?(Xt()<=te.DEBUG&&Zt("QueryEngine","The SDK decides to create cache indexes for query:",bs(t),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,ps(t))):Bn.resolve())}Yi(e,t){if(hs(t))return Bn.resolve(null);let n=ps(t);return this.indexManager.getIndexType(e,n).next((r=>0===r?null:(null!==t.limit&&1===r&&(t=vs(t,null,"F"),n=ps(t)),this.indexManager.getDocumentsMatchingTarget(e,n).next((r=>{const i=Ms(...r);return this.Ji.getDocuments(e,i).next((r=>this.indexManager.getMinOffset(e,n).next((n=>{const s=this.ts(t,r);return this.ns(t,s,i,n.readTime)?this.Yi(e,vs(t,null,"F")):this.rs(e,s,t,n)}))))})))))}Zi(e,t,n,r){return hs(t)||r.isEqual(En.min())?Bn.resolve(null):this.Ji.getDocuments(e,n).next((i=>{const s=this.ts(t,i);return this.ns(t,s,n,r)?Bn.resolve(null):(Xt()<=te.DEBUG&&Zt("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),bs(t)),this.rs(e,s,t,Ln(r,-1)).next((e=>e)))}))}ts(e,t){let n=new Br(Ss(e));return t.forEach(((t,r)=>{_s(e,r)&&(n=n.add(r))})),n}ns(e,t,n,r){if(null===e.limit)return!1;if(n.size!==t.size)return!0;const i="F"===e.limitType?t.last():t.first();return!!i&&(i.hasPendingWrites||i.version.compareTo(r)>0)}Xi(e,t,n){return Xt()<=te.DEBUG&&Zt("QueryEngine","Using full collection scan to execute query:",bs(t)),this.Ji.getDocumentsMatchingQuery(e,t,Fn.min(),n)}rs(e,t,n,r){return this.Ji.getDocumentsMatchingQuery(e,n,r).next((e=>(t.forEach((t=>{e=e.insert(t.key,t)})),e)))}}class gu{constructor(e,t,n,r){this.persistence=e,this.ss=t,this.serializer=r,this.os=new jr(bn),this._s=new Ts((e=>ns(e)),rs),this.us=new Map,this.cs=e.getRemoteDocumentCache(),this.Ur=e.getTargetCache(),this.Gr=e.getBundleCache(),this.ls(n)}ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new Hl(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",(t=>e.collect(t,this.os)))}}function vu(e,t,n,r){return new gu(e,t,n,r)}async function yu(e,t){const n=on(e);return await n.persistence.runTransaction("Handle user change","readonly",(e=>{let r;return n.mutationQueue.getAllMutationBatches(e).next((i=>(r=i,n.ls(t),n.mutationQueue.getAllMutationBatches(e)))).next((t=>{const i=[],s=[];let o=Ms();for(const e of r){i.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}for(const e of t){s.push(e.batchId);for(const t of e.mutations)o=o.add(t.key)}return n.localDocuments.getDocuments(e,o).next((e=>({hs:e,removedBatchIds:i,addedBatchIds:s})))}))}))}function wu(e){const t=on(e);return t.persistence.runTransaction("Get last remote snapshot version","readonly",(e=>t.Ur.getLastRemoteSnapshotVersion(e)))}function bu(e,t,n){let r=Ms(),i=Ms();return n.forEach((e=>r=r.add(e))),t.getEntries(e,r).next((e=>{let r=Cs();return n.forEach(((n,s)=>{const o=e.get(n);s.isFoundDocument()!==o.isFoundDocument()&&(i=i.add(n)),s.isNoDocument()&&s.version.isEqual(En.min())?(t.removeEntry(n,s.readTime),r=r.insert(n,s)):!o.isValidDocument()||s.version.compareTo(o.version)>0||0===s.version.compareTo(o.version)&&o.hasPendingWrites?(t.addEntry(s),r=r.insert(n,s)):Zt("LocalStore","Ignoring outdated watch update for ",n,". Current version:",o.version," Watch version:",s.version)})),{Ps:r,Is:i}}))}function _u(e,t){const n=on(e);return n.persistence.runTransaction("Get next mutation batch","readonly",(e=>(void 0===t&&(t=-1),n.mutationQueue.getNextMutationBatchAfterBatchId(e,t))))}function Iu(e,t){const n=on(e);return n.persistence.runTransaction("Allocate target","readwrite",(e=>{let r;return n.Ur.getTargetData(e,t).next((i=>i?(r=i,Bn.resolve(r)):n.Ur.allocateTargetId(e).next((i=>(r=new Ia(t,i,"TargetPurposeListen",e.currentSequenceNumber),n.Ur.addTargetData(e,r).next((()=>r)))))))})).then((e=>{const r=n.os.get(e.targetId);return(null===r||e.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(n.os=n.os.insert(e.targetId,e),n._s.set(t,e.targetId)),e}))}async function Su(e,t,n){const r=on(e),i=r.os.get(t),s=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",s,(e=>r.persistence.referenceDelegate.removeTarget(e,i)))}catch(e){if(!Wn(e))throw e;Zt("LocalStore",`Failed to update sequence numbers for target ${t}: ${e}`)}r.os=r.os.remove(t),r._s.delete(i.target)}function Eu(e,t,n){const r=on(e);let i=En.min(),s=Ms();return r.persistence.runTransaction("Execute query","readwrite",(e=>function(e,t,n){const r=on(e),i=r._s.get(n);return void 0!==i?Bn.resolve(r.os.get(i)):r.Ur.getTargetData(t,n)}(r,e,ps(t)).next((t=>{if(t)return i=t.lastLimboFreeSnapshotVersion,r.Ur.getMatchingKeysForTargetId(e,t.targetId).next((e=>{s=e}))})).next((()=>r.ss.getDocumentsMatchingQuery(e,t,n?i:En.min(),n?s:Ms()))).next((e=>(Cu(r,Is(t),e),{documents:e,Ts:s})))))}function Tu(e,t){const n=on(e),r=on(n.Ur),i=n.os.get(t);return i?Promise.resolve(i.target):n.persistence.runTransaction("Get target data","readonly",(e=>r.ot(e,t).next((e=>e?e.target:null))))}function ku(e,t){const n=on(e),r=n.us.get(t)||En.min();return n.persistence.runTransaction("Get new document changes","readonly",(e=>n.cs.getAllFromCollectionGroup(e,t,Ln(r,-1),Number.MAX_SAFE_INTEGER))).then((e=>(Cu(n,t,e),e)))}function Cu(e,t,n){let r=e.us.get(t)||En.min();n.forEach(((e,t)=>{t.readTime.compareTo(r)>0&&(r=t.readTime)})),e.us.set(t,r)}async function xu(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Ms();const r=await Iu(e,ps(Pa(t.bundledQuery))),i=on(e);return i.persistence.runTransaction("Save named query","readwrite",(e=>{const s=Jo(t.readTime);if(r.snapshotVersion.compareTo(s)>=0)return i.Gr.saveNamedQuery(e,t);const o=r.withResumeToken(Hr.EMPTY_BYTE_STRING,s);return i.os=i.os.insert(o.targetId,o),i.Ur.updateTargetData(e,o).next((()=>i.Ur.removeMatchingKeysForTargetId(e,r.targetId))).next((()=>i.Ur.addMatchingKeys(e,n,r.targetId))).next((()=>i.Gr.saveNamedQuery(e,t)))}))}function Nu(e,t){return`firestore_clients_${e}_${t}`}function Au(e,t,n){let r=`firestore_mutations_${e}_${n}`;return t.isAuthenticated()&&(r+=`_${t.uid}`),r}function Pu(e,t){return`firestore_targets_${e}_${t}`}class Ru{constructor(e,t,n,r){this.user=e,this.batchId=t,this.state=n,this.error=r}static Rs(e,t,n){const r=JSON.parse(n);let i,s="object"==typeof r&&-1!==["pending","acknowledged","rejected"].indexOf(r.state)&&(void 0===r.error||"object"==typeof r.error);return s&&r.error&&(s="string"==typeof r.error.message&&"string"==typeof r.error.code,s&&(i=new ln(r.error.code,r.error.message))),s?new Ru(e,t,r.state,i):(en("SharedClientState",`Failed to parse mutation state for ID '${t}': ${n}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Du{constructor(e,t,n){this.targetId=e,this.state=t,this.error=n}static Rs(e,t){const n=JSON.parse(t);let r,i="object"==typeof n&&-1!==["not-current","current","rejected"].indexOf(n.state)&&(void 0===n.error||"object"==typeof n.error);return i&&n.error&&(i="string"==typeof n.error.message&&"string"==typeof n.error.code,i&&(r=new ln(n.error.code,n.error.message))),i?new Du(e,n.state,r):(en("SharedClientState",`Failed to parse target state for ID '${e}': ${t}`),null)}Vs(){const e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)}}class Ou{constructor(e,t){this.clientId=e,this.activeTargetIds=t}static Rs(e,t){const n=JSON.parse(t);let r="object"==typeof n&&n.activeTargetIds instanceof Array,i=Us();for(let s=0;r&&s<n.activeTargetIds.length;++s)r=ir(n.activeTargetIds[s]),i=i.add(n.activeTargetIds[s]);return r?new Ou(e,i):(en("SharedClientState",`Failed to parse client data for instance '${e}': ${t}`),null)}}class Lu{constructor(e,t){this.clientId=e,this.onlineState=t}static Rs(e){const t=JSON.parse(e);return"object"==typeof t&&-1!==["Unknown","Online","Offline"].indexOf(t.onlineState)&&"string"==typeof t.clientId?new Lu(t.clientId,t.onlineState):(en("SharedClientState",`Failed to parse online state: ${e}`),null)}}class Mu{constructor(){this.activeTargetIds=Us()}fs(e){this.activeTargetIds=this.activeTargetIds.add(e)}gs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}Vs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fu{constructor(e,t,n,r,i){this.window=e,this.ui=t,this.persistenceKey=n,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new jr(bn),this.started=!1,this.bs=[];const s=n.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=i,this.Ds=Nu(this.persistenceKey,this.ps),this.vs=function(e){return`firestore_sequence_number_${e}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new Mu),this.Cs=new RegExp(`^firestore_clients_${s}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${s}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${s}_(\\d+)$`),this.xs=function(e){return`firestore_online_state_${e}`}(this.persistenceKey),this.Os=function(e){return`firestore_bundle_loaded_v2_${e}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(e){return!(!e||!e.localStorage)}async start(){const e=await this.syncEngine.Qi();for(const n of e){if(n===this.ps)continue;const e=this.getItem(Nu(this.persistenceKey,n));if(e){const t=Ou.Rs(n,e);t&&(this.Ss=this.Ss.insert(t.clientId,t))}}this.Ns();const t=this.storage.getItem(this.xs);if(t){const e=this.Ls(t);e&&this.Bs(e)}for(const n of this.bs)this.ws(n);this.bs=[],this.window.addEventListener("pagehide",(()=>this.shutdown())),this.started=!0}writeSequenceNumber(e){this.setItem(this.vs,JSON.stringify(e))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(e){let t=!1;return this.Ss.forEach(((n,r)=>{r.activeTargetIds.has(e)&&(t=!0)})),t}addPendingMutation(e){this.qs(e,"pending")}updateMutationState(e,t,n){this.qs(e,t,n),this.Qs(e)}addLocalQueryTarget(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="not-current";if(this.isActiveQueryTarget(e)){const t=this.storage.getItem(Pu(this.persistenceKey,e));if(t){const r=Du.Rs(e,t);r&&(n=r.state)}}return t&&this.Ks.fs(e),this.Ns(),n}removeLocalQueryTarget(e){this.Ks.gs(e),this.Ns()}isLocalQueryTarget(e){return this.Ks.activeTargetIds.has(e)}clearQueryState(e){this.removeItem(Pu(this.persistenceKey,e))}updateQueryState(e,t,n){this.$s(e,t,n)}handleUserChange(e,t,n){t.forEach((e=>{this.Qs(e)})),this.currentUser=e,n.forEach((e=>{this.addPendingMutation(e)}))}setOnlineState(e){this.Us(e)}notifyBundleLoaded(e){this.Ws(e)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(e){const t=this.storage.getItem(e);return Zt("SharedClientState","READ",e,t),t}setItem(e,t){Zt("SharedClientState","SET",e,t),this.storage.setItem(e,t)}removeItem(e){Zt("SharedClientState","REMOVE",e),this.storage.removeItem(e)}ws(e){const t=e;if(t.storageArea===this.storage){if(Zt("SharedClientState","EVENT",t.key,t.newValue),t.key===this.Ds)return void en("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable((async()=>{if(this.started){if(null!==t.key)if(this.Cs.test(t.key)){if(null==t.newValue){const e=this.Gs(t.key);return this.zs(e,null)}{const e=this.js(t.key,t.newValue);if(e)return this.zs(e.clientId,e)}}else if(this.Fs.test(t.key)){if(null!==t.newValue){const e=this.Hs(t.key,t.newValue);if(e)return this.Js(e)}}else if(this.Ms.test(t.key)){if(null!==t.newValue){const e=this.Ys(t.key,t.newValue);if(e)return this.Zs(e)}}else if(t.key===this.xs){if(null!==t.newValue){const e=this.Ls(t.newValue);if(e)return this.Bs(e)}}else if(t.key===this.vs){const e=function(e){let t=tr.oe;if(null!=e)try{const n=JSON.parse(e);sn("number"==typeof n),t=n}catch(e){en("SharedClientState","Failed to read sequence number from WebStorage",e)}return t}(t.newValue);e!==tr.oe&&this.sequenceNumberHandler(e)}else if(t.key===this.Os){const e=this.Xs(t.newValue);await Promise.all(e.map((e=>this.syncEngine.eo(e))))}}else this.bs.push(t)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(e,t,n){const r=new Ru(this.currentUser,e,t,n),i=Au(this.persistenceKey,this.currentUser,e);this.setItem(i,r.Vs())}Qs(e){const t=Au(this.persistenceKey,this.currentUser,e);this.removeItem(t)}Us(e){const t={clientId:this.ps,onlineState:e};this.storage.setItem(this.xs,JSON.stringify(t))}$s(e,t,n){const r=Pu(this.persistenceKey,e),i=new Du(e,t,n);this.setItem(r,i.Vs())}Ws(e){const t=JSON.stringify(Array.from(e));this.setItem(this.Os,t)}Gs(e){const t=this.Cs.exec(e);return t?t[1]:null}js(e,t){const n=this.Gs(e);return Ou.Rs(n,t)}Hs(e,t){const n=this.Fs.exec(e),r=Number(n[1]),i=void 0!==n[2]?n[2]:null;return Ru.Rs(new Qt(i),r,t)}Ys(e,t){const n=this.Ms.exec(e),r=Number(n[1]);return Du.Rs(r,t)}Ls(e){return Lu.Rs(e)}Xs(e){return JSON.parse(e)}async Js(e){if(e.user.uid===this.currentUser.uid)return this.syncEngine.no(e.batchId,e.state,e.error);Zt("SharedClientState",`Ignoring mutation for non-active user ${e.user.uid}`)}Zs(e){return this.syncEngine.ro(e.targetId,e.state,e.error)}zs(e,t){const n=t?this.Ss.insert(e,t):this.Ss.remove(e),r=this.ks(this.Ss),i=this.ks(n),s=[],o=[];return i.forEach((e=>{r.has(e)||s.push(e)})),r.forEach((e=>{i.has(e)||o.push(e)})),this.syncEngine.io(s,o).then((()=>{this.Ss=n}))}Bs(e){this.Ss.get(e.clientId)&&this.onlineStateHandler(e.onlineState)}ks(e){let t=Us();return e.forEach(((e,n)=>{t=t.unionWith(n.activeTargetIds)})),t}}class Uu{constructor(){this.so=new Mu,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,t,n){}addLocalQueryTarget(e){return(!(arguments.length>1&&void 0!==arguments[1])||arguments[1])&&this.so.fs(e),this.oo[e]||"not-current"}updateQueryState(e,t,n){this.oo[e]=t}removeLocalQueryTarget(e){this.so.gs(e)}isLocalQueryTarget(e){return this.so.activeTargetIds.has(e)}clearQueryState(e){delete this.oo[e]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(e){return this.so.activeTargetIds.has(e)}start(){return this.so=new Mu,Promise.resolve()}handleUserChange(e,t,n){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}class ju{_o(e){}shutdown(){}}class Vu{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(e){this.ho.push(e)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){Zt("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(const e of this.ho)e(0)}lo(){Zt("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(const e of this.ho)e(1)}static D(){return"undefined"!=typeof window&&void 0!==window.addEventListener&&void 0!==window.removeEventListener}}let zu=null;function Bu(){return null===zu?zu=268435456+Math.round(2147483648*Math.random()):zu++,"0x"+zu.toString(16)}const qu={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class $u{constructor(e){this.Io=e.Io,this.To=e.To}Eo(e){this.Ao=e}Ro(e){this.Vo=e}mo(e){this.fo=e}onMessage(e){this.po=e}close(){this.To()}send(e){this.Io(e)}yo(){this.Ao()}wo(){this.Vo()}So(e){this.fo(e)}bo(e){this.po(e)}}const Ku="WebChannelConnection";class Gu extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const t=e.ssl?"https":"http",n=encodeURIComponent(this.databaseId.projectId),r=encodeURIComponent(this.databaseId.database);this.Do=t+"://"+e.host,this.vo=`projects/${n}/databases/${r}`,this.Co="(default)"===this.databaseId.database?`project_id=${n}`:`project_id=${n}&database_id=${r}`}get Fo(){return!1}Mo(e,t,n,r,i){const s=Bu(),o=this.xo(e,t.toUriEncodedString());Zt("RestConnection",`Sending RPC '${e}' ${s}:`,o,n);const a={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(a,r,i),this.No(e,o,a,n).then((t=>(Zt("RestConnection",`Received RPC '${e}' ${s}: `,t),t)),(t=>{throw tn("RestConnection",`RPC '${e}' ${s} failed with error: `,t,"url: ",o,"request:",n),t}))}Lo(e,t,n,r,i,s){return this.Mo(e,t,n,r,i)}Oo(e,t,n){e["X-Goog-Api-Client"]="gl-js/ fire/"+Jt,e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),t&&t.headers.forEach(((t,n)=>e[n]=t)),n&&n.headers.forEach(((t,n)=>e[n]=t))}xo(e,t){const n=qu[e];return`${this.Do}/v1/${t}:${n}`}terminate(){}}{constructor(e){super(e),this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}No(e,t,n,r){const i=Bu();return new Promise(((s,o)=>{const a=new Ut;a.setWithCredentials(!0),a.listenOnce(Vt.COMPLETE,(()=>{try{switch(a.getLastErrorCode()){case zt.NO_ERROR:const t=a.getResponseJson();Zt(Ku,`XHR for RPC '${e}' ${i} received:`,JSON.stringify(t)),s(t);break;case zt.TIMEOUT:Zt(Ku,`RPC '${e}' ${i} timed out`),o(new ln(an.DEADLINE_EXCEEDED,"Request time out"));break;case zt.HTTP_ERROR:const n=a.getStatus();if(Zt(Ku,`RPC '${e}' ${i} failed with status:`,n,"response text:",a.getResponseText()),n>0){let e=a.getResponseJson();Array.isArray(e)&&(e=e[0]);const t=null==e?void 0:e.error;if(t&&t.status&&t.message){const e=function(e){const t=e.toLowerCase().replace(/_/g,"-");return Object.values(an).indexOf(t)>=0?t:an.UNKNOWN}(t.status);o(new ln(e,t.message))}else o(new ln(an.UNKNOWN,"Server responded with status "+a.getStatus()))}else o(new ln(an.UNAVAILABLE,"Connection failed."));break;default:rn()}}finally{Zt(Ku,`RPC '${e}' ${i} completed.`)}}));const l=JSON.stringify(r);Zt(Ku,`RPC '${e}' ${i} sending request:`,r),a.send(t,"POST",l,n,15)}))}Bo(e,t,n){const r=Bu(),i=[this.Do,"/","google.firestore.v1.Firestore","/",e,"/channel"],s=Kt(),o=$t(),a={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;void 0!==l&&(a.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(a.useFetchStreams=!0),this.Oo(a.initMessageHeaders,t,n),a.encodeInitMessageHeaders=!0;const u=i.join("");Zt(Ku,`Creating RPC '${e}' stream ${r}: ${u}`,a);const c=s.createWebChannel(u,a);let h=!1,d=!1;const f=new $u({Io:t=>{d?Zt(Ku,`Not sending because RPC '${e}' stream ${r} is closed:`,t):(h||(Zt(Ku,`Opening RPC '${e}' stream ${r} transport.`),c.open(),h=!0),Zt(Ku,`RPC '${e}' stream ${r} sending:`,t),c.send(t))},To:()=>c.close()}),p=(e,t,n)=>{e.listen(t,(e=>{try{n(e)}catch(e){setTimeout((()=>{throw e}),0)}}))};return p(c,jt.EventType.OPEN,(()=>{d||(Zt(Ku,`RPC '${e}' stream ${r} transport opened.`),f.yo())})),p(c,jt.EventType.CLOSE,(()=>{d||(d=!0,Zt(Ku,`RPC '${e}' stream ${r} transport closed`),f.So())})),p(c,jt.EventType.ERROR,(t=>{d||(d=!0,tn(Ku,`RPC '${e}' stream ${r} transport errored:`,t),f.So(new ln(an.UNAVAILABLE,"The operation could not be completed")))})),p(c,jt.EventType.MESSAGE,(t=>{var n;if(!d){const i=t.data[0];sn(!!i);const s=i,o=s.error||(null===(n=s[0])||void 0===n?void 0:n.error);if(o){Zt(Ku,`RPC '${e}' stream ${r} received error:`,o);const t=o.status;let n=function(e){const t=Io[e];if(void 0!==t)return To(t)}(t),i=o.message;void 0===n&&(n=an.INTERNAL,i="Unknown error status: "+t+" with message "+o.message),d=!0,f.So(new ln(n,i)),c.close()}else Zt(Ku,`RPC '${e}' stream ${r} received:`,i),f.bo(i)}})),p(o,qt.STAT_EVENT,(t=>{t.stat===Bt.PROXY?Zt(Ku,`RPC '${e}' stream ${r} detected buffering proxy`):t.stat===Bt.NOPROXY&&Zt(Ku,`RPC '${e}' stream ${r} detected no buffering proxy`)})),setTimeout((()=>{f.wo()}),0),f}}function Hu(){return"undefined"!=typeof window?window:null}function Wu(){return"undefined"!=typeof document?document:null}function Qu(e){return new Ko(e,!0)}class Ju{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1e3,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1.5,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:6e4;this.ui=e,this.timerId=t,this.ko=n,this.qo=r,this.Qo=i,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(e){this.cancel();const t=Math.floor(this.Ko+this.zo()),n=Math.max(0,Date.now()-this.Uo),r=Math.max(0,t-n);r>0&&Zt("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${t} ms, last attempt: ${n} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,(()=>(this.Uo=Date.now(),e()))),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){null!==this.$o&&(this.$o.skipDelay(),this.$o=null)}cancel(){null!==this.$o&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}}class Yu{constructor(e,t,n,r,i,s,o,a){this.ui=e,this.Ho=n,this.Jo=r,this.connection=i,this.authCredentialsProvider=s,this.appCheckCredentialsProvider=o,this.listener=a,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new Ju(e,t)}n_(){return 1===this.state||5===this.state||this.r_()}r_(){return 2===this.state||3===this.state}start(){this.e_=0,4!==this.state?this.auth():this.i_()}async stop(){this.n_()&&await this.close(0)}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&null===this.Zo&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,(()=>this.__())))}a_(e){this.u_(),this.stream.send(e)}async __(){if(this.r_())return this.close(0)}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}async close(e,t){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,4!==e?this.t_.reset():t&&t.code===an.RESOURCE_EXHAUSTED?(en(t.toString()),en("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):t&&t.code===an.UNAUTHENTICATED&&3!==this.state&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),null!==this.stream&&(this.l_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.mo(t)}l_(){}auth(){this.state=1;const e=this.h_(this.Yo),t=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then((e=>{let[n,r]=e;this.Yo===t&&this.P_(n,r)}),(t=>{e((()=>{const e=new ln(an.UNKNOWN,"Fetching auth token failed: "+t.message);return this.I_(e)}))}))}P_(e,t){const n=this.h_(this.Yo);this.stream=this.T_(e,t),this.stream.Eo((()=>{n((()=>this.listener.Eo()))})),this.stream.Ro((()=>{n((()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,(()=>(this.r_()&&(this.state=3),Promise.resolve()))),this.listener.Ro())))})),this.stream.mo((e=>{n((()=>this.I_(e)))})),this.stream.onMessage((e=>{n((()=>1==++this.e_?this.E_(e):this.onNext(e)))}))}i_(){this.state=5,this.t_.Go((async()=>{this.state=0,this.start()}))}I_(e){return Zt("PersistentStream",`close with error: ${e}`),this.stream=null,this.close(4,e)}h_(e){return t=>{this.ui.enqueueAndForget((()=>this.Yo===e?t():(Zt("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())))}}}class Xu extends Yu{constructor(e,t,n,r,i,s){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}T_(e,t){return this.connection.Bo("Listen",e,t)}E_(e){return this.onNext(e)}onNext(e){this.t_.reset();const t=function(e,t){let n;if("targetChange"in t){t.targetChange;const r=function(e){return"NO_CHANGE"===e?0:"ADD"===e?1:"REMOVE"===e?2:"CURRENT"===e?3:"RESET"===e?4:rn()}(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],s=function(e,t){return e.useProto3Json?(sn(void 0===t||"string"==typeof t),Hr.fromBase64String(t||"")):(sn(void 0===t||t instanceof Buffer||t instanceof Uint8Array),Hr.fromUint8Array(t||new Uint8Array))}(e,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(e){const t=void 0===e.code?an.UNKNOWN:To(e.code);return new ln(t,e.message||"")}(o);n=new Fo(r,i,s,a||null)}else if("documentChange"in t){t.documentChange;const r=t.documentChange;r.document,r.document.name,r.document.updateTime;const i=ta(e,r.document.name),s=Jo(r.document.updateTime),o=r.document.createTime?Jo(r.document.createTime):En.min(),a=new Ci({mapValue:{fields:r.document.fields}}),l=Ni.newFoundDocument(i,s,o,a),u=r.targetIds||[],c=r.removedTargetIds||[];n=new Lo(u,c,l.key,l)}else if("documentDelete"in t){t.documentDelete;const r=t.documentDelete;r.document;const i=ta(e,r.document),s=r.readTime?Jo(r.readTime):En.min(),o=Ni.newNoDocument(i,s),a=r.removedTargetIds||[];n=new Lo([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;const r=t.documentRemove;r.document;const i=ta(e,r.document),s=r.removedTargetIds||[];n=new Lo([],s,i,null)}else{if(!("filter"in t))return rn();{t.filter;const e=t.filter;e.targetId;const{count:r=0,unchangedNames:i}=e,s=new _o(r,i),o=e.targetId;n=new Mo(o,s)}}return n}(this.serializer,e),n=function(e){if(!("targetChange"in e))return En.min();const t=e.targetChange;return t.targetIds&&t.targetIds.length?En.min():t.readTime?Jo(t.readTime):En.min()}(e);return this.listener.d_(t,n)}A_(e){const t={};t.database=ia(this.serializer),t.addTarget=function(e,t){let n;const r=t.target;if(n=is(r)?{documents:ca(e,r)}:{query:ha(e,r)._t},n.targetId=t.targetId,t.resumeToken.approximateByteSize()>0){n.resumeToken=Wo(e,t.resumeToken);const r=Go(e,t.expectedCount);null!==r&&(n.expectedCount=r)}else if(t.snapshotVersion.compareTo(En.min())>0){n.readTime=Ho(e,t.snapshotVersion.toTimestamp());const r=Go(e,t.expectedCount);null!==r&&(n.expectedCount=r)}return n}(this.serializer,e);const n=function(e,t){const n=function(e){switch(e){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return rn()}}(t.purpose);return null==n?null:{"goog-listen-tags":n}}(this.serializer,e);n&&(t.labels=n),this.a_(t)}R_(e){const t={};t.database=ia(this.serializer),t.removeTarget=e,this.a_(t)}}class Zu extends Yu{constructor(e,t,n,r,i,s){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",t,n,r,s),this.serializer=i}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(e,t){return this.connection.Bo("Write",e,t)}E_(e){return sn(!!e.streamToken),this.lastStreamToken=e.streamToken,sn(!e.writeResults||0===e.writeResults.length),this.listener.f_()}onNext(e){sn(!!e.streamToken),this.lastStreamToken=e.streamToken,this.t_.reset();const t=function(e,t){return e&&e.length>0?(sn(void 0!==t),e.map((e=>function(e,t){let n=e.updateTime?Jo(e.updateTime):Jo(t);return n.isEqual(En.min())&&(n=Jo(t)),new to(n,e.transformResults||[])}(e,t)))):[]}(e.writeResults,e.commitTime),n=Jo(e.commitTime);return this.listener.g_(n,t)}p_(){const e={};e.database=ia(this.serializer),this.a_(e)}m_(e){const t={streamToken:this.lastStreamToken,writes:e.map((e=>la(this.serializer,e)))};this.a_(t)}}class ec extends class{}{constructor(e,t,n,r){super(),this.authCredentials=e,this.appCheckCredentials=t,this.connection=n,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new ln(an.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(e,t,n,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((i=>{let[s,o]=i;return this.connection.Mo(e,Xo(t,n),r,s,o)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===an.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ln(an.UNKNOWN,e.toString())}))}Lo(e,t,n,r,i){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then((s=>{let[o,a]=s;return this.connection.Lo(e,Xo(t,n),r,o,a,i)})).catch((e=>{throw"FirebaseError"===e.name?(e.code===an.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),e):new ln(an.UNKNOWN,e.toString())}))}terminate(){this.y_=!0,this.connection.terminate()}}class tc{constructor(e,t){this.asyncQueue=e,this.onlineStateHandler=t,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){0===this.S_&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,(()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve()))))}M_(e){"Online"===this.state?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.C_("Offline")))}set(e){this.x_(),this.S_=0,"Online"===e&&(this.D_=!1),this.C_(e)}C_(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}F_(e){const t=`Could not reach Cloud Firestore backend. ${e}\nThis typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(en(t),this.D_=!1):Zt("OnlineStateTracker",t)}x_(){null!==this.b_&&(this.b_.cancel(),this.b_=null)}}class nc{constructor(e,t,n,r,i){this.localStore=e,this.datastore=t,this.asyncQueue=n,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=i,this.k_._o((e=>{n.enqueueAndForget((async()=>{hc(this)&&(Zt("RemoteStore","Restarting streams for network reachability change."),await async function(e){const t=on(e);t.L_.add(4),await ic(t),t.q_.set("Unknown"),t.L_.delete(4),await rc(t)}(this))}))})),this.q_=new tc(n,r)}}async function rc(e){if(hc(e))for(const t of e.B_)await t(!0)}async function ic(e){for(const t of e.B_)await t(!1)}function sc(e,t){const n=on(e);n.N_.has(t.targetId)||(n.N_.set(t.targetId,t),cc(n)?uc(n):Ac(n).r_()&&ac(n,t))}function oc(e,t){const n=on(e),r=Ac(n);n.N_.delete(t),r.r_()&&lc(n,t),0===n.N_.size&&(r.r_()?r.o_():hc(n)&&n.q_.set("Unknown"))}function ac(e,t){if(e.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(En.min())>0){const n=e.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(n)}Ac(e).A_(t)}function lc(e,t){e.Q_.xe(t),Ac(e).R_(t)}function uc(e){e.Q_=new jo({getRemoteKeysForTarget:t=>e.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>e.N_.get(t)||null,tt:()=>e.datastore.serializer.databaseId}),Ac(e).start(),e.q_.v_()}function cc(e){return hc(e)&&!Ac(e).n_()&&e.N_.size>0}function hc(e){return 0===on(e).L_.size}function dc(e){e.Q_=void 0}async function fc(e){e.q_.set("Online")}async function pc(e){e.N_.forEach(((t,n)=>{ac(e,t)}))}async function mc(e,t){dc(e),cc(e)?(e.q_.M_(t),uc(e)):e.q_.set("Unknown")}async function gc(e,t,n){if(e.q_.set("Online"),t instanceof Fo&&2===t.state&&t.cause)try{await async function(e,t){const n=t.cause;for(const r of t.targetIds)e.N_.has(r)&&(await e.remoteSyncer.rejectListen(r,n),e.N_.delete(r),e.Q_.removeTarget(r))}(e,t)}catch(n){Zt("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),n),await vc(e,n)}else if(t instanceof Lo?e.Q_.Ke(t):t instanceof Mo?e.Q_.He(t):e.Q_.We(t),!n.isEqual(En.min()))try{const t=await wu(e.localStore);n.compareTo(t)>=0&&await function(e,t){const n=e.Q_.rt(t);return n.targetChanges.forEach(((n,r)=>{if(n.resumeToken.approximateByteSize()>0){const i=e.N_.get(r);i&&e.N_.set(r,i.withResumeToken(n.resumeToken,t))}})),n.targetMismatches.forEach(((t,n)=>{const r=e.N_.get(t);if(!r)return;e.N_.set(t,r.withResumeToken(Hr.EMPTY_BYTE_STRING,r.snapshotVersion)),lc(e,t);const i=new Ia(r.target,t,n,r.sequenceNumber);ac(e,i)})),e.remoteSyncer.applyRemoteEvent(n)}(e,n)}catch(t){Zt("RemoteStore","Failed to raise snapshot:",t),await vc(e,t)}}async function vc(e,t,n){if(!Wn(t))throw t;e.L_.add(1),await ic(e),e.q_.set("Offline"),n||(n=()=>wu(e.localStore)),e.asyncQueue.enqueueRetryable((async()=>{Zt("RemoteStore","Retrying IndexedDB access"),await n(),e.L_.delete(1),await rc(e)}))}function yc(e,t){return t().catch((n=>vc(e,n,t)))}async function wc(e){const t=on(e),n=Pc(t);let r=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;bc(t);)try{const e=await _u(t.localStore,r);if(null===e){0===t.O_.length&&n.o_();break}r=e.batchId,_c(t,e)}catch(e){await vc(t,e)}Ic(t)&&Sc(t)}function bc(e){return hc(e)&&e.O_.length<10}function _c(e,t){e.O_.push(t);const n=Pc(e);n.r_()&&n.V_&&n.m_(t.mutations)}function Ic(e){return hc(e)&&!Pc(e).n_()&&e.O_.length>0}function Sc(e){Pc(e).start()}async function Ec(e){Pc(e).p_()}async function Tc(e){const t=Pc(e);for(const n of e.O_)t.m_(n.mutations)}async function kc(e,t,n){const r=e.O_.shift(),i=wo.from(r,t,n);await yc(e,(()=>e.remoteSyncer.applySuccessfulWrite(i))),await wc(e)}async function Cc(e,t){t&&Pc(e).V_&&await async function(e,t){if(function(e){return Eo(e)&&e!==an.ABORTED}(t.code)){const n=e.O_.shift();Pc(e).s_(),await yc(e,(()=>e.remoteSyncer.rejectFailedWrite(n.batchId,t))),await wc(e)}}(e,t),Ic(e)&&Sc(e)}async function xc(e,t){const n=on(e);n.asyncQueue.verifyOperationInProgress(),Zt("RemoteStore","RemoteStore received new credentials");const r=hc(n);n.L_.add(3),await ic(n),r&&n.q_.set("Unknown"),await n.remoteSyncer.handleCredentialChange(t),n.L_.delete(3),await rc(n)}async function Nc(e,t){const n=on(e);t?(n.L_.delete(2),await rc(n)):t||(n.L_.add(2),await ic(n),n.q_.set("Unknown"))}function Ac(e){return e.K_||(e.K_=function(e,t,n){const r=on(e);return r.w_(),new Xu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:fc.bind(null,e),Ro:pc.bind(null,e),mo:mc.bind(null,e),d_:gc.bind(null,e)}),e.B_.push((async t=>{t?(e.K_.s_(),cc(e)?uc(e):e.q_.set("Unknown")):(await e.K_.stop(),dc(e))}))),e.K_}function Pc(e){return e.U_||(e.U_=function(e,t,n){const r=on(e);return r.w_(),new Zu(t,r.connection,r.authCredentials,r.appCheckCredentials,r.serializer,n)}(e.datastore,e.asyncQueue,{Eo:()=>Promise.resolve(),Ro:Ec.bind(null,e),mo:Cc.bind(null,e),f_:Tc.bind(null,e),g_:kc.bind(null,e)}),e.B_.push((async t=>{t?(e.U_.s_(),await wc(e)):(await e.U_.stop(),e.O_.length>0&&(Zt("RemoteStore",`Stopping write stream with ${e.O_.length} pending writes`),e.O_=[]))}))),e.U_}class Rc{constructor(e,t,n,r,i){this.asyncQueue=e,this.timerId=t,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new un,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch((e=>{}))}get promise(){return this.deferred.promise}static createAndSchedule(e,t,n,r,i){const s=Date.now()+n,o=new Rc(e,t,s,r,i);return o.start(n),o}start(e){this.timerHandle=setTimeout((()=>this.handleDelayElapsed()),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new ln(an.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget((()=>null!==this.timerHandle?(this.clearTimeout(),this.op().then((e=>this.deferred.resolve(e)))):Promise.resolve()))}clearTimeout(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function Dc(e,t){if(en("AsyncQueue",`${t}: ${e}`),Wn(e))return new ln(an.UNAVAILABLE,`${t}: ${e}`);throw e}class Oc{constructor(e){this.comparator=e?(t,n)=>e(t,n)||Nn.comparator(t.key,n.key):(e,t)=>Nn.comparator(e.key,t.key),this.keyedMap=Ns(),this.sortedSet=new jr(this.comparator)}static emptySet(e){return new Oc(e.comparator)}has(e){return null!=this.keyedMap.get(e)}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const t=this.keyedMap.get(e);return t?this.sortedSet.indexOf(t):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal(((t,n)=>(e(t),!1)))}add(e){const t=this.delete(e.key);return t.copy(t.keyedMap.insert(e.key,e),t.sortedSet.insert(e,null))}delete(e){const t=this.get(e);return t?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(t)):this}isEqual(e){if(!(e instanceof Oc))return!1;if(this.size!==e.size)return!1;const t=this.sortedSet.getIterator(),n=e.sortedSet.getIterator();for(;t.hasNext();){const e=t.getNext().key,r=n.getNext().key;if(!e.isEqual(r))return!1}return!0}toString(){const e=[];return this.forEach((t=>{e.push(t.toString())})),0===e.length?"DocumentSet ()":"DocumentSet (\n  "+e.join("  \n")+"\n)"}copy(e,t){const n=new Oc;return n.comparator=this.comparator,n.keyedMap=e,n.sortedSet=t,n}}class Lc{constructor(){this.W_=new jr(Nn.comparator)}track(e){const t=e.doc.key,n=this.W_.get(t);n?0!==e.type&&3===n.type?this.W_=this.W_.insert(t,e):3===e.type&&1!==n.type?this.W_=this.W_.insert(t,{type:n.type,doc:e.doc}):2===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):2===e.type&&0===n.type?this.W_=this.W_.insert(t,{type:0,doc:e.doc}):1===e.type&&0===n.type?this.W_=this.W_.remove(t):1===e.type&&2===n.type?this.W_=this.W_.insert(t,{type:1,doc:n.doc}):0===e.type&&1===n.type?this.W_=this.W_.insert(t,{type:2,doc:e.doc}):rn():this.W_=this.W_.insert(t,e)}G_(){const e=[];return this.W_.inorderTraversal(((t,n)=>{e.push(n)})),e}}class Mc{constructor(e,t,n,r,i,s,o,a,l){this.query=e,this.docs=t,this.oldDocs=n,this.docChanges=r,this.mutatedKeys=i,this.fromCache=s,this.syncStateChanged=o,this.excludesMetadataChanges=a,this.hasCachedResults=l}static fromInitialDocuments(e,t,n,r,i){const s=[];return t.forEach((e=>{s.push({type:0,doc:e})})),new Mc(e,t,Oc.emptySet(t),s,n,r,!0,!1,i)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&ys(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const t=this.docChanges,n=e.docChanges;if(t.length!==n.length)return!1;for(let r=0;r<t.length;r++)if(t[r].type!==n[r].type||!t[r].doc.isEqual(n[r].doc))return!1;return!0}}class Fc{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some((e=>e.J_()))}}class Uc{constructor(){this.queries=jc(),this.onlineState="Unknown",this.Y_=new Set}terminate(){!function(e,t){const n=on(e),r=n.queries;n.queries=jc(),r.forEach(((e,n)=>{for(const r of n.j_)r.onError(t)}))}(this,new ln(an.ABORTED,"Firestore shutting down"))}}function jc(){return new Ts((e=>ws(e)),ys)}async function Vc(e,t){const n=on(e);let r=3;const i=t.query;let s=n.queries.get(i);s?!s.H_()&&t.J_()&&(r=2):(s=new Fc,r=t.J_()?0:1);try{switch(r){case 0:s.z_=await n.onListen(i,!0);break;case 1:s.z_=await n.onListen(i,!1);break;case 2:await n.onFirstRemoteStoreListen(i)}}catch(e){const n=Dc(e,`Initialization of query '${bs(t.query)}' failed`);return void t.onError(n)}n.queries.set(i,s),s.j_.push(t),t.Z_(n.onlineState),s.z_&&t.X_(s.z_)&&$c(n)}async function zc(e,t){const n=on(e),r=t.query;let i=3;const s=n.queries.get(r);if(s){const e=s.j_.indexOf(t);e>=0&&(s.j_.splice(e,1),0===s.j_.length?i=t.J_()?0:1:!s.H_()&&t.J_()&&(i=2))}switch(i){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function Bc(e,t){const n=on(e);let r=!1;for(const i of t){const e=i.query,t=n.queries.get(e);if(t){for(const e of t.j_)e.X_(i)&&(r=!0);t.z_=i}}r&&$c(n)}function qc(e,t,n){const r=on(e),i=r.queries.get(t);if(i)for(const s of i.j_)s.onError(n);r.queries.delete(t)}function $c(e){e.Y_.forEach((e=>{e.next()}))}var Kc,Gc;(Gc=Kc||(Kc={})).ea="default",Gc.Cache="cache";class Hc{constructor(e,t,n){this.query=e,this.ta=t,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=n||{}}X_(e){if(!this.options.includeMetadataChanges){const t=[];for(const n of e.docChanges)3!==n.type&&t.push(n);e=new Mc(e.query,e.docs,e.oldDocs,t,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let t=!1;return this.na?this.ia(e)&&(this.ta.next(e),t=!0):this.sa(e,this.onlineState)&&(this.oa(e),t=!0),this.ra=e,t}onError(e){this.ta.error(e)}Z_(e){this.onlineState=e;let t=!1;return this.ra&&!this.na&&this.sa(this.ra,e)&&(this.oa(this.ra),t=!0),t}sa(e,t){if(!e.fromCache)return!0;if(!this.J_())return!0;const n="Offline"!==t;return(!this.options._a||!n)&&(!e.docs.isEmpty()||e.hasCachedResults||"Offline"===t)}ia(e){if(e.docChanges.length>0)return!0;const t=this.ra&&this.ra.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!t)&&!0===this.options.includeMetadataChanges}oa(e){e=Mc.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.na=!0,this.ta.next(e)}J_(){return this.options.source!==Kc.Cache}}class Wc{constructor(e,t){this.aa=e,this.byteLength=t}ua(){return"metadata"in this.aa}}class Qc{constructor(e){this.serializer=e}Es(e){return ta(this.serializer,e)}ds(e){return e.metadata.exists?aa(this.serializer,e.document,!1):Ni.newNoDocument(this.Es(e.metadata.name),this.As(e.metadata.readTime))}As(e){return Jo(e)}}class Jc{constructor(e,t,n){this.ca=e,this.localStore=t,this.serializer=n,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Yc(e)}la(e){this.progress.bytesLoaded+=e.byteLength;let t=this.progress.documentsLoaded;if(e.aa.namedQuery)this.queries.push(e.aa.namedQuery);else if(e.aa.documentMetadata){this.documents.push({metadata:e.aa.documentMetadata}),e.aa.documentMetadata.exists||++t;const n=kn.fromString(e.aa.documentMetadata.name);this.collectionGroups.add(n.get(n.length-2))}else e.aa.document&&(this.documents[this.documents.length-1].document=e.aa.document,++t);return t!==this.progress.documentsLoaded?(this.progress.documentsLoaded=t,Object.assign({},this.progress)):null}ha(e){const t=new Map,n=new Qc(this.serializer);for(const r of e)if(r.metadata.queries){const e=n.Es(r.metadata.name);for(const n of r.metadata.queries){const r=(t.get(n)||Ms()).add(e);t.set(n,r)}}return t}async complete(){const e=await async function(e,t,n,r){const i=on(e);let s=Ms(),o=Cs();for(const u of n){const e=t.Es(u.metadata.name);u.document&&(s=s.add(e));const n=t.ds(u);n.setReadTime(t.As(u.metadata.readTime)),o=o.insert(e,n)}const a=i.cs.newChangeBuffer({trackRemovals:!0}),l=await Iu(i,function(e){return ps(cs(kn.fromString(`__bundle__/docs/${e}`)))}(r));return i.persistence.runTransaction("Apply bundle documents","readwrite",(e=>bu(e,a,o).next((t=>(a.apply(e),t))).next((t=>i.Ur.removeMatchingKeysForTargetId(e,l.targetId).next((()=>i.Ur.addMatchingKeys(e,s,l.targetId))).next((()=>i.localDocuments.getLocalViewOfDocuments(e,t.Ps,t.Is))).next((()=>t.Ps))))))}(this.localStore,new Qc(this.serializer),this.documents,this.ca.id),t=this.ha(this.documents);for(const n of this.queries)await xu(this.localStore,n,t.get(n.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:e}}}function Yc(e){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}class Xc{constructor(e){this.key=e}}class Zc{constructor(e){this.key=e}}class eh{constructor(e,t){this.query=e,this.Ta=t,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=Ms(),this.mutatedKeys=Ms(),this.Aa=Ss(e),this.Ra=new Oc(this.Aa)}get Va(){return this.Ta}ma(e,t){const n=t?t.fa:new Lc,r=t?t.Ra:this.Ra;let i=t?t.mutatedKeys:this.mutatedKeys,s=r,o=!1;const a="F"===this.query.limitType&&r.size===this.query.limit?r.last():null,l="L"===this.query.limitType&&r.size===this.query.limit?r.first():null;if(e.inorderTraversal(((e,t)=>{const u=r.get(e),c=_s(this.query,t)?t:null,h=!!u&&this.mutatedKeys.has(u.key),d=!!c&&(c.hasLocalMutations||this.mutatedKeys.has(c.key)&&c.hasCommittedMutations);let f=!1;u&&c?u.data.isEqual(c.data)?h!==d&&(n.track({type:3,doc:c}),f=!0):this.ga(u,c)||(n.track({type:2,doc:c}),f=!0,(a&&this.Aa(c,a)>0||l&&this.Aa(c,l)<0)&&(o=!0)):!u&&c?(n.track({type:0,doc:c}),f=!0):u&&!c&&(n.track({type:1,doc:u}),f=!0,(a||l)&&(o=!0)),f&&(c?(s=s.add(c),i=d?i.add(e):i.delete(e)):(s=s.delete(e),i=i.delete(e)))})),null!==this.query.limit)for(;s.size>this.query.limit;){const e="F"===this.query.limitType?s.last():s.first();s=s.delete(e.key),i=i.delete(e.key),n.track({type:1,doc:e})}return{Ra:s,fa:n,ns:o,mutatedKeys:i}}ga(e,t){return e.hasLocalMutations&&t.hasCommittedMutations&&!t.hasLocalMutations}applyChanges(e,t,n,r){const i=this.Ra;this.Ra=e.Ra,this.mutatedKeys=e.mutatedKeys;const s=e.fa.G_();s.sort(((e,t)=>function(e,t){const n=e=>{switch(e){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return rn()}};return n(e)-n(t)}(e.type,t.type)||this.Aa(e.doc,t.doc))),this.pa(n),r=null!=r&&r;const o=t&&!r?this.ya():[],a=0===this.da.size&&this.current&&!r?1:0,l=a!==this.Ea;return this.Ea=a,0!==s.length||l?{snapshot:new Mc(this.query,e.Ra,i,s,e.mutatedKeys,0===a,l,!1,!!n&&n.resumeToken.approximateByteSize()>0),wa:o}:{wa:o}}Z_(e){return this.current&&"Offline"===e?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Lc,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(e){return!this.Ta.has(e)&&!!this.Ra.has(e)&&!this.Ra.get(e).hasLocalMutations}pa(e){e&&(e.addedDocuments.forEach((e=>this.Ta=this.Ta.add(e))),e.modifiedDocuments.forEach((e=>{})),e.removedDocuments.forEach((e=>this.Ta=this.Ta.delete(e))),this.current=e.current)}ya(){if(!this.current)return[];const e=this.da;this.da=Ms(),this.Ra.forEach((e=>{this.Sa(e.key)&&(this.da=this.da.add(e.key))}));const t=[];return e.forEach((e=>{this.da.has(e)||t.push(new Zc(e))})),this.da.forEach((n=>{e.has(n)||t.push(new Xc(n))})),t}ba(e){this.Ta=e.Ts,this.da=Ms();const t=this.ma(e.documents);return this.applyChanges(t,!0)}Da(){return Mc.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,0===this.Ea,this.hasCachedResults)}}class th{constructor(e,t,n){this.query=e,this.targetId=t,this.view=n}}class nh{constructor(e){this.key=e,this.va=!1}}class rh{constructor(e,t,n,r,i,s){this.localStore=e,this.remoteStore=t,this.eventManager=n,this.sharedClientState=r,this.currentUser=i,this.maxConcurrentLimboResolutions=s,this.Ca={},this.Fa=new Ts((e=>ws(e)),ys),this.Ma=new Map,this.xa=new Set,this.Oa=new jr(Nn.comparator),this.Na=new Map,this.La=new Yl,this.Ba={},this.ka=new Map,this.qa=Tl.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return!0===this.Qa}}async function ih(e,t){let n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];const r=Dh(e);let i;const s=r.Fa.get(t);return s?(r.sharedClientState.addLocalQueryTarget(s.targetId),i=s.view.Da()):i=await oh(r,t,n,!0),i}async function sh(e,t){const n=Dh(e);await oh(n,t,!0,!1)}async function oh(e,t,n,r){const i=await Iu(e.localStore,ps(t)),s=i.targetId,o=e.sharedClientState.addLocalQueryTarget(s,n);let a;return r&&(a=await ah(e,t,s,"current"===o,i.resumeToken)),e.isPrimaryClient&&n&&sc(e.remoteStore,i),a}async function ah(e,t,n,r,i){e.Ka=(t,n,r)=>async function(e,t,n,r){let i=t.view.ma(n);i.ns&&(i=await Eu(e.localStore,t.query,!1).then((e=>{let{documents:n}=e;return t.view.ma(n,i)})));const s=r&&r.targetChanges.get(t.targetId),o=r&&null!=r.targetMismatches.get(t.targetId),a=t.view.applyChanges(i,e.isPrimaryClient,s,o);return wh(e,t.targetId,a.wa),a.snapshot}(e,t,n,r);const s=await Eu(e.localStore,t,!0),o=new eh(t,s.Ts),a=o.ma(s.documents),l=Oo.createSynthesizedTargetChangeForCurrentChange(n,r&&"Offline"!==e.onlineState,i),u=o.applyChanges(a,e.isPrimaryClient,l);wh(e,n,u.wa);const c=new th(t,n,o);return e.Fa.set(t,c),e.Ma.has(n)?e.Ma.get(n).push(t):e.Ma.set(n,[t]),u.snapshot}async function lh(e,t,n){const r=on(e),i=r.Fa.get(t),s=r.Ma.get(i.targetId);if(s.length>1)return r.Ma.set(i.targetId,s.filter((e=>!ys(e,t)))),void r.Fa.delete(t);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(i.targetId),r.sharedClientState.isActiveQueryTarget(i.targetId)||await Su(r.localStore,i.targetId,!1).then((()=>{r.sharedClientState.clearQueryState(i.targetId),n&&oc(r.remoteStore,i.targetId),vh(r,i.targetId)})).catch(zn)):(vh(r,i.targetId),await Su(r.localStore,i.targetId,!0))}async function uh(e,t){const n=on(e),r=n.Fa.get(t),i=n.Ma.get(r.targetId);n.isPrimaryClient&&1===i.length&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),oc(n.remoteStore,r.targetId))}async function ch(e,t){const n=on(e);try{const e=await function(e,t){const n=on(e),r=t.snapshotVersion;let i=n.os;return n.persistence.runTransaction("Apply remote event","readwrite-primary",(e=>{const s=n.cs.newChangeBuffer({trackRemovals:!0});i=n.os;const o=[];t.targetChanges.forEach(((s,a)=>{const l=i.get(a);if(!l)return;o.push(n.Ur.removeMatchingKeys(e,s.removedDocuments,a).next((()=>n.Ur.addMatchingKeys(e,s.addedDocuments,a))));let u=l.withSequenceNumber(e.currentSequenceNumber);null!==t.targetMismatches.get(a)?u=u.withResumeToken(Hr.EMPTY_BYTE_STRING,En.min()).withLastLimboFreeSnapshotVersion(En.min()):s.resumeToken.approximateByteSize()>0&&(u=u.withResumeToken(s.resumeToken,r)),i=i.insert(a,u),function(e,t,n){return 0===e.resumeToken.approximateByteSize()||t.snapshotVersion.toMicroseconds()-e.snapshotVersion.toMicroseconds()>=3e8||n.addedDocuments.size+n.modifiedDocuments.size+n.removedDocuments.size>0}(l,u,s)&&o.push(n.Ur.updateTargetData(e,u))}));let a=Cs(),l=Ms();if(t.documentUpdates.forEach((r=>{t.resolvedLimboDocuments.has(r)&&o.push(n.persistence.referenceDelegate.updateLimboDocument(e,r))})),o.push(bu(e,s,t.documentUpdates).next((e=>{a=e.Ps,l=e.Is}))),!r.isEqual(En.min())){const t=n.Ur.getLastRemoteSnapshotVersion(e).next((t=>n.Ur.setTargetsMetadata(e,e.currentSequenceNumber,r)));o.push(t)}return Bn.waitFor(o).next((()=>s.apply(e))).next((()=>n.localDocuments.getLocalViewOfDocuments(e,a,l))).next((()=>a))})).then((e=>(n.os=i,e)))}(n.localStore,t);t.targetChanges.forEach(((e,t)=>{const r=n.Na.get(t);r&&(sn(e.addedDocuments.size+e.modifiedDocuments.size+e.removedDocuments.size<=1),e.addedDocuments.size>0?r.va=!0:e.modifiedDocuments.size>0?sn(r.va):e.removedDocuments.size>0&&(sn(r.va),r.va=!1))})),await Ih(n,e,t)}catch(e){await zn(e)}}function hh(e,t,n){const r=on(e);if(r.isPrimaryClient&&0===n||!r.isPrimaryClient&&1===n){const e=[];r.Fa.forEach(((n,r)=>{const i=r.view.Z_(t);i.snapshot&&e.push(i.snapshot)})),function(e,t){const n=on(e);n.onlineState=t;let r=!1;n.queries.forEach(((e,n)=>{for(const i of n.j_)i.Z_(t)&&(r=!0)})),r&&$c(n)}(r.eventManager,t),e.length&&r.Ca.d_(e),r.onlineState=t,r.isPrimaryClient&&r.sharedClientState.setOnlineState(t)}}async function dh(e,t,n){const r=on(e);r.sharedClientState.updateQueryState(t,"rejected",n);const i=r.Na.get(t),s=i&&i.key;if(s){let e=new jr(Nn.comparator);e=e.insert(s,Ni.newNoDocument(s,En.min()));const n=Ms().add(s),i=new Do(En.min(),new Map,new jr(bn),e,n);await ch(r,i),r.Oa=r.Oa.remove(s),r.Na.delete(t),_h(r)}else await Su(r.localStore,t,!1).then((()=>vh(r,t,n))).catch(zn)}async function fh(e,t){const n=on(e),r=t.batch.batchId;try{const e=await function(e,t){const n=on(e);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",(e=>{const r=t.batch.keys(),i=n.cs.newChangeBuffer({trackRemovals:!0});return function(e,t,n,r){const i=n.batch,s=i.keys();let o=Bn.resolve();return s.forEach((e=>{o=o.next((()=>r.getEntry(t,e))).next((t=>{const s=n.docVersions.get(e);sn(null!==s),t.version.compareTo(s)<0&&(i.applyToRemoteDocument(t,n),t.isValidDocument()&&(t.setReadTime(n.commitVersion),r.addEntry(t)))}))})),o.next((()=>e.mutationQueue.removeMutationBatch(t,i)))}(n,e,t,i).next((()=>i.apply(e))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t.batch.batchId))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,function(e){let t=Ms();for(let n=0;n<e.mutationResults.length;++n)e.mutationResults[n].transformResults.length>0&&(t=t.add(e.batch.mutations[n].key));return t}(t)))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(n.localStore,t);gh(n,r,null),mh(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await Ih(n,e)}catch(e){await zn(e)}}async function ph(e,t,n){const r=on(e);try{const e=await function(e,t){const n=on(e);return n.persistence.runTransaction("Reject batch","readwrite-primary",(e=>{let r;return n.mutationQueue.lookupMutationBatch(e,t).next((t=>(sn(null!==t),r=t.keys(),n.mutationQueue.removeMutationBatch(e,t)))).next((()=>n.mutationQueue.performConsistencyCheck(e))).next((()=>n.documentOverlayCache.removeOverlaysForBatchId(e,r,t))).next((()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(e,r))).next((()=>n.localDocuments.getDocuments(e,r)))}))}(r.localStore,t);gh(r,t,n),mh(r,t),r.sharedClientState.updateMutationState(t,"rejected",n),await Ih(r,e)}catch(n){await zn(n)}}function mh(e,t){(e.ka.get(t)||[]).forEach((e=>{e.resolve()})),e.ka.delete(t)}function gh(e,t,n){const r=on(e);let i=r.Ba[r.currentUser.toKey()];if(i){const e=i.get(t);e&&(n?e.reject(n):e.resolve(),i=i.remove(t)),r.Ba[r.currentUser.toKey()]=i}}function vh(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;e.sharedClientState.removeLocalQueryTarget(t);for(const r of e.Ma.get(t))e.Fa.delete(r),n&&e.Ca.$a(r,n);e.Ma.delete(t),e.isPrimaryClient&&e.La.gr(t).forEach((t=>{e.La.containsKey(t)||yh(e,t)}))}function yh(e,t){e.xa.delete(t.path.canonicalString());const n=e.Oa.get(t);null!==n&&(oc(e.remoteStore,n),e.Oa=e.Oa.remove(t),e.Na.delete(n),_h(e))}function wh(e,t,n){for(const r of n)r instanceof Xc?(e.La.addReference(r.key,t),bh(e,r)):r instanceof Zc?(Zt("SyncEngine","Document no longer in limbo: "+r.key),e.La.removeReference(r.key,t),e.La.containsKey(r.key)||yh(e,r.key)):rn()}function bh(e,t){const n=t.key,r=n.path.canonicalString();e.Oa.get(n)||e.xa.has(r)||(Zt("SyncEngine","New document in limbo: "+n),e.xa.add(r),_h(e))}function _h(e){for(;e.xa.size>0&&e.Oa.size<e.maxConcurrentLimboResolutions;){const t=e.xa.values().next().value;e.xa.delete(t);const n=new Nn(kn.fromString(t)),r=e.qa.next();e.Na.set(r,new nh(n)),e.Oa=e.Oa.insert(n,r),sc(e.remoteStore,new Ia(ps(cs(n.path)),r,"TargetPurposeLimboResolution",tr.oe))}}async function Ih(e,t,n){const r=on(e),i=[],s=[],o=[];r.Fa.isEmpty()||(r.Fa.forEach(((e,a)=>{o.push(r.Ka(a,t,n).then((e=>{var t;if((e||n)&&r.isPrimaryClient){const i=e?!e.fromCache:null===(t=null==n?void 0:n.targetChanges.get(a.targetId))||void 0===t?void 0:t.current;r.sharedClientState.updateQueryState(a.targetId,i?"current":"not-current")}if(e){i.push(e);const t=fu.Wi(a.targetId,e);s.push(t)}})))})),await Promise.all(o),r.Ca.d_(i),await async function(e,t){const n=on(e);try{await n.persistence.runTransaction("notifyLocalViewChanges","readwrite",(e=>Bn.forEach(t,(t=>Bn.forEach(t.$i,(r=>n.persistence.referenceDelegate.addReference(e,t.targetId,r))).next((()=>Bn.forEach(t.Ui,(r=>n.persistence.referenceDelegate.removeReference(e,t.targetId,r)))))))))}catch(e){if(!Wn(e))throw e;Zt("LocalStore","Failed to update sequence numbers: "+e)}for(const r of t){const e=r.targetId;if(!r.fromCache){const t=n.os.get(e),r=t.snapshotVersion,i=t.withLastLimboFreeSnapshotVersion(r);n.os=n.os.insert(e,i)}}}(r.localStore,s))}async function Sh(e,t){const n=on(e);if(!n.currentUser.isEqual(t)){Zt("SyncEngine","User change. New user:",t.toKey());const e=await yu(n.localStore,t);n.currentUser=t,function(e,t){e.ka.forEach((e=>{e.forEach((e=>{e.reject(new ln(an.CANCELLED,t))}))})),e.ka.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(t,e.removedBatchIds,e.addedBatchIds),await Ih(n,e.hs)}}function Eh(e,t){const n=on(e),r=n.Na.get(t);if(r&&r.va)return Ms().add(r.key);{let e=Ms();const r=n.Ma.get(t);if(!r)return e;for(const t of r){const r=n.Fa.get(t);e=e.unionWith(r.view.Va)}return e}}async function Th(e,t){const n=on(e),r=await Eu(n.localStore,t.query,!0),i=t.view.ba(r);return n.isPrimaryClient&&wh(n,t.targetId,i.wa),i}async function kh(e,t){const n=on(e);return ku(n.localStore,t).then((e=>Ih(n,e)))}async function Ch(e,t,n,r){const i=on(e),s=await function(e,t){const n=on(e),r=on(n.mutationQueue);return n.persistence.runTransaction("Lookup mutation documents","readonly",(e=>r.Mn(e,t).next((t=>t?n.localDocuments.getDocuments(e,t):Bn.resolve(null)))))}(i.localStore,t);null!==s?("pending"===n?await wc(i.remoteStore):"acknowledged"===n||"rejected"===n?(gh(i,t,r||null),mh(i,t),function(e,t){on(on(e).mutationQueue).On(t)}(i.localStore,t)):rn(),await Ih(i,s)):Zt("SyncEngine","Cannot apply mutation batch with id: "+t)}async function xh(e,t,n){const r=on(e),i=[],s=[];for(const o of t){let e;const t=r.Ma.get(o);if(t&&0!==t.length){e=await Iu(r.localStore,ps(t[0]));for(const e of t){const t=r.Fa.get(e),n=await Th(r,t);n.snapshot&&s.push(n.snapshot)}}else{const t=await Tu(r.localStore,o);e=await Iu(r.localStore,t),await ah(r,Nh(t),o,!1,e.resumeToken)}i.push(e)}return r.Ca.d_(s),i}function Nh(e){return us(e.path,e.collectionGroup,e.orderBy,e.filters,e.limit,"F",e.startAt,e.endAt)}function Ah(e){return function(e){return on(on(e).persistence).Qi()}(on(e).localStore)}async function Ph(e,t,n,r){const i=on(e);if(i.Qa)return void Zt("SyncEngine","Ignoring unexpected query state notification.");const s=i.Ma.get(t);if(s&&s.length>0)switch(n){case"current":case"not-current":{const e=await ku(i.localStore,Is(s[0])),r=Do.createSynthesizedRemoteEventForCurrentChange(t,"current"===n,Hr.EMPTY_BYTE_STRING);await Ih(i,e,r);break}case"rejected":await Su(i.localStore,t,!0),vh(i,t,r);break;default:rn()}}async function Rh(e,t,n){const r=Dh(e);if(r.Qa){for(const e of t){if(r.Ma.has(e)&&r.sharedClientState.isActiveQueryTarget(e)){Zt("SyncEngine","Adding an already active target "+e);continue}const t=await Tu(r.localStore,e),n=await Iu(r.localStore,t);await ah(r,Nh(t),n.targetId,!1,n.resumeToken),sc(r.remoteStore,n)}for(const e of n)r.Ma.has(e)&&await Su(r.localStore,e,!1).then((()=>{oc(r.remoteStore,e),vh(r,e)})).catch(zn)}}function Dh(e){const t=on(e);return t.remoteStore.remoteSyncer.applyRemoteEvent=ch.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=Eh.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=dh.bind(null,t),t.Ca.d_=Bc.bind(null,t.eventManager),t.Ca.$a=qc.bind(null,t.eventManager),t}function Oh(e){const t=on(e);return t.remoteStore.remoteSyncer.applySuccessfulWrite=fh.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=ph.bind(null,t),t}class Lh{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=Qu(e.databaseInfo.databaseId),this.sharedClientState=this.Wa(e),this.persistence=this.Ga(e),await this.persistence.start(),this.localStore=this.za(e),this.gcScheduler=this.ja(e,this.localStore),this.indexBackfillerScheduler=this.Ha(e,this.localStore)}ja(e,t){return null}Ha(e,t){return null}za(e){return vu(this.persistence,new mu,e.initialUser,this.serializer)}Ga(e){return new ru(su.Zr,this.serializer)}Wa(e){return new Uu}async terminate(){var e,t;null===(e=this.gcScheduler)||void 0===e||e.stop(),null===(t=this.indexBackfillerScheduler)||void 0===t||t.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}Lh.provider={build:()=>new Lh};class Mh extends Lh{constructor(e,t,n){super(),this.Ja=e,this.cacheSizeBytes=t,this.forceOwnership=n,this.kind="persistent",this.synchronizeTabs=!1}async initialize(e){await super.initialize(e),await this.Ja.initialize(this,e),await Oh(this.Ja.syncEngine),await wc(this.Ja.remoteStore),await this.persistence.yi((()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve())))}za(e){return vu(this.persistence,new mu,e.initialUser,this.serializer)}ja(e,t){const n=this.persistence.referenceDelegate.garbageCollector;return new Rl(n,e.asyncQueue,t)}Ha(e,t){const n=new er(t,this.persistence);return new Zn(e.asyncQueue,n)}Ga(e){const t=du(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey),n=void 0!==this.cacheSizeBytes?vl.withCacheSize(this.cacheSizeBytes):vl.DEFAULT;return new uu(this.synchronizeTabs,t,e.clientId,n,e.asyncQueue,Hu(),Wu(),this.serializer,this.sharedClientState,!!this.forceOwnership)}Wa(e){return new Uu}}class Fh extends Mh{constructor(e,t){super(e,t,!1),this.Ja=e,this.cacheSizeBytes=t,this.synchronizeTabs=!0}async initialize(e){await super.initialize(e);const t=this.Ja.syncEngine;this.sharedClientState instanceof Fu&&(this.sharedClientState.syncEngine={no:Ch.bind(null,t),ro:Ph.bind(null,t),io:Rh.bind(null,t),Qi:Ah.bind(null,t),eo:kh.bind(null,t)},await this.sharedClientState.start()),await this.persistence.yi((async e=>{await async function(e,t){const n=on(e);if(Dh(n),Oh(n),!0===t&&!0!==n.Qa){const e=n.sharedClientState.getAllActiveQueryTargets(),t=await xh(n,e.toArray());n.Qa=!0,await Nc(n.remoteStore,!0);for(const r of t)sc(n.remoteStore,r)}else if(!1===t&&!1!==n.Qa){const e=[];let t=Promise.resolve();n.Ma.forEach(((r,i)=>{n.sharedClientState.isLocalQueryTarget(i)?e.push(i):t=t.then((()=>(vh(n,i),Su(n.localStore,i,!0)))),oc(n.remoteStore,i)})),await t,await xh(n,e),function(e){const t=on(e);t.Na.forEach(((e,n)=>{oc(t.remoteStore,n)})),t.La.pr(),t.Na=new Map,t.Oa=new jr(Nn.comparator)}(n),n.Qa=!1,await Nc(n.remoteStore,!1)}}(this.Ja.syncEngine,e),this.gcScheduler&&(e&&!this.gcScheduler.started?this.gcScheduler.start():e||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(e&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():e||this.indexBackfillerScheduler.stop())}))}Wa(e){const t=Hu();if(!Fu.D(t))throw new ln(an.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");const n=du(e.databaseInfo.databaseId,e.databaseInfo.persistenceKey);return new Fu(t,e.asyncQueue,n,e.clientId,e.initialUser)}}class Uh{async initialize(e,t){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(t),this.remoteStore=this.createRemoteStore(t),this.eventManager=this.createEventManager(t),this.syncEngine=this.createSyncEngine(t,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=e=>hh(this.syncEngine,e,1),this.remoteStore.remoteSyncer.handleCredentialChange=Sh.bind(null,this.syncEngine),await Nc(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return new Uc}createDatastore(e){const t=Qu(e.databaseInfo.databaseId),n=function(e){return new Gu(e)}(e.databaseInfo);return function(e,t,n,r){return new ec(e,t,n,r)}(e.authCredentials,e.appCheckCredentials,n,t)}createRemoteStore(e){return function(e,t,n,r,i){return new nc(e,t,n,r,i)}(this.localStore,this.datastore,e.asyncQueue,(e=>hh(this.syncEngine,e,0)),Vu.D()?new Vu:new ju)}createSyncEngine(e,t){return function(e,t,n,r,i,s,o){const a=new rh(e,t,n,r,i,s);return o&&(a.Qa=!0),a}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,t)}async terminate(){var e,t;await async function(e){const t=on(e);Zt("RemoteStore","RemoteStore shutting down."),t.L_.add(5),await ic(t),t.k_.shutdown(),t.q_.set("Unknown")}(this.remoteStore),null===(e=this.datastore)||void 0===e||e.terminate(),null===(t=this.eventManager)||void 0===t||t.terminate()}}function jh(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10240,n=0;return{async read(){if(n<e.byteLength){const r={value:e.slice(n,n+t),done:!1};return n+=t,r}return{done:!0}},async cancel(){},releaseLock(){},closed:Promise.resolve()}}Uh.provider={build:()=>new Uh};class Vh{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Ya(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Ya(this.observer.error,e):en("Uncaught Error in snapshot listener:",e.toString()))}Za(){this.muted=!0}Ya(e,t){setTimeout((()=>{this.muted||e(t)}),0)}}class zh{constructor(e,t){this.Xa=e,this.serializer=t,this.metadata=new un,this.buffer=new Uint8Array,this.eu=new TextDecoder("utf-8"),this.tu().then((e=>{e&&e.ua()?this.metadata.resolve(e.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is\n             ${JSON.stringify(null==e?void 0:e.aa)}`))}),(e=>this.metadata.reject(e)))}close(){return this.Xa.cancel()}async getMetadata(){return this.metadata.promise}async Ua(){return await this.getMetadata(),this.tu()}async tu(){const e=await this.nu();if(null===e)return null;const t=this.eu.decode(e),n=Number(t);isNaN(n)&&this.ru(`length string (${t}) is not valid number`);const r=await this.iu(n);return new Wc(JSON.parse(r),e.length+n)}su(){return this.buffer.findIndex((e=>e==="{".charCodeAt(0)))}async nu(){for(;this.su()<0&&!await this.ou(););if(0===this.buffer.length)return null;const e=this.su();e<0&&this.ru("Reached the end of bundle when a length string is expected.");const t=this.buffer.slice(0,e);return this.buffer=this.buffer.slice(e),t}async iu(e){for(;this.buffer.length<e;)await this.ou()&&this.ru("Reached the end of bundle when more is expected.");const t=this.eu.decode(this.buffer.slice(0,e));return this.buffer=this.buffer.slice(e),t}ru(e){throw this.Xa.cancel(),new Error(`Invalid bundle format: ${e}`)}async ou(){const e=await this.Xa.read();if(!e.done){const t=new Uint8Array(this.buffer.length+e.value.length);t.set(this.buffer),t.set(e.value,this.buffer.length),this.buffer=t}return e.done}}class Bh{constructor(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}async lookup(e){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new ln(an.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;const t=await async function(e,t){const n=on(e),r={documents:t.map((e=>ea(n.serializer,e)))},i=await n.Lo("BatchGetDocuments",n.serializer.databaseId,kn.emptyPath(),r,t.length),s=new Map;i.forEach((e=>{const t=function(e,t){return"found"in t?function(e,t){sn(!!t.found),t.found.name,t.found.updateTime;const n=ta(e,t.found.name),r=Jo(t.found.updateTime),i=t.found.createTime?Jo(t.found.createTime):En.min(),s=new Ci({mapValue:{fields:t.found.fields}});return Ni.newFoundDocument(n,r,i,s)}(e,t):"missing"in t?function(e,t){sn(!!t.missing),sn(!!t.readTime);const n=ta(e,t.missing),r=Jo(t.readTime);return Ni.newNoDocument(n,r)}(e,t):rn()}(n.serializer,e);s.set(t.key.toString(),t)}));const o=[];return t.forEach((e=>{const t=s.get(e.toString());sn(!!t),o.push(t)})),o}(this.datastore,e);return t.forEach((e=>this.recordVersion(e))),t}set(e,t){this.write(t.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())}update(e,t){try{this.write(t.toMutation(e,this.preconditionForUpdate(e)))}catch(e){this.lastTransactionError=e}this.writtenDocs.add(e.toString())}delete(e){this.write(new go(e,this.precondition(e))),this.writtenDocs.add(e.toString())}async commit(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;const e=this.readVersions;this.mutations.forEach((t=>{e.delete(t.key.toString())})),e.forEach(((e,t)=>{const n=Nn.fromPath(t);this.mutations.push(new vo(n,this.precondition(n)))})),await async function(e,t){const n=on(e),r={writes:t.map((e=>la(n.serializer,e)))};await n.Mo("Commit",n.serializer.databaseId,kn.emptyPath(),r)}(this.datastore,this.mutations),this.committed=!0}recordVersion(e){let t;if(e.isFoundDocument())t=e.version;else{if(!e.isNoDocument())throw rn();t=En.min()}const n=this.readVersions.get(e.key.toString());if(n){if(!t.isEqual(n))throw new ln(an.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),t)}precondition(e){const t=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&t?t.isEqual(En.min())?no.exists(!1):no.updateTime(t):no.none()}preconditionForUpdate(e){const t=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&t){if(t.isEqual(En.min()))throw new ln(an.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return no.updateTime(t)}return no.exists(!0)}write(e){this.ensureCommitNotCalled(),this.mutations.push(e)}ensureCommitNotCalled(){}}class qh{constructor(e,t,n,r,i){this.asyncQueue=e,this.datastore=t,this.options=n,this.updateFunction=r,this.deferred=i,this._u=n.maxAttempts,this.t_=new Ju(this.asyncQueue,"transaction_retry")}au(){this._u-=1,this.uu()}uu(){this.t_.Go((async()=>{const e=new Bh(this.datastore),t=this.cu(e);t&&t.then((t=>{this.asyncQueue.enqueueAndForget((()=>e.commit().then((()=>{this.deferred.resolve(t)})).catch((e=>{this.lu(e)}))))})).catch((e=>{this.lu(e)}))}))}cu(e){try{const t=this.updateFunction(e);return!nr(t)&&t.catch&&t.then?t:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}lu(e){this._u>0&&this.hu(e)?(this._u-=1,this.asyncQueue.enqueueAndForget((()=>(this.uu(),Promise.resolve())))):this.deferred.reject(e)}hu(e){if("FirebaseError"===e.name){const t=e.code;return"aborted"===t||"failed-precondition"===t||"already-exists"===t||!Eo(t)}return!1}}class $h{constructor(e,t,n,r,i){this.authCredentials=e,this.appCheckCredentials=t,this.asyncQueue=n,this.databaseInfo=r,this.user=Qt.UNAUTHENTICATED,this.clientId=wn.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=i,this.authCredentials.start(n,(async e=>{Zt("FirestoreClient","Received user=",e.uid),await this.authCredentialListener(e),this.user=e})),this.appCheckCredentials.start(n,(e=>(Zt("FirestoreClient","Received new app check token=",e),this.appCheckCredentialListener(e,this.user))))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new un;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted((async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(t){const n=Dc(t,"Failed to shutdown persistence");e.reject(n)}})),e.promise}}async function Kh(e,t){e.asyncQueue.verifyOperationInProgress(),Zt("FirestoreClient","Initializing OfflineComponentProvider");const n=e.configuration;await t.initialize(n);let r=n.initialUser;e.setCredentialChangeListener((async e=>{r.isEqual(e)||(await yu(t.localStore,e),r=e)})),t.persistence.setDatabaseDeletedListener((()=>e.terminate())),e._offlineComponents=t}async function Gh(e,t){e.asyncQueue.verifyOperationInProgress();const n=await Hh(e);Zt("FirestoreClient","Initializing OnlineComponentProvider"),await t.initialize(n,e.configuration),e.setCredentialChangeListener((e=>xc(t.remoteStore,e))),e.setAppCheckTokenChangeListener(((e,n)=>xc(t.remoteStore,n))),e._onlineComponents=t}async function Hh(e){if(!e._offlineComponents)if(e._uninitializedComponentsProvider){Zt("FirestoreClient","Using user provided OfflineComponentProvider");try{await Kh(e,e._uninitializedComponentsProvider._offline)}catch(t){const n=t;if(!function(e){return"FirebaseError"===e.name?e.code===an.FAILED_PRECONDITION||e.code===an.UNIMPLEMENTED:!("undefined"!=typeof DOMException&&e instanceof DOMException)||22===e.code||20===e.code||11===e.code}(n))throw n;tn("Error using user provided cache. Falling back to memory cache: "+n),await Kh(e,new Lh)}}else Zt("FirestoreClient","Using default OfflineComponentProvider"),await Kh(e,new Lh);return e._offlineComponents}async function Wh(e){return e._onlineComponents||(e._uninitializedComponentsProvider?(Zt("FirestoreClient","Using user provided OnlineComponentProvider"),await Gh(e,e._uninitializedComponentsProvider._online)):(Zt("FirestoreClient","Using default OnlineComponentProvider"),await Gh(e,new Uh))),e._onlineComponents}function Qh(e){return Hh(e).then((e=>e.persistence))}function Jh(e){return Hh(e).then((e=>e.localStore))}function Yh(e){return Wh(e).then((e=>e.remoteStore))}function Xh(e){return Wh(e).then((e=>e.syncEngine))}function Zh(e){return Wh(e).then((e=>e.datastore))}async function ed(e){const t=await Wh(e),n=t.eventManager;return n.onListen=ih.bind(null,t.syncEngine),n.onUnlisten=lh.bind(null,t.syncEngine),n.onFirstRemoteStoreListen=sh.bind(null,t.syncEngine),n.onLastRemoteStoreUnlisten=uh.bind(null,t.syncEngine),n}function td(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new un;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Vh({next:a=>{s.Za(),t.enqueueAndForget((()=>zc(e,o)));const l=a.docs.has(n);!l&&a.fromCache?i.reject(new ln(an.UNAVAILABLE,"Failed to get document because the client is offline.")):l&&a.fromCache&&r&&"server"===r.source?i.reject(new ln(an.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):i.resolve(a)},error:e=>i.reject(e)}),o=new Hc(cs(n.path),s,{includeMetadataChanges:!0,_a:!0});return Vc(e,o)}(await ed(e),e.asyncQueue,t,n,r))),r.promise}function nd(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const r=new un;return e.asyncQueue.enqueueAndForget((async()=>function(e,t,n,r,i){const s=new Vh({next:n=>{s.Za(),t.enqueueAndForget((()=>zc(e,o))),n.fromCache&&"server"===r.source?i.reject(new ln(an.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):i.resolve(n)},error:e=>i.reject(e)}),o=new Hc(n,s,{includeMetadataChanges:!0,_a:!0});return Vc(e,o)}(await ed(e),e.asyncQueue,t,n,r))),r.promise}function rd(e,t,n,r){const i=function(e,t){let n;return n="string"==typeof e?Co().encode(e):e,function(e,t){return new zh(e,t)}(function(e,t){if(e instanceof Uint8Array)return jh(e,t);if(e instanceof ArrayBuffer)return jh(new Uint8Array(e),t);if(e instanceof ReadableStream)return e.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(n),t)}(n,Qu(t));e.asyncQueue.enqueueAndForget((async()=>{!function(e,t,n){const r=on(e);(async function(e,t,n){try{const r=await t.getMetadata();if(await function(e,t){const n=on(e),r=Jo(t.createTime);return n.persistence.runTransaction("hasNewerBundle","readonly",(e=>n.Gr.getBundleMetadata(e,t.id))).then((e=>!!e&&e.createTime.compareTo(r)>=0))}(e.localStore,r))return await t.close(),n._completeWith(function(e){return{taskState:"Success",documentsLoaded:e.totalDocuments,bytesLoaded:e.totalBytes,totalDocuments:e.totalDocuments,totalBytes:e.totalBytes}}(r)),Promise.resolve(new Set);n._updateProgress(Yc(r));const i=new Jc(r,e.localStore,t.serializer);let s=await t.Ua();for(;s;){const e=await i.la(s);e&&n._updateProgress(e),s=await t.Ua()}const o=await i.complete();return await Ih(e,o.Ia,void 0),await function(e,t){const n=on(e);return n.persistence.runTransaction("Save bundle","readwrite",(e=>n.Gr.saveBundleMetadata(e,t)))}(e.localStore,r),n._completeWith(o.progress),Promise.resolve(o.Pa)}catch(e){return tn("SyncEngine",`Loading bundle failed with ${e}`),n._failWith(e),Promise.resolve(new Set)}})(r,t,n).then((e=>{r.sharedClientState.notifyBundleLoaded(e)}))}(await Xh(e),i,r)}))}function id(e){const t={};return void 0!==e.timeoutSeconds&&(t.timeoutSeconds=e.timeoutSeconds),t}const sd=new Map;function od(e,t,n){if(!n)throw new ln(an.INVALID_ARGUMENT,`Function ${e}() cannot be called with an empty ${t}.`)}function ad(e,t,n,r){if(!0===t&&!0===r)throw new ln(an.INVALID_ARGUMENT,`${e} and ${n} cannot be used together.`)}function ld(e){if(!Nn.isDocumentKey(e))throw new ln(an.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${e} has ${e.length}.`)}function ud(e){if(Nn.isDocumentKey(e))throw new ln(an.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${e} has ${e.length}.`)}function cd(e){if(void 0===e)return"undefined";if(null===e)return"null";if("string"==typeof e)return e.length>20&&(e=`${e.substring(0,20)}...`),JSON.stringify(e);if("number"==typeof e||"boolean"==typeof e)return""+e;if("object"==typeof e){if(e instanceof Array)return"an array";{const t=function(e){return e.constructor?e.constructor.name:null}(e);return t?`a custom ${t} object`:"an object"}}return"function"==typeof e?"a function":rn()}function hd(e,t){if("_delegate"in e&&(e=e._delegate),!(e instanceof t)){if(t.name===e.constructor.name)throw new ln(an.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=cd(e);throw new ln(an.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${n}`)}}return e}function dd(e,t){if(t<=0)throw new ln(an.INVALID_ARGUMENT,`Function ${e}() requires a positive number, but it was: ${t}.`)}class fd{constructor(e){var t,n;if(void 0===e.host){if(void 0!==e.ssl)throw new ln(an.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=null===(t=e.ssl)||void 0===t||t;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,void 0===e.cacheSizeBytes)this.cacheSizeBytes=41943040;else{if(-1!==e.cacheSizeBytes&&e.cacheSizeBytes<1048576)throw new ln(an.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}ad("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:void 0===e.experimentalAutoDetectLongPolling?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=id(null!==(n=e.experimentalLongPollingOptions)&&void 0!==n?n:{}),function(e){if(void 0!==e.timeoutSeconds){if(isNaN(e.timeoutSeconds))throw new ln(an.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (must not be NaN)`);if(e.timeoutSeconds<5)throw new ln(an.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (minimum allowed value is 5)`);if(e.timeoutSeconds>30)throw new ln(an.INVALID_ARGUMENT,`invalid long polling timeout: ${e.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(e,t){return e.timeoutSeconds===t.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class pd{constructor(e,t,n,r){this._authCredentials=e,this._appCheckCredentials=t,this._databaseId=n,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fd({}),this._settingsFrozen=!1,this._terminateTask="notTerminated"}get app(){if(!this._app)throw new ln(an.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return"notTerminated"!==this._terminateTask}_setSettings(e){if(this._settingsFrozen)throw new ln(an.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fd(e),void 0!==e.credentials&&(this._authCredentials=function(e){if(!e)return new hn;switch(e.type){case"firstParty":return new mn(e.sessionIndex||"0",e.iamToken||null,e.authTokenFactory||null);case"provider":return e.client;default:throw new ln(an.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return"notTerminated"===this._terminateTask&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){"notTerminated"===this._terminateTask?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){const t=sd.get(e);t&&(Zt("ComponentProvider","Removing Datastore"),sd.delete(e),t.terminate())}(this),Promise.resolve()}}function md(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};var i;const s=(e=hd(e,pd))._getSettings(),o=`${t}:${n}`;if("firestore.googleapis.com"!==s.host&&s.host!==o&&tn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),e._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),r.mockUserToken){let t,n;if("string"==typeof r.mockUserToken)t=r.mockUserToken,n=Qt.MOCK_USER;else{t=x(r.mockUserToken,null===(i=e._app)||void 0===i?void 0:i.options.projectId);const s=r.mockUserToken.sub||r.mockUserToken.user_id;if(!s)throw new ln(an.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");n=new Qt(s)}e._authCredentials=new dn(new cn(t,n))}}class gd{constructor(e,t,n){this.converter=t,this._query=n,this.type="query",this.firestore=e}withConverter(e){return new gd(this.firestore,e,this._query)}}class vd{constructor(e,t,n){this.converter=t,this._key=n,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new yd(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new vd(this.firestore,e,this._key)}}class yd extends gd{constructor(e,t,n){super(e,t,cs(n)),this._path=n,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new vd(this.firestore,null,new Nn(e))}withConverter(e){return new yd(this.firestore,e,this._path)}}function wd(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Q(e),od("collection","path",t),e instanceof pd){const n=kn.fromString(t,...r);return ud(n),new yd(e,null,n)}{if(!(e instanceof vd||e instanceof yd))throw new ln(an.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(kn.fromString(t,...r));return ud(n),new yd(e.firestore,null,n)}}function bd(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];if(e=Q(e),1===arguments.length&&(t=wn.newId()),od("doc","path",t),e instanceof pd){const n=kn.fromString(t,...r);return ld(n),new vd(e,null,new Nn(n))}{if(!(e instanceof vd||e instanceof yd))throw new ln(an.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const n=e._path.child(kn.fromString(t,...r));return ld(n),new vd(e.firestore,e instanceof yd?e.converter:null,new Nn(n))}}function _d(e,t){return e=Q(e),t=Q(t),(e instanceof vd||e instanceof yd)&&(t instanceof vd||t instanceof yd)&&e.firestore===t.firestore&&e.path===t.path&&e.converter===t.converter}function Id(e,t){return e=Q(e),t=Q(t),e instanceof gd&&t instanceof gd&&e.firestore===t.firestore&&ys(e._query,t._query)&&e.converter===t.converter}class Sd{constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Promise.resolve();this.Pu=[],this.Iu=!1,this.Tu=[],this.Eu=null,this.du=!1,this.Au=!1,this.Ru=[],this.t_=new Ju(this,"async_queue_retry"),this.Vu=()=>{const e=Wu();e&&Zt("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()},this.mu=e;const t=Wu();t&&"function"==typeof t.addEventListener&&t.addEventListener("visibilitychange",this.Vu)}get isShuttingDown(){return this.Iu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.fu(),this.gu(e)}enterRestrictedMode(e){if(!this.Iu){this.Iu=!0,this.Au=e||!1;const t=Wu();t&&"function"==typeof t.removeEventListener&&t.removeEventListener("visibilitychange",this.Vu)}}enqueue(e){if(this.fu(),this.Iu)return new Promise((()=>{}));const t=new un;return this.gu((()=>this.Iu&&this.Au?Promise.resolve():(e().then(t.resolve,t.reject),t.promise))).then((()=>t.promise))}enqueueRetryable(e){this.enqueueAndForget((()=>(this.Pu.push(e),this.pu())))}async pu(){if(0!==this.Pu.length){try{await this.Pu[0](),this.Pu.shift(),this.t_.reset()}catch(e){if(!Wn(e))throw e;Zt("AsyncQueue","Operation failed with retryable error: "+e)}this.Pu.length>0&&this.t_.Go((()=>this.pu()))}}gu(e){const t=this.mu.then((()=>(this.du=!0,e().catch((e=>{this.Eu=e,this.du=!1;const t=function(e){let t=e.message||"";return e.stack&&(t=e.stack.includes(e.message)?e.stack:e.message+"\n"+e.stack),t}(e);throw en("INTERNAL UNHANDLED ERROR: ",t),e})).then((e=>(this.du=!1,e))))));return this.mu=t,t}enqueueAfterDelay(e,t,n){this.fu(),this.Ru.indexOf(e)>-1&&(t=0);const r=Rc.createAndSchedule(this,e,t,n,(e=>this.yu(e)));return this.Tu.push(r),r}fu(){this.Eu&&rn()}verifyOperationInProgress(){}async wu(){let e;do{e=this.mu,await e}while(e!==this.mu)}Su(e){for(const t of this.Tu)if(t.timerId===e)return!0;return!1}bu(e){return this.wu().then((()=>{this.Tu.sort(((e,t)=>e.targetTimeMs-t.targetTimeMs));for(const t of this.Tu)if(t.skipDelay(),"all"!==e&&t.timerId===e)break;return this.wu()}))}Du(e){this.Ru.push(e)}yu(e){const t=this.Tu.indexOf(e);this.Tu.splice(t,1)}}function Ed(e){return function(e,t){if("object"!=typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"==typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Td{constructor(){this._progressObserver={},this._taskCompletionResolver=new un,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(e,t,n){this._progressObserver={next:e,error:t,complete:n}}catch(e){return this._taskCompletionResolver.promise.catch(e)}then(e,t){return this._taskCompletionResolver.promise.then(e,t)}_completeWith(e){this._updateProgress(e),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(e)}_failWith(e){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(e),this._taskCompletionResolver.reject(e)}_updateProgress(e){this._lastProgress=e,this._progressObserver.next&&this._progressObserver.next(e)}}class kd extends pd{constructor(e,t,n,r){super(e,t,n,r),this.type="firestore",this._queue=new Sd,this._persistenceKey=(null==r?void 0:r.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new Sd(e),this._firestoreClient=void 0,await e}}}function Cd(e,t){const n="string"==typeof e?e:t||"(default)",r=at("object"==typeof e?e:yt(),"firestore").getImmediate({identifier:n});if(!r._initialized){const e=T("firestore");e&&md(r,...e)}return r}function xd(e){if(e._terminated)throw new ln(an.FAILED_PRECONDITION,"The client has already been terminated.");return e._firestoreClient||Nd(e),e._firestoreClient}function Nd(e){var t,n,r;const i=e._freezeSettings(),s=function(e,t,n,r){return new ti(e,t,n,r.host,r.ssl,r.experimentalForceLongPolling,r.experimentalAutoDetectLongPolling,id(r.experimentalLongPollingOptions),r.useFetchStreams)}(e._databaseId,(null===(t=e._app)||void 0===t?void 0:t.options.appId)||"",e._persistenceKey,i);e._componentsProvider||(null===(n=i.localCache)||void 0===n?void 0:n._offlineComponentProvider)&&(null===(r=i.localCache)||void 0===r?void 0:r._onlineComponentProvider)&&(e._componentsProvider={_offline:i.localCache._offlineComponentProvider,_online:i.localCache._onlineComponentProvider}),e._firestoreClient=new $h(e._authCredentials,e._appCheckCredentials,e._queue,s,e._componentsProvider&&function(e){const t=null==e?void 0:e._online.build();return{_offline:null==e?void 0:e._offline.build(t),_online:t}}(e._componentsProvider))}function Ad(e,t,n){if((e=hd(e,kd))._firestoreClient||e._terminated)throw new ln(an.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.");if(e._componentsProvider||e._getSettings().localCache)throw new ln(an.FAILED_PRECONDITION,"SDK cache is already specified.");e._componentsProvider={_online:t,_offline:n},Nd(e)}function Pd(e){return function(e){const t=new un;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t){const n=on(e);hc(n.remoteStore)||Zt("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{const e=await function(e){const t=on(e);return t.persistence.runTransaction("Get highest unacknowledged batch id","readonly",(e=>t.mutationQueue.getHighestUnacknowledgedBatchId(e)))}(n.localStore);if(-1===e)return void t.resolve();const r=n.ka.get(e)||[];r.push(t),n.ka.set(e,r)}catch(e){const n=Dc(e,"Initialization of waitForPendingWrites() operation failed");t.reject(n)}}(await Xh(e),t))),t.promise}(xd(e=hd(e,kd)))}function Rd(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Qh(e),n=await Yh(e);return t.setNetworkEnabled(!0),function(e){const t=on(e);return t.L_.delete(0),rc(t)}(n)}))}(xd(e=hd(e,kd)))}function Dd(e){return function(e){return e.asyncQueue.enqueue((async()=>{const t=await Qh(e),n=await Yh(e);return t.setNetworkEnabled(!1),async function(e){const t=on(e);t.L_.add(0),await ic(t),t.q_.set("Offline")}(n)}))}(xd(e=hd(e,kd)))}function Od(e,t){return function(e,t){return e.asyncQueue.enqueue((async()=>function(e,t){const n=on(e);return n.persistence.runTransaction("Get named query","readonly",(e=>n.Gr.getNamedQuery(e,t)))}(await Jh(e),t)))}(xd(e=hd(e,kd)),t).then((t=>t?new gd(e,null,t.query):null))}class Ld{constructor(e){this._byteString=e}static fromBase64String(e){try{return new Ld(Hr.fromBase64String(e))}catch(e){throw new ln(an.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(e){return new Ld(Hr.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}class Md{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(let r=0;r<t.length;++r)if(0===t[r].length)throw new ln(an.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new xn(t)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}class Fd{constructor(e){this._methodName=e}}class Ud{constructor(e,t){if(!isFinite(e)||e<-90||e>90)throw new ln(an.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(t)||t<-180||t>180)throw new ln(an.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+t);this._lat=e,this._long=t}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return bn(this._lat,e._lat)||bn(this._long,e._long)}}class jd{constructor(e){this._values=(e||[]).map((e=>e))}toArray(){return this._values.map((e=>e))}isEqual(e){return function(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;++n)if(e[n]!==t[n])return!1;return!0}(this._values,e._values)}}const Vd=/^__.*__$/;class zd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return null!==this.fieldMask?new ho(e,this.data,this.fieldMask,t,this.fieldTransforms):new co(e,this.data,t,this.fieldTransforms)}}class Bd{constructor(e,t,n){this.data=e,this.fieldMask=t,this.fieldTransforms=n}toMutation(e,t){return new ho(e,this.data,this.fieldMask,t,this.fieldTransforms)}}function qd(e){switch(e){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw rn()}}class $d{constructor(e,t,n,r,i,s){this.settings=e,this.databaseId=t,this.serializer=n,this.ignoreUndefinedProperties=r,void 0===i&&this.vu(),this.fieldTransforms=i||[],this.fieldMask=s||[]}get path(){return this.settings.path}get Cu(){return this.settings.Cu}Fu(e){return new $d(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Mu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.Ou(e),r}Nu(e){var t;const n=null===(t=this.path)||void 0===t?void 0:t.child(e),r=this.Fu({path:n,xu:!1});return r.vu(),r}Lu(e){return this.Fu({path:void 0,xu:!0})}Bu(e){return hf(e,this.settings.methodName,this.settings.ku||!1,this.path,this.settings.qu)}contains(e){return void 0!==this.fieldMask.find((t=>e.isPrefixOf(t)))||void 0!==this.fieldTransforms.find((t=>e.isPrefixOf(t.field)))}vu(){if(this.path)for(let e=0;e<this.path.length;e++)this.Ou(this.path.get(e))}Ou(e){if(0===e.length)throw this.Bu("Document fields must not be empty");if(qd(this.Cu)&&Vd.test(e))throw this.Bu('Document fields cannot begin and end with "__"')}}class Kd{constructor(e,t,n){this.databaseId=e,this.ignoreUndefinedProperties=t,this.serializer=n||Qu(e)}Qu(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return new $d({Cu:e,methodName:t,qu:n,path:xn.emptyPath(),xu:!1,ku:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function Gd(e){const t=e._freezeSettings(),n=Qu(e._databaseId);return new Kd(e._databaseId,!!t.ignoreUndefinedProperties,n)}function Hd(e,t,n,r,i){let s=arguments.length>5&&void 0!==arguments[5]?arguments[5]:{};const o=e.Qu(s.merge||s.mergeFields?2:0,t,n,i);af("Data must be an object, but it was:",o,r);const a=sf(r,o);let l,u;if(s.merge)l=new Kr(o.fieldMask),u=o.fieldTransforms;else if(s.mergeFields){const e=[];for(const r of s.mergeFields){const i=lf(t,r,n);if(!o.contains(i))throw new ln(an.INVALID_ARGUMENT,`Field '${i}' is specified in your field mask but missing from your input data.`);df(e,i)||e.push(i)}l=new Kr(e),u=o.fieldTransforms.filter((e=>l.covers(e.field)))}else l=null,u=o.fieldTransforms;return new zd(new Ci(a),l,u)}class Wd extends Fd{_toFieldTransform(e){if(2!==e.Cu)throw 1===e.Cu?e.Bu(`${this._methodName}() can only appear at the top level of your update data`):e.Bu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof Wd}}function Qd(e,t,n){return new $d({Cu:3,qu:t.settings.qu,methodName:e._methodName,xu:n},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}class Jd extends Fd{_toFieldTransform(e){return new eo(e.path,new Gs)}isEqual(e){return e instanceof Jd}}class Yd extends Fd{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Qd(this,e,!0),n=this.Ku.map((e=>rf(e,t))),r=new Hs(n);return new eo(e.path,r)}isEqual(e){return e instanceof Yd&&z(this.Ku,e.Ku)}}class Xd extends Fd{constructor(e,t){super(e),this.Ku=t}_toFieldTransform(e){const t=Qd(this,e,!0),n=this.Ku.map((e=>rf(e,t))),r=new Qs(n);return new eo(e.path,r)}isEqual(e){return e instanceof Xd&&z(this.Ku,e.Ku)}}class Zd extends Fd{constructor(e,t){super(e),this.$u=t}_toFieldTransform(e){const t=new Ys(e.serializer,zs(e.serializer,this.$u));return new eo(e.path,t)}isEqual(e){return e instanceof Zd&&this.$u===e.$u}}function ef(e,t,n,r){const i=e.Qu(1,t,n);af("Data must be an object, but it was:",i,r);const s=[],o=Ci.empty();Fr(r,((e,r)=>{const a=cf(t,e,n);r=Q(r);const l=i.Nu(a);if(r instanceof Wd)s.push(a);else{const e=rf(r,l);null!=e&&(s.push(a),o.set(a,e))}}));const a=new Kr(s);return new Bd(o,a,i.fieldTransforms)}function tf(e,t,n,r,i,s){const o=e.Qu(1,t,n),a=[lf(t,r,n)],l=[i];if(s.length%2!=0)throw new ln(an.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let d=0;d<s.length;d+=2)a.push(lf(t,s[d])),l.push(s[d+1]);const u=[],c=Ci.empty();for(let d=a.length-1;d>=0;--d)if(!df(u,a[d])){const e=a[d];let t=l[d];t=Q(t);const n=o.Nu(e);if(t instanceof Wd)u.push(e);else{const r=rf(t,n);null!=r&&(u.push(e),c.set(e,r))}}const h=new Kr(u);return new Bd(c,h,o.fieldTransforms)}function nf(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return rf(n,e.Qu(r?4:3,t))}function rf(e,t){if(of(e=Q(e)))return af("Unsupported field value:",t,e),sf(e,t);if(e instanceof Fd)return function(e,t){if(!qd(t.Cu))throw t.Bu(`${e._methodName}() can only be used with update() and set()`);if(!t.path)throw t.Bu(`${e._methodName}() is not currently supported inside arrays`);const n=e._toFieldTransform(t);n&&t.fieldTransforms.push(n)}(e,t),null;if(void 0===e&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),e instanceof Array){if(t.settings.xu&&4!==t.Cu)throw t.Bu("Nested arrays are not supported");return function(e,t){const n=[];let r=0;for(const i of e){let e=rf(i,t.Lu(r));null==e&&(e={nullValue:"NULL_VALUE"}),n.push(e),r++}return{arrayValue:{values:n}}}(e,t)}return function(e,t){if(null===(e=Q(e)))return{nullValue:"NULL_VALUE"};if("number"==typeof e)return zs(t.serializer,e);if("boolean"==typeof e)return{booleanValue:e};if("string"==typeof e)return{stringValue:e};if(e instanceof Date){const n=Sn.fromDate(e);return{timestampValue:Ho(t.serializer,n)}}if(e instanceof Sn){const n=new Sn(e.seconds,1e3*Math.floor(e.nanoseconds/1e3));return{timestampValue:Ho(t.serializer,n)}}if(e instanceof Ud)return{geoPointValue:{latitude:e.latitude,longitude:e.longitude}};if(e instanceof Ld)return{bytesValue:Wo(t.serializer,e._byteString)};if(e instanceof vd){const n=t.databaseId,r=e.firestore._databaseId;if(!r.isEqual(n))throw t.Bu(`Document reference is for database ${r.projectId}/${r.database} but should be for database ${n.projectId}/${n.database}`);return{referenceValue:Yo(e.firestore._databaseId||t.databaseId,e._key.path)}}if(e instanceof jd)return function(e,t){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:e.toArray().map((e=>{if("number"!=typeof e)throw t.Bu("VectorValues must only contain numeric values.");return js(t.serializer,e)}))}}}}}}(e,t);throw t.Bu(`Unsupported field value: ${cd(e)}`)}(e,t)}function sf(e,t){const n={};return Ur(e)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):Fr(e,((e,r)=>{const i=rf(r,t.Mu(e));null!=i&&(n[e]=i)})),{mapValue:{fields:n}}}function of(e){return!("object"!=typeof e||null===e||e instanceof Array||e instanceof Date||e instanceof Sn||e instanceof Ud||e instanceof Ld||e instanceof vd||e instanceof Fd||e instanceof jd)}function af(e,t,n){if(!of(n)||!function(e){return"object"==typeof e&&null!==e&&(Object.getPrototypeOf(e)===Object.prototype||null===Object.getPrototypeOf(e))}(n)){const r=cd(n);throw"an object"===r?t.Bu(e+" a custom object"):t.Bu(e+" "+r)}}function lf(e,t,n){if((t=Q(t))instanceof Md)return t._internalPath;if("string"==typeof t)return cf(e,t);throw hf("Field path arguments must be of type string or ",e,!1,void 0,n)}const uf=new RegExp("[~\\*/\\[\\]]");function cf(e,t,n){if(t.search(uf)>=0)throw hf(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,e,!1,void 0,n);try{return new Md(...t.split("."))._internalPath}catch(r){throw hf(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,e,!1,void 0,n)}}function hf(e,t,n,r,i){const s=r&&!r.isEmpty(),o=void 0!==i;let a=`Function ${t}() called with invalid data`;n&&(a+=" (via `toFirestore()`)"),a+=". ";let l="";return(s||o)&&(l+=" (found",s&&(l+=` in field ${r}`),o&&(l+=` in document ${i}`),l+=")"),new ln(an.INVALID_ARGUMENT,a+e+l)}function df(e,t){return e.some((e=>e.isEqual(t)))}class ff{constructor(e,t,n,r,i){this._firestore=e,this._userDataWriter=t,this._key=n,this._document=r,this._converter=i}get id(){return this._key.path.lastSegment()}get ref(){return new vd(this._firestore,this._converter,this._key)}exists(){return null!==this._document}data(){if(this._document){if(this._converter){const e=new pf(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const t=this._document.data.field(mf("DocumentSnapshot.get",e));if(null!==t)return this._userDataWriter.convertValue(t)}}}class pf extends ff{data(){return super.data()}}function mf(e,t){return"string"==typeof t?cf(e,t):t instanceof Md?t._internalPath:t._delegate._internalPath}function gf(e){if("L"===e.limitType&&0===e.explicitOrderBy.length)throw new ln(an.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class vf{}class yf extends vf{}function wf(e,t){let n=[];for(var r=arguments.length,i=new Array(r>2?r-2:0),s=2;s<r;s++)i[s-2]=arguments[s];t instanceof vf&&n.push(t),n=n.concat(i),function(e){const t=e.filter((e=>e instanceof _f)).length,n=e.filter((e=>e instanceof bf)).length;if(t>1||t>0&&n>0)throw new ln(an.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(n);for(const o of n)e=o._apply(e);return e}class bf extends yf{constructor(e,t,n){super(),this._field=e,this._op=t,this._value=n,this.type="where"}static _create(e,t,n){return new bf(e,t,n)}_apply(e){const t=this._parse(e);return Nf(e._query,t),new gd(e.firestore,e.converter,gs(e._query,t))}_parse(e){const t=Gd(e.firestore),n=function(e,t,n,r,i,s,o){let a;if(i.isKeyField()){if("array-contains"===s||"array-contains-any"===s)throw new ln(an.INVALID_ARGUMENT,`Invalid Query. You can't perform '${s}' queries on documentId().`);if("in"===s||"not-in"===s){xf(o,s);const t=[];for(const n of o)t.push(Cf(r,e,n));a={arrayValue:{values:t}}}else a=Cf(r,e,o)}else"in"!==s&&"not-in"!==s&&"array-contains-any"!==s||xf(o,s),a=nf(n,t,o,"in"===s||"not-in"===s);return Mi.create(i,s,a)}(e._query,"where",t,e.firestore._databaseId,this._field,this._op,this._value);return n}}class _f extends vf{constructor(e,t){super(),this.type=e,this._queryConstraints=t}static _create(e,t){return new _f(e,t)}_parse(e){const t=this._queryConstraints.map((t=>t._parse(e))).filter((e=>e.getFilters().length>0));return 1===t.length?t[0]:Fi.create(t,this._getOperator())}_apply(e){const t=this._parse(e);return 0===t.getFilters().length?e:(function(e,t){let n=e;const r=t.getFlattenedFilters();for(const i of r)Nf(n,i),n=gs(n,i)}(e._query,t),new gd(e.firestore,e.converter,gs(e._query,t)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return"and"===this.type?"and":"or"}}class If extends yf{constructor(e,t){super(),this._field=e,this._direction=t,this.type="orderBy"}static _create(e,t){return new If(e,t)}_apply(e){const t=function(e,t,n){if(null!==e.startAt)throw new ln(an.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(null!==e.endAt)throw new ln(an.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new Di(t,n)}(e._query,this._field,this._direction);return new gd(e.firestore,e.converter,function(e,t){const n=e.explicitOrderBy.concat([t]);return new ls(e.path,e.collectionGroup,n,e.filters.slice(),e.limit,e.limitType,e.startAt,e.endAt)}(e._query,t))}}class Sf extends yf{constructor(e,t,n){super(),this.type=e,this._limit=t,this._limitType=n}static _create(e,t,n){return new Sf(e,t,n)}_apply(e){return new gd(e.firestore,e.converter,vs(e._query,this._limit,this._limitType))}}class Ef extends yf{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Ef(e,t,n)}_apply(e){const t=kf(e,this.type,this._docOrFields,this._inclusive);return new gd(e.firestore,e.converter,function(e,t){return new ls(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,t,e.endAt)}(e._query,t))}}class Tf extends yf{constructor(e,t,n){super(),this.type=e,this._docOrFields=t,this._inclusive=n}static _create(e,t,n){return new Tf(e,t,n)}_apply(e){const t=kf(e,this.type,this._docOrFields,this._inclusive);return new gd(e.firestore,e.converter,function(e,t){return new ls(e.path,e.collectionGroup,e.explicitOrderBy.slice(),e.filters.slice(),e.limit,e.limitType,e.startAt,t)}(e._query,t))}}function kf(e,t,n,r){if(n[0]=Q(n[0]),n[0]instanceof ff)return function(e,t,n,r,i){if(!r)throw new ln(an.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${n}().`);const s=[];for(const o of fs(e))if(o.field.isKeyField())s.push(fi(t,r.key));else{const e=r.data.field(o.field);if(Xr(e))throw new ln(an.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+o.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(null===e){const e=o.field.canonicalString();throw new ln(an.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${e}' (used as the orderBy) does not exist.`)}s.push(e)}return new Ai(s,i)}(e._query,e.firestore._databaseId,t,n[0]._document,r);{const i=Gd(e.firestore);return function(e,t,n,r,i,s){const o=e.explicitOrderBy;if(i.length>o.length)throw new ln(an.INVALID_ARGUMENT,`Too many arguments provided to ${r}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);const a=[];for(let l=0;l<i.length;l++){const s=i[l];if(o[l].field.isKeyField()){if("string"!=typeof s)throw new ln(an.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${r}(), but got a ${typeof s}`);if(!ds(e)&&-1!==s.indexOf("/"))throw new ln(an.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${r}() must be a plain document ID, but '${s}' contains a slash.`);const n=e.path.child(kn.fromString(s));if(!Nn.isDocumentKey(n))throw new ln(an.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${r}() must result in a valid document path, but '${n}' is not because it contains an odd number of segments.`);const i=new Nn(n);a.push(fi(t,i))}else{const e=nf(n,r,s);a.push(e)}}return new Ai(a,s)}(e._query,e.firestore._databaseId,i,t,n,r)}}function Cf(e,t,n){if("string"==typeof(n=Q(n))){if(""===n)throw new ln(an.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!ds(t)&&-1!==n.indexOf("/"))throw new ln(an.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=t.path.child(kn.fromString(n));if(!Nn.isDocumentKey(r))throw new ln(an.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return fi(e,new Nn(r))}if(n instanceof vd)return fi(e,n._key);throw new ln(an.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${cd(n)}.`)}function xf(e,t){if(!Array.isArray(e)||0===e.length)throw new ln(an.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function Nf(e,t){const n=function(e,t){for(const n of e)for(const e of n.getFlattenedFilters())if(t.indexOf(e.op)>=0)return e.op;return null}(e.filters,function(e){switch(e){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(null!==n)throw n===t.op?new ln(an.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new ln(an.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${n.toString()}' filters.`)}class Af{convertValue(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";switch(si(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Jr(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,t);case 5:return e.stringValue;case 6:return this.convertBytes(Yr(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,t);case 11:return this.convertObject(e.mapValue,t);case 10:return this.convertVectorValue(e.mapValue);default:throw rn()}}convertObject(e,t){return this.convertObjectMap(e.fields,t)}convertObjectMap(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"none";const n={};return Fr(e,((e,r)=>{n[e]=this.convertValue(r,t)})),n}convertVectorValue(e){var t,n,r;const i=null===(r=null===(n=null===(t=e.fields)||void 0===t?void 0:t.value.arrayValue)||void 0===n?void 0:n.values)||void 0===r?void 0:r.map((e=>Jr(e.doubleValue)));return new jd(i)}convertGeoPoint(e){return new Ud(Jr(e.latitude),Jr(e.longitude))}convertArray(e,t){return(e.values||[]).map((e=>this.convertValue(e,t)))}convertServerTimestamp(e,t){switch(t){case"previous":const n=Zr(e);return null==n?null:this.convertValue(n,t);case"estimate":return this.convertTimestamp(ei(e));default:return null}}convertTimestamp(e){const t=Qr(e);return new Sn(t.seconds,t.nanos)}convertDocumentKey(e,t){const n=kn.fromString(e);sn(_a(n));const r=new ni(n.get(1),n.get(3)),i=new Nn(n.popFirst(5));return r.isEqual(t)||en(`Document ${i} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${t.projectId}/${t.database}) instead.`),i}}function Pf(e,t,n){let r;return r=e?n&&(n.merge||n.mergeFields)?e.toFirestore(t,n):e.toFirestore(t):t,r}class Rf extends Af{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ld(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vd(this.firestore,null,t)}}class Df{constructor(e,t){this.hasPendingWrites=e,this.fromCache=t}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class Of extends ff{constructor(e,t,n,r,i,s){super(e,t,n,r,s),this._firestore=e,this._firestoreImpl=e,this.metadata=i}exists(){return super.exists()}data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(this._document){if(this._converter){const t=new Lf(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(t,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(this._document){const n=this._document.data.field(mf("DocumentSnapshot.get",e));if(null!==n)return this._userDataWriter.convertValue(n,t.serverTimestamps)}}}class Lf extends Of{data(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return super.data(e)}}class Mf{constructor(e,t,n,r){this._firestore=e,this._userDataWriter=t,this._snapshot=r,this.metadata=new Df(r.hasPendingWrites,r.fromCache),this.query=n}get docs(){const e=[];return this.forEach((t=>e.push(t))),e}get size(){return this._snapshot.docs.size}get empty(){return 0===this.size}forEach(e,t){this._snapshot.docs.forEach((n=>{e.call(t,new Lf(this._firestore,this._userDataWriter,n.key,n,new Df(this._snapshot.mutatedKeys.has(n.key),this._snapshot.fromCache),this.query.converter))}))}docChanges(){const e=!!(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}).includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new ln(an.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(e,t){if(e._snapshot.oldDocs.isEmpty()){let t=0;return e._snapshot.docChanges.map((n=>{const r=new Lf(e._firestore,e._userDataWriter,n.doc.key,n.doc,new Df(e._snapshot.mutatedKeys.has(n.doc.key),e._snapshot.fromCache),e.query.converter);return n.doc,{type:"added",doc:r,oldIndex:-1,newIndex:t++}}))}{let n=e._snapshot.oldDocs;return e._snapshot.docChanges.filter((e=>t||3!==e.type)).map((t=>{const r=new Lf(e._firestore,e._userDataWriter,t.doc.key,t.doc,new Df(e._snapshot.mutatedKeys.has(t.doc.key),e._snapshot.fromCache),e.query.converter);let i=-1,s=-1;return 0!==t.type&&(i=n.indexOf(t.doc.key),n=n.delete(t.doc.key)),1!==t.type&&(n=n.add(t.doc),s=n.indexOf(t.doc.key)),{type:Ff(t.type),doc:r,oldIndex:i,newIndex:s}}))}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}}function Ff(e){switch(e){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return rn()}}function Uf(e,t){return e instanceof Of&&t instanceof Of?e._firestore===t._firestore&&e._key.isEqual(t._key)&&(null===e._document?null===t._document:e._document.isEqual(t._document))&&e._converter===t._converter:e instanceof Mf&&t instanceof Mf&&e._firestore===t._firestore&&Id(e.query,t.query)&&e.metadata.isEqual(t.metadata)&&e._snapshot.isEqual(t._snapshot)}class jf extends Af{constructor(e){super(),this.firestore=e}convertBytes(e){return new Ld(e)}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return new vd(this.firestore,null,t)}}function Vf(e){e=hd(e,vd);const t=hd(e.firestore,kd),n=xd(t),r=new jf(t);return function(e,t){const n=new un;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await function(e,t){const n=on(e);return n.persistence.runTransaction("read document","readonly",(e=>n.localDocuments.getDocument(e,t)))}(e,t);r.isFoundDocument()?n.resolve(r):r.isNoDocument()?n.resolve(null):n.reject(new ln(an.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(e){const r=Dc(e,`Failed to get document '${t} from cache`);n.reject(r)}}(await Jh(e),t,n))),n.promise}(n,e._key).then((n=>new Of(t,r,e._key,n,new Df(null!==n&&n.hasLocalMutations,!0),e.converter)))}function zf(e){e=hd(e,gd);const t=hd(e.firestore,kd),n=xd(t),r=new jf(t);return gf(e._query),nd(n,e._query).then((n=>new Mf(t,r,e,n)))}function Bf(e){e=hd(e,gd);const t=hd(e.firestore,kd),n=xd(t),r=new jf(t);return function(e,t){const n=new un;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){try{const r=await Eu(e,t,!0),i=new eh(t,r.Ts),s=i.ma(r.documents),o=i.applyChanges(s,!1);n.resolve(o.snapshot)}catch(e){const r=Dc(e,`Failed to execute query '${t} against cache`);n.reject(r)}}(await Jh(e),t,n))),n.promise}(n,e._query).then((n=>new Mf(t,r,e,n)))}function qf(e,t,n){e=hd(e,vd);const r=hd(e.firestore,kd),i=Pf(e.converter,t,n);return Hf(r,[Hd(Gd(r),"setDoc",e._key,i,null!==e.converter,n).toMutation(e._key,no.none())])}function $f(e,t,n){e=hd(e,vd);const r=hd(e.firestore,kd),i=Gd(r);let s;for(var o=arguments.length,a=new Array(o>3?o-3:0),l=3;l<o;l++)a[l-3]=arguments[l];return s="string"==typeof(t=Q(t))||t instanceof Md?tf(i,"updateDoc",e._key,t,n,a):ef(i,"updateDoc",e._key,t),Hf(r,[s.toMutation(e._key,no.exists(!0))])}function Kf(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i,s,o;e=Q(e);let a={includeMetadataChanges:!1,source:"default"},l=0;"object"!=typeof n[l]||Ed(n[l])||(a=n[l],l++);const u={includeMetadataChanges:a.includeMetadataChanges,source:a.source};if(Ed(n[l])){const e=n[l];n[l]=null===(i=e.next)||void 0===i?void 0:i.bind(e),n[l+1]=null===(s=e.error)||void 0===s?void 0:s.bind(e),n[l+2]=null===(o=e.complete)||void 0===o?void 0:o.bind(e)}let c,h,d;if(e instanceof vd)h=hd(e.firestore,kd),d=cs(e._key.path),c={next:t=>{n[l]&&n[l](Wf(h,e,t))},error:n[l+1],complete:n[l+2]};else{const t=hd(e,gd);h=hd(t.firestore,kd),d=t._query;const r=new jf(h);c={next:e=>{n[l]&&n[l](new Mf(h,r,t,e))},error:n[l+1],complete:n[l+2]},gf(e._query)}return function(e,t,n,r){const i=new Vh(r),s=new Hc(t,i,n);return e.asyncQueue.enqueueAndForget((async()=>Vc(await ed(e),s))),()=>{i.Za(),e.asyncQueue.enqueueAndForget((async()=>zc(await ed(e),s)))}}(xd(h),d,u,c)}function Gf(e,t){return function(e,t){const n=new Vh(t);return e.asyncQueue.enqueueAndForget((async()=>function(e,t){on(e).Y_.add(t),t.next()}(await ed(e),n))),()=>{n.Za(),e.asyncQueue.enqueueAndForget((async()=>function(e,t){on(e).Y_.delete(t)}(await ed(e),n)))}}(xd(e=hd(e,kd)),Ed(t)?t:{next:t})}function Hf(e,t){return function(e,t){const n=new un;return e.asyncQueue.enqueueAndForget((async()=>async function(e,t,n){const r=Oh(e);try{const e=await function(e,t){const n=on(e),r=Sn.now(),i=t.reduce(((e,t)=>e.add(t.key)),Ms());let s,o;return n.persistence.runTransaction("Locally write mutations","readwrite",(e=>{let a=Cs(),l=Ms();return n.cs.getEntries(e,i).next((e=>{a=e,a.forEach(((e,t)=>{t.isValidDocument()||(l=l.add(e))}))})).next((()=>n.localDocuments.getOverlayedDocuments(e,a))).next((i=>{s=i;const o=[];for(const e of t){const t=lo(e,s.get(e.key).overlayedDocument);null!=t&&o.push(new ho(e.key,t,xi(t.value.mapValue),no.exists(!0)))}return n.mutationQueue.addMutationBatch(e,r,o,t)})).next((t=>{o=t;const r=t.applyToLocalDocumentSet(s,l);return n.documentOverlayCache.saveOverlays(e,t.batchId,r)}))})).then((()=>({batchId:o.batchId,changes:As(s)})))}(r.localStore,t);r.sharedClientState.addPendingMutation(e.batchId),function(e,t,n){let r=e.Ba[e.currentUser.toKey()];r||(r=new jr(bn)),r=r.insert(t,n),e.Ba[e.currentUser.toKey()]=r}(r,e.batchId,n),await Ih(r,e.changes),await wc(r.remoteStore)}catch(e){const t=Dc(e,"Failed to persist write");n.reject(t)}}(await Xh(e),t,n))),n.promise}(xd(e),t)}function Wf(e,t,n){const r=n.docs.get(t._key),i=new jf(e);return new Of(e,i,t._key,r,new Df(n.hasPendingWrites,n.fromCache),t.converter)}const Qf={maxAttempts:5};class Jf{constructor(e,t){this._firestore=e,this._commitHandler=t,this._mutations=[],this._committed=!1,this._dataReader=Gd(e)}set(e,t,n){this._verifyNotCommitted();const r=Yf(e,this._firestore),i=Pf(r.converter,t,n),s=Hd(this._dataReader,"WriteBatch.set",r._key,i,null!==r.converter,n);return this._mutations.push(s.toMutation(r._key,no.none())),this}update(e,t,n){this._verifyNotCommitted();const r=Yf(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=Q(t))||t instanceof Md?tf(this._dataReader,"WriteBatch.update",r._key,t,n,o):ef(this._dataReader,"WriteBatch.update",r._key,t),this._mutations.push(i.toMutation(r._key,no.exists(!0))),this}delete(e){this._verifyNotCommitted();const t=Yf(e,this._firestore);return this._mutations=this._mutations.concat(new go(t._key,no.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new ln(an.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}}function Yf(e,t){if((e=Q(e)).firestore!==t)throw new ln(an.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}class Xf extends class{constructor(e,t){this._firestore=e,this._transaction=t,this._dataReader=Gd(e)}get(e){const t=Yf(e,this._firestore),n=new Rf(this._firestore);return this._transaction.lookup([t._key]).then((e=>{if(!e||1!==e.length)return rn();const r=e[0];if(r.isFoundDocument())return new ff(this._firestore,n,r.key,r,t.converter);if(r.isNoDocument())return new ff(this._firestore,n,t._key,null,t.converter);throw rn()}))}set(e,t,n){const r=Yf(e,this._firestore),i=Pf(r.converter,t,n),s=Hd(this._dataReader,"Transaction.set",r._key,i,null!==r.converter,n);return this._transaction.set(r._key,s),this}update(e,t,n){const r=Yf(e,this._firestore);let i;for(var s=arguments.length,o=new Array(s>3?s-3:0),a=3;a<s;a++)o[a-3]=arguments[a];return i="string"==typeof(t=Q(t))||t instanceof Md?tf(this._dataReader,"Transaction.update",r._key,t,n,o):ef(this._dataReader,"Transaction.update",r._key,t),this._transaction.update(r._key,i),this}delete(e){const t=Yf(e,this._firestore);return this._transaction.delete(t._key),this}}{constructor(e,t){super(e,t),this._firestore=e}get(e){const t=Yf(e,this._firestore),n=new jf(this._firestore);return super.get(e).then((e=>new Of(this._firestore,n,t._key,e._document,new Df(!1,!1),t.converter)))}}new WeakMap;!function(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];!function(e){Jt=e}(mt),ot(new J("firestore",((e,n)=>{let{instanceIdentifier:r,options:i}=n;const s=e.getProvider("app").getImmediate(),o=new kd(new fn(e.getProvider("auth-internal")),new vn(e.getProvider("app-check-internal")),function(e,t){if(!Object.prototype.hasOwnProperty.apply(e.options,["projectId"]))throw new ln(an.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new ni(e.options.projectId,t)}(s,r),s);return i=Object.assign({useFetchStreams:t},i),o._setSettings(i),o}),"PUBLIC").setMultipleInstances(!0)),_t(Wt,"4.7.3",e),_t(Wt,"4.7.3","esm2017")}();const Zf="firebasestorage.googleapis.com",ep="storageBucket";class tp extends F{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;super(ip(e),`Firebase Storage: ${t} (${ip(e)})`),this.status_=n,this.customData={serverResponse:null},this._baseMessage=this.message,Object.setPrototypeOf(this,tp.prototype)}get status(){return this.status_}set status(e){this.status_=e}_codeEquals(e){return ip(e)===this.code}get serverResponse(){return this.customData.serverResponse}set serverResponse(e){this.customData.serverResponse=e,this.customData.serverResponse?this.message=`${this._baseMessage}\n${this.customData.serverResponse}`:this.message=this._baseMessage}}var np,rp;function ip(e){return"storage/"+e}function sp(){return new tp(np.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function op(){return new tp(np.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function ap(){return new tp(np.CANCELED,"User canceled the upload/download.")}function lp(e){return new tp(np.INVALID_ARGUMENT,e)}function up(){return new tp(np.APP_DELETED,"The Firebase app was deleted.")}function cp(e){throw new tp(np.INTERNAL_ERROR,"Internal error: "+e)}!function(e){e.UNKNOWN="unknown",e.OBJECT_NOT_FOUND="object-not-found",e.BUCKET_NOT_FOUND="bucket-not-found",e.PROJECT_NOT_FOUND="project-not-found",e.QUOTA_EXCEEDED="quota-exceeded",e.UNAUTHENTICATED="unauthenticated",e.UNAUTHORIZED="unauthorized",e.UNAUTHORIZED_APP="unauthorized-app",e.RETRY_LIMIT_EXCEEDED="retry-limit-exceeded",e.INVALID_CHECKSUM="invalid-checksum",e.CANCELED="canceled",e.INVALID_EVENT_NAME="invalid-event-name",e.INVALID_URL="invalid-url",e.INVALID_DEFAULT_BUCKET="invalid-default-bucket",e.NO_DEFAULT_BUCKET="no-default-bucket",e.CANNOT_SLICE_BLOB="cannot-slice-blob",e.SERVER_FILE_WRONG_SIZE="server-file-wrong-size",e.NO_DOWNLOAD_URL="no-download-url",e.INVALID_ARGUMENT="invalid-argument",e.INVALID_ARGUMENT_COUNT="invalid-argument-count",e.APP_DELETED="app-deleted",e.INVALID_ROOT_OPERATION="invalid-root-operation",e.INVALID_FORMAT="invalid-format",e.INTERNAL_ERROR="internal-error",e.UNSUPPORTED_ENVIRONMENT="unsupported-environment"}(np||(np={}));class hp{constructor(e,t){this.bucket=e,this.path_=t}get path(){return this.path_}get isRoot(){return 0===this.path.length}fullServerUrl(){const e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)}bucketOnlyServerUrl(){return"/b/"+encodeURIComponent(this.bucket)+"/o"}static makeFromBucketSpec(e,t){let n;try{n=hp.makeFromUrl(e,t)}catch(i){return new hp(e,"")}if(""===n.path)return n;throw r=e,new tp(np.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+r+"'.");var r}static makeFromUrl(e,t){let n=null;const r="([A-Za-z0-9.\\-_]+)";const i=new RegExp("^gs://"+r+"(/(.*))?$","i");function s(e){e.path_=decodeURIComponent(e.path)}const o=t.replace(/[.]/g,"\\."),a=[{regex:i,indices:{bucket:1,path:3},postModify:function(e){"/"===e.path.charAt(e.path.length-1)&&(e.path_=e.path_.slice(0,-1))}},{regex:new RegExp(`^https?://${o}/v[A-Za-z0-9_]+/b/${r}/o(/([^?#]*).*)?$`,"i"),indices:{bucket:1,path:3},postModify:s},{regex:new RegExp(`^https?://${t===Zf?"(?:storage.googleapis.com|storage.cloud.google.com)":t}/${r}/([^?#]*)`,"i"),indices:{bucket:1,path:2},postModify:s}];for(let l=0;l<a.length;l++){const t=a[l],r=t.regex.exec(e);if(r){const e=r[t.indices.bucket];let i=r[t.indices.path];i||(i=""),n=new hp(e,i),t.postModify(n);break}}if(null==n)throw function(e){return new tp(np.INVALID_URL,"Invalid URL '"+e+"'.")}(e);return n}}class dp{constructor(e){this.promise_=Promise.reject(e)}getPromise(){return this.promise_}cancel(){}}function fp(e){return"string"===typeof e||e instanceof String}function pp(e,t,n,r){if(r<t)throw lp(`Invalid value for '${e}'. Expected ${t} or greater.`);if(r>n)throw lp(`Invalid value for '${e}'. Expected ${n} or less.`)}function mp(e,t,n){let r=t;return null==n&&(r=`https://${t}`),`${n}://${r}/v0${e}`}function gp(e){const t=encodeURIComponent;let n="?";for(const r in e)if(e.hasOwnProperty(r)){n=n+(t(r)+"="+t(e[r]))+"&"}return n=n.slice(0,-1),n}function vp(e,t){const n=e>=500&&e<600,r=-1!==[408,429].indexOf(e),i=-1!==t.indexOf(e);return n||r||i}!function(e){e[e.NO_ERROR=0]="NO_ERROR",e[e.NETWORK_ERROR=1]="NETWORK_ERROR",e[e.ABORT=2]="ABORT"}(rp||(rp={}));class yp{constructor(e,t,n,r,i,s,o,a,l,u,c){let h=!(arguments.length>11&&void 0!==arguments[11])||arguments[11];this.url_=e,this.method_=t,this.headers_=n,this.body_=r,this.successCodes_=i,this.additionalRetryCodes_=s,this.callback_=o,this.errorCallback_=a,this.timeout_=l,this.progressCallback_=u,this.connectionFactory_=c,this.retry=h,this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.promise_=new Promise(((e,t)=>{this.resolve_=e,this.reject_=t,this.start_()}))}start_(){const e=(e,t)=>{if(t)return void e(!1,new wp(!1,null,!0));const n=this.connectionFactory_();this.pendingConnection_=n;const r=e=>{const t=e.loaded,n=e.lengthComputable?e.total:-1;null!==this.progressCallback_&&this.progressCallback_(t,n)};null!==this.progressCallback_&&n.addUploadProgressListener(r),n.send(this.url_,this.method_,this.body_,this.headers_).then((()=>{null!==this.progressCallback_&&n.removeUploadProgressListener(r),this.pendingConnection_=null;const t=n.getErrorCode()===rp.NO_ERROR,i=n.getStatus();if(!t||vp(i,this.additionalRetryCodes_)&&this.retry){const t=n.getErrorCode()===rp.ABORT;return void e(!1,new wp(!1,null,t))}const s=-1!==this.successCodes_.indexOf(i);e(!0,new wp(s,n))}))},t=(e,t)=>{const n=this.resolve_,r=this.reject_,i=t.connection;if(t.wasSuccessCode)try{const e=this.callback_(i,i.getResponse());void 0!==e?n(e):n()}catch(s){r(s)}else if(null!==i){const e=sp();e.serverResponse=i.getErrorText(),this.errorCallback_?r(this.errorCallback_(i,e)):r(e)}else if(t.canceled){r(this.appDelete_?up():ap())}else{r(op())}};this.canceled_?t(0,new wp(!1,null,!0)):this.backoffId_=function(e,t,n){let r=1,i=null,s=null,o=!1,a=0;function l(){return 2===a}let u=!1;function c(){if(!u){u=!0;for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.apply(null,n)}}function h(t){i=setTimeout((()=>{i=null,e(f,l())}),t)}function d(){s&&clearTimeout(s)}function f(e){if(u)return void d();for(var t=arguments.length,n=new Array(t>1?t-1:0),i=1;i<t;i++)n[i-1]=arguments[i];if(e)return d(),void c.call(null,e,...n);if(l()||o)return d(),void c.call(null,e,...n);let s;r<64&&(r*=2),1===a?(a=2,s=0):s=1e3*(r+Math.random()),h(s)}let p=!1;function m(e){p||(p=!0,d(),u||(null!==i?(e||(a=2),clearTimeout(i),h(0)):e||(a=1)))}return h(0),s=setTimeout((()=>{o=!0,m(!0)}),n),m}(e,t,this.timeout_)}getPromise(){return this.promise_}cancel(e){this.canceled_=!0,this.appDelete_=e||!1,null!==this.backoffId_&&(0,this.backoffId_)(!1),null!==this.pendingConnection_&&this.pendingConnection_.abort()}}class wp{constructor(e,t,n){this.wasSuccessCode=e,this.connection=t,this.canceled=!!n}}function bp(e){let t;try{t=JSON.parse(e)}catch(r){return null}return"object"!==typeof(n=t)||Array.isArray(n)?null:t;var n}function _p(e){const t=e.lastIndexOf("/",e.length-2);return-1===t?e:e.slice(t+1)}function Ip(e,t){return t}class Sp{constructor(e,t,n,r){this.server=e,this.local=t||e,this.writable=!!n,this.xform=r||Ip}}let Ep=null;function Tp(){if(Ep)return Ep;const e=[];e.push(new Sp("bucket")),e.push(new Sp("generation")),e.push(new Sp("metageneration")),e.push(new Sp("name","fullPath",!0));const t=new Sp("name");t.xform=function(e,t){return function(e){return!fp(e)||e.length<2?e:_p(e)}(t)},e.push(t);const n=new Sp("size");return n.xform=function(e,t){return void 0!==t?Number(t):t},e.push(n),e.push(new Sp("timeCreated")),e.push(new Sp("updated")),e.push(new Sp("md5Hash",null,!0)),e.push(new Sp("cacheControl",null,!0)),e.push(new Sp("contentDisposition",null,!0)),e.push(new Sp("contentEncoding",null,!0)),e.push(new Sp("contentLanguage",null,!0)),e.push(new Sp("contentType",null,!0)),e.push(new Sp("metadata","customMetadata",!0)),Ep=e,Ep}function kp(e,t,n){const r={type:"file"},i=n.length;for(let s=0;s<i;s++){const e=n[s];r[e.local]=e.xform(r,t[e.server])}return function(e,t){Object.defineProperty(e,"ref",{get:function(){const n=e.bucket,r=e.fullPath,i=new hp(n,r);return t._makeStorageReference(i)}})}(r,e),r}function Cp(e,t,n){const r=bp(t);if(null===r)return null;return kp(e,r,n)}class xp{constructor(e,t,n,r){this.url=e,this.method=t,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}}function Np(e){if(!e)throw sp()}function Ap(e,t){return function(n,r){const i=Cp(e,r,t);return Np(null!==i),function(e,t,n,r){const i=bp(t);if(null===i)return null;if(!fp(i.downloadTokens))return null;const s=i.downloadTokens;if(0===s.length)return null;const o=encodeURIComponent;return s.split(",").map((t=>{const i=e.bucket,s=e.fullPath;return mp("/b/"+o(i)+"/o/"+o(s),n,r)+gp({alt:"media",token:t})}))[0]}(i,r,e.host,e._protocol)}}function Pp(e){return function(t,n){let r;var i,s;return 401===t.getStatus()?r=t.getErrorText().includes("Firebase App Check token is invalid")?new tp(np.UNAUTHORIZED_APP,"This app does not have permission to access Firebase Storage on this project."):new tp(np.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again."):402===t.getStatus()?(s=e.bucket,r=new tp(np.QUOTA_EXCEEDED,"Quota for bucket '"+s+"' exceeded, please view quota on https://firebase.google.com/pricing/.")):403===t.getStatus()?(i=e.path,r=new tp(np.UNAUTHORIZED,"User does not have permission to access '"+i+"'.")):r=n,r.status=t.getStatus(),r.serverResponse=n.serverResponse,r}}function Rp(e){const t=Pp(e);return function(n,r){let i=t(n,r);var s;return 404===n.getStatus()&&(s=e.path,i=new tp(np.OBJECT_NOT_FOUND,"Object '"+s+"' does not exist.")),i.serverResponse=r.serverResponse,i}}class Dp{constructor(){this.sent_=!1,this.xhr_=new XMLHttpRequest,this.initXhr(),this.errorCode_=rp.NO_ERROR,this.sendPromise_=new Promise((e=>{this.xhr_.addEventListener("abort",(()=>{this.errorCode_=rp.ABORT,e()})),this.xhr_.addEventListener("error",(()=>{this.errorCode_=rp.NETWORK_ERROR,e()})),this.xhr_.addEventListener("load",(()=>{e()}))}))}send(e,t,n,r){if(this.sent_)throw cp("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(t,e,!0),void 0!==r)for(const i in r)r.hasOwnProperty(i)&&this.xhr_.setRequestHeader(i,r[i].toString());return void 0!==n?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_}getErrorCode(){if(!this.sent_)throw cp("cannot .getErrorCode() before sending");return this.errorCode_}getStatus(){if(!this.sent_)throw cp("cannot .getStatus() before sending");try{return this.xhr_.status}catch(e){return-1}}getResponse(){if(!this.sent_)throw cp("cannot .getResponse() before sending");return this.xhr_.response}getErrorText(){if(!this.sent_)throw cp("cannot .getErrorText() before sending");return this.xhr_.statusText}abort(){this.xhr_.abort()}getResponseHeader(e){return this.xhr_.getResponseHeader(e)}addUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.addEventListener("progress",e)}removeUploadProgressListener(e){null!=this.xhr_.upload&&this.xhr_.upload.removeEventListener("progress",e)}}class Op extends Dp{initXhr(){this.xhr_.responseType="text"}}function Lp(){return new Op}class Mp{constructor(e,t){this._service=e,this._location=t instanceof hp?t:hp.makeFromUrl(t,e.host)}toString(){return"gs://"+this._location.bucket+"/"+this._location.path}_newRef(e,t){return new Mp(e,t)}get root(){const e=new hp(this._location.bucket,"");return this._newRef(this._service,e)}get bucket(){return this._location.bucket}get fullPath(){return this._location.path}get name(){return _p(this._location.path)}get storage(){return this._service}get parent(){const e=function(e){if(0===e.length)return null;const t=e.lastIndexOf("/");return-1===t?"":e.slice(0,t)}(this._location.path);if(null===e)return null;const t=new hp(this._location.bucket,e);return new Mp(this._service,t)}_throwIfRoot(e){if(""===this._location.path)throw function(e){return new tp(np.INVALID_ROOT_OPERATION,"The operation '"+e+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}(e)}}function Fp(e){e._throwIfRoot("getDownloadURL");const t=function(e,t,n){const r=mp(t.fullServerUrl(),e.host,e._protocol),i=e.maxOperationRetryTime,s=new xp(r,"GET",Ap(e,n),i);return s.errorHandler=Rp(t),s}(e.storage,e._location,Tp());return e.storage.makeRequestWithTokens(t,Lp).then((e=>{if(null===e)throw new tp(np.NO_DOWNLOAD_URL,"The given file does not have any download URLs.");return e}))}function Up(e,t){const n=function(e,t){const n=t.split("/").filter((e=>e.length>0)).join("/");return 0===e.length?n:e+"/"+n}(e._location.path,t),r=new hp(e._location.bucket,n);return new Mp(e.storage,r)}function jp(e,t){if(e instanceof Bp){const n=e;if(null==n._bucket)throw new tp(np.NO_DEFAULT_BUCKET,"No default bucket found. Did you set the '"+ep+"' property when initializing the app?");const r=new Mp(n,n._bucket);return null!=t?jp(r,t):r}return void 0!==t?Up(e,t):e}function Vp(e,t){if(t&&/^[A-Za-z]+:\/\//.test(t)){if(e instanceof Bp)return new Mp(e,t);throw lp("To use ref(service, url), the first argument must be a Storage instance.")}return jp(e,t)}function zp(e,t){const n=null===t||void 0===t?void 0:t[ep];return null==n?null:hp.makeFromBucketSpec(n,e)}class Bp{constructor(e,t,n,r,i){this.app=e,this._authProvider=t,this._appCheckProvider=n,this._url=r,this._firebaseVersion=i,this._bucket=null,this._host=Zf,this._protocol="https",this._appId=null,this._deleted=!1,this._maxOperationRetryTime=12e4,this._maxUploadRetryTime=6e5,this._requests=new Set,this._bucket=null!=r?hp.makeFromBucketSpec(r,this._host):zp(this._host,this.app.options)}get host(){return this._host}set host(e){this._host=e,null!=this._url?this._bucket=hp.makeFromBucketSpec(this._url,e):this._bucket=zp(e,this.app.options)}get maxUploadRetryTime(){return this._maxUploadRetryTime}set maxUploadRetryTime(e){pp("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e}get maxOperationRetryTime(){return this._maxOperationRetryTime}set maxOperationRetryTime(e){pp("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e}async _getAuthToken(){if(this._overrideAuthToken)return this._overrideAuthToken;const e=this._authProvider.getImmediate({optional:!0});if(e){const t=await e.getToken();if(null!==t)return t.accessToken}return null}async _getAppCheckToken(){const e=this._appCheckProvider.getImmediate({optional:!0});if(e){return(await e.getToken()).token}return null}_delete(){return this._deleted||(this._deleted=!0,this._requests.forEach((e=>e.cancel())),this._requests.clear()),Promise.resolve()}_makeStorageReference(e){return new Mp(this,e)}_makeRequest(e,t,n,r){let i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(this._deleted)return new dp(up());{const s=function(e,t,n,r,i,s){let o=!(arguments.length>6&&void 0!==arguments[6])||arguments[6];const a=gp(e.urlParams),l=e.url+a,u=Object.assign({},e.headers);return function(e,t){t&&(e["X-Firebase-GMPID"]=t)}(u,t),function(e,t){null!==t&&t.length>0&&(e.Authorization="Firebase "+t)}(u,n),function(e,t){e["X-Firebase-Storage-Version"]="webjs/"+(null!==t&&void 0!==t?t:"AppManager")}(u,s),function(e,t){null!==t&&(e["X-Firebase-AppCheck"]=t)}(u,r),new yp(l,e.method,u,e.body,e.successCodes,e.additionalRetryCodes,e.handler,e.errorHandler,e.timeout,e.progressCallback,i,o)}(e,this._appId,n,r,t,this._firebaseVersion,i);return this._requests.add(s),s.getPromise().then((()=>this._requests.delete(s)),(()=>this._requests.delete(s))),s}}async makeRequestWithTokens(e,t){const[n,r]=await Promise.all([this._getAuthToken(),this._getAppCheckToken()]);return this._makeRequest(e,t,n,r).getPromise()}}const qp="@firebase/storage",$p="0.13.2",Kp="storage";function Gp(e){return Fp(e=Q(e))}function Hp(e,t){return Vp(e=Q(e),t)}function Wp(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:yt(),t=arguments.length>1?arguments[1]:void 0;e=Q(e);const n=at(e,Kp).getImmediate({identifier:t}),r=T("storage");return r&&function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};!function(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};e.host=`${t}:${n}`,e._protocol="http";const{mockUserToken:i}=r;i&&(e._overrideAuthToken="string"===typeof i?i:x(i,e.app.options.projectId))}(e,t,n,r)}(n,...r),n}function Qp(e,t){let{instanceIdentifier:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("auth-internal"),s=e.getProvider("app-check-internal");return new Bp(r,i,s,n,mt)}ot(new J(Kp,Qp,"PUBLIC").setMultipleInstances(!0)),_t(qp,$p,""),_t(qp,$p,"esm2017");const Jp=(0,i.createContext)(),Yp=()=>(0,i.useContext)(Jp),Xp=()=>new Promise(((e,t)=>{const n=indexedDB.open("VixenDatabase",1);n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("vixens")||t.createObjectStore("vixens",{keyPath:"id"})},n.onsuccess=()=>{e(n.result)},n.onerror=e=>{t(e.target.error)}})),Zp=e=>{let{children:t}=e;const[n,r]=(0,i.useState)({}),[s,o]=(0,i.useState)(!0),a=async()=>{try{const e=wd(Cd(),"vixens"),t=await zf(e),n=await Promise.all(t.docs.map((async e=>{const t=e.data(),n=t.name;try{const r=Hp(Wp(),`${n}.avif`),i=await Gp(r);return{id:e.id,...t,imageUrl:i,timestamp:Date.now()}}catch(r){return console.error(`Error fetching image for ${n}:`,r),{id:e.id,...t,imageUrl:"/path/to/default-image.png",timestamp:Date.now()}}})));r(n.reduce(((e,t)=>(e[t.id]=t,e)),{})),await(async e=>{const t=await Xp();return new Promise(((n,r)=>{const i=t.transaction("vixens","readwrite"),s=i.objectStore("vixens");e.forEach((e=>{s.put(e)})),i.oncomplete=()=>{n()},i.onerror=e=>{r(e.target.error)}}))})(n),o(!1)}catch(e){console.error("Error fetching Vixens from Firestore:",e),o(!1)}};return(0,i.useEffect)((()=>{(async()=>{try{var e;const n=await(async()=>{const e=await Xp();return new Promise(((t,n)=>{const r=e.transaction("vixens","readonly").objectStore("vixens").getAll();r.onsuccess=()=>{t(r.result)},r.onerror=e=>{n(e.target.error)}}))})();n.length>0&&(t=null===(e=n[0])||void 0===e?void 0:e.timestamp,!((new Date).getTime()-t>9e5))?(r(n.reduce(((e,t)=>(e[t.id]=t,e)),{})),o(!1)):await a()}catch(n){console.error("Error initializing cache:",n),await a()}var t})()}),[]),(0,d.jsx)(Jp.Provider,{value:{vixenCache:n,isLoading:s},children:t})};function em(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}Object.create;Object.create;"function"===typeof SuppressedError&&SuppressedError;const tm="facebook.com",nm="github.com",rm="google.com",im="password",sm="twitter.com",om="EMAIL_SIGNIN",am="PASSWORD_RESET",lm="RECOVER_EMAIL",um="REVERT_SECOND_FACTOR_ADDITION",cm="VERIFY_AND_CHANGE_EMAIL",hm="VERIFY_EMAIL";function dm(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const fm=function(){return{"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","emulator-config-failed":'Auth instance has already been used to make a network call. Auth can no longer be configured to use the emulator. Try calling "connectAuthEmulator()" sooner.',"expired-action-code":"The action code has expired.","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal AuthError has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registered for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal AuthError has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-emulator-scheme":"Emulator URL must start with a valid scheme (http:// or https://).","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is incorrect, malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","login-blocked":"Login blocked by user-provided method: {$originalMessage}","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal AuthError has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-password":"A non-empty password must be provided","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network AuthError (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal AuthError has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled.","already-initialized":"initializeAuth() has already been called with different options. To avoid this error, call initializeAuth() with the same options as when it was originally called, or call getAuth() to return the already initialized instance.","missing-recaptcha-token":"The reCAPTCHA token is missing when sending request to the backend.","invalid-recaptcha-token":"The reCAPTCHA token is invalid when sending request to the backend.","invalid-recaptcha-action":"The reCAPTCHA action is invalid when sending request to the backend.","recaptcha-not-enabled":"reCAPTCHA Enterprise integration is not enabled for this project.","missing-client-type":"The reCAPTCHA client type is missing when sending request to the backend.","missing-recaptcha-version":"The reCAPTCHA version is missing when sending request to the backend.","invalid-req-type":"Invalid request parameters.","invalid-recaptcha-version":"The reCAPTCHA version is invalid when sending request to the backend.","unsupported-password-policy-schema-version":"The password policy received from the backend uses a schema version that is not supported by this version of the Firebase SDK.","password-does-not-meet-requirements":"The password does not meet the requirements."}},pm=dm,mm=new U("auth","Firebase",{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}),gm=new oe("@firebase/auth");function vm(e){if(gm.logLevel<=te.ERROR){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gm.error(`Auth (${mt}): ${e}`,...n)}}function ym(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Sm(e,...n)}function wm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return Sm(e,...n)}function bm(e,t,n){const r=Object.assign(Object.assign({},pm()),{[t]:n});return new U("auth","Firebase",r).create(t,{appName:e.name})}function _m(e){return bm(e,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function Im(e,t,n){if(!(t instanceof n))throw n.name!==t.constructor.name&&ym(e,"argument-error"),bm(e,"argument-error",`Type of ${t.constructor.name} does not match expected instance.Did you pass a reference from a different Auth SDK?`)}function Sm(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];if("string"!==typeof e){const t=n[0],r=[...n.slice(1)];return r[0]&&(r[0].appName=e.name),e._errorFactory.create(t,...r)}return mm.create(e,...n)}function Em(e,t){if(!e){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];throw Sm(t,...r)}}function Tm(e){const t="INTERNAL ASSERTION FAILED: "+e;throw vm(t),new Error(t)}function km(e,t){e||Tm(t)}function Cm(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.href)||""}function xm(){return"http:"===Nm()||"https:"===Nm()}function Nm(){var e;return"undefined"!==typeof self&&(null===(e=self.location)||void 0===e?void 0:e.protocol)||null}class Am{constructor(e,t){this.shortDelay=e,this.longDelay=t,km(t>e,"Short delay should be less than long delay!"),this.isMobile="undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(N())||D()}get(){return"undefined"!==typeof navigator&&navigator&&"onLine"in navigator&&"boolean"===typeof navigator.onLine&&(xm()||R()||"connection"in navigator)&&!navigator.onLine?Math.min(5e3,this.shortDelay):this.isMobile?this.longDelay:this.shortDelay}}function Pm(e,t){km(e.emulator,"Emulator should always be set here");const{url:n}=e.emulator;return t?`${n}${t.startsWith("/")?t.slice(1):t}`:n}class Rm{static initialize(e,t,n){this.fetchImpl=e,t&&(this.headersImpl=t),n&&(this.responseImpl=n)}static fetch(){return this.fetchImpl?this.fetchImpl:"undefined"!==typeof self&&"fetch"in self?self.fetch:"undefined"!==typeof globalThis&&globalThis.fetch?globalThis.fetch:"undefined"!==typeof fetch?fetch:void Tm("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){return this.headersImpl?this.headersImpl:"undefined"!==typeof self&&"Headers"in self?self.Headers:"undefined"!==typeof globalThis&&globalThis.Headers?globalThis.Headers:"undefined"!==typeof Headers?Headers:void Tm("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){return this.responseImpl?this.responseImpl:"undefined"!==typeof self&&"Response"in self?self.Response:"undefined"!==typeof globalThis&&globalThis.Response?globalThis.Response:"undefined"!==typeof Response?Response:void Tm("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}const Dm={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"},Om=new Am(3e4,6e4);function Lm(e,t){return e.tenantId&&!t.tenantId?Object.assign(Object.assign({},t),{tenantId:e.tenantId}):t}async function Mm(e,t,n,r){return Fm(e,arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},(async()=>{let i={},s={};r&&("GET"===t?s=r:i={body:JSON.stringify(r)});const o=q(Object.assign({key:e.config.apiKey},s)).slice(1),a=await e._getAdditionalHeaders();a["Content-Type"]="application/json",e.languageCode&&(a["X-Firebase-Locale"]=e.languageCode);const l=Object.assign({method:t,headers:a},i);return"undefined"!==typeof navigator&&"Cloudflare-Workers"===navigator.userAgent||(l.referrerPolicy="no-referrer"),Rm.fetch()(jm(e,e.config.apiHost,n,o),l)}))}async function Fm(e,t,n){e._canInitEmulator=!1;const r=Object.assign(Object.assign({},Dm),t);try{const t=new zm(e),i=await Promise.race([n(),t.promise]);t.clearNetworkTimeout();const s=await i.json();if("needConfirmation"in s)throw Bm(e,"account-exists-with-different-credential",s);if(i.ok&&!("errorMessage"in s))return s;{const t=i.ok?s.errorMessage:s.error.message,[n,o]=t.split(" : ");if("FEDERATED_USER_ID_ALREADY_LINKED"===n)throw Bm(e,"credential-already-in-use",s);if("EMAIL_EXISTS"===n)throw Bm(e,"email-already-in-use",s);if("USER_DISABLED"===n)throw Bm(e,"user-disabled",s);const a=r[n]||n.toLowerCase().replace(/[_\s]+/g,"-");if(o)throw bm(e,a,o);ym(e,a)}}catch(i){if(i instanceof F)throw i;ym(e,"network-request-failed",{message:String(i)})}}async function Um(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const s=await Mm(e,t,n,r,i);return"mfaPendingCredential"in s&&ym(e,"multi-factor-auth-required",{_serverResponse:s}),s}function jm(e,t,n,r){const i=`${t}${n}?${r}`;return e.config.emulator?Pm(e.config,i):`${e.config.apiScheme}://${i}`}function Vm(e){switch(e){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class zm{constructor(e){this.auth=e,this.timer=null,this.promise=new Promise(((e,t)=>{this.timer=setTimeout((()=>t(wm(this.auth,"network-request-failed"))),Om.get())}))}clearNetworkTimeout(){clearTimeout(this.timer)}}function Bm(e,t,n){const r={appName:e.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const i=wm(e,t,r);return i.customData._tokenResponse=n,i}function qm(e){return void 0!==e&&void 0!==e.getResponse}function $m(e){return void 0!==e&&void 0!==e.enterprise}class Km{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],void 0===e.recaptchaKey)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||0===this.recaptchaEnforcementState.length)return null;for(const t of this.recaptchaEnforcementState)if(t.provider&&t.provider===e)return Vm(t.enforcementState);return null}isProviderEnabled(e){return"ENFORCE"===this.getProviderEnforcementState(e)||"AUDIT"===this.getProviderEnforcementState(e)}}async function Gm(e,t){return Mm(e,"GET","/v2/recaptchaConfig",Lm(e,t))}async function Hm(e,t){return Mm(e,"POST","/v1/accounts:lookup",t)}function Wm(e){if(e)try{const t=new Date(Number(e));if(!isNaN(t.getTime()))return t.toUTCString()}catch(t){}}function Qm(e){return 1e3*Number(e)}function Jm(e){const[t,n,r]=e.split(".");if(void 0===t||void 0===n||void 0===r)return vm("JWT malformed, contained fewer than 3 sections"),null;try{const e=_(n);return e?JSON.parse(e):(vm("Failed to decode base64 JWT payload"),null)}catch(i){return vm("Caught error parsing JWT payload as JSON",null===i||void 0===i?void 0:i.toString()),null}}function Ym(e){const t=Jm(e);return Em(t,"internal-error"),Em("undefined"!==typeof t.exp,"internal-error"),Em("undefined"!==typeof t.iat,"internal-error"),Number(t.exp)-Number(t.iat)}async function Xm(e,t){if(arguments.length>2&&void 0!==arguments[2]&&arguments[2])return t;try{return await t}catch(n){throw n instanceof F&&function(e){let{code:t}=e;return"auth/user-disabled"===t||"auth/user-token-expired"===t}(n)&&e.auth.currentUser===e&&await e.auth.signOut(),n}}class Zm{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,null!==this.timerId&&clearTimeout(this.timerId))}getInterval(e){var t;if(e){const e=this.errorBackoff;return this.errorBackoff=Math.min(2*this.errorBackoff,96e4),e}{this.errorBackoff=3e4;const e=(null!==(t=this.user.stsTokenManager.expirationTime)&&void 0!==t?t:0)-Date.now()-3e5;return Math.max(0,e)}}schedule(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this.isRunning)return;const t=this.getInterval(e);this.timerId=setTimeout((async()=>{await this.iteration()}),t)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){return void("auth/network-request-failed"===(null===e||void 0===e?void 0:e.code)&&this.schedule(!0))}this.schedule()}}class eg{constructor(e,t){this.createdAt=e,this.lastLoginAt=t,this._initializeTime()}_initializeTime(){this.lastSignInTime=Wm(this.lastLoginAt),this.creationTime=Wm(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}async function tg(e){var t;const n=e.auth,r=await e.getIdToken(),i=await Xm(e,Hm(n,{idToken:r}));Em(null===i||void 0===i?void 0:i.users.length,n,"internal-error");const s=i.users[0];e._notifyReloadListener(s);const o=(null===(t=s.providerUserInfo)||void 0===t?void 0:t.length)?ng(s.providerUserInfo):[],a=(l=e.providerData,u=o,[...l.filter((e=>!u.some((t=>t.providerId===e.providerId)))),...u]);var l,u;const c=e.isAnonymous,h=!(e.email&&s.passwordHash)&&!(null===a||void 0===a?void 0:a.length),d=!!c&&h,f={uid:s.localId,displayName:s.displayName||null,photoURL:s.photoUrl||null,email:s.email||null,emailVerified:s.emailVerified||!1,phoneNumber:s.phoneNumber||null,tenantId:s.tenantId||null,providerData:a,metadata:new eg(s.createdAt,s.lastLoginAt),isAnonymous:d};Object.assign(e,f)}function ng(e){return e.map((e=>{var{providerId:t}=e,n=em(e,["providerId"]);return{providerId:t,uid:n.rawId||"",displayName:n.displayName||null,email:n.email||null,phoneNumber:n.phoneNumber||null,photoURL:n.photoUrl||null}}))}class rg{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Em(e.idToken,"internal-error"),Em("undefined"!==typeof e.idToken,"internal-error"),Em("undefined"!==typeof e.refreshToken,"internal-error");const t="expiresIn"in e&&"undefined"!==typeof e.expiresIn?Number(e.expiresIn):Ym(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,t)}updateFromIdToken(e){Em(0!==e.length,"internal-error");const t=Ym(e);this.updateTokensAndExpiration(e,null,t)}async getToken(e){return arguments.length>1&&void 0!==arguments[1]&&arguments[1]||!this.accessToken||this.isExpired?(Em(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null):this.accessToken}clearRefreshToken(){this.refreshToken=null}async refresh(e,t){const{accessToken:n,refreshToken:r,expiresIn:i}=await async function(e,t){const n=await Fm(e,{},(async()=>{const n=q({grant_type:"refresh_token",refresh_token:t}).slice(1),{tokenApiHost:r,apiKey:i}=e.config,s=jm(e,r,"/v1/token",`key=${i}`),o=await e._getAdditionalHeaders();return o["Content-Type"]="application/x-www-form-urlencoded",Rm.fetch()(s,{method:"POST",headers:o,body:n})}));return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}(e,t);this.updateTokensAndExpiration(n,r,Number(i))}updateTokensAndExpiration(e,t,n){this.refreshToken=t||null,this.accessToken=e||null,this.expirationTime=Date.now()+1e3*n}static fromJSON(e,t){const{refreshToken:n,accessToken:r,expirationTime:i}=t,s=new rg;return n&&(Em("string"===typeof n,"internal-error",{appName:e}),s.refreshToken=n),r&&(Em("string"===typeof r,"internal-error",{appName:e}),s.accessToken=r),i&&(Em("number"===typeof i,"internal-error",{appName:e}),s.expirationTime=i),s}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new rg,this.toJSON())}_performRefresh(){return Tm("not implemented")}}function ig(e,t){Em("string"===typeof e||"undefined"===typeof e,"internal-error",{appName:t})}class sg{constructor(e){var{uid:t,auth:n,stsTokenManager:r}=e,i=em(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new Zm(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=t,this.auth=n,this.stsTokenManager=r,this.accessToken=r.accessToken,this.displayName=i.displayName||null,this.email=i.email||null,this.emailVerified=i.emailVerified||!1,this.phoneNumber=i.phoneNumber||null,this.photoURL=i.photoURL||null,this.isAnonymous=i.isAnonymous||!1,this.tenantId=i.tenantId||null,this.providerData=i.providerData?[...i.providerData]:[],this.metadata=new eg(i.createdAt||void 0,i.lastLoginAt||void 0)}async getIdToken(e){const t=await Xm(this,this.stsTokenManager.getToken(this.auth,e));return Em(t,this.auth,"internal-error"),this.accessToken!==t&&(this.accessToken=t,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),t}getIdTokenResult(e){return async function(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const n=Q(e),r=await n.getIdToken(t),i=Jm(r);Em(i&&i.exp&&i.auth_time&&i.iat,n.auth,"internal-error");const s="object"===typeof i.firebase?i.firebase:void 0,o=null===s||void 0===s?void 0:s.sign_in_provider;return{claims:i,token:r,authTime:Wm(Qm(i.auth_time)),issuedAtTime:Wm(Qm(i.iat)),expirationTime:Wm(Qm(i.exp)),signInProvider:o||null,signInSecondFactor:(null===s||void 0===s?void 0:s.sign_in_second_factor)||null}}(this,e)}reload(){return async function(e){const t=Q(e);await tg(t),await t.auth._persistUserIfCurrent(t),t.auth._notifyListenersIfCurrent(t)}(this)}_assign(e){this!==e&&(Em(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map((e=>Object.assign({},e))),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const t=new sg(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return t.metadata._copy(this.metadata),t}_onReload(e){Em(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),n=!0),t&&await tg(this),await this.auth._persistUserIfCurrent(this),n&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(ct(this.auth.app))return Promise.reject(_m(this.auth));const e=await this.getIdToken();return await Xm(this,async function(e,t){return Mm(e,"POST","/v1/accounts:delete",t)}(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map((e=>Object.assign({},e))),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,t){var n,r,i,s,o,a,l,u;const c=null!==(n=t.displayName)&&void 0!==n?n:void 0,h=null!==(r=t.email)&&void 0!==r?r:void 0,d=null!==(i=t.phoneNumber)&&void 0!==i?i:void 0,f=null!==(s=t.photoURL)&&void 0!==s?s:void 0,p=null!==(o=t.tenantId)&&void 0!==o?o:void 0,m=null!==(a=t._redirectEventId)&&void 0!==a?a:void 0,g=null!==(l=t.createdAt)&&void 0!==l?l:void 0,v=null!==(u=t.lastLoginAt)&&void 0!==u?u:void 0,{uid:y,emailVerified:w,isAnonymous:b,providerData:_,stsTokenManager:I}=t;Em(y&&I,e,"internal-error");const S=rg.fromJSON(this.name,I);Em("string"===typeof y,e,"internal-error"),ig(c,e.name),ig(h,e.name),Em("boolean"===typeof w,e,"internal-error"),Em("boolean"===typeof b,e,"internal-error"),ig(d,e.name),ig(f,e.name),ig(p,e.name),ig(m,e.name),ig(g,e.name),ig(v,e.name);const E=new sg({uid:y,auth:e,email:h,emailVerified:w,displayName:c,isAnonymous:b,photoURL:f,phoneNumber:d,tenantId:p,stsTokenManager:S,createdAt:g,lastLoginAt:v});return _&&Array.isArray(_)&&(E.providerData=_.map((e=>Object.assign({},e)))),m&&(E._redirectEventId=m),E}static async _fromIdTokenResponse(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=new rg;r.updateFromServerResponse(t);const i=new sg({uid:t.localId,auth:e,stsTokenManager:r,isAnonymous:n});return await tg(i),i}static async _fromGetAccountInfoResponse(e,t,n){const r=t.users[0];Em(void 0!==r.localId,"internal-error");const i=void 0!==r.providerUserInfo?ng(r.providerUserInfo):[],s=!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length),o=new rg;o.updateFromIdToken(n);const a=new sg({uid:r.localId,auth:e,stsTokenManager:o,isAnonymous:s}),l={uid:r.localId,displayName:r.displayName||null,photoURL:r.photoUrl||null,email:r.email||null,emailVerified:r.emailVerified||!1,phoneNumber:r.phoneNumber||null,tenantId:r.tenantId||null,providerData:i,metadata:new eg(r.createdAt,r.lastLoginAt),isAnonymous:!(r.email&&r.passwordHash)&&!(null===i||void 0===i?void 0:i.length)};return Object.assign(a,l),a}}const og=new Map;function ag(e){km(e instanceof Function,"Expected a class definition");let t=og.get(e);return t?(km(t instanceof e,"Instance stored in cache mismatched with class"),t):(t=new e,og.set(e,t),t)}class lg{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,t){this.storage[e]=t}async _get(e){const t=this.storage[e];return void 0===t?null:t}async _remove(e){delete this.storage[e]}_addListener(e,t){}_removeListener(e,t){}}lg.type="NONE";const ug=lg;function cg(e,t,n){return`firebase:${e}:${t}:${n}`}class hg{constructor(e,t,n){this.persistence=e,this.auth=t,this.userKey=n;const{config:r,name:i}=this.auth;this.fullUserKey=cg(this.userKey,r.apiKey,i),this.fullPersistenceKey=cg("persistence",r.apiKey,i),this.boundEventHandler=t._onStorageEvent.bind(t),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);return e?sg._fromJSON(this.auth,e):null}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const t=await this.getCurrentUser();return await this.removeCurrentUser(),this.persistence=e,t?this.setCurrentUser(t):void 0}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"authUser";if(!t.length)return new hg(ag(ug),e,n);const r=(await Promise.all(t.map((async e=>{if(await e._isAvailable())return e})))).filter((e=>e));let i=r[0]||ag(ug);const s=cg(n,e.config.apiKey,e.name);let o=null;for(const u of t)try{const t=await u._get(s);if(t){const n=sg._fromJSON(e,t);u!==i&&(o=n),i=u;break}}catch(l){}const a=r.filter((e=>e._shouldAllowMigration));return i._shouldAllowMigration&&a.length?(i=a[0],o&&await i._set(s,o.toJSON()),await Promise.all(t.map((async e=>{if(e!==i)try{await e._remove(s)}catch(l){}}))),new hg(i,e,n)):new hg(i,e,n)}}function dg(e){const t=e.toLowerCase();if(t.includes("opera/")||t.includes("opr/")||t.includes("opios/"))return"Opera";if(gg(t))return"IEMobile";if(t.includes("msie")||t.includes("trident/"))return"IE";if(t.includes("edge/"))return"Edge";if(fg(t))return"Firefox";if(t.includes("silk/"))return"Silk";if(yg(t))return"Blackberry";if(wg(t))return"Webos";if(pg(t))return"Safari";if((t.includes("chrome/")||mg(t))&&!t.includes("edge/"))return"Chrome";if(vg(t))return"Android";{const t=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,n=e.match(t);if(2===(null===n||void 0===n?void 0:n.length))return n[1]}return"Other"}function fg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/firefox\//i.test(e)}function pg(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:N()).toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function mg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/crios\//i.test(e)}function gg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/iemobile/i.test(e)}function vg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/android/i.test(e)}function yg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/blackberry/i.test(e)}function wg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/webos/i.test(e)}function bg(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/iphone|ipad|ipod/i.test(e)||/macintosh/i.test(e)&&/mobile/i.test(e)}function _g(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return bg(e)||vg(e)||wg(e)||yg(e)||/windows phone/i.test(e)||gg(e)}function Ig(e){let t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];switch(e){case"Browser":t=dg(N());break;case"Worker":t=`${dg(N())}-${e}`;break;default:t=e}const r=n.length?n.join(","):"FirebaseCore-web";return`${t}/JsCore/${mt}/${r}`}class Sg{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,t){const n=t=>new Promise(((n,r)=>{try{n(e(t))}catch(i){r(i)}}));n.onAbort=t,this.queue.push(n);const r=this.queue.length-1;return()=>{this.queue[r]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const t=[];try{for(const n of this.queue)await n(e),n.onAbort&&t.push(n.onAbort)}catch(n){t.reverse();for(const e of t)try{e()}catch(r){}throw this.auth._errorFactory.create("login-blocked",{originalMessage:null===n||void 0===n?void 0:n.message})}}}class Eg{constructor(e){var t,n,r,i;const s=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=null!==(t=s.minPasswordLength)&&void 0!==t?t:6,s.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=s.maxPasswordLength),void 0!==s.containsLowercaseCharacter&&(this.customStrengthOptions.containsLowercaseLetter=s.containsLowercaseCharacter),void 0!==s.containsUppercaseCharacter&&(this.customStrengthOptions.containsUppercaseLetter=s.containsUppercaseCharacter),void 0!==s.containsNumericCharacter&&(this.customStrengthOptions.containsNumericCharacter=s.containsNumericCharacter),void 0!==s.containsNonAlphanumericCharacter&&(this.customStrengthOptions.containsNonAlphanumericCharacter=s.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,"ENFORCEMENT_STATE_UNSPECIFIED"===this.enforcementState&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=null!==(r=null===(n=e.allowedNonAlphanumericCharacters)||void 0===n?void 0:n.join(""))&&void 0!==r?r:"",this.forceUpgradeOnSignin=null!==(i=e.forceUpgradeOnSignin)&&void 0!==i&&i,this.schemaVersion=e.schemaVersion}validatePassword(e){var t,n,r,i,s,o;const a={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,a),this.validatePasswordCharacterOptions(e,a),a.isValid&&(a.isValid=null===(t=a.meetsMinPasswordLength)||void 0===t||t),a.isValid&&(a.isValid=null===(n=a.meetsMaxPasswordLength)||void 0===n||n),a.isValid&&(a.isValid=null===(r=a.containsLowercaseLetter)||void 0===r||r),a.isValid&&(a.isValid=null===(i=a.containsUppercaseLetter)||void 0===i||i),a.isValid&&(a.isValid=null===(s=a.containsNumericCharacter)||void 0===s||s),a.isValid&&(a.isValid=null===(o=a.containsNonAlphanumericCharacter)||void 0===o||o),a}validatePasswordLengthOptions(e,t){const n=this.customStrengthOptions.minPasswordLength,r=this.customStrengthOptions.maxPasswordLength;n&&(t.meetsMinPasswordLength=e.length>=n),r&&(t.meetsMaxPasswordLength=e.length<=r)}validatePasswordCharacterOptions(e,t){let n;this.updatePasswordCharacterOptionsStatuses(t,!1,!1,!1,!1);for(let r=0;r<e.length;r++)n=e.charAt(r),this.updatePasswordCharacterOptionsStatuses(t,n>="a"&&n<="z",n>="A"&&n<="Z",n>="0"&&n<="9",this.allowedNonAlphanumericCharacters.includes(n))}updatePasswordCharacterOptionsStatuses(e,t,n,r,i){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=t)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=n)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=r)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=i))}}class Tg{constructor(e,t,n,r){this.app=e,this.heartbeatServiceProvider=t,this.appCheckServiceProvider=n,this.config=r,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new Cg(this),this.idTokenSubscription=new Cg(this),this.beforeStateQueue=new Sg(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=mm,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=r.sdkClientVersion}_initializeWithPersistence(e,t){return t&&(this._popupRedirectResolver=ag(t)),this._initializationPromise=this.queue((async()=>{var n,r;if(!this._deleted&&(this.persistenceManager=await hg.create(this,e),!this._deleted)){if(null===(n=this._popupRedirectResolver)||void 0===n?void 0:n._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch(i){}await this.initializeCurrentUser(t),this.lastNotifiedUid=(null===(r=this.currentUser)||void 0===r?void 0:r.uid)||null,this._deleted||(this._isInitialized=!0)}})),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();return this.currentUser||e?this.currentUser&&e&&this.currentUser.uid===e.uid?(this._currentUser._assign(e),void await this.currentUser.getIdToken()):void await this._updateCurrentUser(e,!0):void 0}async initializeCurrentUserFromIdToken(e){try{const t=await Hm(this,{idToken:e}),n=await sg._fromGetAccountInfoResponse(this,t,e);await this.directlySetCurrentUser(n)}catch(t){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",t),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var t;if(ct(this.app)){const e=this.app.settings.authIdToken;return e?new Promise((t=>{setTimeout((()=>this.initializeCurrentUserFromIdToken(e).then(t,t)))})):this.directlySetCurrentUser(null)}const n=await this.assertedPersistence.getCurrentUser();let r=n,i=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const n=null===(t=this.redirectUser)||void 0===t?void 0:t._redirectEventId,s=null===r||void 0===r?void 0:r._redirectEventId,o=await this.tryRedirectSignIn(e);n&&n!==s||!(null===o||void 0===o?void 0:o.user)||(r=o.user,i=!0)}if(!r)return this.directlySetCurrentUser(null);if(!r._redirectEventId){if(i)try{await this.beforeStateQueue.runMiddleware(r)}catch(s){r=n,this._popupRedirectResolver._overrideRedirectResult(this,(()=>Promise.reject(s)))}return r?this.reloadAndSetCurrentUserOrClear(r):this.directlySetCurrentUser(null)}return Em(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===r._redirectEventId?this.directlySetCurrentUser(r):this.reloadAndSetCurrentUserOrClear(r)}async tryRedirectSignIn(e){let t=null;try{t=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch(n){await this._setRedirectUser(null)}return t}async reloadAndSetCurrentUserOrClear(e){try{await tg(e)}catch(t){if("auth/network-request-failed"!==(null===t||void 0===t?void 0:t.code))return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=function(){if("undefined"===typeof navigator)return null;const e=navigator;return e.languages&&e.languages[0]||e.language||null}()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(ct(this.app))return Promise.reject(_m(this));const t=e?Q(e):null;return t&&Em(t.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(t&&t._clone(this))}async _updateCurrentUser(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!this._deleted)return e&&Em(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),t||await this.beforeStateQueue.runMiddleware(e),this.queue((async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()}))}async signOut(){return ct(this.app)?Promise.reject(_m(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return ct(this.app)?Promise.reject(_m(this)):this.queue((async()=>{await this.assertedPersistence.setPersistence(ag(e))}))}_getRecaptchaConfig(){return null==this.tenantId?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const t=this._getPasswordPolicyInternal();return t.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):t.validatePassword(e)}_getPasswordPolicyInternal(){return null===this.tenantId?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await async function(e){return Mm(e,"GET","/v2/passwordPolicy",Lm(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}))}(this),t=new Eg(e);null===this.tenantId?this._projectPasswordPolicy=t:this._tenantPasswordPolicies[this.tenantId]=t}_getPersistence(){return this.assertedPersistence.persistence.type}_updateErrorMap(e){this._errorFactory=new U("auth","Firebase",e())}onAuthStateChanged(e,t,n){return this.registerStateListener(this.authStateSubscription,e,t,n)}beforeAuthStateChanged(e,t){return this.beforeStateQueue.pushCallback(e,t)}onIdTokenChanged(e,t,n){return this.registerStateListener(this.idTokenSubscription,e,t,n)}authStateReady(){return new Promise(((e,t)=>{if(this.currentUser)e();else{const n=this.onAuthStateChanged((()=>{n(),e()}),t)}}))}async revokeAccessToken(e){if(this.currentUser){const t={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:await this.currentUser.getIdToken()};null!=this.tenantId&&(t.tenantId=this.tenantId),await async function(e,t){return Mm(e,"POST","/v2/accounts:revokeToken",Lm(e,t))}(this,t)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:null===(e=this._currentUser)||void 0===e?void 0:e.toJSON()}}async _setRedirectUser(e,t){const n=await this.getOrInitRedirectPersistenceManager(t);return null===e?n.removeCurrentUser():n.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const t=e&&ag(e)||this._popupRedirectResolver;Em(t,this,"argument-error"),this.redirectPersistenceManager=await hg.create(this,[ag(t._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var t,n;return this._isInitialized&&await this.queue((async()=>{})),(null===(t=this._currentUser)||void 0===t?void 0:t._redirectEventId)===e?this._currentUser:(null===(n=this.redirectUser)||void 0===n?void 0:n._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue((async()=>this.directlySetCurrentUser(e)))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,t;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const n=null!==(t=null===(e=this.currentUser)||void 0===e?void 0:e.uid)&&void 0!==t?t:null;this.lastNotifiedUid!==n&&(this.lastNotifiedUid=n,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,t,n,r){if(this._deleted)return()=>{};const i="function"===typeof t?t:t.next.bind(t);let s=!1;const o=this._isInitialized?Promise.resolve():this._initializationPromise;if(Em(o,this,"internal-error"),o.then((()=>{s||i(this.currentUser)})),"function"===typeof t){const i=e.addObserver(t,n,r);return()=>{s=!0,i()}}{const n=e.addObserver(t);return()=>{s=!0,n()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Em(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){e&&!this.frameworks.includes(e)&&(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=Ig(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const t={"X-Client-Version":this.clientVersion};this.app.options.appId&&(t["X-Firebase-gmpid"]=this.app.options.appId);const n=await(null===(e=this.heartbeatServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getHeartbeatsHeader());n&&(t["X-Firebase-Client"]=n);const r=await this._getAppCheckToken();return r&&(t["X-Firebase-AppCheck"]=r),t}async _getAppCheckToken(){var e;const t=await(null===(e=this.appCheckServiceProvider.getImmediate({optional:!0}))||void 0===e?void 0:e.getToken());return(null===t||void 0===t?void 0:t.error)&&function(e){if(gm.logLevel<=te.WARN){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];gm.warn(`Auth (${mt}): ${e}`,...n)}}(`Error while retrieving App Check token: ${t.error}`),null===t||void 0===t?void 0:t.token}}function kg(e){return Q(e)}class Cg{constructor(e){this.auth=e,this.observer=null,this.addObserver=G((e=>this.observer=e))}get next(){return Em(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}let xg={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function Ng(e){return xg.loadJS(e)}function Ag(e){return`__${e}${Math.floor(1e6*Math.random())}`}class Pg{constructor(e){this.type="recaptcha-enterprise",this.auth=kg(e)}async verify(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"verify",t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];function n(t,n,r){const i=window.grecaptcha;$m(i)?i.enterprise.ready((()=>{i.enterprise.execute(t,{action:e}).then((e=>{n(e)})).catch((()=>{n("NO_RECAPTCHA")}))})):r(Error("No reCAPTCHA enterprise script loaded."))}return new Promise(((e,r)=>{(async function(e){if(!t){if(null==e.tenantId&&null!=e._agentRecaptchaConfig)return e._agentRecaptchaConfig.siteKey;if(null!=e.tenantId&&void 0!==e._tenantRecaptchaConfigs[e.tenantId])return e._tenantRecaptchaConfigs[e.tenantId].siteKey}return new Promise((async(t,n)=>{Gm(e,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then((r=>{if(void 0!==r.recaptchaKey){const n=new Km(r);return null==e.tenantId?e._agentRecaptchaConfig=n:e._tenantRecaptchaConfigs[e.tenantId]=n,t(n.siteKey)}n(new Error("recaptcha Enterprise site key undefined"))})).catch((e=>{n(e)}))}))})(this.auth).then((i=>{if(!t&&$m(window.grecaptcha))n(i,e,r);else{if("undefined"===typeof window)return void r(new Error("RecaptchaVerifier is only supported in browser"));let t=xg.recaptchaEnterpriseScript;0!==t.length&&(t+=i),Ng(t).then((()=>{n(i,e,r)})).catch((e=>{r(e)}))}})).catch((e=>{r(e)}))}))}}async function Rg(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=new Pg(e);let s;try{s=await i.verify(n)}catch(a){s=await i.verify(n,!0)}const o=Object.assign({},t);return r?Object.assign(o,{captchaResp:s}):Object.assign(o,{captchaResponse:s}),Object.assign(o,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(o,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),o}async function Dg(e,t,n,r){var i;if(null===(i=e._getRecaptchaConfig())||void 0===i?void 0:i.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const i=await Rg(e,t,n,"getOobCode"===n);return r(e,i)}return r(e,t).catch((async i=>{if("auth/missing-recaptcha-token"===i.code){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const i=await Rg(e,t,n,"getOobCode"===n);return r(e,i)}return Promise.reject(i)}))}function Og(e,t,n){const r=kg(e);Em(r._canInitEmulator,r,"emulator-config-failed"),Em(/^https?:\/\//.test(t),r,"invalid-emulator-scheme");const i=!!(null===n||void 0===n?void 0:n.disableWarnings),s=Lg(t),{host:o,port:a}=function(e){const t=Lg(e),n=/(\/\/)?([^?#/]+)/.exec(e.substr(t.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",i=/^(\[[^\]]+\])(:|$)/.exec(r);if(i){const e=i[1];return{host:e,port:Mg(r.substr(e.length+1))}}{const[e,t]=r.split(":");return{host:e,port:Mg(t)}}}(t),l=null===a?"":`:${a}`;r.config.emulator={url:`${s}//${o}${l}/`},r.settings.appVerificationDisabledForTesting=!0,r.emulatorConfig=Object.freeze({host:o,port:a,protocol:s.replace(":",""),options:Object.freeze({disableWarnings:i})}),i||function(){function e(){const e=document.createElement("p"),t=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",t.position="fixed",t.width="100%",t.backgroundColor="#ffffff",t.border=".1em solid #000000",t.color="#b50000",t.bottom="0px",t.left="0px",t.margin="0px",t.zIndex="10000",t.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}"undefined"!==typeof console&&"function"===typeof console.info&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials.");"undefined"!==typeof window&&"undefined"!==typeof document&&("loading"===document.readyState?window.addEventListener("DOMContentLoaded",e):e())}()}function Lg(e){const t=e.indexOf(":");return t<0?"":e.substr(0,t+1)}function Mg(e){if(!e)return null;const t=Number(e);return isNaN(t)?null:t}class Fg{constructor(e,t){this.providerId=e,this.signInMethod=t}toJSON(){return Tm("not implemented")}_getIdTokenResponse(e){return Tm("not implemented")}_linkToIdToken(e,t){return Tm("not implemented")}_getReauthenticationResolver(e){return Tm("not implemented")}}async function Ug(e,t){return Mm(e,"POST","/v1/accounts:resetPassword",Lm(e,t))}async function jg(e,t){return Mm(e,"POST","/v1/accounts:signUp",t)}async function Vg(e,t){return Um(e,"POST","/v1/accounts:signInWithPassword",Lm(e,t))}async function zg(e,t){return Mm(e,"POST","/v1/accounts:sendOobCode",Lm(e,t))}async function Bg(e,t){return zg(e,t)}async function qg(e,t){return zg(e,t)}class $g extends Fg{constructor(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;super("password",n),this._email=e,this._password=t,this._tenantId=r}static _fromEmailAndPassword(e,t){return new $g(e,t,"password")}static _fromEmailAndCode(e,t){return new $g(e,t,"emailLink",arguments.length>2&&void 0!==arguments[2]?arguments[2]:null)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e;if((null===t||void 0===t?void 0:t.email)&&(null===t||void 0===t?void 0:t.password)){if("password"===t.signInMethod)return this._fromEmailAndPassword(t.email,t.password);if("emailLink"===t.signInMethod)return this._fromEmailAndCode(t.email,t.password,t.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":return Dg(e,{returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signInWithPassword",Vg);case"emailLink":return async function(e,t){return Um(e,"POST","/v1/accounts:signInWithEmailLink",Lm(e,t))}(e,{email:this._email,oobCode:this._password});default:ym(e,"internal-error")}}async _linkToIdToken(e,t){switch(this.signInMethod){case"password":return Dg(e,{idToken:t,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",jg);case"emailLink":return async function(e,t){return Um(e,"POST","/v1/accounts:signInWithEmailLink",Lm(e,t))}(e,{idToken:t,email:this._email,oobCode:this._password});default:ym(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}async function Kg(e,t){return Um(e,"POST","/v1/accounts:signInWithIdp",Lm(e,t))}class Gg extends Fg{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const t=new Gg(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(t.idToken=e.idToken),e.accessToken&&(t.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(t.nonce=e.nonce),e.pendingToken&&(t.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(t.accessToken=e.oauthToken,t.secret=e.oauthTokenSecret):ym("argument-error"),t}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r}=t,i=em(t,["providerId","signInMethod"]);if(!n||!r)return null;const s=new Gg(n,r);return s.idToken=i.idToken||void 0,s.accessToken=i.accessToken||void 0,s.secret=i.secret,s.nonce=i.nonce,s.pendingToken=i.pendingToken||null,s}_getIdTokenResponse(e){return Kg(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Kg(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kg(e,t)}buildRequest(){const e={requestUri:"http://localhost",returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const t={};this.idToken&&(t.id_token=this.idToken),this.accessToken&&(t.access_token=this.accessToken),this.secret&&(t.oauth_token_secret=this.secret),t.providerId=this.providerId,this.nonce&&!this.pendingToken&&(t.nonce=this.nonce),e.postBody=q(t)}return e}}const Hg={USER_NOT_FOUND:"user-not-found"};class Wg extends Fg{constructor(e){super("phone","phone"),this.params=e}static _fromVerification(e,t){return new Wg({verificationId:e,verificationCode:t})}static _fromTokenResponse(e,t){return new Wg({phoneNumber:e,temporaryProof:t})}_getIdTokenResponse(e){return async function(e,t){return Um(e,"POST","/v1/accounts:signInWithPhoneNumber",Lm(e,t))}(e,this._makeVerificationRequest())}_linkToIdToken(e,t){return async function(e,t){const n=await Um(e,"POST","/v1/accounts:signInWithPhoneNumber",Lm(e,t));if(n.temporaryProof)throw Bm(e,"account-exists-with-different-credential",n);return n}(e,Object.assign({idToken:t},this._makeVerificationRequest()))}_getReauthenticationResolver(e){return async function(e,t){return Um(e,"POST","/v1/accounts:signInWithPhoneNumber",Lm(e,Object.assign(Object.assign({},t),{operation:"REAUTH"})),Hg)}(e,this._makeVerificationRequest())}_makeVerificationRequest(){const{temporaryProof:e,phoneNumber:t,verificationId:n,verificationCode:r}=this.params;return e&&t?{temporaryProof:e,phoneNumber:t}:{sessionInfo:n,code:r}}toJSON(){const e={providerId:this.providerId};return this.params.phoneNumber&&(e.phoneNumber=this.params.phoneNumber),this.params.temporaryProof&&(e.temporaryProof=this.params.temporaryProof),this.params.verificationCode&&(e.verificationCode=this.params.verificationCode),this.params.verificationId&&(e.verificationId=this.params.verificationId),e}static fromJSON(e){"string"===typeof e&&(e=JSON.parse(e));const{verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}=e;return n||t||r||i?new Wg({verificationId:t,verificationCode:n,phoneNumber:r,temporaryProof:i}):null}}class Qg{constructor(e){var t,n,r,i,s,o;const a=$(K(e)),l=null!==(t=a.apiKey)&&void 0!==t?t:null,u=null!==(n=a.oobCode)&&void 0!==n?n:null,c=function(e){switch(e){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}(null!==(r=a.mode)&&void 0!==r?r:null);Em(l&&u&&c,"argument-error"),this.apiKey=l,this.operation=c,this.code=u,this.continueUrl=null!==(i=a.continueUrl)&&void 0!==i?i:null,this.languageCode=null!==(s=a.languageCode)&&void 0!==s?s:null,this.tenantId=null!==(o=a.tenantId)&&void 0!==o?o:null}static parseLink(e){const t=function(e){const t=$(K(e)).link,n=t?$(K(t)).deep_link_id:null,r=$(K(e)).deep_link_id;return(r?$(K(r)).link:null)||r||n||t||e}(e);try{return new Qg(t)}catch(n){return null}}}class Jg{constructor(){this.providerId=Jg.PROVIDER_ID}static credential(e,t){return $g._fromEmailAndPassword(e,t)}static credentialWithLink(e,t){const n=Qg.parseLink(t);return Em(n,"argument-error"),$g._fromEmailAndCode(e,n.code,n.tenantId)}}Jg.PROVIDER_ID="password",Jg.EMAIL_PASSWORD_SIGN_IN_METHOD="password",Jg.EMAIL_LINK_SIGN_IN_METHOD="emailLink";class Yg{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}class Xg extends Yg{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}class Zg extends Xg{static credentialFromJSON(e){const t="string"===typeof e?JSON.parse(e):e;return Em("providerId"in t&&"signInMethod"in t,"argument-error"),Gg._fromParams(t)}credential(e){return this._credential(Object.assign(Object.assign({},e),{nonce:e.rawNonce}))}_credential(e){return Em(e.idToken||e.accessToken,"argument-error"),Gg._fromParams(Object.assign(Object.assign({},e),{providerId:this.providerId,signInMethod:this.providerId}))}static credentialFromResult(e){return Zg.oauthCredentialFromTaggedObject(e)}static credentialFromError(e){return Zg.oauthCredentialFromTaggedObject(e.customData||{})}static oauthCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r,oauthTokenSecret:i,pendingToken:s,nonce:o,providerId:a}=t;if(!r&&!i&&!n&&!s)return null;if(!a)return null;try{return new Zg(a)._credential({idToken:n,accessToken:r,nonce:o,pendingToken:s})}catch(l){return null}}}class ev extends Xg{constructor(){super("facebook.com")}static credential(e){return Gg._fromParams({providerId:ev.PROVIDER_ID,signInMethod:ev.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return ev.credentialFromTaggedObject(e)}static credentialFromError(e){return ev.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return ev.credential(t.oauthAccessToken)}catch(n){return null}}}ev.FACEBOOK_SIGN_IN_METHOD="facebook.com",ev.PROVIDER_ID="facebook.com";class tv extends Xg{constructor(){super("google.com"),this.addScope("profile")}static credential(e,t){return Gg._fromParams({providerId:tv.PROVIDER_ID,signInMethod:tv.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:t})}static credentialFromResult(e){return tv.credentialFromTaggedObject(e)}static credentialFromError(e){return tv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthIdToken:n,oauthAccessToken:r}=t;if(!n&&!r)return null;try{return tv.credential(n,r)}catch(i){return null}}}tv.GOOGLE_SIGN_IN_METHOD="google.com",tv.PROVIDER_ID="google.com";class nv extends Xg{constructor(){super("github.com")}static credential(e){return Gg._fromParams({providerId:nv.PROVIDER_ID,signInMethod:nv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return nv.credentialFromTaggedObject(e)}static credentialFromError(e){return nv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t||!("oauthAccessToken"in t))return null;if(!t.oauthAccessToken)return null;try{return nv.credential(t.oauthAccessToken)}catch(n){return null}}}nv.GITHUB_SIGN_IN_METHOD="github.com",nv.PROVIDER_ID="github.com";class rv extends Fg{constructor(e,t){super(e,e),this.pendingToken=t}_getIdTokenResponse(e){return Kg(e,this.buildRequest())}_linkToIdToken(e,t){const n=this.buildRequest();return n.idToken=t,Kg(e,n)}_getReauthenticationResolver(e){const t=this.buildRequest();return t.autoCreate=!1,Kg(e,t)}toJSON(){return{signInMethod:this.signInMethod,providerId:this.providerId,pendingToken:this.pendingToken}}static fromJSON(e){const t="string"===typeof e?JSON.parse(e):e,{providerId:n,signInMethod:r,pendingToken:i}=t;return n&&r&&i&&n===r?new rv(n,i):null}static _create(e,t){return new rv(e,t)}buildRequest(){return{requestUri:"http://localhost",returnSecureToken:!0,pendingToken:this.pendingToken}}}class iv extends Yg{constructor(e){Em(e.startsWith("saml."),"argument-error"),super(e)}static credentialFromResult(e){return iv.samlCredentialFromTaggedObject(e)}static credentialFromError(e){return iv.samlCredentialFromTaggedObject(e.customData||{})}static credentialFromJSON(e){const t=rv.fromJSON(e);return Em(t,"argument-error"),t}static samlCredentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{pendingToken:n,providerId:r}=t;if(!n||!r)return null;try{return rv._create(r,n)}catch(i){return null}}}class sv extends Xg{constructor(){super("twitter.com")}static credential(e,t){return Gg._fromParams({providerId:sv.PROVIDER_ID,signInMethod:sv.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:t})}static credentialFromResult(e){return sv.credentialFromTaggedObject(e)}static credentialFromError(e){return sv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=t;if(!n||!r)return null;try{return sv.credential(n,r)}catch(i){return null}}}async function ov(e,t){return Um(e,"POST","/v1/accounts:signUp",Lm(e,t))}sv.TWITTER_SIGN_IN_METHOD="twitter.com",sv.PROVIDER_ID="twitter.com";class av{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];const i=await sg._fromIdTokenResponse(e,n,r),s=lv(n);return new av({user:i,providerId:s,_tokenResponse:n,operationType:t})}static async _forOperation(e,t,n){await e._updateTokensIfNecessary(n,!0);const r=lv(n);return new av({user:e,providerId:r,_tokenResponse:n,operationType:t})}}function lv(e){return e.providerId?e.providerId:"phoneNumber"in e?"phone":null}class uv extends F{constructor(e,t,n,r){var i;super(t.code,t.message),this.operationType=n,this.user=r,Object.setPrototypeOf(this,uv.prototype),this.customData={appName:e.name,tenantId:null!==(i=e.tenantId)&&void 0!==i?i:void 0,_serverResponse:t.customData._serverResponse,operationType:n}}static _fromErrorAndOperation(e,t,n,r){return new uv(e,t,n,r)}}function cv(e,t,n,r){return("reauthenticate"===t?n._getReauthenticationResolver(e):n._getIdTokenResponse(e)).catch((n=>{if("auth/multi-factor-auth-required"===n.code)throw uv._fromErrorAndOperation(e,n,t,r);throw n}))}function hv(e){return new Set(e.map((e=>{let{providerId:t}=e;return t})).filter((e=>!!e)))}async function dv(e,t){const n=Q(e);await pv(!0,n,t);const{providerUserInfo:r}=await async function(e,t){return Mm(e,"POST","/v1/accounts:update",t)}(n.auth,{idToken:await n.getIdToken(),deleteProvider:[t]}),i=hv(r||[]);return n.providerData=n.providerData.filter((e=>i.has(e.providerId))),i.has("phone")||(n.phoneNumber=null),await n.auth._persistUserIfCurrent(n),n}async function fv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const r=await Xm(e,t._linkToIdToken(e.auth,await e.getIdToken()),n);return av._forOperation(e,"link",r)}async function pv(e,t,n){await tg(t);const r=!1===e?"provider-already-linked":"no-such-provider";Em(hv(t.providerData).has(n)===e,t.auth,r)}async function mv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const{auth:r}=e;if(ct(r.app))return Promise.reject(_m(r));const i="reauthenticate";try{const s=await Xm(e,cv(r,i,t,e),n);Em(s.idToken,r,"internal-error");const o=Jm(s.idToken);Em(o,r,"internal-error");const{sub:a}=o;return Em(e.uid===a,r,"user-mismatch"),av._forOperation(e,i,s)}catch(s){throw"auth/user-not-found"===(null===s||void 0===s?void 0:s.code)&&ym(r,"user-mismatch"),s}}async function gv(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ct(e.app))return Promise.reject(_m(e));const r="signIn",i=await cv(e,r,t),s=await av._fromIdTokenResponse(e,r,i);return n||await e._updateCurrentUser(s.user),s}async function vv(e,t){return gv(kg(e),t)}async function yv(e,t){const n=Q(e);return await pv(!1,n,t.providerId),fv(n,t)}async function wv(e,t){return mv(Q(e),t)}async function bv(e,t){if(ct(e.app))return Promise.reject(_m(e));const n=kg(e),r=await async function(e,t){return Um(e,"POST","/v1/accounts:signInWithCustomToken",Lm(e,t))}(n,{token:t,returnSecureToken:!0}),i=await av._fromIdTokenResponse(n,"signIn",r);return await n._updateCurrentUser(i.user),i}class _v{constructor(e,t){this.factorId=e,this.uid=t.mfaEnrollmentId,this.enrollmentTime=new Date(t.enrolledAt).toUTCString(),this.displayName=t.displayName}static _fromServerResponse(e,t){return"phoneInfo"in t?Iv._fromServerResponse(e,t):"totpInfo"in t?Sv._fromServerResponse(e,t):ym(e,"internal-error")}}class Iv extends _v{constructor(e){super("phone",e),this.phoneNumber=e.phoneInfo}static _fromServerResponse(e,t){return new Iv(t)}}class Sv extends _v{constructor(e){super("totp",e)}static _fromServerResponse(e,t){return new Sv(t)}}function Ev(e,t,n){var r;Em((null===(r=n.url)||void 0===r?void 0:r.length)>0,e,"invalid-continue-uri"),Em("undefined"===typeof n.dynamicLinkDomain||n.dynamicLinkDomain.length>0,e,"invalid-dynamic-link-domain"),t.continueUrl=n.url,t.dynamicLinkDomain=n.dynamicLinkDomain,t.canHandleCodeInApp=n.handleCodeInApp,n.iOS&&(Em(n.iOS.bundleId.length>0,e,"missing-ios-bundle-id"),t.iOSBundleId=n.iOS.bundleId),n.android&&(Em(n.android.packageName.length>0,e,"missing-android-pkg-name"),t.androidInstallApp=n.android.installApp,t.androidMinimumVersionCode=n.android.minimumVersion,t.androidPackageName=n.android.packageName)}async function Tv(e){const t=kg(e);t._getPasswordPolicyInternal()&&await t._updatePasswordPolicy()}async function kv(e,t){await async function(e,t){return Mm(e,"POST","/v1/accounts:update",Lm(e,t))}(Q(e),{oobCode:t})}async function Cv(e,t){const n=Q(e),r=await Ug(n,{oobCode:t}),i=r.requestType;switch(Em(i,n,"internal-error"),i){case"EMAIL_SIGNIN":break;case"VERIFY_AND_CHANGE_EMAIL":Em(r.newEmail,n,"internal-error");break;case"REVERT_SECOND_FACTOR_ADDITION":Em(r.mfaInfo,n,"internal-error");default:Em(r.email,n,"internal-error")}let s=null;return r.mfaInfo&&(s=_v._fromServerResponse(kg(n),r.mfaInfo)),{data:{email:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.newEmail:r.email)||null,previousEmail:("VERIFY_AND_CHANGE_EMAIL"===r.requestType?r.email:r.newEmail)||null,multiFactorInfo:s},operation:i}}async function xv(e,t){const n={identifier:t,continueUri:xm()?Cm():"http://localhost"},{signinMethods:r}=await async function(e,t){return Mm(e,"POST","/v1/accounts:createAuthUri",Lm(e,t))}(Q(e),n);return r||[]}async function Nv(e,t){const n=Q(e),r={requestType:"VERIFY_EMAIL",idToken:await e.getIdToken()};t&&Ev(n.auth,r,t);const{email:i}=await async function(e,t){return zg(e,t)}(n.auth,r);i!==e.email&&await e.reload()}async function Av(e,t,n){const r=Q(e),i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:await e.getIdToken(),newEmail:t};n&&Ev(r.auth,i,n);const{email:s}=await async function(e,t){return zg(e,t)}(r.auth,i);s!==e.email&&await e.reload()}async function Pv(e,t){let{displayName:n,photoURL:r}=t;if(void 0===n&&void 0===r)return;const i=Q(e),s={idToken:await i.getIdToken(),displayName:n,photoUrl:r,returnSecureToken:!0},o=await Xm(i,async function(e,t){return Mm(e,"POST","/v1/accounts:update",t)}(i.auth,s));i.displayName=o.displayName||null,i.photoURL=o.photoUrl||null;const a=i.providerData.find((e=>{let{providerId:t}=e;return"password"===t}));a&&(a.displayName=i.displayName,a.photoURL=i.photoURL),await i._updateTokensIfNecessary(o)}async function Rv(e,t,n){const{auth:r}=e,i={idToken:await e.getIdToken(),returnSecureToken:!0};t&&(i.email=t),n&&(i.password=n);const s=await Xm(e,async function(e,t){return Mm(e,"POST","/v1/accounts:update",t)}(r,i));await e._updateTokensIfNecessary(s,!0)}class Dv{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};this.isNewUser=e,this.providerId=t,this.profile=n}}class Ov extends Dv{constructor(e,t,n,r){super(e,t,n),this.username=r}}class Lv extends Dv{constructor(e,t){super(e,"facebook.com",t)}}class Mv extends Ov{constructor(e,t){super(e,"github.com",t,"string"===typeof(null===t||void 0===t?void 0:t.login)?null===t||void 0===t?void 0:t.login:null)}}class Fv extends Dv{constructor(e,t){super(e,"google.com",t)}}class Uv extends Ov{constructor(e,t,n){super(e,"twitter.com",t,n)}}function jv(e){const{user:t,_tokenResponse:n}=e;return t.isAnonymous&&!n?{providerId:null,isNewUser:!1,profile:null}:function(e){var t,n;if(!e)return null;const{providerId:r}=e,i=e.rawUserInfo?JSON.parse(e.rawUserInfo):{},s=e.isNewUser||"identitytoolkit#SignupNewUserResponse"===e.kind;if(!r&&(null===e||void 0===e?void 0:e.idToken)){const r=null===(n=null===(t=Jm(e.idToken))||void 0===t?void 0:t.firebase)||void 0===n?void 0:n.sign_in_provider;if(r)return new Dv(s,"anonymous"!==r&&"custom"!==r?r:null)}if(!r)return null;switch(r){case"facebook.com":return new Lv(s,i);case"github.com":return new Mv(s,i);case"google.com":return new Fv(s,i);case"twitter.com":return new Uv(s,i,e.screenName||null);case"custom":case"anonymous":return new Dv(s,null);default:return new Dv(s,r,i)}}(n)}class Vv{constructor(e,t,n){this.type=e,this.credential=t,this.user=n}static _fromIdtoken(e,t){return new Vv("enroll",e,t)}static _fromMfaPendingCredential(e){return new Vv("signin",e)}toJSON(){const e="enroll"===this.type?"idToken":"pendingCredential";return{multiFactorSession:{[e]:this.credential}}}static fromJSON(e){var t,n;if(null===e||void 0===e?void 0:e.multiFactorSession){if(null===(t=e.multiFactorSession)||void 0===t?void 0:t.pendingCredential)return Vv._fromMfaPendingCredential(e.multiFactorSession.pendingCredential);if(null===(n=e.multiFactorSession)||void 0===n?void 0:n.idToken)return Vv._fromIdtoken(e.multiFactorSession.idToken)}return null}}class zv{constructor(e,t,n){this.session=e,this.hints=t,this.signInResolver=n}static _fromError(e,t){const n=kg(e),r=t.customData._serverResponse,i=(r.mfaInfo||[]).map((e=>_v._fromServerResponse(n,e)));Em(r.mfaPendingCredential,n,"internal-error");const s=Vv._fromMfaPendingCredential(r.mfaPendingCredential);return new zv(s,i,(async e=>{const i=await e._process(n,s);delete r.mfaInfo,delete r.mfaPendingCredential;const o=Object.assign(Object.assign({},r),{idToken:i.idToken,refreshToken:i.refreshToken});switch(t.operationType){case"signIn":const e=await av._fromIdTokenResponse(n,t.operationType,o);return await n._updateCurrentUser(e.user),e;case"reauthenticate":return Em(t.user,n,"internal-error"),av._forOperation(t.user,t.operationType,o);default:ym(n,"internal-error")}}))}async resolveSignIn(e){const t=e;return this.signInResolver(t)}}class Bv{constructor(e){this.user=e,this.enrolledFactors=[],e._onReload((t=>{t.mfaInfo&&(this.enrolledFactors=t.mfaInfo.map((t=>_v._fromServerResponse(e.auth,t))))}))}static _fromUser(e){return new Bv(e)}async getSession(){return Vv._fromIdtoken(await this.user.getIdToken(),this.user)}async enroll(e,t){const n=e,r=await this.getSession(),i=await Xm(this.user,n._process(this.user.auth,r,t));return await this.user._updateTokensIfNecessary(i),this.user.reload()}async unenroll(e){const t="string"===typeof e?e:e.uid,n=await this.user.getIdToken();try{const e=await Xm(this.user,function(e,t){return Mm(e,"POST","/v2/accounts/mfaEnrollment:withdraw",Lm(e,t))}(this.user.auth,{idToken:n,mfaEnrollmentId:t}));this.enrolledFactors=this.enrolledFactors.filter((e=>{let{uid:n}=e;return n!==t})),await this.user._updateTokensIfNecessary(e),await this.user.reload()}catch(r){throw r}}}const qv=new WeakMap;const $v="__sak";class Kv{constructor(e,t){this.storageRetriever=e,this.type=t}_isAvailable(){try{return this.storage?(this.storage.setItem($v,"1"),this.storage.removeItem($v),Promise.resolve(!0)):Promise.resolve(!1)}catch(e){return Promise.resolve(!1)}}_set(e,t){return this.storage.setItem(e,JSON.stringify(t)),Promise.resolve()}_get(e){const t=this.storage.getItem(e);return Promise.resolve(t?JSON.parse(t):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}class Gv extends Kv{constructor(){super((()=>window.localStorage),"LOCAL"),this.boundEventHandler=(e,t)=>this.onStorageEvent(e,t),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=_g(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const t of Object.keys(this.listeners)){const n=this.storage.getItem(t),r=this.localCache[t];n!==r&&e(t,r,n)}}onStorageEvent(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e.key)return void this.forAllChangedKeys(((e,t,n)=>{this.notifyListeners(e,n)}));const n=e.key;t?this.detachListener():this.stopPolling();const r=()=>{const e=this.storage.getItem(n);(t||this.localCache[n]!==e)&&this.notifyListeners(n,e)},i=this.storage.getItem(n);O()&&10===document.documentMode&&i!==e.newValue&&e.newValue!==e.oldValue?setTimeout(r,10):r()}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t?JSON.parse(t):t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((()=>{this.forAllChangedKeys(((e,t,n)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:t,newValue:n}),!0)}))}),1e3)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,t){0===Object.keys(this.listeners).length&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&(this.detachListener(),this.stopPolling())}async _set(e,t){await super._set(e,t),this.localCache[e]=JSON.stringify(t)}async _get(e){const t=await super._get(e);return this.localCache[e]=JSON.stringify(t),t}async _remove(e){await super._remove(e),delete this.localCache[e]}}Gv.type="LOCAL";const Hv=Gv;class Wv extends Kv{constructor(){super((()=>window.sessionStorage),"SESSION")}_addListener(e,t){}_removeListener(e,t){}}Wv.type="SESSION";const Qv=Wv;class Jv{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const t=this.receivers.find((t=>t.isListeningto(e)));if(t)return t;const n=new Jv(e);return this.receivers.push(n),n}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const t=e,{eventId:n,eventType:r,data:i}=t.data,s=this.handlersMap[r];if(!(null===s||void 0===s?void 0:s.size))return;t.ports[0].postMessage({status:"ack",eventId:n,eventType:r});const o=Array.from(s).map((async e=>e(t.origin,i))),a=await function(e){return Promise.all(e.map((async e=>{try{return{fulfilled:!0,value:await e}}catch(t){return{fulfilled:!1,reason:t}}})))}(o);t.ports[0].postMessage({status:"done",eventId:n,eventType:r,response:a})}_subscribe(e,t){0===Object.keys(this.handlersMap).length&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(t)}_unsubscribe(e,t){this.handlersMap[e]&&t&&this.handlersMap[e].delete(t),t&&0!==this.handlersMap[e].size||delete this.handlersMap[e],0===Object.keys(this.handlersMap).length&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}function Yv(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,n="";for(let r=0;r<t;r++)n+=Math.floor(10*Math.random());return e+n}Jv.receivers=[];class Xv{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:50;const r="undefined"!==typeof MessageChannel?new MessageChannel:null;if(!r)throw new Error("connection_unavailable");let i,s;return new Promise(((o,a)=>{const l=Yv("",20);r.port1.start();const u=setTimeout((()=>{a(new Error("unsupported_event"))}),n);s={messageChannel:r,onMessage(e){const t=e;if(t.data.eventId===l)switch(t.data.status){case"ack":clearTimeout(u),i=setTimeout((()=>{a(new Error("timeout"))}),3e3);break;case"done":clearTimeout(i),o(t.data.response);break;default:clearTimeout(u),clearTimeout(i),a(new Error("invalid_response"))}}},this.handlers.add(s),r.port1.addEventListener("message",s.onMessage),this.target.postMessage({eventType:e,eventId:l,data:t},[r.port2])})).finally((()=>{s&&this.removeMessageHandler(s)}))}}function Zv(){return window}function ey(){return"undefined"!==typeof Zv().WorkerGlobalScope&&"function"===typeof Zv().importScripts}const ty="firebaseLocalStorageDb",ny="firebaseLocalStorage",ry="fbase_key";class iy{constructor(e){this.request=e}toPromise(){return new Promise(((e,t)=>{this.request.addEventListener("success",(()=>{e(this.request.result)})),this.request.addEventListener("error",(()=>{t(this.request.error)}))}))}}function sy(e,t){return e.transaction([ny],t?"readwrite":"readonly").objectStore(ny)}function oy(){const e=indexedDB.open(ty,1);return new Promise(((t,n)=>{e.addEventListener("error",(()=>{n(e.error)})),e.addEventListener("upgradeneeded",(()=>{const t=e.result;try{t.createObjectStore(ny,{keyPath:ry})}catch(r){n(r)}})),e.addEventListener("success",(async()=>{const n=e.result;n.objectStoreNames.contains(ny)?t(n):(n.close(),await function(){const e=indexedDB.deleteDatabase(ty);return new iy(e).toPromise()}(),t(await oy()))}))}))}async function ay(e,t,n){const r=sy(e,!0).put({[ry]:t,value:n});return new iy(r).toPromise()}function ly(e,t){const n=sy(e,!0).delete(t);return new iy(n).toPromise()}class uy{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then((()=>{}),(()=>{}))}async _openDb(){return this.db||(this.db=await oy()),this.db}async _withRetries(e){let t=0;for(;;)try{const t=await this._openDb();return await e(t)}catch(n){if(t++>3)throw n;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return ey()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=Jv._getInstance(ey()?self:null),this.receiver._subscribe("keyChanged",(async(e,t)=>({keyProcessed:(await this._poll()).includes(t.key)}))),this.receiver._subscribe("ping",(async(e,t)=>["keyChanged"]))}async initializeSender(){var e,t;if(this.activeServiceWorker=await async function(){if(!(null===navigator||void 0===navigator?void 0:navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch(e){return null}}(),!this.activeServiceWorker)return;this.sender=new Xv(this.activeServiceWorker);const n=await this.sender._send("ping",{},800);n&&(null===(e=n[0])||void 0===e?void 0:e.fulfilled)&&(null===(t=n[0])||void 0===t?void 0:t.value.includes("keyChanged"))&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(this.sender&&this.activeServiceWorker&&function(){var e;return(null===(e=null===navigator||void 0===navigator?void 0:navigator.serviceWorker)||void 0===e?void 0:e.controller)||null}()===this.activeServiceWorker)try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch(t){}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await oy();return await ay(e,$v,"1"),await ly(e,$v),!0}catch(e){}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,t){return this._withPendingWrite((async()=>(await this._withRetries((n=>ay(n,e,t))),this.localCache[e]=t,this.notifyServiceWorker(e))))}async _get(e){const t=await this._withRetries((t=>async function(e,t){const n=sy(e,!1).get(t),r=await new iy(n).toPromise();return void 0===r?null:r.value}(t,e)));return this.localCache[e]=t,t}async _remove(e){return this._withPendingWrite((async()=>(await this._withRetries((t=>ly(t,e))),delete this.localCache[e],this.notifyServiceWorker(e))))}async _poll(){const e=await this._withRetries((e=>{const t=sy(e,!1).getAll();return new iy(t).toPromise()}));if(!e)return[];if(0!==this.pendingWrites)return[];const t=[],n=new Set;if(0!==e.length)for(const{fbase_key:r,value:i}of e)n.add(r),JSON.stringify(this.localCache[r])!==JSON.stringify(i)&&(this.notifyListeners(r,i),t.push(r));for(const r of Object.keys(this.localCache))this.localCache[r]&&!n.has(r)&&(this.notifyListeners(r,null),t.push(r));return t}notifyListeners(e,t){this.localCache[e]=t;const n=this.listeners[e];if(n)for(const r of Array.from(n))r(t)}startPolling(){this.stopPolling(),this.pollTimer=setInterval((async()=>this._poll()),800)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,t){0===Object.keys(this.listeners).length&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(t)}_removeListener(e,t){this.listeners[e]&&(this.listeners[e].delete(t),0===this.listeners[e].size&&delete this.listeners[e]),0===Object.keys(this.listeners).length&&this.stopPolling()}}uy.type="LOCAL";const cy=uy;const hy=1e12;class dy{constructor(e){this.auth=e,this.counter=hy,this._widgets=new Map}render(e,t){const n=this.counter;return this._widgets.set(n,new fy(e,this.auth.name,t||{})),this.counter++,n}reset(e){var t;const n=e||hy;null===(t=this._widgets.get(n))||void 0===t||t.delete(),this._widgets.delete(n)}getResponse(e){var t;const n=e||hy;return(null===(t=this._widgets.get(n))||void 0===t?void 0:t.getResponse())||""}async execute(e){var t;const n=e||hy;return null===(t=this._widgets.get(n))||void 0===t||t.execute(),""}}class fy{constructor(e,t,n){this.params=n,this.timerId=null,this.deleted=!1,this.responseToken=null,this.clickHandler=()=>{this.execute()};const r="string"===typeof e?document.getElementById(e):e;Em(r,"argument-error",{appName:t}),this.container=r,this.isVisible="invisible"!==this.params.size,this.isVisible?this.execute():this.container.addEventListener("click",this.clickHandler)}getResponse(){return this.checkIfDeleted(),this.responseToken}delete(){this.checkIfDeleted(),this.deleted=!0,this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this.container.removeEventListener("click",this.clickHandler)}execute(){this.checkIfDeleted(),this.timerId||(this.timerId=window.setTimeout((()=>{this.responseToken=function(e){const t=[],n="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let r=0;r<e;r++)t.push(n.charAt(Math.floor(Math.random()*n.length)));return t.join("")}(50);const{callback:e,"expired-callback":t}=this.params;if(e)try{e(this.responseToken)}catch(n){}this.timerId=window.setTimeout((()=>{if(this.timerId=null,this.responseToken=null,t)try{t()}catch(n){}this.isVisible&&this.execute()}),6e4)}),500))}checkIfDeleted(){if(this.deleted)throw new Error("reCAPTCHA mock was already deleted!")}}const py=Ag("rcb"),my=new Am(3e4,6e4);class gy{constructor(){var e;this.hostLanguage="",this.counter=0,this.librarySeparatelyLoaded=!!(null===(e=Zv().grecaptcha)||void 0===e?void 0:e.render)}load(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"";return Em(function(e){return e.length<=6&&/^\s*[a-zA-Z0-9\-]*\s*$/.test(e)}(t),e,"argument-error"),this.shouldResolveImmediately(t)&&qm(Zv().grecaptcha)?Promise.resolve(Zv().grecaptcha):new Promise(((n,r)=>{const i=Zv().setTimeout((()=>{r(wm(e,"network-request-failed"))}),my.get());Zv()[py]=()=>{Zv().clearTimeout(i),delete Zv()[py];const s=Zv().grecaptcha;if(!s||!qm(s))return void r(wm(e,"internal-error"));const o=s.render;s.render=(e,t)=>{const n=o(e,t);return this.counter++,n},this.hostLanguage=t,n(s)};Ng(`${xg.recaptchaV2Script}?${q({onload:py,render:"explicit",hl:t})}`).catch((()=>{clearTimeout(i),r(wm(e,"internal-error"))}))}))}clearedOneInstance(){this.counter--}shouldResolveImmediately(e){var t;return!!(null===(t=Zv().grecaptcha)||void 0===t?void 0:t.render)&&(e===this.hostLanguage||this.counter>0||this.librarySeparatelyLoaded)}}class vy{async load(e){return new dy(e)}clearedOneInstance(){}}const yy="recaptcha",wy={theme:"light",type:"image"};class by{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Object.assign({},wy);this.parameters=n,this.type=yy,this.destroyed=!1,this.widgetId=null,this.tokenChangeListeners=new Set,this.renderPromise=null,this.recaptcha=null,this.auth=kg(e),this.isInvisible="invisible"===this.parameters.size,Em("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment");const r="string"===typeof t?document.getElementById(t):t;Em(r,this.auth,"argument-error"),this.container=r,this.parameters.callback=this.makeTokenCallback(this.parameters.callback),this._recaptchaLoader=this.auth.settings.appVerificationDisabledForTesting?new vy:new gy,this.validateStartingState()}async verify(){this.assertNotDestroyed();const e=await this.render(),t=this.getAssertedRecaptcha(),n=t.getResponse(e);return n||new Promise((n=>{const r=e=>{e&&(this.tokenChangeListeners.delete(r),n(e))};this.tokenChangeListeners.add(r),this.isInvisible&&t.execute(e)}))}render(){try{this.assertNotDestroyed()}catch(e){return Promise.reject(e)}return this.renderPromise||(this.renderPromise=this.makeRenderPromise().catch((e=>{throw this.renderPromise=null,e}))),this.renderPromise}_reset(){this.assertNotDestroyed(),null!==this.widgetId&&this.getAssertedRecaptcha().reset(this.widgetId)}clear(){this.assertNotDestroyed(),this.destroyed=!0,this._recaptchaLoader.clearedOneInstance(),this.isInvisible||this.container.childNodes.forEach((e=>{this.container.removeChild(e)}))}validateStartingState(){Em(!this.parameters.sitekey,this.auth,"argument-error"),Em(this.isInvisible||!this.container.hasChildNodes(),this.auth,"argument-error"),Em("undefined"!==typeof document,this.auth,"operation-not-supported-in-this-environment")}makeTokenCallback(e){return t=>{if(this.tokenChangeListeners.forEach((e=>e(t))),"function"===typeof e)e(t);else if("string"===typeof e){const n=Zv()[e];"function"===typeof n&&n(t)}}}assertNotDestroyed(){Em(!this.destroyed,this.auth,"internal-error")}async makeRenderPromise(){if(await this.init(),!this.widgetId){let e=this.container;if(!this.isInvisible){const t=document.createElement("div");e.appendChild(t),e=t}this.widgetId=this.getAssertedRecaptcha().render(e,this.parameters)}return this.widgetId}async init(){Em(xm()&&!ey(),this.auth,"internal-error"),await function(){let e=null;return new Promise((t=>{"complete"!==document.readyState?(e=()=>t(),window.addEventListener("load",e)):t()})).catch((t=>{throw e&&window.removeEventListener("load",e),t}))}(),this.recaptcha=await this._recaptchaLoader.load(this.auth,this.auth.languageCode||void 0);const e=await async function(e){return(await Mm(e,"GET","/v1/recaptchaParams")).recaptchaSiteKey||""}(this.auth);Em(e,this.auth,"internal-error"),this.parameters.sitekey=e}getAssertedRecaptcha(){return Em(this.recaptcha,this.auth,"internal-error"),this.recaptcha}}class _y{constructor(e,t){this.verificationId=e,this.onConfirmation=t}confirm(e){const t=Wg._fromVerification(this.verificationId,e);return this.onConfirmation(t)}}async function Iy(e,t,n){var r;const i=await n.verify();try{let s;if(Em("string"===typeof i,e,"argument-error"),Em(n.type===yy,e,"argument-error"),s="string"===typeof t?{phoneNumber:t}:t,"session"in s){const t=s.session;if("phoneNumber"in s){Em("enroll"===t.type,e,"internal-error");const n=await function(e,t){return Mm(e,"POST","/v2/accounts/mfaEnrollment:start",Lm(e,t))}(e,{idToken:t.credential,phoneEnrollmentInfo:{phoneNumber:s.phoneNumber,recaptchaToken:i}});return n.phoneSessionInfo.sessionInfo}{Em("signin"===t.type,e,"internal-error");const n=(null===(r=s.multiFactorHint)||void 0===r?void 0:r.uid)||s.multiFactorUid;Em(n,e,"missing-multi-factor-info");const o=await function(e,t){return Mm(e,"POST","/v2/accounts/mfaSignIn:start",Lm(e,t))}(e,{mfaPendingCredential:t.credential,mfaEnrollmentId:n,phoneSignInInfo:{recaptchaToken:i}});return o.phoneResponseInfo.sessionInfo}}{const{sessionInfo:t}=await async function(e,t){return Mm(e,"POST","/v1/accounts:sendVerificationCode",Lm(e,t))}(e,{phoneNumber:s.phoneNumber,recaptchaToken:i});return t}}finally{n._reset()}}class Sy{constructor(e){this.providerId=Sy.PROVIDER_ID,this.auth=kg(e)}verifyPhoneNumber(e,t){return Iy(this.auth,e,Q(t))}static credential(e,t){return Wg._fromVerification(e,t)}static credentialFromResult(e){const t=e;return Sy.credentialFromTaggedObject(t)}static credentialFromError(e){return Sy.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject(e){let{_tokenResponse:t}=e;if(!t)return null;const{phoneNumber:n,temporaryProof:r}=t;return n&&r?Wg._fromTokenResponse(n,r):null}}function Ey(e,t){return t?ag(t):(Em(e._popupRedirectResolver,e,"argument-error"),e._popupRedirectResolver)}Sy.PROVIDER_ID="phone",Sy.PHONE_SIGN_IN_METHOD="phone";class Ty extends Fg{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Kg(e,this._buildIdpRequest())}_linkToIdToken(e,t){return Kg(e,this._buildIdpRequest(t))}_getReauthenticationResolver(e){return Kg(e,this._buildIdpRequest())}_buildIdpRequest(e){const t={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(t.idToken=e),t}}function ky(e){return gv(e.auth,new Ty(e),e.bypassAuthState)}function Cy(e){const{auth:t,user:n}=e;return Em(n,t,"internal-error"),mv(n,new Ty(e),e.bypassAuthState)}async function xy(e){const{auth:t,user:n}=e;return Em(n,t,"internal-error"),fv(n,new Ty(e),e.bypassAuthState)}class Ny{constructor(e,t,n,r){let i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];this.auth=e,this.resolver=n,this.user=r,this.bypassAuthState=i,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(t)?t:[t]}execute(){return new Promise((async(e,t)=>{this.pendingPromise={resolve:e,reject:t};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(n){this.reject(n)}}))}async onAuthEvent(e){const{urlResponse:t,sessionId:n,postBody:r,tenantId:i,error:s,type:o}=e;if(s)return void this.reject(s);const a={auth:this.auth,requestUri:t,sessionId:n,tenantId:i||void 0,postBody:r||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(o)(a))}catch(l){this.reject(l)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return ky;case"linkViaPopup":case"linkViaRedirect":return xy;case"reauthViaPopup":case"reauthViaRedirect":return Cy;default:ym(this.auth,"internal-error")}}resolve(e){km(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){km(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}const Ay=new Am(2e3,1e4);class Py extends Ny{constructor(e,t,n,r,i){super(e,t,r,i),this.provider=n,this.authWindow=null,this.pollId=null,Py.currentPopupAction&&Py.currentPopupAction.cancel(),Py.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Em(e,this.auth,"internal-error"),e}async onExecution(){km(1===this.filter.length,"Popup operations only handle one event");const e=Yv();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch((e=>{this.reject(e)})),this.resolver._isIframeWebStorageSupported(this.auth,(e=>{e||this.reject(wm(this.auth,"web-storage-unsupported"))})),this.pollUserCancellation()}get eventId(){var e;return(null===(e=this.authWindow)||void 0===e?void 0:e.associatedEvent)||null}cancel(){this.reject(wm(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Py.currentPopupAction=null}pollUserCancellation(){const e=()=>{var t,n;(null===(n=null===(t=this.authWindow)||void 0===t?void 0:t.window)||void 0===n?void 0:n.closed)?this.pollId=window.setTimeout((()=>{this.pollId=null,this.reject(wm(this.auth,"popup-closed-by-user"))}),8e3):this.pollId=window.setTimeout(e,Ay.get())};e()}}Py.currentPopupAction=null;const Ry=new Map;class Dy extends Ny{constructor(e,t){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],t,void 0,arguments.length>2&&void 0!==arguments[2]&&arguments[2]),this.eventId=null}async execute(){let e=Ry.get(this.auth._key());if(!e){try{const t=await async function(e,t){const n=Fy(t),r=My(e);if(!await r._isAvailable())return!1;const i="true"===await r._get(n);return await r._remove(n),i}(this.resolver,this.auth),n=t?await super.execute():null;e=()=>Promise.resolve(n)}catch(t){e=()=>Promise.reject(t)}Ry.set(this.auth._key(),e)}return this.bypassAuthState||Ry.set(this.auth._key(),(()=>Promise.resolve(null))),e()}async onAuthEvent(e){if("signInViaRedirect"===e.type)return super.onAuthEvent(e);if("unknown"!==e.type){if(e.eventId){const t=await this.auth._redirectUserForId(e.eventId);if(t)return this.user=t,super.onAuthEvent(e);this.resolve(null)}}else this.resolve(null)}async onExecution(){}cleanUp(){}}async function Oy(e,t){return My(e)._set(Fy(t),"true")}function Ly(e,t){Ry.set(e._key(),t)}function My(e){return ag(e._redirectPersistence)}function Fy(e){return cg("pendingRedirect",e.config.apiKey,e.name)}function Uy(e,t,n){return async function(e,t,n){if(ct(e.app))return Promise.reject(_m(e));const r=kg(e);Im(e,t,Yg),await r._initializationPromise;const i=Ey(r,n);return await Oy(i,r),i._openRedirect(r,t,"signInViaRedirect")}(e,t,n)}function jy(e,t,n){return async function(e,t,n){const r=Q(e);if(Im(r.auth,t,Yg),ct(r.auth.app))return Promise.reject(_m(r.auth));await r.auth._initializationPromise;const i=Ey(r.auth,n);await Oy(i,r.auth);const s=await By(r);return i._openRedirect(r.auth,t,"reauthViaRedirect",s)}(e,t,n)}function Vy(e,t,n){return async function(e,t,n){const r=Q(e);Im(r.auth,t,Yg),await r.auth._initializationPromise;const i=Ey(r.auth,n);await pv(!1,r,t.providerId),await Oy(i,r.auth);const s=await By(r);return i._openRedirect(r.auth,t,"linkViaRedirect",s)}(e,t,n)}async function zy(e,t){let n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(ct(e.app))return Promise.reject(_m(e));const r=kg(e),i=Ey(r,t),s=new Dy(r,i,n),o=await s.execute();return o&&!n&&(delete o.user._redirectEventId,await r._persistUserIfCurrent(o.user),await r._setRedirectUser(null,t)),o}async function By(e){const t=Yv(`${e.uid}:::`);return e._redirectEventId=t,await e.auth._setRedirectUser(e),await e.auth._persistUserIfCurrent(e),t}class qy{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let t=!1;return this.consumers.forEach((n=>{this.isEventForConsumer(e,n)&&(t=!0,this.sendToConsumer(e,n),this.saveEventToCache(e))})),this.hasHandledPotentialRedirect||!function(e){switch(e.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return Ky(e);default:return!1}}(e)||(this.hasHandledPotentialRedirect=!0,t||(this.queuedRedirectEvent=e,t=!0)),t}sendToConsumer(e,t){var n;if(e.error&&!Ky(e)){const r=(null===(n=e.error.code)||void 0===n?void 0:n.split("auth/")[1])||"internal-error";t.onError(wm(this.auth,r))}else t.onAuthEvent(e)}isEventForConsumer(e,t){const n=null===t.eventId||!!e.eventId&&e.eventId===t.eventId;return t.filter.includes(e.type)&&n}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=6e5&&this.cachedEventUids.clear(),this.cachedEventUids.has($y(e))}saveEventToCache(e){this.cachedEventUids.add($y(e)),this.lastProcessedEventTime=Date.now()}}function $y(e){return[e.type,e.eventId,e.sessionId,e.tenantId].filter((e=>e)).join("-")}function Ky(e){let{type:t,error:n}=e;return"unknown"===t&&"auth/no-auth-event"===(null===n||void 0===n?void 0:n.code)}async function Gy(e){return Mm(e,"GET","/v1/projects",arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}const Hy=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Wy=/^https?/;function Qy(e){const t=Cm(),{protocol:n,hostname:r}=new URL(t);if(e.startsWith("chrome-extension://")){const i=new URL(e);return""===i.hostname&&""===r?"chrome-extension:"===n&&e.replace("chrome-extension://","")===t.replace("chrome-extension://",""):"chrome-extension:"===n&&i.hostname===r}if(!Wy.test(n))return!1;if(Hy.test(e))return r===e;const i=e.replace(/\./g,"\\.");return new RegExp("^(.+\\."+i+"|"+i+")$","i").test(r)}const Jy=new Am(3e4,6e4);function Yy(){const e=Zv().___jsl;if(null===e||void 0===e?void 0:e.H)for(const t of Object.keys(e.H))if(e.H[t].r=e.H[t].r||[],e.H[t].L=e.H[t].L||[],e.H[t].r=[...e.H[t].L],e.CP)for(let n=0;n<e.CP.length;n++)e.CP[n]=null}function Xy(e){return new Promise(((t,n)=>{var r,i,s;function o(){Yy(),gapi.load("gapi.iframes",{callback:()=>{t(gapi.iframes.getContext())},ontimeout:()=>{Yy(),n(wm(e,"network-request-failed"))},timeout:Jy.get()})}if(null===(i=null===(r=Zv().gapi)||void 0===r?void 0:r.iframes)||void 0===i?void 0:i.Iframe)t(gapi.iframes.getContext());else{if(!(null===(s=Zv().gapi)||void 0===s?void 0:s.load)){const t=Ag("iframefcb");return Zv()[t]=()=>{gapi.load?o():n(wm(e,"network-request-failed"))},Ng(`${xg.gapiScript}?onload=${t}`).catch((e=>n(e)))}o()}})).catch((e=>{throw Zy=null,e}))}let Zy=null;const ew=new Am(5e3,15e3),tw={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},nw=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function rw(e){const t=e.config;Em(t.authDomain,e,"auth-domain-config-required");const n=t.emulator?Pm(t,"emulator/auth/iframe"):`https://${e.config.authDomain}/__/auth/iframe`,r={apiKey:t.apiKey,appName:e.name,v:mt},i=nw.get(e.config.apiHost);i&&(r.eid=i);const s=e._getFrameworks();return s.length&&(r.fw=s.join(",")),`${n}?${q(r).slice(1)}`}async function iw(e){const t=await function(e){return Zy=Zy||Xy(e),Zy}(e),n=Zv().gapi;return Em(n,e,"internal-error"),t.open({where:document.body,url:rw(e),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:tw,dontclear:!0},(t=>new Promise((async(n,r)=>{await t.restyle({setHideOnLeave:!1});const i=wm(e,"network-request-failed"),s=Zv().setTimeout((()=>{r(i)}),ew.get());function o(){Zv().clearTimeout(s),n(t)}t.ping(o).then(o,(()=>{r(i)}))}))))}const sw={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"};class ow{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch(e){}}}function aw(e,t,n){let r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:500,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:600;const s=Math.max((window.screen.availHeight-i)/2,0).toString(),o=Math.max((window.screen.availWidth-r)/2,0).toString();let a="";const l=Object.assign(Object.assign({},sw),{width:r.toString(),height:i.toString(),top:s,left:o}),u=N().toLowerCase();n&&(a=mg(u)?"_blank":n),fg(u)&&(t=t||"http://localhost",l.scrollbars="yes");const c=Object.entries(l).reduce(((e,t)=>{let[n,r]=t;return`${e}${n}=${r},`}),"");if(function(){var e;return bg(arguments.length>0&&void 0!==arguments[0]?arguments[0]:N())&&!!(null===(e=window.navigator)||void 0===e?void 0:e.standalone)}(u)&&"_self"!==a)return function(e,t){const n=document.createElement("a");n.href=e,n.target=t;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}(t||"",a),new ow(null);const h=window.open(t||"",a,c);Em(h,e,"popup-blocked");try{h.focus()}catch(d){}return new ow(h)}const lw="__/auth/handler",uw="emulator/auth/handler",cw=encodeURIComponent("fac");async function hw(e,t,n,r,i,s){Em(e.config.authDomain,e,"auth-domain-config-required"),Em(e.config.apiKey,e,"invalid-api-key");const o={apiKey:e.config.apiKey,appName:e.name,authType:n,redirectUrl:r,v:mt,eventId:i};if(t instanceof Yg){t.setDefaultLanguage(e.languageCode),o.providerId=t.providerId||"",function(e){for(const t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}(t.getCustomParameters())||(o.customParameters=JSON.stringify(t.getCustomParameters()));for(const[e,t]of Object.entries(s||{}))o[e]=t}if(t instanceof Xg){const e=t.getScopes().filter((e=>""!==e));e.length>0&&(o.scopes=e.join(","))}e.tenantId&&(o.tid=e.tenantId);const a=o;for(const c of Object.keys(a))void 0===a[c]&&delete a[c];const l=await e._getAppCheckToken(),u=l?`#${cw}=${encodeURIComponent(l)}`:"";return`${function(e){let{config:t}=e;if(!t.emulator)return`https://${t.authDomain}/${lw}`;return Pm(t,uw)}(e)}?${q(a).slice(1)}${u}`}const dw="webStorageSupport";const fw=class{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=Qv,this._completeRedirectFn=zy,this._overrideRedirectResult=Ly}async _openPopup(e,t,n,r){var i;km(null===(i=this.eventManagers[e._key()])||void 0===i?void 0:i.manager,"_initialize() not called before _openPopup()");return aw(e,await hw(e,t,n,Cm(),r),Yv())}async _openRedirect(e,t,n,r){await this._originValidation(e);return function(e){Zv().location.href=e}(await hw(e,t,n,Cm(),r)),new Promise((()=>{}))}_initialize(e){const t=e._key();if(this.eventManagers[t]){const{manager:e,promise:n}=this.eventManagers[t];return e?Promise.resolve(e):(km(n,"If manager is not set, promise should be"),n)}const n=this.initAndGetManager(e);return this.eventManagers[t]={promise:n},n.catch((()=>{delete this.eventManagers[t]})),n}async initAndGetManager(e){const t=await iw(e),n=new qy(e);return t.register("authEvent",(t=>{Em(null===t||void 0===t?void 0:t.authEvent,e,"invalid-auth-event");return{status:n.onEvent(t.authEvent)?"ACK":"ERROR"}}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:n},this.iframes[e._key()]=t,n}_isIframeWebStorageSupported(e,t){this.iframes[e._key()].send(dw,{type:dw},(n=>{var r;const i=null===(r=null===n||void 0===n?void 0:n[0])||void 0===r?void 0:r[dw];void 0!==i&&t(!!i),ym(e,"internal-error")}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){if(e.config.emulator)return;const{authorizedDomains:t}=await Gy(e);for(const r of t)try{if(Qy(r))return}catch(n){}ym(e,"unauthorized-domain")}(e)),this.originValidationPromises[t]}get _shouldInitProactively(){return _g()||pg()||bg()}};class pw{constructor(e){this.factorId=e}_process(e,t,n){switch(t.type){case"enroll":return this._finalizeEnroll(e,t.credential,n);case"signin":return this._finalizeSignIn(e,t.credential);default:return Tm("unexpected MultiFactorSessionType")}}}class mw extends pw{constructor(e){super("phone"),this.credential=e}static _fromCredential(e){return new mw(e)}_finalizeEnroll(e,t,n){return function(e,t){return Mm(e,"POST","/v2/accounts/mfaEnrollment:finalize",Lm(e,t))}(e,{idToken:t,displayName:n,phoneVerificationInfo:this.credential._makeVerificationRequest()})}_finalizeSignIn(e,t){return function(e,t){return Mm(e,"POST","/v2/accounts/mfaSignIn:finalize",Lm(e,t))}(e,{mfaPendingCredential:t,phoneVerificationInfo:this.credential._makeVerificationRequest()})}}class gw{constructor(){}static assertion(e){return mw._fromCredential(e)}}gw.FACTOR_ID="phone";var vw="@firebase/auth",yw="1.7.9";class ww{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),(null===(e=this.auth.currentUser)||void 0===e?void 0:e.uid)||null}async getToken(e){if(this.assertAuthConfigured(),await this.auth._initializationPromise,!this.auth.currentUser)return null;return{accessToken:await this.auth.currentUser.getIdToken(e)}}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const t=this.auth.onIdTokenChanged((t=>{e((null===t||void 0===t?void 0:t.stsTokenManager.accessToken)||null)}));this.internalListeners.set(e,t),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const t=this.internalListeners.get(e);t&&(this.internalListeners.delete(e),t(),this.updateProactiveRefresh())}assertAuthConfigured(){Em(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}(e=>{var t;null===(t=E())||void 0===t||t[`_${e}`]})("authIdTokenMaxAge");var bw;function _w(e,t,n,r){return new(n||(n=Promise))((function(i,s){function o(e){try{l(r.next(e))}catch(t){s(t)}}function a(e){try{l(r.throw(e))}catch(t){s(t)}}function l(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(o,a)}l((r=r.apply(e,t||[])).next())}))}function Iw(e,t){var n,r,i,s,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return s={next:a(0),throw:a(1),return:a(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s;function a(s){return function(a){return function(s){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,r&&(i=2&s[0]?r.return:s[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;switch(r=0,i&&(s=[2&s[0],i.value]),s[0]){case 0:case 1:i=s;break;case 4:return o.label++,{value:s[1],done:!1};case 5:o.label++,r=s[1],s=[0];continue;case 7:s=o.ops.pop(),o.trys.pop();continue;default:if(!(i=(i=o.trys).length>0&&i[i.length-1])&&(6===s[0]||2===s[0])){o=0;continue}if(3===s[0]&&(!i||s[1]>i[0]&&s[1]<i[3])){o.label=s[1];break}if(6===s[0]&&o.label<i[1]){o.label=i[1],i=s;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(s);break}i[2]&&o.ops.pop(),o.trys.pop();continue}s=t.call(e,o)}catch(a){s=[6,a],r=0}finally{n=i=0}if(5&s[0])throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}([s,a])}}}xg={loadJS:e=>new Promise(((t,n)=>{const r=document.createElement("script");r.setAttribute("src",e),r.onload=t,r.onerror=e=>{const t=wm("internal-error");t.customData=e,n(t)},r.type="text/javascript",r.charset="UTF-8",function(){var e,t;return null!==(t=null===(e=document.getElementsByTagName("head"))||void 0===e?void 0:e[0])&&void 0!==t?t:document}().appendChild(r)})),gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="},bw="Browser",ot(new J("auth",((e,t)=>{let{options:n}=t;const r=e.getProvider("app").getImmediate(),i=e.getProvider("heartbeat"),s=e.getProvider("app-check-internal"),{apiKey:o,authDomain:a}=r.options;Em(o&&!o.includes(":"),"invalid-api-key",{appName:r.name});const l={apiKey:o,authDomain:a,clientPlatform:bw,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:Ig(bw)},u=new Tg(r,i,s,l);return function(e,t){const n=(null===t||void 0===t?void 0:t.persistence)||[],r=(Array.isArray(n)?n:[n]).map(ag);(null===t||void 0===t?void 0:t.errorMap)&&e._updateErrorMap(t.errorMap),e._initializeWithPersistence(r,null===t||void 0===t?void 0:t.popupRedirectResolver)}(u,n),u}),"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback(((e,t,n)=>{e.getProvider("auth-internal").initialize()}))),ot(new J("auth-internal",(e=>(e=>new ww(e))(kg(e.getProvider("auth").getImmediate()))),"PRIVATE").setInstantiationMode("EXPLICIT")),_t(vw,yw,function(e){switch(e){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}(bw)),_t(vw,yw,"esm2017");var Sw=function(){return Sw=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e},Sw.apply(this,arguments)},Ew=function(e){return{loading:void 0===e||null===e,value:e}},Tw=function(e){var t=e?e():void 0,n=(0,i.useReducer)((function(e,t){switch(t.type){case"error":return Sw(Sw({},e),{error:t.error,loading:!1,value:void 0});case"reset":return Ew(t.defaultValue);case"value":return Sw(Sw({},e),{error:void 0,loading:!1,value:t.value});default:return e}}),Ew(t)),r=n[0],s=n[1],o=(0,i.useCallback)((function(){var t=e?e():void 0;s({type:"reset",defaultValue:t})}),[e]),a=(0,i.useCallback)((function(e){s({type:"error",error:e})}),[]),l=(0,i.useCallback)((function(e){s({type:"value",value:e})}),[]);return(0,i.useMemo)((function(){return{error:r.error,loading:r.loading,reset:o,setError:a,setValue:l,value:r.value}}),[r.error,r.loading,o,a,l,r.value])},kw=function(e,t){var n=Tw((function(){return e.currentUser})),r=n.error,s=n.loading,o=n.setError,a=n.setValue,l=n.value;return(0,i.useEffect)((function(){var n=function(e,t,n,r){return Q(e).onAuthStateChanged(t,n,r)}(e,(function(e){return _w(void 0,void 0,void 0,(function(){var n;return Iw(this,(function(r){switch(r.label){case 0:if(!(null===t||void 0===t?void 0:t.onUserChanged))return[3,4];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,t.onUserChanged(e)];case 2:return r.sent(),[3,4];case 3:return n=r.sent(),o(n),[3,4];case 4:return a(e),[2]}}))}))}),o);return function(){n()}}),[e]),[l,s,r]};class Cw{constructor(e,t){this._delegate=e,this.firebase=t,it(e,new J("app-compat",(()=>this),"PUBLIC")),this.container=e.container}get automaticDataCollectionEnabled(){return this._delegate.automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this._delegate.automaticDataCollectionEnabled=e}get name(){return this._delegate.name}get options(){return this._delegate.options}delete(){return new Promise((e=>{this._delegate.checkDestroyed(),e()})).then((()=>(this.firebase.INTERNAL.removeApp(this.name),bt(this._delegate))))}_getService(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ze;var n;this._delegate.checkDestroyed();const r=this._delegate.container.getProvider(e);return r.isInitialized()||"EXPLICIT"!==(null===(n=r.getComponent())||void 0===n?void 0:n.instantiationMode)||r.initialize(),r.getImmediate({identifier:t})}_removeServiceInstance(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ze;this._delegate.container.getProvider(e).clearInstance(t)}_addComponent(e){it(this._delegate,e)}_addOrOverwriteComponent(e){st(this._delegate,e)}toJSON(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}}}const xw=new U("app-compat","Firebase",{"no-app":"No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance."});const Nw=function e(){const t=function(e){const t={},n={__esModule:!0,initializeApp:function(r){const i=gt(r,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{});if(V(t,i.name))return t[i.name];const s=new e(i,n);return t[i.name]=s,s},app:i,registerVersion:_t,setLogLevel:St,onLog:It,apps:null,SDK_VERSION:mt,INTERNAL:{registerComponent:function(t){const r=t.name,s=r.replace("-compat","");if(ot(t)&&"PUBLIC"===t.type){const o=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:i();if("function"!==typeof e[s])throw xw.create("invalid-app-argument",{appName:r});return e[s]()};void 0!==t.serviceProps&&I(o,t.serviceProps),n[s]=o,e.prototype[s]=function(){const e=this._getService.bind(this,r);for(var n=arguments.length,i=new Array(n),s=0;s<n;s++)i[s]=arguments[s];return e.apply(this,t.multipleInstances?i:[])}}return"PUBLIC"===t.type?n[s]:null},removeApp:function(e){delete t[e]},useAsService:function(e,t){return"serverAuth"===t?null:t},modularAPIs:r}};function i(e){if(!V(t,e=e||Ze))throw xw.create("no-app",{appName:e});return t[e]}return n.default=n,Object.defineProperty(n,"apps",{get:function(){return Object.keys(t).map((e=>t[e]))}}),i.App=e,n}(Cw);return t.INTERNAL=Object.assign(Object.assign({},t.INTERNAL),{createFirebaseNamespace:e,extendNamespace:function(e){I(t,e)},createSubscribe:G,ErrorFactory:U,deepExtend:I}),t}(),Aw=new oe("@firebase/app-compat");try{const e=S();if(void 0!==e.firebase){Aw.warn("\n      Warning: Firebase is already defined in the global scope. Please make sure\n      Firebase library is only loaded once.\n    ");const t=e.firebase.SDK_VERSION;t&&t.indexOf("LITE")>=0&&Aw.warn("\n        Warning: You are trying to load Firebase while using Firebase Performance standalone script.\n        You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.\n        ")}}catch(k_){}const Pw=Nw;!function(e){_t("@firebase/app-compat","0.2.43",e)}();Pw.registerVersion("firebase","10.14.1","app-compat");function Rw(e,t){if(void 0===t)return{merge:!1};if(void 0!==t.mergeFields&&void 0!==t.merge)throw new ln("invalid-argument",`Invalid options passed to function ${e}(): You cannot specify both "merge" and "mergeFields".`);return t}function Dw(){if("undefined"===typeof Uint8Array)throw new ln("unimplemented","Uint8Arrays are not available in this environment.")}function Ow(){if("undefined"==typeof atob)throw new ln("unimplemented","Blobs are unavailable in Firestore in this environment.")}class Lw{constructor(e){this._delegate=e}static fromBase64String(e){return Ow(),new Lw(Ld.fromBase64String(e))}static fromUint8Array(e){return Dw(),new Lw(Ld.fromUint8Array(e))}toBase64(){return Ow(),this._delegate.toBase64()}toUint8Array(){return Dw(),this._delegate.toUint8Array()}isEqual(e){return this._delegate.isEqual(e._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}}function Mw(e){return function(e,t){if("object"!==typeof e||null===e)return!1;const n=e;for(const r of t)if(r in n&&"function"===typeof n[r])return!0;return!1}(e,["next","error","complete"])}class Fw{enableIndexedDbPersistence(e,t){return function(e,t){tn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const n=e._freezeSettings();return Ad(e,Uh.provider,{build:e=>new Mh(e,n.cacheSizeBytes,null==t?void 0:t.forceOwnership)}),Promise.resolve()}(e._delegate,{forceOwnership:t})}enableMultiTabIndexedDbPersistence(e){return async function(e){tn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");const t=e._freezeSettings();Ad(e,Uh.provider,{build:e=>new Fh(e,t.cacheSizeBytes)})}(e._delegate)}clearIndexedDbPersistence(e){return function(e){if(e._initialized&&!e._terminated)throw new ln(an.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");const t=new un;return e._queue.enqueueAndForgetEvenWhileRestricted((async()=>{try{await async function(e){if(!$n.D())return Promise.resolve();const t=e+"main";await $n.delete(t)}(du(e._databaseId,e._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}(e._delegate)}}class Uw{constructor(e,t,n){this._delegate=t,this._persistenceProvider=n,this.INTERNAL={delete:()=>this.terminate()},e instanceof ni||(this._appCompat=e)}get _databaseId(){return this._delegate._databaseId}settings(e){const t=this._delegate._getSettings();e.merge||t.host===e.host||tn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},t),e)).merge,this._delegate._setSettings(e)}useEmulator(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};md(this._delegate,e,t,n)}enableNetwork(){return Rd(this._delegate)}disableNetwork(){return Dd(this._delegate)}enablePersistence(e){let t=!1,n=!1;return e&&(t=!!e.synchronizeTabs,n=!!e.experimentalForceOwningTab,ad("synchronizeTabs",t,"experimentalForceOwningTab",n)),t?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,n)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Pd(this._delegate)}onSnapshotsInSync(e){return Gf(this._delegate,e)}get app(){if(!this._appCompat)throw new ln("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(e){try{return new Xw(this,wd(this._delegate,e))}catch(t){throw $w(t,"collection()","Firestore.collection()")}}doc(e){try{return new qw(this,bd(this._delegate,e))}catch(t){throw $w(t,"doc()","Firestore.doc()")}}collectionGroup(e){try{return new Qw(this,function(e,t){if(e=hd(e,pd),od("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new ln(an.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new gd(e,null,function(e){return new ls(kn.emptyPath(),e)}(t))}(this._delegate,e))}catch(t){throw $w(t,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(e){return function(e,t,n){e=hd(e,kd);const r=Object.assign(Object.assign({},Qf),n);return function(e){if(e.maxAttempts<1)throw new ln(an.INVALID_ARGUMENT,"Max attempts must be at least 1")}(r),function(e,t,n){const r=new un;return e.asyncQueue.enqueueAndForget((async()=>{const i=await Zh(e);new qh(e.asyncQueue,i,n,t,r).au()})),r.promise}(xd(e),(n=>t(new Xf(e,n))),r)}(this._delegate,(t=>e(new Vw(this,t))))}batch(){return xd(this._delegate),new zw(new Jf(this._delegate,(e=>Hf(this._delegate,e))))}loadBundle(e){return function(e,t){const n=xd(e=hd(e,kd)),r=new Td;return rd(n,e._databaseId,t,r),r}(this._delegate,e)}namedQuery(e){return Od(this._delegate,e).then((e=>e?new Qw(this,e):null))}}class jw extends Af{constructor(e){super(),this.firestore=e}convertBytes(e){return new Lw(new Ld(e))}convertReference(e){const t=this.convertDocumentKey(e,this.firestore._databaseId);return qw.forKey(t,this.firestore,null)}}class Vw{constructor(e,t){this._firestore=e,this._delegate=t,this._userDataWriter=new jw(e)}get(e){const t=Zw(e);return this._delegate.get(t).then((e=>new Hw(this._firestore,new Of(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,t.converter))))}set(e,t,n){const r=Zw(e);return n?(Rw("Transaction.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=Zw(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=Zw(e);return this._delegate.delete(t),this}}class zw{constructor(e){this._delegate=e}set(e,t,n){const r=Zw(e);return n?(Rw("WriteBatch.set",n),this._delegate.set(r,t,n)):this._delegate.set(r,t),this}update(e,t,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),s=3;s<r;s++)i[s-3]=arguments[s];const o=Zw(e);return 2===arguments.length?this._delegate.update(o,t):this._delegate.update(o,t,n,...i),this}delete(e){const t=Zw(e);return this._delegate.delete(t),this}commit(){return this._delegate.commit()}}class Bw{constructor(e,t,n){this._firestore=e,this._userDataWriter=t,this._delegate=n}fromFirestore(e,t){const n=new Lf(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new Ww(this._firestore,n),null!==t&&void 0!==t?t:{})}toFirestore(e,t){return t?this._delegate.toFirestore(e,t):this._delegate.toFirestore(e)}static getInstance(e,t){const n=Bw.INSTANCES;let r=n.get(e);r||(r=new WeakMap,n.set(e,r));let i=r.get(t);return i||(i=new Bw(e,new jw(e),t),r.set(t,i)),i}}Bw.INSTANCES=new WeakMap;class qw{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new jw(e)}static forPath(e,t,n){if(e.length%2!==0)throw new ln("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${e.canonicalString()} has ${e.length}`);return new qw(t,new vd(t._delegate,n,new Nn(e)))}static forKey(e,t,n){return new qw(t,new vd(t._delegate,n,e))}get id(){return this._delegate.id}get parent(){return new Xw(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(e){try{return new Xw(this.firestore,wd(this._delegate,e))}catch(t){throw $w(t,"collection()","DocumentReference.collection()")}}isEqual(e){return(e=Q(e))instanceof vd&&_d(this._delegate,e)}set(e,t){t=Rw("DocumentReference.set",t);try{return t?qf(this._delegate,e,t):qf(this._delegate,e)}catch(n){throw $w(n,"setDoc()","DocumentReference.set()")}}update(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];try{return 1===arguments.length?$f(this._delegate,e):$f(this._delegate,e,t,...r)}catch(s){throw $w(s,"updateDoc()","DocumentReference.update()")}}delete(){return Hf(hd((e=this._delegate).firestore,kd),[new go(e._key,no.none())]);var e}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Kw(t),i=Gw(t,(e=>new Hw(this.firestore,new Of(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))));return Kf(this._delegate,r,i)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?Vf(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=hd(e,vd);const t=hd(e.firestore,kd);return td(xd(t),e._key,{source:"server"}).then((n=>Wf(t,e,n)))}(this._delegate):function(e){e=hd(e,vd);const t=hd(e.firestore,kd);return td(xd(t),e._key).then((n=>Wf(t,e,n)))}(this._delegate),t.then((e=>new Hw(this.firestore,new Of(this.firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,this._delegate.converter))))}withConverter(e){return new qw(this.firestore,e?this._delegate.withConverter(Bw.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function $w(e,t,n){return e.message=e.message.replace(t,n),e}function Kw(e){for(const t of e)if("object"===typeof t&&!Mw(t))return t;return{}}function Gw(e,t){var n,r;let i;return i=Mw(e[0])?e[0]:Mw(e[1])?e[1]:"function"===typeof e[0]?{next:e[0],error:e[1],complete:e[2]}:{next:e[1],error:e[2],complete:e[3]},{next:e=>{i.next&&i.next(t(e))},error:null===(n=i.error)||void 0===n?void 0:n.bind(i),complete:null===(r=i.complete)||void 0===r?void 0:r.bind(i)}}class Hw{constructor(e,t){this._firestore=e,this._delegate=t}get ref(){return new qw(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(e){return this._delegate.data(e)}get(e,t){return this._delegate.get(e,t)}isEqual(e){return Uf(this._delegate,e._delegate)}}class Ww extends Hw{data(e){const t=this._delegate.data(e);return this._delegate._converter||void 0!==t||rn(),t}}class Qw{constructor(e,t){this.firestore=e,this._delegate=t,this._userDataWriter=new jw(e)}where(e,t,n){try{return new Qw(this.firestore,wf(this._delegate,function(e,t,n){const r=t,i=mf("where",e);return bf._create(i,r,n)}(e,t,n)))}catch(r){throw $w(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(e,t){try{return new Qw(this.firestore,wf(this._delegate,function(e){const t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"asc",n=mf("orderBy",e);return If._create(n,t)}(e,t)))}catch(n){throw $w(n,/(orderBy|where)\(\)/,"Query.$1()")}}limit(e){try{return new Qw(this.firestore,wf(this._delegate,(dd("limit",t=e),Sf._create("limit",t,"F"))))}catch(t){throw $w(t,"limit()","Query.limit()")}var t}limitToLast(e){try{return new Qw(this.firestore,wf(this._delegate,(dd("limitToLast",t=e),Sf._create("limitToLast",t,"L"))))}catch(t){throw $w(t,"limitToLast()","Query.limitToLast()")}var t}startAt(){try{return new Qw(this.firestore,wf(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ef._create("startAt",t,!0)}(...arguments)))}catch(e){throw $w(e,"startAt()","Query.startAt()")}}startAfter(){try{return new Qw(this.firestore,wf(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Ef._create("startAfter",t,!1)}(...arguments)))}catch(e){throw $w(e,"startAfter()","Query.startAfter()")}}endBefore(){try{return new Qw(this.firestore,wf(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Tf._create("endBefore",t,!1)}(...arguments)))}catch(e){throw $w(e,"endBefore()","Query.endBefore()")}}endAt(){try{return new Qw(this.firestore,wf(this._delegate,function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return Tf._create("endAt",t,!0)}(...arguments)))}catch(e){throw $w(e,"endAt()","Query.endAt()")}}isEqual(e){return Id(this._delegate,e._delegate)}get(e){let t;return t="cache"===(null===e||void 0===e?void 0:e.source)?Bf(this._delegate):"server"===(null===e||void 0===e?void 0:e.source)?function(e){e=hd(e,gd);const t=hd(e.firestore,kd),n=xd(t),r=new jf(t);return nd(n,e._query,{source:"server"}).then((n=>new Mf(t,r,e,n)))}(this._delegate):zf(this._delegate),t.then((e=>new Yw(this.firestore,new Mf(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))))}onSnapshot(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];const r=Kw(t),i=Gw(t,(e=>new Yw(this.firestore,new Mf(this.firestore._delegate,this._userDataWriter,this._delegate,e._snapshot))));return Kf(this._delegate,r,i)}withConverter(e){return new Qw(this.firestore,e?this._delegate.withConverter(Bw.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}class Jw{constructor(e,t){this._firestore=e,this._delegate=t}get type(){return this._delegate.type}get doc(){return new Ww(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}}class Yw{constructor(e,t){this._firestore=e,this._delegate=t}get query(){return new Qw(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map((e=>new Ww(this._firestore,e)))}docChanges(e){return this._delegate.docChanges(e).map((e=>new Jw(this._firestore,e)))}forEach(e,t){this._delegate.forEach((n=>{e.call(t,new Ww(this._firestore,n))}))}isEqual(e){return Uf(this._delegate,e._delegate)}}class Xw extends Qw{constructor(e,t){super(e,t),this.firestore=e,this._delegate=t}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){const e=this._delegate.parent;return e?new qw(this.firestore,e):null}doc(e){try{return new qw(this.firestore,void 0===e?bd(this._delegate):bd(this._delegate,e))}catch(t){throw $w(t,"doc()","CollectionReference.doc()")}}add(e){return function(e,t){const n=hd(e.firestore,kd),r=bd(e),i=Pf(e.converter,t);return Hf(n,[Hd(Gd(e.firestore),"addDoc",r._key,i,null!==e.converter,{}).toMutation(r._key,no.exists(!1))]).then((()=>r))}(this._delegate,e).then((e=>new qw(this.firestore,e)))}isEqual(e){return _d(this._delegate,e._delegate)}withConverter(e){return new Xw(this.firestore,e?this._delegate.withConverter(Bw.getInstance(this.firestore,e)):this._delegate.withConverter(null))}}function Zw(e){return hd(e,vd)}class eb{constructor(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this._delegate=new Md(...t)}static documentId(){return new eb(xn.keyField().canonicalString())}isEqual(e){return(e=Q(e))instanceof Md&&this._delegate._internalPath.isEqual(e._internalPath)}}class tb{constructor(e){this._delegate=e}static serverTimestamp(){const e=new Jd("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new tb(e)}static delete(){const e=new Wd("deleteField");return e._methodName="FieldValue.delete",new tb(e)}static arrayUnion(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Yd("arrayUnion",t)}(...arguments);return e._methodName="FieldValue.arrayUnion",new tb(e)}static arrayRemove(){const e=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return new Xd("arrayRemove",t)}(...arguments);return e._methodName="FieldValue.arrayRemove",new tb(e)}static increment(e){const t=new Zd("increment",e);return t._methodName="FieldValue.increment",new tb(t)}isEqual(e){return this._delegate.isEqual(e._delegate)}}const nb={Firestore:Uw,GeoPoint:Ud,Timestamp:Sn,Blob:Lw,Transaction:Vw,WriteBatch:zw,DocumentReference:qw,DocumentSnapshot:Hw,Query:Qw,QueryDocumentSnapshot:Ww,QuerySnapshot:Yw,CollectionReference:Xw,FieldPath:eb,FieldValue:tb,setLogLevel:function(e){var t;t=e,Yt.setLogLevel(t)},CACHE_SIZE_UNLIMITED:-1};var rb;function ib(){return window}(function(e,t){e.INTERNAL.registerComponent(new J("firestore-compat",(e=>{const n=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(n,r)}),"PUBLIC").setServiceProps(Object.assign({},nb)))})(rb=Pw,((e,t)=>new Uw(e,t,new Fw))),rb.registerVersion("@firebase/firestore-compat","0.3.38");async function sb(e,t,n){var r;const{BuildInfo:i}=ib();km(t.sessionId,"AuthEvent did not contain a session ID");const s=await async function(e){const t=function(e){if(km(/[0-9a-zA-Z]+/.test(e),"Can only convert alpha-numeric strings"),"undefined"!==typeof TextEncoder)return(new TextEncoder).encode(e);const t=new ArrayBuffer(e.length),n=new Uint8Array(t);for(let r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(e),n=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(n)).map((e=>e.toString(16).padStart(2,"0"))).join("")}(t.sessionId),o={};return bg()?o.ibi=i.packageName:vg()?o.apn=i.packageName:ym(e,"operation-not-supported-in-this-environment"),i.displayName&&(o.appDisplayName=i.displayName),o.sessionId=s,hw(e,n,t.type,void 0,null!==(r=t.eventId)&&void 0!==r?r:void 0,o)}function ob(e){const{cordova:t}=ib();return new Promise((n=>{t.plugins.browsertab.isAvailable((r=>{let i=null;r?t.plugins.browsertab.openUrl(e):i=t.InAppBrowser.open(e,function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/(iPad|iPhone|iPod).*OS 7_\d/i.test(e)||/(iPad|iPhone|iPod).*OS 8_\d/i.test(e)}()?"_blank":"_system","location=yes"),n(i)}))}))}class ab extends qy{constructor(){super(...arguments),this.passiveListeners=new Set,this.initPromise=new Promise((e=>{this.resolveInitialized=e}))}addPassiveListener(e){this.passiveListeners.add(e)}removePassiveListener(e){this.passiveListeners.delete(e)}resetRedirect(){this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1}onEvent(e){return this.resolveInitialized(),this.passiveListeners.forEach((t=>t(e))),super.onEvent(e)}async initialized(){await this.initPromise}}async function lb(e){const t=await hb()._get(db(e));return t&&await hb()._remove(db(e)),t}function ub(e,t){var n,r;const i=function(e){const t=fb(e),n=t.link?decodeURIComponent(t.link):void 0,r=fb(n).link,i=t.deep_link_id?decodeURIComponent(t.deep_link_id):void 0;return fb(i).link||i||r||n||e}(t);if(i.includes("/__/auth/callback")){const t=fb(i),s=t.firebaseError?function(e){try{return JSON.parse(e)}catch(t){return null}}(decodeURIComponent(t.firebaseError)):null,o=null===(r=null===(n=null===s||void 0===s?void 0:s.code)||void 0===n?void 0:n.split("auth/"))||void 0===r?void 0:r[1],a=o?wm(o):null;return a?{type:e.type,eventId:e.eventId,tenantId:e.tenantId,error:a,urlResponse:null,sessionId:null,postBody:null}:{type:e.type,eventId:e.eventId,tenantId:e.tenantId,sessionId:e.sessionId,urlResponse:i,postBody:null}}return null}function cb(){const e=[],t="1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";for(let n=0;n<20;n++){const n=Math.floor(62*Math.random());e.push(t.charAt(n))}return e.join("")}function hb(){return ag(Hv)}function db(e){return cg("authEvent",e.config.apiKey,e.name)}function fb(e){if(!(null===e||void 0===e?void 0:e.includes("?")))return{};const[t,...n]=e.split("?");return $(n.join("?"))}const pb=class{constructor(){this._redirectPersistence=Qv,this._shouldInitProactively=!0,this.eventManagers=new Map,this.originValidationPromises={},this._completeRedirectFn=zy,this._overrideRedirectResult=Ly}async _initialize(e){const t=e._key();let n=this.eventManagers.get(t);return n||(n=new ab(e),this.eventManagers.set(t,n),this.attachCallbackListeners(e,n)),n}_openPopup(e){ym(e,"operation-not-supported-in-this-environment")}async _openRedirect(e,t,n,r){!function(e){var t,n,r,i,s,o,a,l,u,c;const h=ib();Em("function"===typeof(null===(t=null===h||void 0===h?void 0:h.universalLinks)||void 0===t?void 0:t.subscribe),e,"invalid-cordova-configuration",{missingPlugin:"cordova-universal-links-plugin-fix"}),Em("undefined"!==typeof(null===(n=null===h||void 0===h?void 0:h.BuildInfo)||void 0===n?void 0:n.packageName),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-buildInfo"}),Em("function"===typeof(null===(s=null===(i=null===(r=null===h||void 0===h?void 0:h.cordova)||void 0===r?void 0:r.plugins)||void 0===i?void 0:i.browsertab)||void 0===s?void 0:s.openUrl),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Em("function"===typeof(null===(l=null===(a=null===(o=null===h||void 0===h?void 0:h.cordova)||void 0===o?void 0:o.plugins)||void 0===a?void 0:a.browsertab)||void 0===l?void 0:l.isAvailable),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-browsertab"}),Em("function"===typeof(null===(c=null===(u=null===h||void 0===h?void 0:h.cordova)||void 0===u?void 0:u.InAppBrowser)||void 0===c?void 0:c.open),e,"invalid-cordova-configuration",{missingPlugin:"cordova-plugin-inappbrowser"})}(e);const i=await this._initialize(e);await i.initialized(),i.resetRedirect(),Ry.clear(),await this._originValidation(e);const s=function(e,t){return{type:t,eventId:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,urlResponse:null,sessionId:cb(),postBody:null,tenantId:e.tenantId,error:wm(e,"no-auth-event")}}(e,n,r);await function(e,t){return hb()._set(db(e),t)}(e,s);const o=await sb(e,s,t);return async function(e,t,n){const{cordova:r}=ib();let i=()=>{};try{await new Promise(((s,o)=>{let a=null;function l(){var e;s();const t=null===(e=r.plugins.browsertab)||void 0===e?void 0:e.close;"function"===typeof t&&t(),"function"===typeof(null===n||void 0===n?void 0:n.close)&&n.close()}function u(){a||(a=window.setTimeout((()=>{o(wm(e,"redirect-cancelled-by-user"))}),2e3))}function c(){"visible"===(null===document||void 0===document?void 0:document.visibilityState)&&u()}t.addPassiveListener(l),document.addEventListener("resume",u,!1),vg()&&document.addEventListener("visibilitychange",c,!1),i=()=>{t.removePassiveListener(l),document.removeEventListener("resume",u,!1),document.removeEventListener("visibilitychange",c,!1),a&&window.clearTimeout(a)}}))}finally{i()}}(e,i,await ob(o))}_isIframeWebStorageSupported(e,t){throw new Error("Method not implemented.")}_originValidation(e){const t=e._key();return this.originValidationPromises[t]||(this.originValidationPromises[t]=async function(e){const{BuildInfo:t}=ib(),n={};bg()?n.iosBundleId=t.packageName:vg()?n.androidPackageName=t.packageName:ym(e,"operation-not-supported-in-this-environment"),await Gy(e,n)}(e)),this.originValidationPromises[t]}attachCallbackListeners(e,t){const{universalLinks:n,handleOpenURL:r,BuildInfo:i}=ib(),s=setTimeout((async()=>{await lb(e),t.onEvent(mb())}),500),o=async n=>{clearTimeout(s);const r=await lb(e);let i=null;r&&(null===n||void 0===n?void 0:n.url)&&(i=ub(r,n.url)),t.onEvent(i||mb())};"undefined"!==typeof n&&"function"===typeof n.subscribe&&n.subscribe(null,o);const a=r,l=`${i.packageName.toLowerCase()}://`;ib().handleOpenURL=async e=>{if(e.toLowerCase().startsWith(l)&&o({url:e}),"function"===typeof a)try{a(e)}catch(t){console.error(t)}}}};function mb(){return{type:"unknown",eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:wm("no-auth-event")}}function gb(){var e;return(null===(e=null===self||void 0===self?void 0:self.location)||void 0===e?void 0:e.protocol)||null}function vb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return!("file:"!==gb()&&"ionic:"!==gb()&&"capacitor:"!==gb()||!e.toLowerCase().match(/iphone|ipad|ipod|android/))}function yb(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return O()&&11===(null===document||void 0===document?void 0:document.documentMode)||function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N();return/Edge\/\d+/.test(e)}(e)}function wb(){try{const e=self.localStorage,t=Yv();if(e)return e.setItem(t,"1"),e.removeItem(t),!yb()||M()}catch(e){return bb()&&M()}return!1}function bb(){return"undefined"!==typeof n.g&&"WorkerGlobalScope"in n.g&&"importScripts"in n.g}function _b(){return("http:"===gb()||"https:"===gb()||R()||vb())&&!(D()||A())&&wb()&&!bb()}function Ib(){return vb()&&"undefined"!==typeof document}const Sb={LOCAL:"local",NONE:"none",SESSION:"session"},Eb=Em,Tb="persistence";async function kb(e){await e._initializationPromise;const t=Cb(),n=cg(Tb,e.config.apiKey,e.name);t&&t.setItem(n,e._getPersistence())}function Cb(){var e;try{return(null===(e="undefined"!==typeof window?window:null)||void 0===e?void 0:e.sessionStorage)||null}catch(t){return null}}const xb=Em;class Nb{constructor(){this.browserResolver=ag(fw),this.cordovaResolver=ag(pb),this.underlyingResolver=null,this._redirectPersistence=Qv,this._completeRedirectFn=zy,this._overrideRedirectResult=Ly}async _initialize(e){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._initialize(e)}async _openPopup(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openPopup(e,t,n,r)}async _openRedirect(e,t,n,r){return await this.selectUnderlyingResolver(),this.assertedUnderlyingResolver._openRedirect(e,t,n,r)}_isIframeWebStorageSupported(e,t){this.assertedUnderlyingResolver._isIframeWebStorageSupported(e,t)}_originValidation(e){return this.assertedUnderlyingResolver._originValidation(e)}get _shouldInitProactively(){return Ib()||this.browserResolver._shouldInitProactively}get assertedUnderlyingResolver(){return xb(this.underlyingResolver,"internal-error"),this.underlyingResolver}async selectUnderlyingResolver(){if(this.underlyingResolver)return;const e=await async function(){return!!Ib()&&new Promise((e=>{const t=setTimeout((()=>{e(!1)}),1e3);document.addEventListener("deviceready",(()=>{clearTimeout(t),e(!0)}))}))}();this.underlyingResolver=e?this.cordovaResolver:this.browserResolver}}function Ab(e){return e.unwrap()}function Pb(e,t){var n;const r=null===(n=t.customData)||void 0===n?void 0:n._tokenResponse;if("auth/multi-factor-auth-required"===(null===t||void 0===t?void 0:t.code)){t.resolver=new Lb(e,function(e,t){var n;const r=Q(e),i=t;return Em(t.customData.operationType,r,"argument-error"),Em(null===(n=i.customData._serverResponse)||void 0===n?void 0:n.mfaPendingCredential,r,"argument-error"),zv._fromError(r,i)}(e,t))}else if(r){const e=Rb(t),n=t;e&&(n.credential=e,n.tenantId=r.tenantId||void 0,n.email=r.email||void 0,n.phoneNumber=r.phoneNumber||void 0)}}function Rb(e){const{_tokenResponse:t}=e instanceof F?e.customData:e;if(!t)return null;if(!(e instanceof F)&&"temporaryProof"in t&&"phoneNumber"in t)return Sy.credentialFromResult(e);const n=t.providerId;if(!n||n===im)return null;let r;switch(n){case rm:r=tv;break;case tm:r=ev;break;case nm:r=nv;break;case sm:r=sv;break;default:const{oauthIdToken:e,oauthAccessToken:i,oauthTokenSecret:s,pendingToken:o,nonce:a}=t;return i||s||e||o?o?n.startsWith("saml.")?rv._create(n,o):Gg._fromParams({providerId:n,signInMethod:n,pendingToken:o,idToken:e,accessToken:i}):new Zg(n).credential({idToken:e,accessToken:i,rawNonce:a}):null}return e instanceof F?r.credentialFromError(e):r.credentialFromResult(e)}function Db(e,t){return t.catch((t=>{throw t instanceof F&&Pb(e,t),t})).then((e=>{const t=e.operationType,n=e.user;return{operationType:t,credential:(r=e,Rb(r)),additionalUserInfo:jv(e),user:Mb.getOrCreate(n)};var r}))}async function Ob(e,t){const n=await t;return{verificationId:n.verificationId,confirm:t=>Db(e,n.confirm(t))}}class Lb{constructor(e,t){this.resolver=t,this.auth=e.wrapped()}get session(){return this.resolver.session}get hints(){return this.resolver.hints}resolveSignIn(e){return Db(Ab(this.auth),this.resolver.resolveSignIn(e))}}class Mb{constructor(e){this._delegate=e,this.multiFactor=function(e){const t=Q(e);return qv.has(t)||qv.set(t,Bv._fromUser(t)),qv.get(t)}(e)}static getOrCreate(e){return Mb.USER_MAP.has(e)||Mb.USER_MAP.set(e,new Mb(e)),Mb.USER_MAP.get(e)}delete(){return this._delegate.delete()}reload(){return this._delegate.reload()}toJSON(){return this._delegate.toJSON()}getIdTokenResult(e){return this._delegate.getIdTokenResult(e)}getIdToken(e){return this._delegate.getIdToken(e)}linkAndRetrieveDataWithCredential(e){return this.linkWithCredential(e)}async linkWithCredential(e){return Db(this.auth,yv(this._delegate,e))}async linkWithPhoneNumber(e,t){return Ob(this.auth,async function(e,t,n){const r=Q(e);await pv(!1,r,"phone");const i=await Iy(r.auth,t,Q(n));return new _y(i,(e=>yv(r,e)))}(this._delegate,e,t))}async linkWithPopup(e){return Db(this.auth,async function(e,t,n){const r=Q(e);Im(r.auth,t,Yg);const i=Ey(r.auth,n);return new Py(r.auth,"linkViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Nb))}async linkWithRedirect(e){return await kb(kg(this.auth)),Vy(this._delegate,e,Nb)}reauthenticateAndRetrieveDataWithCredential(e){return this.reauthenticateWithCredential(e)}async reauthenticateWithCredential(e){return Db(this.auth,wv(this._delegate,e))}reauthenticateWithPhoneNumber(e,t){return Ob(this.auth,async function(e,t,n){const r=Q(e);if(ct(r.auth.app))return Promise.reject(_m(r.auth));const i=await Iy(r.auth,t,Q(n));return new _y(i,(e=>wv(r,e)))}(this._delegate,e,t))}reauthenticateWithPopup(e){return Db(this.auth,async function(e,t,n){const r=Q(e);if(ct(r.auth.app))return Promise.reject(wm(r.auth,"operation-not-supported-in-this-environment"));Im(r.auth,t,Yg);const i=Ey(r.auth,n);return new Py(r.auth,"reauthViaPopup",t,i,r).executeNotNull()}(this._delegate,e,Nb))}async reauthenticateWithRedirect(e){return await kb(kg(this.auth)),jy(this._delegate,e,Nb)}sendEmailVerification(e){return Nv(this._delegate,e)}async unlink(e){return await dv(this._delegate,e),this}updateEmail(e){return function(e,t){const n=Q(e);return ct(n.auth.app)?Promise.reject(_m(n.auth)):Rv(n,t,null)}(this._delegate,e)}updatePassword(e){return function(e,t){return Rv(Q(e),null,t)}(this._delegate,e)}updatePhoneNumber(e){return async function(e,t){const n=Q(e);if(ct(n.auth.app))return Promise.reject(_m(n.auth));await fv(n,t)}(this._delegate,e)}updateProfile(e){return Pv(this._delegate,e)}verifyBeforeUpdateEmail(e,t){return Av(this._delegate,e,t)}get emailVerified(){return this._delegate.emailVerified}get isAnonymous(){return this._delegate.isAnonymous}get metadata(){return this._delegate.metadata}get phoneNumber(){return this._delegate.phoneNumber}get providerData(){return this._delegate.providerData}get refreshToken(){return this._delegate.refreshToken}get tenantId(){return this._delegate.tenantId}get displayName(){return this._delegate.displayName}get email(){return this._delegate.email}get photoURL(){return this._delegate.photoURL}get providerId(){return this._delegate.providerId}get uid(){return this._delegate.uid}get auth(){return this._delegate.auth}}Mb.USER_MAP=new WeakMap;const Fb=Em;class Ub{constructor(e,t){if(this.app=e,t.isInitialized())return this._delegate=t.getImmediate(),void this.linkUnderlyingAuth();const{apiKey:n}=e.options;Fb(n,"invalid-api-key",{appName:e.name}),Fb(n,"invalid-api-key",{appName:e.name});const r="undefined"!==typeof window?Nb:void 0;this._delegate=t.initialize({options:{persistence:Vb(n,e.name),popupRedirectResolver:r}}),this._delegate._updateErrorMap(fm),this.linkUnderlyingAuth()}get emulatorConfig(){return this._delegate.emulatorConfig}get currentUser(){return this._delegate.currentUser?Mb.getOrCreate(this._delegate.currentUser):null}get languageCode(){return this._delegate.languageCode}set languageCode(e){this._delegate.languageCode=e}get settings(){return this._delegate.settings}get tenantId(){return this._delegate.tenantId}set tenantId(e){this._delegate.tenantId=e}useDeviceLanguage(){this._delegate.useDeviceLanguage()}signOut(){return this._delegate.signOut()}useEmulator(e,t){Og(this._delegate,e,t)}applyActionCode(e){return kv(this._delegate,e)}checkActionCode(e){return Cv(this._delegate,e)}confirmPasswordReset(e,t){return async function(e,t,n){await Ug(Q(e),{oobCode:t,newPassword:n}).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Tv(e),t}))}(this._delegate,e,t)}async createUserWithEmailAndPassword(e,t){return Db(this._delegate,async function(e,t,n){if(ct(e.app))return Promise.reject(_m(e));const r=kg(e),i=Dg(r,{returnSecureToken:!0,email:t,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",ov),s=await i.catch((t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Tv(e),t})),o=await av._fromIdTokenResponse(r,"signIn",s);return await r._updateCurrentUser(o.user),o}(this._delegate,e,t))}fetchProvidersForEmail(e){return this.fetchSignInMethodsForEmail(e)}fetchSignInMethodsForEmail(e){return xv(this._delegate,e)}isSignInWithEmailLink(e){return function(e,t){const n=Qg.parseLink(t);return"EMAIL_SIGNIN"===(null===n||void 0===n?void 0:n.operation)}(this._delegate,e)}async getRedirectResult(){Fb(_b(),this._delegate,"operation-not-supported-in-this-environment");const e=await async function(e,t){return await kg(e)._initializationPromise,zy(e,t,!1)}(this._delegate,Nb);return e?Db(this._delegate,Promise.resolve(e)):{credential:null,user:null}}addFrameworkForLogging(e){!function(e,t){kg(e)._logFramework(t)}(this._delegate,e)}onAuthStateChanged(e,t,n){const{next:r,error:i,complete:s}=jb(e,t,n);return this._delegate.onAuthStateChanged(r,i,s)}onIdTokenChanged(e,t,n){const{next:r,error:i,complete:s}=jb(e,t,n);return this._delegate.onIdTokenChanged(r,i,s)}sendSignInLinkToEmail(e,t){return async function(e,t,n){const r=kg(e),i={requestType:"EMAIL_SIGNIN",email:t,clientType:"CLIENT_TYPE_WEB"};!function(e,t){Em(t.handleCodeInApp,r,"argument-error"),t&&Ev(r,e,t)}(i,n),await Dg(r,i,"getOobCode",qg)}(this._delegate,e,t)}sendPasswordResetEmail(e,t){return async function(e,t,n){const r=kg(e),i={requestType:"PASSWORD_RESET",email:t,clientType:"CLIENT_TYPE_WEB"};n&&Ev(r,i,n),await Dg(r,i,"getOobCode",Bg)}(this._delegate,e,t||void 0)}async setPersistence(e){let t;switch(function(e,t){Eb(Object.values(Sb).includes(t),e,"invalid-persistence-type"),D()?Eb(t!==Sb.SESSION,e,"unsupported-persistence-type"):A()?Eb(t===Sb.NONE,e,"unsupported-persistence-type"):bb()?Eb(t===Sb.NONE||t===Sb.LOCAL&&M(),e,"unsupported-persistence-type"):Eb(t===Sb.NONE||wb(),e,"unsupported-persistence-type")}(this._delegate,e),e){case Sb.SESSION:t=Qv;break;case Sb.LOCAL:t=await ag(cy)._isAvailable()?cy:Hv;break;case Sb.NONE:t=ug;break;default:return ym("argument-error",{appName:this._delegate.name})}return this._delegate.setPersistence(t)}signInAndRetrieveDataWithCredential(e){return this.signInWithCredential(e)}signInAnonymously(){return Db(this._delegate,async function(e){var t;if(ct(e.app))return Promise.reject(_m(e));const n=kg(e);if(await n._initializationPromise,null===(t=n.currentUser)||void 0===t?void 0:t.isAnonymous)return new av({user:n.currentUser,providerId:null,operationType:"signIn"});const r=await ov(n,{returnSecureToken:!0}),i=await av._fromIdTokenResponse(n,"signIn",r,!0);return await n._updateCurrentUser(i.user),i}(this._delegate))}signInWithCredential(e){return Db(this._delegate,vv(this._delegate,e))}signInWithCustomToken(e){return Db(this._delegate,bv(this._delegate,e))}signInWithEmailAndPassword(e,t){return Db(this._delegate,function(e,t,n){return ct(e.app)?Promise.reject(_m(e)):vv(Q(e),Jg.credential(t,n)).catch((async t=>{throw"auth/password-does-not-meet-requirements"===t.code&&Tv(e),t}))}(this._delegate,e,t))}signInWithEmailLink(e,t){return Db(this._delegate,async function(e,t,n){if(ct(e.app))return Promise.reject(_m(e));const r=Q(e),i=Jg.credentialWithLink(t,n||Cm());return Em(i._tenantId===(r.tenantId||null),r,"tenant-id-mismatch"),vv(r,i)}(this._delegate,e,t))}signInWithPhoneNumber(e,t){return Ob(this._delegate,async function(e,t,n){if(ct(e.app))return Promise.reject(_m(e));const r=kg(e),i=await Iy(r,t,Q(n));return new _y(i,(e=>vv(r,e)))}(this._delegate,e,t))}async signInWithPopup(e){return Fb(_b(),this._delegate,"operation-not-supported-in-this-environment"),Db(this._delegate,async function(e,t,n){if(ct(e.app))return Promise.reject(wm(e,"operation-not-supported-in-this-environment"));const r=kg(e);Im(e,t,Yg);const i=Ey(r,n);return new Py(r,"signInViaPopup",t,i).executeNotNull()}(this._delegate,e,Nb))}async signInWithRedirect(e){return Fb(_b(),this._delegate,"operation-not-supported-in-this-environment"),await kb(this._delegate),Uy(this._delegate,e,Nb)}updateCurrentUser(e){return this._delegate.updateCurrentUser(e)}verifyPasswordResetCode(e){return async function(e,t){const{data:n}=await Cv(Q(e),t);return n.email}(this._delegate,e)}unwrap(){return this._delegate}_delete(){return this._delegate._delete()}linkUnderlyingAuth(){this._delegate.wrapped=()=>this}}function jb(e,t,n){let r=e;"function"!==typeof e&&({next:r,error:t,complete:n}=e);const i=r;return{next:e=>i(e&&Mb.getOrCreate(e)),error:t,complete:n}}function Vb(e,t){const n=function(e,t){const n=Cb();if(!n)return[];const r=cg(Tb,e,t);switch(n.getItem(r)){case Sb.NONE:return[ug];case Sb.LOCAL:return[cy,Qv];case Sb.SESSION:return[Qv];default:return[]}}(e,t);if("undefined"===typeof self||n.includes(cy)||n.push(cy),"undefined"!==typeof window)for(const r of[Hv,Qv])n.includes(r)||n.push(r);return n.includes(ug)||n.push(ug),n}Ub.Persistence=Sb;class zb{constructor(){this.providerId="phone",this._delegate=new Sy(Ab(Pw.auth()))}static credential(e,t){return Sy.credential(e,t)}verifyPhoneNumber(e,t){return this._delegate.verifyPhoneNumber(e,t)}unwrap(){return this._delegate}}zb.PHONE_SIGN_IN_METHOD=Sy.PHONE_SIGN_IN_METHOD,zb.PROVIDER_ID=Sy.PROVIDER_ID;const Bb=Em;class qb{constructor(e,t){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pw.app();var r;Bb(null===(r=n.options)||void 0===r?void 0:r.apiKey,"invalid-api-key",{appName:n.name}),this._delegate=new by(n.auth(),e,t),this.type=this._delegate.type}clear(){this._delegate.clear()}render(){return this._delegate.render()}verify(){return this._delegate.verify()}}!function(e){e.INTERNAL.registerComponent(new J("auth-compat",(e=>{const t=e.getProvider("app-compat").getImmediate(),n=e.getProvider("auth");return new Ub(t,n)}),"PUBLIC").setServiceProps({ActionCodeInfo:{Operation:{EMAIL_SIGNIN:om,PASSWORD_RESET:am,RECOVER_EMAIL:lm,REVERT_SECOND_FACTOR_ADDITION:um,VERIFY_AND_CHANGE_EMAIL:cm,VERIFY_EMAIL:hm}},EmailAuthProvider:Jg,FacebookAuthProvider:ev,GithubAuthProvider:nv,GoogleAuthProvider:tv,OAuthProvider:Zg,SAMLAuthProvider:iv,PhoneAuthProvider:zb,PhoneMultiFactorGenerator:gw,RecaptchaVerifier:qb,TwitterAuthProvider:sv,Auth:Ub,AuthCredential:Fg,Error:F}).setInstantiationMode("LAZY").setMultipleInstances(!1)),e.registerVersion("@firebase/auth-compat","0.5.14")}(Pw);Pw.initializeApp({apiKey:"AIzaSyAFlvpByYKkO8sBzT567RGIOYPbktQ59XQ",authDomain:"vixen-ai-3086f.firebaseapp.com",projectId:"vixen-ai-3086f",storageBucket:"vixen-ai-3086f.appspot.com",messagingSenderId:"297803521713",appId:"1:297803521713:web:0b064aa1f5681e570b0c90",measurementId:"G-BFSMJBJ7L6"});const $b=Pw.auth();Pw.firestore();function Kb(){const[e]=kw($b),[t,n]=(0,i.useState)(""),[r,s]=(0,i.useState)(""),[o,a]=(0,i.useState)("");return(0,d.jsx)("div",{children:e?(0,d.jsx)(Gb,{}):(0,d.jsxs)("div",{className:"signInOptions",children:[(0,d.jsx)("img",{className:"homeLogo",src:"./imgs/v-chat-logo.avif",alt:"V-Chat Logo"}),(0,d.jsxs)("div",{className:"emailInputs",children:[(0,d.jsx)("input",{className:"emailSignIn",type:"email",placeholder:"Email",value:t,onChange:e=>n(e.target.value)}),(0,d.jsx)("input",{className:"passwordSignIn",type:"password",placeholder:"Password",value:r,onChange:e=>s(e.target.value)}),(0,d.jsx)("button",{className:"signUpWithEmail",onClick:async()=>{try{await $b.createUserWithEmailAndPassword(t,r)}catch(e){a(e.message)}},children:"Sign Up with Email"}),(0,d.jsx)("button",{className:"signInWithEmail",onClick:async()=>{try{await $b.signInWithEmailAndPassword(t,r)}catch(e){a(e.message)}},children:"Sign In with Email"})]}),o&&(0,d.jsx)("p",{style:{color:"red"},children:o}),(0,d.jsx)("button",{className:"signin",onClick:async()=>{const e=new Pw.auth.GoogleAuthProvider;try{await $b.signInWithPopup(e)}catch(t){a(t.message)}},children:"Sign In with Google"})]})})}function Gb(){return $b.currentUser&&(0,d.jsx)("button",{className:"signout",onClick:()=>$b.signOut(),children:"Sign Out"})}const Hb=(0,i.createContext)(),Wb=()=>{const e=(0,i.useContext)(Hb);return e||{}},Qb={backgroundColor:"#47121a",accentColor:"#640726",chatWidth:"100%",chatTitleColor:"#912333",fontScale:1,userMessageColor:"#e38484",aiMessageColor:"#e38484",mainTextColor:"#ffffff",italicsColor:"#101010",quotesColor:"#ffffff",chatBackgroundColor:"#47121a",modalBackgroundColor:"#640726",chatInputBackgroundColor:"#ffb3c1"},Jb=()=>new Promise(((e,t)=>{const n=indexedDB.open("UserSettingsDB",1);n.onupgradeneeded=e=>{const t=e.target.result;t.objectStoreNames.contains("settings")||t.createObjectStore("settings",{keyPath:"userId"})},n.onsuccess=()=>{e(n.result)},n.onerror=()=>{t(n.error)}})),Yb=async(e,t)=>new Promise(((n,r)=>{const i=e.transaction("settings","readwrite").objectStore("settings").put(t);i.onsuccess=()=>{n()},i.onerror=()=>{r(i.error)}})),Xb=e=>{let{children:t}=e;const[n]=kw($b),[r,s]=(0,i.useState)(null);(0,i.useEffect)((()=>{let e;return(async()=>{try{if(e=await Jb(),n){const t=n.uid,r=await(async(e,t)=>new Promise(((n,r)=>{const i=e.transaction("settings","readonly").objectStore("settings").get(t);i.onsuccess=()=>{n(i.result)},i.onerror=()=>{r(i.error)}})))(e,t);if(r)s(r);else{const r={userId:t,fontSize:16,displayName:n.displayName?n.displayName.split(" ")[0]:"Guest",theme:Qb,vixenSettings:{},personas:[]};await Yb(e,r),s(r)}}}catch(t){console.error("Error initializing settings:",t)}})(),()=>{e&&e.close()}}),[n]);const o=async e=>{if(!r)return;const t={...r,...e,theme:{...r.theme,...e.theme||{}},vixenSettings:{...r.vixenSettings,...e.vixenSettings||{}}};if(s(t),n)try{const e=await Jb();await Yb(e,t)}catch(i){console.error("Error saving settings to IndexedDB:",i)}};return r?(0,d.jsx)(Hb.Provider,{value:{settings:r,updateSettings:o,addPersona:async e=>{if(!r)return;const t=[...r.personas||[],e];await o({personas:t})},updatePersona:async(e,t)=>{if(!r||!r.personas)return;const n=r.personas.map(((n,r)=>r===e?{...n,...t}:n));await o({personas:n})},deletePersona:async e=>{if(!r||!r.personas)return;const t=r.personas.filter(((t,n)=>n!==e));await o({personas:t})}},children:t}):null};function Zb(e){let{sortMethod:t,onSortChange:n}=e;const[r,s]=(0,i.useState)((()=>localStorage.getItem("vixenSortMethod")||"mostMessages"));(0,i.useEffect)((()=>{localStorage.setItem("vixenSortMethod",r),n(r)}),[r,n]);const o=e=>{s(e)};return(0,d.jsxs)("div",{className:"sort-vixen-container",children:[(0,d.jsx)("p",{children:"Sort By"}),(0,d.jsx)("button",{className:"mostMessagesButton",onClick:()=>o("mostMessages"),title:"Sort by most interacted vixens",children:"\ud83e\uddfe"}),(0,d.jsx)("button",{className:"trendingButton",onClick:()=>o("trending"),title:"Sort by trending vixens",children:"\ud83d\ude47\u200d\u2642\ufe0f"}),(0,d.jsx)("button",{className:"mostLikedButton",title:"Sort by most liked vixens",onClick:()=>o("mostLiked"),children:"\ud83d\udc97"})]})}function e_(e){let{goChat:t,currentChat:n,setCurrentChat:r}=e;const[s,o]=(0,i.useState)("female"),[a,l]=(0,i.useState)([]),[u,c]=(0,i.useState)("trending"),{vixenCache:h,isLoading:f}=Yp(),{settings:p}=Wb(),m=(0,i.useMemo)((()=>Object.values(h||{})),[h]),v=(0,i.useCallback)((()=>{const e=[...m.filter((e=>e.category===s))].sort(((e,t)=>{const n=e.interactionCount||0,r=t.interactionCount||0,i=e.messageCount||0,s=t.messageCount||0;return"trending"===u?r-n:"mostMessages"===u?s-i:0}));l(e)}),[s,u,m]);(0,i.useEffect)((()=>{v()}),[v]);const y=e=>{o(e)};return f||!h?(0,d.jsx)("div",{children:"Loading Vixens..."}):(0,d.jsxs)("div",{className:"character-room-container",style:{backgroundColor:p.theme.backgroundColor},children:[(0,d.jsx)(Zb,{sortMethod:u,onSortChange:e=>{c(e)}}),(0,d.jsx)("div",{className:"character-filters-dropdown",children:(0,d.jsxs)("select",{id:"character-filter",value:s,onChange:e=>y(e.target.value),children:[(0,d.jsx)("option",{value:"female",children:"Female"}),(0,d.jsx)("option",{value:"male",children:"Male"}),(0,d.jsx)("option",{value:"furry_female",children:"Furry Female"}),(0,d.jsx)("option",{value:"furry_male",children:"Furry Male"})]})}),(0,d.jsxs)("div",{className:"character-filters",children:[(0,d.jsx)("button",{onClick:()=>y("female"),children:"Female"}),(0,d.jsx)("button",{onClick:()=>y("male"),children:"Male"}),(0,d.jsx)("button",{onClick:()=>y("furry_female"),children:"Furry Female"}),(0,d.jsx)("button",{onClick:()=>y("furry_male"),children:"Furry Male"})]}),(0,d.jsx)("div",{className:"character-room",children:a.map((e=>(0,d.jsx)(g,{vixen:e,goChat:t,currentChat:n,setCurrentChat:r,profilePicture:e.imageUrl},e.id)))})]})}const t_=Cd();function n_(e){let{settings:t,vixen:n}=e;const[r,s]=(0,i.useState)(0),[o,a]=(0,i.useState)(0),[l,u]=(0,i.useState)(100),[c]=kw($b);(0,i.useEffect)((()=>{if(!c||null===n||void 0===n||!n.vixen_id)return;const e=Kf(bd(t_,"users",c.uid),(e=>{if(e.exists()){var t;const r=null===(t=e.data().vixens)||void 0===t?void 0:t[n.vixen_id];if(r){const{chatLevel:e,experience:t}=r;s(e),a(t);const n=Math.floor(100*Math.pow(1.2,e));u(n)}}else s(0),a(0),u(100)}),(e=>{console.error("Error listening to user's document:",e)}));return()=>e()}),[c,null===n||void 0===n?void 0:n.vixen_id]);const h=Math.min(o/l*100,100);return(0,d.jsx)("div",{className:"chat-level-container",children:(0,d.jsxs)("div",{className:"progress-bar-container",children:[(0,d.jsx)("div",{className:"progress-bar-shimmer",style:{width:`${h}%`}}),(0,d.jsxs)("div",{className:"progress-bar-text",children:["Level ",r," - XP: ",o," / ",l]})]})})}function r_(e){var t;let{vixen:n,imageUrl:r,user:i}=e;const{settings:s}=Wb();return(0,d.jsxs)("div",{className:"titleBar",style:{backgroundColor:s.theme.chatTitleColor},children:[(0,d.jsx)("img",{className:"titlePic",src:r,alt:null===n||void 0===n?void 0:n.name}),(0,d.jsx)(n_,{user:i,settings:s,vixen:n}),(0,d.jsx)("div",{className:"chatTitle",children:null!==(t=s.vixenSettings[null===n||void 0===n?void 0:n.vixen_id])&&void 0!==t&&t.nickname?s.vixenSettings[null===n||void 0===n?void 0:n.vixen_id].nickname:null===n||void 0===n?void 0:n.name})]})}const i_=function(e){let{isOpen:t,onClose:n,children:r}=e;return t?(0,d.jsxs)("div",{className:"modal-overlay",onClick:n,children:[(0,d.jsx)("button",{className:"modal-close",onClick:n,children:"\xd7"}),(0,d.jsx)("div",{className:"modal-content "+(t?"activeModal":""),onClick:e=>e.stopPropagation(),children:r})]}):null};function s_(e){var t;let{vixen:n}=e;const[r,s]=(0,i.useState)(!1),{settings:o,updateSettings:a}=Wb(),[l,u]=(0,i.useState)(null),{vixenCache:c}=Yp(),h=Object.values(c).find((e=>e.vixen_id===n.vixen_id));(0,i.useEffect)((()=>{var e;const t=null===(e=o.vixenSettings)||void 0===e?void 0:e[n.vixen_id];if(t)u(t);else{const e={tone:"neutral",model:"velvet",temperature:1,nickname:null===h||void 0===h?void 0:h.name,userPersona:null};u(e)}}),[n,o.vixenSettings,h]);const f=e=>{u((t=>({...t,model:e})))},p=()=>s(!1);return l?(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"vixenSettingsButton",onClick:()=>s(!0),children:"\u2699"}),(0,d.jsx)(i_,{isOpen:r,onClose:p,children:(0,d.jsxs)("div",{className:"vixenSettingsContainer",style:{backgroundColor:o.theme.modalBackgroundColor},children:[(0,d.jsx)("h2",{children:"Settings"}),(0,d.jsxs)("div",{className:"aiNickname",children:[(0,d.jsx)("h3",{children:"Vixen Nickname"}),(0,d.jsx)("input",{className:"aiNicknameInput",style:{backgroundColor:o.theme.chatInputBackgroundColor},type:"text",value:l.nickname||"",onChange:e=>{const t=e.target.value;u((e=>({...e,nickname:t})))}})]}),(0,d.jsxs)("div",{className:"aiTone",children:[(0,d.jsx)("h3",{children:"Vixen Tone"}),(0,d.jsx)("input",{className:"aiToneSlider",type:"range",min:"0",max:"2",step:"1",value:["shy","neutral","flirty"].indexOf(l.tone||"neutral"),onChange:e=>(e=>{const t=["shy","neutral","flirty"];u((n=>({...n,tone:t[e]})))})(Number(e.target.value))}),(0,d.jsxs)("div",{className:"aiToneLabels",children:[(0,d.jsx)("span",{children:"Shy"}),(0,d.jsx)("span",{children:"Neutral"}),(0,d.jsx)("span",{children:"Flirty"})]})]}),(0,d.jsxs)("div",{className:"aiModel",children:[(0,d.jsx)("h3",{children:"Vixen Model"}),(0,d.jsxs)("div",{className:"aiModelButtons",children:[(0,d.jsx)("button",{onClick:()=>f("velvet"),className:"velvet"===l.model?"active":"","data-model":"velvet",children:"Velvet (Default)"}),(0,d.jsx)("button",{onClick:()=>f("yariel"),className:"yariel"===l.model?"active":"","data-model":"yariel",children:"Yariel"}),(0,d.jsx)("button",{onClick:()=>f("nova"),className:"nova"===l.model?"active":"","data-model":"nova",children:"Nova"}),(0,d.jsx)("button",{onClick:()=>f("xeno"),className:"xeno"===l.model?"active":"","data-model":"xeno",children:"Xeno"})]})]}),(0,d.jsx)("div",{className:"modelDescription",children:(0,d.jsx)("p",{children:"velvet"===l.model?"Velvet: Balanced and versatile, suitable for most tasks.":"yariel"===l.model?"Yariel: Creative and expressive, ideal for imaginative outputs.":"nova"===l.model?"Nova: Fast and concise, optimized for quick responses.":"xeno"===l.model?"Xeno: Analytical and logical, great for technical tasks.":"Select a model to see its description."})}),(0,d.jsxs)("div",{className:"temperatureControl",children:[(0,d.jsx)("p",{children:"Temperature"}),(0,d.jsx)("input",{type:"range",min:"0.0",max:"2.0",step:"0.05",value:l.temperature||1,onChange:e=>{return t=e.target.value,void u((e=>({...e,temperature:parseFloat(t)})));var t}}),(0,d.jsx)("p",{children:`Current: ${(null===(t=l.temperature)||void 0===t?void 0:t.toFixed(2))||"1.00"}`}),(0,d.jsx)("p",{className:"temperatureDescription",children:"The temperature setting controls the creativity of the AI's responses. Lower values (e.g., 0.2) make the output more focused and deterministic, while higher values (e.g., 1.8) encourage more diverse and creative responses. Adjust this slider to find the right balance for your needs."})]}),(0,d.jsxs)("div",{className:"aiPersona",children:[(0,d.jsx)("h3",{children:"Assign Persona"}),(0,d.jsxs)("select",{value:l.userPersona||"",onChange:e=>{const t=e.target.value;u((e=>({...e,userPersona:t})))},children:[(0,d.jsx)("option",{value:"",children:"None"}),o.personas.map((e=>(0,d.jsx)("option",{value:JSON.stringify(e),children:e.name},e.id)))]})]}),(0,d.jsx)("button",{className:"saveButton",onClick:()=>{a({vixenSettings:{...o.vixenSettings,[n.vixen_id]:l}}),p()},children:"Save Changes"})]})})]}):null}async function o_(e,t,n){n(!0);const r=e.getReader(),i=new TextDecoder;let s="";const o=e=>e.replace(/data:|data\[DONE\]|\[DONE\]/g,"");for(;;){const{done:e,value:n}=await r.read();if(e)break;const a=o(i.decode(n,{stream:!0}));s+=a,t&&t(a)}return n(!1),s+=o(i.decode()),s}function a_(e){var t,n;let{user:r,currentChat:s}=e;const{vixenCache:o}=Yp(),l=Object.values(o),{settings:u}=Wb(),f=l.filter((e=>e.vixen_id===s)),[p,m]=(0,i.useState)(""),[g,v]=(0,i.useState)([]),[y,w]=(0,i.useState)(""),[b,_]=(0,i.useState)(null),[I,S]=(0,i.useState)([]),[E,T]=(0,i.useState)(!1),[k,C]=(0,i.useState)(0),[x,N]=(0,i.useState)(!1),[A,P]=(0,i.useState)(""),[R,D]=(0,i.useState)(null),O=((null===u||void 0===u||null===(t=u.theme)||void 0===t?void 0:t.fontSize)||14)*((null===u||void 0===u||null===(n=u.theme)||void 0===n?void 0:n.fontScale)||1);(0,i.useEffect)((()=>{let e=document.getElementById("chat-box");e.scrollTop=e.scrollHeight}),[g]),(0,i.useEffect)((()=>{(async()=>{S([]),C(0),N(!1);const e=await h(s);if(e)_(e),e.imageUrl?w(e.imageUrl):(async(e,t,n)=>{try{const r=Hp(Wp(),`${e}.avif`),i=await Gp(r);t(i),n((e=>{const t={...e,imageUrl:i};return a("vixens",t),t}))}catch(r){console.error("Error fetching image:",r),t("./imgs/blank_user_icon.avif")}})(e.name,w,_);else{await c(f[0]);const e=await h(s);_(e),console.warn("Vixen not found in IndexedDB for id:",s),w(f[0].imageUrl)}L()})()}),[s]);const L=async()=>{try{const e=await h(s);if(e&&e.chatHistory){const t=Array.from(new Map(e.chatHistory.map((e=>[`${e.role}:${e.content}`,e])))).map((e=>{let[,t]=e;return t}));v(t),S(e.altResponses||[]),C(e.currentAltIndex||0),M(t,e.altResponses||[],e.currentAltIndex||0)}}catch(e){console.error("Error loading chat history:",e)}},M=async(e,t,n)=>{const r=Array.from(new Map(e.map((e=>[`${e.role}:${e.content}`,e])))).map((e=>{let[,t]=e;return t})),i={vixen_name:f[0].name,vixen_id:s,chatHistory:r,altResponses:t,currentAltIndex:n,lastMessage:(new Date).getTime(),imageUrl:f[0].imageUrl};try{await a("vixens",i)}catch(o){console.error("Error saving chat data to IndexedDB:",o)}},F=(e,t)=>{const n=e+t;if(0===e||n<=0||n>=g.length)return;const r=[...g],[i]=r.splice(e,1);if(r.splice(n,0,i),v(r),M(r,I,k),x)return D(n),void P(i.content);N(!1)},U=()=>{N(!1),P("")},j=()=>{const e=[...g];e[R].content=A,v(e),M(e,I,k),N(!1),D(null)},V=async()=>{const e=p.trim();if(!e)return;const t={role:"user",content:e};m(""),v((e=>[...e,t,{role:"assistant",content:"Thinking..."}]));try{var n,i,o,a;const e=await fetch("https://us-central1-vixen-ai-3086f.cloudfunctions.net/generateVixenPrompt",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({regen:!1,messages:[...g,t],user:r,vixen:{id:s,originalName:f[0].name,tone:null!==u&&void 0!==u&&null!==(n=u.vixenSettings[s])&&void 0!==n&&n.tone?u.vixenSettings[s].tone:"neutral",name:null!==u&&void 0!==u&&null!==(i=u.vixenSettings[s])&&void 0!==i&&i.name?u.vixenSettings[s].name:f[0].name,temp:null!==u&&void 0!==u&&null!==(o=u.vixenSettings[s])&&void 0!==o&&o.temp?u.vixenSettings[s].temp:1},model:null!==u&&void 0!==u&&u.vixenSettings[s]?u.vixenSettings[s].model:"velvet",displayName:u.displayName,userPersona:null===(a=u.vixenSettings[s])||void 0===a?void 0:a.userPersona})});let l={role:"assistant",content:""};await o_(e.body,(e=>{l.content+=e,v((e=>{const t=[...e];return t[t.length-1]={...l},t}))}),T),l.content.trim()&&(S([l.content]),C(0),M([...g,t,l],[l.content],0))}catch(l){console.error("Error generating AI response:",l),v((e=>e.slice(0,-1)))}};(0,i.useEffect)((()=>{I.length>0&&v((e=>{const t=[...e];return t[t.length-1]={role:"assistant",content:I[k]},M(t,I,k),t}))}),[k,I]);const z=(e,t,n,i)=>{const o=t.replace(/\*(.*?)\*/g,"<i>$1</i>").replace(/["`]([^"`]+)["`]/g,'<span className="speech-text">$1</span>'),a=1*u.theme.fontScale+"rem";return(0,d.jsxs)("span",{children:[(0,d.jsx)("span",{style:{fontSize:a},dangerouslySetInnerHTML:{__html:o}}),"assistant"===e&&n===g.length-1&&0!==n&&(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"aiControls",children:[(0,d.jsx)("button",{className:"previousResponse",disabled:k<=0,onClick:()=>C((e=>e-1)),children:"<"}),(0,d.jsx)("button",{className:"nextResponse",disabled:E,onClick:()=>{k>=I.length-1?(async()=>{v((e=>{const t=[...e];return t[t.length-1]={role:"assistant",content:"Thinking..."},t}));try{var e,t,n,i,o;const a=await fetch("https://us-central1-vixen-ai-3086f.cloudfunctions.net/generateVixenPrompt",{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({regen:!0,messages:g.slice(0,-1),user:r,vixen:{id:s,tone:(null===u||void 0===u||null===(e=u.vixenSettings[s])||void 0===e?void 0:e.tone)||"neutral",name:(null===u||void 0===u||null===(t=u.vixenSettings[s])||void 0===t?void 0:t.name)||f[0].name,originalName:f[0].name,temp:(null===u||void 0===u||null===(n=u.vixenSettings[s])||void 0===n?void 0:n.temp)||1},model:(null===u||void 0===u||null===(i=u.vixenSettings[s])||void 0===i?void 0:i.model)||"velvet",displayName:u.displayName,userPersona:null===(o=u.vixenSettings[s])||void 0===o?void 0:o.userPersona})});let l={role:"assistant",content:""};await o_(a.body,(e=>{l.content+=e,v((e=>{const t=[...e];return t[t.length-1]={...l},t}))}),T),l.content.trim()&&(S((e=>{const t=[...e,l.content];return v((e=>{const n=[...e];return n[n.length-1]=l,M(n,t,t.length-1),n})),t})),C((e=>e+1)))}catch(a){console.error("Error regenerating AI response:",a),v((e=>e.slice(0,-1)))}})():C((e=>e+1))},children:">"})]}),(0,d.jsxs)("span",{className:"altResponseTracker",children:[k+1,"/",I.length]})]})]})};return(0,d.jsx)("div",{className:"chatrooms",children:s||0===s?(0,d.jsxs)("div",{className:"chatBox",children:[(0,d.jsx)(r_,{vixen:f[0],imageUrl:y,theme:u.theme,user:r}),(0,d.jsx)("div",{className:"chatMessages",id:"chat-box",style:{width:`${u.theme.chatWidth}%`},children:g.map(((e,t)=>(0,d.jsxs)("div",{className:"chatMessage",children:[(0,d.jsx)("div",{className:"chatIcon",children:(0,d.jsx)("img",{className:"chatIcon",src:"user"===e.role?"./imgs/blank_user_icon.avif":y,alt:null===b||void 0===b?void 0:b.vixen_name})}),(0,d.jsx)("div",{className:"chatMessageContent",style:"user"===e.role?{backgroundColor:u.theme.userMessageColor,fontSize:`${O}px`}:{backgroundColor:u.theme.aiMessageColor,fontSize:`${O}px`},children:x&&R===t?(0,d.jsxs)("div",{className:"editContainer",children:[(0,d.jsx)("textarea",{className:"editInput",value:A,onChange:e=>P(e.target.value)}),(0,d.jsxs)("div",{className:"editOptions",children:[(0,d.jsx)("button",{className:"saveEdit",onClick:j,children:"\u2705"}),(0,d.jsx)("button",{className:"copyMessage",onClick:()=>(e=>{navigator.clipboard.writeText(e.content).then((()=>{}))})(e),children:"\ud83d\udccb"}),(0,d.jsx)("button",{className:"moveUp",onClick:()=>F(t,-1),children:"\ud83d\udd3c"}),(0,d.jsx)("button",{className:"moveDown",onClick:()=>F(t,1),children:"\ud83d\udd3d"}),(0,d.jsx)("button",{className:"deleteMessage",onClick:()=>(e=>{const t=g.filter(((t,n)=>n!==e));v(t),M(t,I,k),U()})(t),children:"\ud83d\uddd1"}),(0,d.jsx)("button",{className:"cancelEdit",onClick:U,children:"\u274c"})]})]}):z(e.role,e.content.replaceAll("{{user}}",r.displayName.split(" ")[0]).replaceAll("{{char}}",null===b||void 0===b?void 0:b.vixen_name),t,g.length)}),x&&R===t?null:(0,d.jsx)("button",{className:"editLastMessage",onClick:()=>(e=>{D(e),P(g[e].content),N(!0)})(t),children:"\ud83d\udcdd"})]},t)))}),(0,d.jsxs)("div",{className:"chatBar",children:[(0,d.jsx)(s_,{vixen:f[0],user:r}),(0,d.jsxs)("form",{className:"userContainer",onSubmit:e=>{e.preventDefault(),V()},children:[(0,d.jsx)("textarea",{className:"userInput",style:{backgroundColor:u.theme.chatInputBackgroundColor},value:p,onKeyDown:e=>{if("Enter"===e.key){if(e.shiftKey)return;e.preventDefault(),V()}},onChange:e=>m(e.target.value),placeholder:"Type a message..."}),(0,d.jsx)("button",{type:"submit",className:"sendButton",children:(0,d.jsx)("img",{className:"sendIcon",src:"./imgs/send_icon.avif",alt:"Send"})})]})]})]}):(0,d.jsx)("div",{className:"vixen-active-chat-title",children:"No active chat selected"})})}const l_=Cd();function u_(){const[e]=kw($b),[t,n]=(0,i.useState)(0);(0,i.useEffect)((()=>{let t;if(e){const r=bd(l_,"users",e.uid);t=Kf(r,(e=>{if(e.exists()){const t=e.data();n(t.premiumBalance)}}),(e=>{console.error("Error listening to user's document:",e)}))}return()=>{t&&t()}}),[e]);const[r,s]=(0,i.useState)(!1),o=()=>s(!1);return null===t?null:(0,d.jsxs)("div",{className:"token-stash",children:[(0,d.jsx)("img",{className:"token-stash-icon",src:"./imgs/YToken.avif",alt:"Token icon"}),(0,d.jsx)("p",{children:t}),(0,d.jsx)("button",{className:"buyTokensButton",onClick:()=>{s(!0)},children:"+"}),(0,d.jsx)(i_,{isOpen:r,onClose:o,children:(0,d.jsxs)("div",{className:"tokenPurchaseOptions",children:[(0,d.jsx)("h1",{className:"token-title",children:"Recharge Tokens"}),(0,d.jsxs)("div",{className:"purchaseItem",children:[(0,d.jsx)("img",{className:"tokenPurchaseIcon",src:"./imgs/YToken.avif",alt:"Token icon"}),(0,d.jsx)("div",{className:"baseAmountPurchase",children:"500"}),(0,d.jsx)("div",{className:"bonusPurchaseAmount",children:"+250"}),(0,d.jsx)("button",{className:"purchasePrice",children:"$9.99"}),(0,d.jsx)("img",{className:"mostPopular",src:"./imgs/most_popular.avif",alt:"Most Popular Item"})]}),(0,d.jsxs)("div",{className:"purchaseItem",children:[(0,d.jsx)("img",{className:"tokenPurchaseIcon",src:"./imgs/YToken.avif",alt:"Token icon"}),(0,d.jsx)("div",{className:"baseAmountPurchase",children:"1,000"}),(0,d.jsx)("div",{className:"bonusPurchaseAmount",children:"+750"}),(0,d.jsx)("button",{className:"purchasePrice",children:"$19.99"})]}),(0,d.jsxs)("div",{className:"purchaseItem",children:[(0,d.jsx)("img",{className:"tokenPurchaseIcon",src:"./imgs/YToken.avif",alt:"Token icon"}),(0,d.jsx)("div",{className:"baseAmountPurchase",children:"3,250"}),(0,d.jsx)("div",{className:"bonusPurchaseAmount",children:"+2,000"}),(0,d.jsx)("button",{className:"purchasePrice",children:"$49.99"})]}),(0,d.jsxs)("div",{className:"purchaseItem",children:[(0,d.jsx)("img",{className:"tokenPurchaseIcon",src:"./imgs/YToken.avif",alt:"Token icon"}),(0,d.jsx)("div",{className:"baseAmountPurchase",children:"7,500"}),(0,d.jsx)("div",{className:"bonusPurchaseAmount",children:"+4,500"}),(0,d.jsx)("button",{className:"purchasePrice",children:"$99.99"})]}),(0,d.jsxs)("div",{className:"purchaseItem",children:[(0,d.jsx)("img",{className:"tokenPurchaseIcon",src:"./imgs/YToken.avif",alt:"Token icon"}),(0,d.jsx)("div",{className:"baseAmountPurchase",children:"250"}),(0,d.jsx)("button",{className:"purchasePrice",onClick:()=>window.open("https://buy.stripe.com/3cseVicJ00x188M8ww"),children:"$4.99"})]})]})})]})}const c_=Wp();function h_(e){let{handleChatSelection:t,toggleMenu:n,currentChat:r,setCurrentChat:s}=e;const[o,a]=(0,i.useState)([]),[c,h]=(0,i.useState)({}),{settings:f}=Wb(),p=(0,i.useRef)({}),m=async()=>{const e=await async function(){return await l(u)||[]}();e&&(e.sort(((e,t)=>(t.lastMessage||0)-(e.lastMessage||0))),a(e))};(0,i.useEffect)((()=>{m()}),[r]),(0,i.useEffect)((()=>{const e=setInterval((()=>{m()}),5e3);return()=>clearInterval(e)}),[]),(0,i.useEffect)((()=>{const e=e=>{"userChats"===e.key&&m()};return window.addEventListener("storage",e),()=>{window.removeEventListener("storage",e)}}),[]);(0,i.useEffect)((()=>{o.length>0&&(async()=>{const e={};await Promise.all(o.map((async t=>{if(p.current[t.vixen_id])e[t.vixen_id]=p.current[t.vixen_id];else{const n=await(async e=>{if(p.current[e.vixen_id])return p.current[e.vixen_id];try{const t=Hp(c_,`${e.vixen_name}.avif`),n=await Gp(t);return p.current[e.vixen_id]=n,n}catch{return"/path/to/default-image.png"}})(t);p.current[t.vixen_id]=n,e[t.vixen_id]=n}}))),h((t=>({...t,...e})))})()}),[o]);const g=e=>{if(!e)return"No messages yet";const t=Date.now()-e,n=Math.floor(t/1e3),r=Math.floor(n/60),i=Math.floor(r/60),s=Math.floor(i/24);return s>0?`${s}d ago`:i>0?`${i}h ago`:r>0?`${r}m ago`:`${n}s ago`};return(0,d.jsx)("div",{className:"vixen-chat-selector",children:o.length>0?o.map((e=>{var r;return(0,d.jsxs)("div",{className:"vixen-chat-item",onClick:()=>{s(e.vixen_id),t(e.vixen_id),n()},children:[(0,d.jsx)("img",{className:"vixen-chat-pic",src:c[e.vixen_id]||"/path/to/default-image.png",alt:e.vixen_name}),(0,d.jsxs)("div",{className:"vixen-chat-info",children:[(0,d.jsx)("div",{className:"vixen-chat-name",children:null!==(r=f.vixenSettings[e.vixen_id])&&void 0!==r&&r.nickname?f.vixenSettings[e.vixen_id].nickname:e.vixen_name}),(0,d.jsx)("div",{className:"vixen-chat-timestamp",children:e.lastMessage?g(e.lastMessage):"No messages yet"})]})]},e.vixen_id||0)})):(0,d.jsx)("div",{className:"vixen-chat-item",children:"No active chats yet. Please select a vixen from the Character Room."})},"vixenSelector")}const d_=()=>{const[e,t]=(0,i.useState)(""),[n,r]=(0,i.useState)(""),[s,o]=(0,i.useState)("idle"),[a,l]=(0,i.useState)(!1),[u]=kw($b);return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"redeem-code-button",onClick:()=>l(!0),children:"\ud83d\udd11 Redeem Code"}),(0,d.jsx)(i_,{isOpen:a,onClose:()=>l(!1),children:(0,d.jsxs)("div",{className:"code-redemption-container",children:[(0,d.jsx)("h2",{className:"modal-title",children:"Redeem Your Code"}),(0,d.jsxs)("form",{className:"redemption-form",onSubmit:async n=>{if(n.preventDefault(),!e.trim())return r("Please enter a valid code."),void o("error");o("loading"),r("");try{const n=u.uid,i=await fetch("https://us-central1-vixen-ai-3086f.cloudfunctions.net/validateVoucher",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:n,code:e})}),s=await i.json();if(!i.ok)throw new Error(s.error||"Invalid code. Please try again.");r(s.message||"Code redeemed successfully!"),o("success"),t("")}catch(i){r(i.message||"Something went wrong."),o("error")}finally{o("idle")}},children:[(0,d.jsx)("input",{type:"text",className:"code-input",placeholder:"Enter your code",value:e,onChange:e=>t(e.target.value),disabled:"loading"===s}),(0,d.jsx)("button",{type:"submit",className:"submit-code-button "+("loading"===s?"loading":""),disabled:"loading"===s,children:"loading"===s?"Redeeming...":"Redeem"})]}),n&&(0,d.jsx)("p",{className:`feedback-message ${s}`,children:n})]})})]})};function f_(){const{settings:e,updateSettings:t,addPersona:n,updatePersona:r,deletePersona:s}=Wb(),[o,a]=(0,i.useState)(!1),[l,u]=(0,i.useState)("general"),[c,h]=(0,i.useState)({name:"",personality:"",appearance:"",age:null,gender:0,image:""}),[f,p]=(0,i.useState)(null),m="/imgs/blank_user_icon.avif",g=(n,r)=>{t({theme:{...e.theme,[n]:r}})},v=e=>{const t=e.target.files[0];if(t){const e=new FileReader;e.onload=()=>{h({...c,image:e.result})},e.readAsDataURL(t)}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"userSettingsButton",onClick:()=>a(!0),children:"\u2699"}),(0,d.jsx)(i_,{isOpen:o,onClose:()=>{a(!1),u("general")},children:(0,d.jsxs)("div",{className:"user-settings-container",style:{backgroundColor:e.theme.modalBackgroundColor},children:[(0,d.jsx)("h4",{children:"User Settings"}),(0,d.jsxs)("div",{className:"settings-tabs",children:[(0,d.jsx)("button",{className:"tab "+("general"===l?"active":""),onClick:()=>u("general"),children:"Theme Settings"}),(0,d.jsx)("button",{className:"tab "+("personas"===l?"active":""),onClick:()=>u("personas"),children:"Manage Personas"})]}),"general"===l&&(0,d.jsxs)("div",{className:"theme-tab-content",children:[(0,d.jsxs)("div",{className:"theme-settings-container",children:[(0,d.jsx)("h4",{className:"setting-category",children:"Theme"}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"backgroundColor",children:"Background:"}),(0,d.jsx)("input",{id:"backgroundColor",type:"color",value:e.theme.backgroundColor,onChange:e=>g("backgroundColor",e.target.value)})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"modalBackgroundColor",children:"Popup:"}),(0,d.jsx)("input",{id:"modalBackgroundColor",type:"color",value:e.theme.modalBackgroundColor,onChange:e=>g("modalBackgroundColor",e.target.value)})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"accentColor",children:"Accent:"}),(0,d.jsx)("input",{id:"accentColor",type:"color",value:e.theme.accentColor,onChange:e=>g("accentColor",e.target.value)})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"chatTitleColor",children:"Chat Titlebar:"}),(0,d.jsx)("input",{id:"chatTitleColor",type:"color",value:e.theme.chatTitleColor,onChange:e=>g("chatTitleColor",e.target.value)})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"userMessageColor",children:"User Messages:"}),(0,d.jsx)("input",{id:"userMessageColor",type:"color",value:e.theme.userMessageColor,onChange:e=>g("userMessageColor",e.target.value)})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"aiMessageColor",children:"AI Messages:"}),(0,d.jsx)("input",{id:"aiMessageColor",type:"color",value:e.theme.aiMessageColor,onChange:e=>g("aiMessageColor",e.target.value)})]})]}),(0,d.jsxs)("div",{className:"chat-settings-container",children:[(0,d.jsx)("h4",{className:"setting-category",children:"Chat"}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"chatWidth",children:"Chat Width:"}),(0,d.jsx)("input",{id:"chatWidth",type:"range",step:"0.1",min:"0.5",max:"1",value:e.theme.chatWidth/100,onChange:e=>g("chatWidth",100*e.target.value)}),(0,d.jsxs)("label",{htmlFor:"chatWidth",children:[e.theme.chatWidth,"%"]})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"fontScale",children:"Font Scale:"}),(0,d.jsx)("input",{id:"fontScale",type:"range",step:"0.1",min:"0.5",max:"2",value:e.theme.fontScale,onChange:e=>g("fontScale",parseFloat(e.target.value))}),(0,d.jsxs)("label",{htmlFor:"fontScale",children:[e.theme.fontScale,"x"]})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"mainTextColor",children:"Main Text:"}),(0,d.jsx)("input",{id:"mainTextColor",type:"color",value:e.theme.mainTextColor,onChange:e=>g("mainTextColor",e.target.value)})]}),(0,d.jsxs)("div",{className:"theme-setting-item",children:[(0,d.jsx)("label",{htmlFor:"chatInputBackgroundColor",children:"Chat Input Color:"}),(0,d.jsx)("input",{id:"chatInputBackgroundColor",type:"color",value:e.theme.chatInputBackgroundColor,onChange:e=>g("chatInputBackgroundColor",e.target.value)})]})]})]}),"personas"===l&&(0,d.jsxs)("div",{className:"persona-tab-content",children:[(0,d.jsx)("ul",{className:"persona-list",children:e.personas.length>0?e.personas.map(((t,n)=>(0,d.jsxs)("li",{className:"persona-item",onClick:()=>(t=>{p(t),h({...e.personas[t]})})(n),children:[null!==t&&void 0!==t&&t.image?(0,d.jsx)("img",{src:t.image,alt:`${t.name} Profile`}):(0,d.jsx)("img",{src:m,alt:`${t.name} Profile`}),(0,d.jsxs)("strong",{children:[t.name," ",t.age," ","male"===t.gender?"\u2642":"female"===t.gender?"\u2640":"\u26a5"]})]},n))):(0,d.jsx)("p",{className:"persona-item",children:"No current personas"})}),(0,d.jsxs)("div",{className:"persona-form",children:[(0,d.jsx)("h4",{className:"persona-title",children:null===f?"Add Persona":"Edit Persona"}),(0,d.jsx)("div",{className:"profile-picture-container",children:c.image?(0,d.jsxs)("div",{className:"profile-picture-preview",children:[(0,d.jsx)("img",{src:c.image,alt:"Profile Preview"}),(0,d.jsx)("button",{className:"replace-image-button",onClick:()=>document.getElementById("imageInput").click(),children:"Replace Image"}),(0,d.jsx)("input",{id:"imageInput",type:"file",accept:"image/*",style:{display:"none"},onChange:v})]}):(0,d.jsxs)("div",{className:"upload-image",children:[(0,d.jsx)("img",{src:m,alt:"Default Profile"}),(0,d.jsx)("label",{htmlFor:"imageInput",className:"upload-label",children:"Upload Image"}),(0,d.jsx)("input",{id:"imageInput",type:"file",accept:"image/*",onChange:v})]})}),(0,d.jsx)("div",{className:"persona-name-box",children:(0,d.jsx)("input",{className:"persona-name-input",type:"text",placeholder:"Name",value:c.name,onChange:e=>h({...c,name:e.target.value})})}),(0,d.jsxs)("div",{className:"age-gender-box",children:[(0,d.jsx)("input",{className:"persona-age-input",type:"number",inputMode:"numeric",min:"18",step:"1",placeholder:"Age",value:c.age,onChange:e=>h({...c,age:e.target.value})}),(0,d.jsx)("div",{className:"persona-gender-dropdown-container",children:(0,d.jsxs)("select",{className:"gender-select",value:c.gender,onChange:e=>h({...c,gender:e.target.value}),children:[(0,d.jsx)("option",{value:"null",children:"Select Gender"}),(0,d.jsx)("option",{value:"male",children:"Male"}),(0,d.jsx)("option",{value:"female",children:"Female"}),(0,d.jsx)("option",{value:"nonbinary",children:"Non-binary"})]})})]}),(0,d.jsxs)("div",{className:"personality-input-box",children:[(0,d.jsx)("textarea",{className:"persona-personality-input",rows:3,maxLength:1024,value:c.personality,onChange:e=>h({...c,personality:e.target.value}),placeholder:"Describe the personality"}),c.personality.length,"/1024"]}),(0,d.jsxs)("div",{className:"appearance-input-box",children:[(0,d.jsx)("textarea",{className:"persona-appearance-input",rows:3,maxLength:1024,value:c.appearance,onChange:e=>h({...c,appearance:e.target.value}),placeholder:"Describe the appearance"}),c.appearance.length,"/1024"]}),null===f?(0,d.jsx)("button",{onClick:()=>{c.name.trim()&&(n({...c}),h({name:"",personality:"",appearance:"",age:"",gender:0,image:""}))},className:"add-persona-button",children:"Add Persona"}):(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("button",{className:"delete-persona-button",onClick:()=>{return s(e=f),void(f===e&&(p(null),h({name:"",personality:"",appearance:"",age:"",gender:""})));var e},children:"Delete"}),(0,d.jsx)("button",{onClick:()=>{null!==f&&c.name.trim()&&(r(f,{...c}),p(null),h({name:"",personality:"",appearance:"",age:"",gender:0,image:""}))},className:"save-persona-button",children:"Save"}),(0,d.jsx)("button",{onClick:()=>{p(null),h({name:"",personality:"",appearance:"",age:"",gender:0,image:""})},className:"cancel-edit-button",children:"Cancel"})]})]})]})]})})]})}const p_=e=>{let{goHome:t,goChat:n,currentChat:r,setCurrentChat:s,user:o}=e;const[a,l]=(0,i.useState)(!1),[u,c]=(0,i.useState)(!1),{settings:h}=Wb(),f=(0,i.useRef)(null),p=e=>{f.current&&!f.current.contains(e.target)&&l(!1)};(0,i.useEffect)((()=>(document.addEventListener("mousedown",p),()=>{document.removeEventListener("mousedown",p)})),[]);const m=()=>{l(!a)};return(0,d.jsxs)("div",{className:"side-menu-container",ref:f,children:[(0,d.jsx)("button",{onClick:m,className:"menu-button p-5",children:a?(0,d.jsx)(d.Fragment,{}):(0,d.jsx)("svg",{height:"2rem",width:"2rem",viewBox:"0 0 32 32",className:"menu-icon",fill:"#000000",children:(0,d.jsx)("path",{d:"M4,10h24c1.104,0,2-0.896,2-2s-0.896-2-2-2H4C2.896,6,2,6.896,2,8S2.896,10,4,10z M28,14H4c-1.104,0-2,0.896-2,2  s0.896,2,2,2h24c1.104,0,2-0.896,2-2S29.104,14,28,14z M28,22H4c-1.104,0-2,0.896-2,2s0.896,2,2,2h24c1.104,0,2-0.896,2-2  S29.104,22,28,22z"})})}),(0,d.jsx)("div",{className:"side-menu "+(a?"open":""),children:(0,d.jsxs)("div",{style:{backgroundColor:h.theme.accentColor},children:[(0,d.jsx)("div",{className:"side-menu-top",children:(0,d.jsx)("img",{onClick:()=>{t(),m()},src:"./imgs/v-chat-logo.avif",style:{width:"100%",height:"3rem"},alt:"V-Chat Logo"})}),(0,d.jsxs)("div",{className:"userLinks",children:[(0,d.jsxs)("h1",{className:"userWelcome",children:["Welcome, ",h.displayName||"Guest"]}),(0,d.jsx)(f_,{}),(0,d.jsxs)("p",{className:"userUid",children:["UID: ",o.uid,(0,d.jsx)("button",{onClick:()=>{const e=o.uid;if(navigator.clipboard&&navigator.clipboard.writeText)navigator.clipboard.writeText(e).then((()=>{c(!0),setTimeout((()=>c(!1)),2e3)})).catch((e=>{console.error("Failed to copy with Clipboard API: ",e)}));else{const n=document.createElement("textarea");n.value=e,n.style.position="fixed",n.style.opacity="0",document.body.appendChild(n),n.focus(),n.select();try{document.execCommand("copy"),c(!0),setTimeout((()=>c(!1)),2e3)}catch(t){console.error("Fallback: Failed to copy text: ",t)}document.body.removeChild(n)}},className:"copy-button",title:"Copy to Clipboard",children:"\ud83d\udccb"})]}),u&&(0,d.jsx)("span",{className:"copied-message",children:"Copied!"})]}),(0,d.jsx)(d_,{}),(0,d.jsxs)("div",{className:"recentChats",children:[(0,d.jsx)("h2",{className:"recentChatHistoryTitle",children:"Recent Chats"}),(0,d.jsx)(h_,{handleChatSelection:n,toggleMenu:m,currentChat:r,setCurrentChat:s})]}),(0,d.jsx)(Gb,{})]})})]})},m_=Cd(),g_={0:5,1:10,2:15,3:15,4:20,5:20,6:25},v_={0:15,1:30,2:45,3:45,4:60,5:60,6:75};function y_(){const[e]=kw($b),[t,n]=(0,i.useState)(!1),[r,s]=(0,i.useState)(0),[o,a]=(0,i.useState)(0),[l,u]=(0,i.useState)(!1),[c,h]=(0,i.useState)(null),[f,p]=(0,i.useState)(""),[m,g]=(0,i.useState)(!1),[v,y]=(0,i.useState)(!1);(0,i.useEffect)((()=>{if(e){const t=Kf(bd(m_,"users",e.uid),(e=>{if(e.exists()){const t=e.data();s(t.dailyReward||0),a(t.dailyRewardPremium||0),u(t.isPremium||!1),h(t.timeUntilNextDay);const n=(new Date).getDate();g(t.lastDaily&&t.dailyReward===n),y(t.lastDaily&&t.dailyRewardPremium===n)}}),(e=>{console.error("Error listening to user's document:",e)}));return()=>t()}}),[e]),(0,i.useEffect)((()=>{if(!c)return;const e=setInterval((()=>{const t=(n=c)&&"function"===typeof n.toDate?n.toDate():n instanceof Date?n:null;var n;if(!t)return;const r=t.getTime()-Date.now();if(r<=0)clearInterval(e),p("Redeem available!"),h(null);else{const e=Math.floor(r/36e5%24),t=Math.floor(r/6e4%60),n=Math.floor(r/1e3%60);p(`${e}h ${t}m ${n}s`)}}),1e3);return()=>clearInterval(e)}),[c]);const w=Math.max(r,o),b=(t,n,i)=>{const s="free"===n?r:o,a="free"===n?!m:!v,u=t===s,c="premium"===n;return(0,d.jsx)("button",{className:`redeem${n}${t}Daily`,disabled:t<s,onPointerUp:()=>{if(c&&!l)return console.log("Upgrade to premium to claim this reward!"),void alert("This reward is for premium members only. Upgrade to Premium to claim!");a&&u&&(((t,n)=>{const i="free"===t?r:o;m&&v?console.log("Both free and premium rewards already redeemed for today."):n===i?fetch("https://us-central1-vixen-ai-3086f.cloudfunctions.net/dailyReward",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e.uid,day:n,tier:t,time:(new Date).getTime()})}).then((e=>e.json())).then((e=>{console.log("Success:",e),"free"===t?g(!0):"premium"===t&&y(!0)})).catch((e=>console.error("Error:",e))):console.log("Day does not match the current day for this tier.")})(n,t),"free"===n?g(!0):y(!0))},children:i})};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("img",{onClick:()=>n(!0),className:"dailyLogin",src:"./imgs/daily_login.webp",alt:"daily login"}),(0,d.jsx)(i_,{isOpen:t,onClose:()=>n(!1),children:(0,d.jsxs)("div",{className:"dailyLoginContent",children:[(0,d.jsx)("h1",{children:"Daily Bonus"}),(0,d.jsx)("p",{children:"Come back daily for more rewards!"}),f&&(0,d.jsxs)("p",{children:["Time until next redeem: ",f]}),(0,d.jsxs)("div",{className:"dailyLoginTiers",children:[(0,d.jsx)("h2",{children:"Free"}),(0,d.jsx)("h2",{children:"V+"})]}),(0,d.jsx)("div",{className:"dailyLoginRewards",children:Array.from({length:7}).map(((e,t)=>(0,d.jsxs)("div",{className:`daily${t}`,children:[b(t,"free",0===t?`\xa0\xa0+${g_[t]} Tokens`:`+${g_[t]} Tokens`),(0,d.jsxs)("p",{className:"dayText "+(t===w?"glowingDay":""),children:["Day ",t+1]}),b(t,"premium",`+${v_[t]} Tokens`)]},t)))})]})})]})}function w_(e){let{user:t,goHome:n,goChat:r,currentChat:i,setCurrentChat:s}=e;return(0,d.jsxs)("div",{className:"navbar",children:[t?(0,d.jsx)(p_,{user:t,goHome:()=>n(),goChat:()=>r(),currentChat:i,setCurrentChat:s}):null,t?(0,d.jsx)("img",{src:"./imgs/discord.svg",alt:"Discord",className:"discordLink",onClick:()=>{window.open("https://discord.gg/8RhTFqbkM4","_blank")}}):null,t?(0,d.jsx)(y_,{}):null,t?(0,d.jsx)(u_,{}):null]})}const b_=()=>{const[e,t]=(0,i.useState)(!1);(0,i.useEffect)((()=>{localStorage.getItem("ageConsent")||t(!0)}),[]);const n=e=>{e?(localStorage.setItem("ageConsent","true"),t(!1)):(localStorage.removeItem("ageConsent"),$b.signOut(),window.location.replace("https://www.google.com"))};return e?(0,d.jsx)("div",{className:"consent-modal",children:(0,d.jsxs)("div",{className:"consent-content",children:[(0,d.jsx)("h2",{children:"Age Verification"}),(0,d.jsx)("p",{children:"You must be 18 years or older to use this app. Do you confirm that you are over 18?"}),(0,d.jsx)("button",{onClick:()=>n(!0),children:"I am over 18"}),(0,d.jsx)("button",{onClick:()=>n(!1),children:"I am under 18"})]})}):null},__=()=>{(0,i.useEffect)((()=>{const e=$b.onAuthStateChanged((async e=>{if(e)try{const t={user:e},n=await fetch("https://us-central1-vixen-ai-3086f.cloudfunctions.net/validateUser",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!n.ok)throw new Error(`Failed to post data: ${n.statusText}`)}catch(t){console.error("Error posting data:",t)}else console.log("User is signed out.")}));return()=>e()}),[])};const I_=e=>{let{user:t,screen:n,setScreen:r,currentChat:i,updateCurrentChat:s}=e;const{settings:o}=Wb();return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(b_,{}),(0,d.jsx)("header",{className:"App-header",children:(0,d.jsx)(w_,{user:t,goHome:()=>r("home"),goChat:()=>r("chatrooms"),currentChat:i,setCurrentChat:s})}),(0,d.jsx)("section",{className:"main-content",style:{backgroundColor:o.theme.backgroundColor},children:"home"===n?(0,d.jsx)(e_,{goChat:()=>r("chatrooms"),currentChat:i,setCurrentChat:s}):"chatrooms"===n?(0,d.jsx)(a_,{user:t,currentChat:i,setCurrentChat:s}):null})]})},S_=e=>{let{user:t}=e;return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)("header",{className:"App-header",children:(0,d.jsx)(w_,{user:t})}),(0,d.jsx)("section",{className:"main-content",children:(0,d.jsx)(Kb,{})})]})},E_=function(){const[e,t]=(0,i.useState)("home"),[n]=kw($b),[r,s]=(0,i.useState)(null);return __(),(0,d.jsx)("div",{className:"App",children:n?(0,d.jsx)(Zp,{children:(0,d.jsx)(Xb,{children:(0,d.jsx)(I_,{user:n,screen:e,setScreen:t,currentChat:r,updateCurrentChat:e=>{s(e)}})})}):(0,d.jsx)(S_,{user:n})})},T_=e=>{e&&e instanceof Function&&n.e(453).then(n.bind(n,453)).then((t=>{let{getCLS:n,getFID:r,getFCP:i,getLCP:s,getTTFB:o}=t;n(e),r(e),i(e),s(e),o(e)}))};s.createRoot(document.getElementById("root")).render((0,d.jsx)(i.StrictMode,{children:(0,d.jsx)(E_,{})})),T_()})();
//# sourceMappingURL=main.679bcfd0.js.map